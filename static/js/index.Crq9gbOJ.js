const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index.594f436c.js","./monaco-editor.D3ig2Cuf.js","../css/monaco-editor.BzWl1eyH.css","./vue.ClgfzGxZ.js","./@vue.Lfky3Lsd.js","./@vueuse.BGoRStkq.js","./vue3-sfc-loader.CoUr1SK8.js","./@turf.CPgb6OuJ.js","./point-in-polygon-hao.CVtqB2KT.js","./sweepline-intersections.D78iGcFZ.js","./geojson-equality-ts.385IDfwq.js","./rbush.CLeiUrJX.js","./quickselect.cI_fw6Fh.js","./fast-deep-equal.BLADVbhr.js","./d3-geo.B8ycIn1u.js","./d3-array.0UpHvbR7.js","./concaveman.B96GfrFV.js","./tinyqueue.CiIUVAWw.js","./point-in-polygon.BrHNa-um.js","./robust-predicates.t9dwelUT.js","./skmeans.CQ19ITB9.js","./topojson-client.C_Q_XF1Z.js","./topojson-server.BJ5ICLc2.js","./polygon-clipping.C7RG_Bzj.js","./splaytree.t-pFliWO.js","./marchingsquares.DR8wX6S2.js","./d3-voronoi.DD4zjRyK.js","./dat.gui.kzZ7KUwl.js","./element-plus.CW35jMhI.js","./lodash-es.CiJSjksT.js","./@element-plus.BfX6RqXe.js","./@popperjs.D9SI2xQl.js","./@ctrl.r5W6hzzQ.js","./dayjs.By2JHiwa.js","./async-validator.DKvM95Vc.js","./memoize-one.BdPwpGay.js","./normalize-wheel-es.B6fDCfyv.js","./@floating-ui.8uccrNCM.js","../css/element-plus.B2tId5af.css","./vue-router.bYO7SHUI.js","./pinia.CteNNo4a.js","./lodash.k7QQcLOC.js","./echarts.pFRMlpcI.js","./zrender.DGSZmGY9.js","../css/index.C1tgC0g0.css","../css/cesium.BHwS5cQ6.css","./index.1e92a8a7.js","../css/index.6XvRZn7p.css"])))=>i.map(i=>d[i]);
var ei=Object.defineProperty;var ti=(a,e,t)=>e in a?ei(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var r=(a,e,t)=>ti(a,typeof e!="symbol"?e+"":e,t);import"./vue.ClgfzGxZ.js";/* empty css               */import{E as ii,a as Dt,b as si,i as oi,z as ni}from"./element-plus.CW35jMhI.js";import{d as Q,M as De,O as W,u as P,ai as j,o as F,U as x,c as B,a as g,I as Be,b as D,j as ce,T as J,J as Et,F as ai,a8 as ri,P as Le,V as ke,k as Lt,n as kt,S as pe,R as it,A as $e,D as oe,a2 as li,Z as ci,e as xe,H as hi,ah as di,z as ui,as as mi,au as pi}from"./@vue.Lfky3Lsd.js";import{c as gi,d as fi}from"./pinia.CteNNo4a.js";import{_ as At}from"./monaco-editor.D3ig2Cuf.js";import{c as wi,a as vi}from"./vue-router.bYO7SHUI.js";import{Q as Ci,u as _i,z as yi,R as Si,S as bi,T as xi,U as Pi,V as Mi}from"./@element-plus.BfX6RqXe.js";import{d as Ti}from"./dat.gui.kzZ7KUwl.js";import{l as Di}from"./lodash.k7QQcLOC.js";import{b as Ei,p as Li,d as ki,l as Ai,e as Ri}from"./@turf.CPgb6OuJ.js";import{i as Ii}from"./echarts.pFRMlpcI.js";import"./lodash-es.CiJSjksT.js";import"./@vueuse.BGoRStkq.js";import"./@popperjs.D9SI2xQl.js";import"./@ctrl.r5W6hzzQ.js";import"./dayjs.By2JHiwa.js";import"./async-validator.DKvM95Vc.js";import"./memoize-one.BdPwpGay.js";import"./normalize-wheel-es.B6fDCfyv.js";import"./@floating-ui.8uccrNCM.js";import"./point-in-polygon-hao.CVtqB2KT.js";import"./sweepline-intersections.D78iGcFZ.js";import"./geojson-equality-ts.385IDfwq.js";import"./rbush.CLeiUrJX.js";import"./quickselect.cI_fw6Fh.js";import"./fast-deep-equal.BLADVbhr.js";import"./d3-geo.B8ycIn1u.js";import"./d3-array.0UpHvbR7.js";import"./concaveman.B96GfrFV.js";import"./tinyqueue.CiIUVAWw.js";import"./point-in-polygon.BrHNa-um.js";import"./robust-predicates.t9dwelUT.js";import"./skmeans.CQ19ITB9.js";import"./topojson-client.C_Q_XF1Z.js";import"./topojson-server.BJ5ICLc2.js";import"./polygon-clipping.C7RG_Bzj.js";import"./splaytree.t-pFliWO.js";import"./marchingsquares.DR8wX6S2.js";import"./d3-voronoi.DD4zjRyK.js";import"./zrender.DGSZmGY9.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();const Hi=Q({__name:"App",setup(a){const e="production",i="https://cesium.com/downloads/cesiumjs/releases/1.120/Build/Cesium/";return window.CESIUM_BASE_URL=i,console.log(`模式: ${e}, CESIUM_BASE_URL: ${i}`),(s,o)=>{const n=j("router-view");return F(),De(P(ii),{size:"default"},{default:W(()=>[x(n)]),_:1})}}}),ie=(a,e)=>{const t=a.__vccOpts||a;for(const[i,s]of e)t[i]=s;return t},zi=ie(Hi,[["__scopeId","data-v-6ec92aea"]]),Vi=gi();function Ni(a){a.use(Vi)}const Ui=()=>At(()=>import("./index.594f436c.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45]),import.meta.url),Fi=()=>At(()=>import("./index.1e92a8a7.js"),__vite__mapDeps([46,3,4,40,28,29,5,30,31,32,33,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,34,35,36,37,38,1,2,39,27,41,42,43,47,45]),import.meta.url),Oi=[{path:"/",redirect:"/examples"},{path:"/examples",component:Fi,name:"examples"},{path:"/examples/preview",component:Ui,name:"preview"}],Bi=wi({history:vi(),routes:Oi,scrollBehavior:()=>({left:0,top:0})}),Wi=Q({name:"IconSvg",props:{value:{type:String,required:!0}}}),$i={key:0,class:"com-icon"},Gi={class:"com-icon-svg","aria-hidden":"true"},ji=["xlink:href"];function Yi(a,e,t,i,s,o){return a.value.indexOf("#")===0?(F(),B("i",$i,[(F(),B("svg",Gi,[g("use",{"xlink:href":a.value},null,8,ji)]))])):(F(),B("i",{key:1,class:Be(a.value)},null,2))}const Zi=ie(Wi,[["render",Yi],["__scopeId","data-v-f8504d79"]]);let Ge;function he(){return{getMainViewer:()=>new Promise(t=>{const i=setInterval(()=>{Ge&&(clearInterval(i),t(Ge))},10)}),setMainViewer:t=>{Ge=t}}}const Ie=window.Cesium,qi=`
  uniform sampler2D colorTexture;
  uniform bool showLightning;
  in vec2 v_textureCoordinates;
  

  float rand(float x)
  {
    return fract(sin(x)*75154.32912);
  }

  // 使用Perlin噪声生成3D伪随机噪声
  float rand3d(vec3 x)
  {
    return fract(375.10297*sin(dot(x,vec3(103.0139,227.0595,31.05914))));
  }
  // 生成1D Perlin噪声
  float noise(float x)
  {
    float i=floor(x);
    float a=rand(i),b=rand(i+1.);
    float f=x-i;
    return mix(a,b,f);
  }

  // 结合多个1D Perlin噪声的八度
  float perlin(float x)
  {
    float r=0.,s=1.,w=1.;
    for(int i=0;i<6;i++){
      s*=2.;
      w*=.5;
      r+=w*noise(s*x);
    }
    return r;
  }
  // 生成3D Perlin噪声
  float noise3d(vec3 x)
  {
    vec3 i=floor(x);
    float i000=rand3d(i+vec3(0.,0.,0.)),i001=rand3d(i+vec3(0.,0.,1.));
    float i010=rand3d(i+vec3(0.,1.,0.)),i011=rand3d(i+vec3(0.,1.,1.));
    float i100=rand3d(i+vec3(1.,0.,0.)),i101=rand3d(i+vec3(1.,0.,1.));
    float i110=rand3d(i+vec3(1.,1.,0.)),i111=rand3d(i+vec3(1.,1.,1.));
    vec3 f=x-i;
    return mix(mix(mix(i000,i001,f.z),mix(i010,i011,f.z),f.y),
    mix(mix(i100,i101,f.z),mix(i110,i111,f.z),f.y),f.x);
  }

  // 结合多个3D Perlin噪声的八度
  float perlin3d(vec3 x)
  {
    float r=0.;
    float w=1.,s=1.;
    for(int i=0;i<5;i++){
      w*=.5;
      s*=2.;
      r+=w*noise3d(s*x);
    }
    return r;
  }

  // 基于Perlin噪声生成闪电形状
  float f(float y)
  {
    float w=.4;// 走向宽度
    return w*(perlin(2.*y)-.5);
  }

  // 绘制闪电，可选择增加厚度
  float plot(vec2 p,float d,bool thicker)
  {
    if(thicker)d+=5.*abs(f(p.y+.001)-f(p.y));
    return smoothstep(d,0.,abs(f(p.y)-p.x));
  }

  // 基于3D Perlin噪声生成云效果
  float cloud(vec2 uv,float speed,float scale,float cover)
  {
    float iTime=czm_frameNumber*.008;
    float c=perlin3d(vec3(uv*scale,iTime*speed*2.));
    return max(0.,c-(1.-cover));
  }

  vec3 render(vec2 uv)
  {
    float iTime=czm_frameNumber*.008;
    float x=iTime+.1;
    float m=.25;// 闪电形状持续时间
    float i=floor(x/m);
    float f=x/m-i;
    float k=.4;// 闪电间隔/频率
    float n=noise(i);
    float t=ceil(n-k);
    float d=max(0.,n-k)/(1.-k);
    float o=ceil(t-f-(1.-d));
    float gt=.1;
    float go=ceil(t-f-(1.-gt));

    float lightning=0.;
    float light=0.;
    float glare=0.;
    if(o==1.){
      vec2 uv2=uv;
      uv2.y+=i*2.;
      float p=(noise(i+10.)-.5)*2.;
      uv2.x-=p;

      float strike=plot(uv2,.01,true);
      float glow=plot(uv2,.04,false);
      float glow2=plot(uv2,1.5,false);

      lightning=strike*.4+glow*.15;

      float h=noise(i+5.);
      lightning*=smoothstep(h,h+.05,uv.y+perlin(1.2*uv.x+4.*h)*.03);
      lightning+=glow2*.3;
      light=smoothstep(5.,0.,abs(uv.x-p));
      glare=go*light;
    }

    vec3 clouds=
    vec3(.5,.7,1.)*mix(.6,.9,cloud(uv,.2,.1,1.))+
    vec3(.7,.8,1.)*.6*cloud(uv*vec2(.5,1.),.06,.8,.8)+
    vec3(.9,.9,1.)*.3*cloud(uv*vec2(.1,1.),.08,5.5,.6)+
    vec3(1.,1.,1.)*.4*cloud(uv*vec2(.1,1.),.07,10.,.5);

    vec3 background=vec3(.8);//背景颜色
    background*=(.2+light*.5);
    if(showLightning == true){
      return vec3(background+lightning+glare);
    }else {
      return vec3(background+glare);
    }
    
  }

  void main()
  {
    vec2 iResolution=czm_viewport.zw;
    vec2 uv=(gl_FragCoord.xy*2.-iResolution.xy)/iResolution.y;

    out_FragColor=vec4(render(uv),1.);

    vec4 sceneColor=texture(colorTexture,v_textureCoordinates);
    out_FragColor=mix(out_FragColor,sceneColor,.5);
  }
`;class Ji{constructor(e){r(this,"_viewer");r(this,"showLightning",!1);r(this,"_lighting");this._viewer=e}init(){this._lighting=new Ie.PostProcessStage({name:"weather_lighting",fragmentShader:qi,uniforms:{fogByDistance:new Ie.Cartesian4(10,0,1e3,.8),fogColor:Ie.Color.WHITE,showLightning:()=>this.showLightning}}),this._viewer.scene.postProcessStages.add(this._lighting),this._viewer.scene.postRender.addEventListener(()=>{const e=Ie.Math.toDegrees(this._viewer.camera.pitch);this.showLightning=e>-15})}destroy(){var e;this.clear(),(e=this._lighting)==null||e.destroy()}clear(){!this._viewer||!this._lighting||this._viewer.scene.postProcessStages.remove(this._lighting)}show(e){e?this.init():this.clear()}}const He=window.Cesium;class Xi{constructor(e,t){r(this,"viewer");r(this,"angle");r(this,"size");r(this,"speed");r(this,"rainStage");if(!e)throw new Error("no viewer object!");t=t||{},this.angle=He.defaultValue(t.angle,-.6),this.size=He.defaultValue(t.size,.1),this.speed=He.defaultValue(t.speed,1e3),this.viewer=e,this.init()}show(e){this.rainStage.enabled=e}init(){this.rainStage=new He.PostProcessStage({name:"czml_rain",fragmentShader:this.rain(),uniforms:{angle:()=>this.angle,size:()=>this.size,speed:()=>this.speed}}),this.viewer.scene.postProcessStages.add(this.rainStage)}destroy(){!this.viewer||!this.rainStage||this.viewer.scene.postProcessStages.remove(this.rainStage)}rain(){return`uniform sampler2D colorTexture;
              varying vec2 v_textureCoordinates;
              uniform float angle;
              uniform float size;
              uniform float speed;
              float hash(float x){
                  return fract(sin(x*133.3)*13.13);
          }
          void main(void){
              float time = czm_frameNumber / speed;
              vec2 resolution = czm_viewport.zw;
              vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);
              vec3 c=vec3(.6,.7,.8);
              float a=angle;
              float si=sin(a),co=cos(a);
              uv*=mat2(co,-si,si,co);
              uv*=length(uv+vec2(0,4.9))*size + 1.;
              float v=1.-sin(hash(floor(uv.x*100.))*2.);
              float b=clamp(abs(sin(20.*time*v+uv.y*(5./(2.+v))))-.95,0.,1.)*20.;
              c*=v*b; 
              gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(c,1), 0.5);  
          }
           `}}const Ki=window.Cesium.Cartesian4,Qi=window.Cesium.Color,es=window.Cesium.PostProcessStage;class ts{constructor(e){r(this,"viewer");r(this,"collection");r(this,"postProcessState");r(this,"_fogByDistance",{near:100,nearValue:.35,far:4e3,farValue:.9});r(this,"_color",new Qi(1,1,1,1));r(this,"_visibility",.4);this.viewer=e,this.collection=e.scene.postProcessStages}set fogByDistance(e){this._fogByDistance=e}get fogByDistance(){return this._fogByDistance}set color(e){this._color=e}get color(){return this._color}get visibility(){return this._visibility}set visibility(e){this._visibility=e}_createPostProcessStage(){var e,t,i,s;this.postProcessState=new es({name:"czm_fog",fragmentShader:this._getFs(),uniforms:{fogColor:()=>this._color,visibility:()=>this._visibility,fogByDistance:new Ki(((e=this._fogByDistance)==null?void 0:e.near)||10,((t=this._fogByDistance)==null?void 0:t.nearValue)||0,((i=this._fogByDistance)==null?void 0:i.far)||200,((s=this._fogByDistance)==null?void 0:s.farValue)||1)}}),this.collection.add(this.postProcessState)}_getFs(){return`float getDistance(sampler2D depthTexture, vec2 texCoords)
              {
                  float depth = czm_unpackDepth(texture(depthTexture, texCoords));
                  if (depth == 0.0) {
                      return czm_infinity;
                  }
                  vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, depth);
                  return -eyeCoordinate.z / eyeCoordinate.w;
              }
              //根据距离，在中间进行插值
              float interpolateByDistance(vec4 nearFarScalar, float distance)
              {
                  //根据常识，雾应该是距离远，越看不清，近距离内的物体可以看清
                  //因此近距离alpha=0，远距离的alpha=1.0
                  //本例中设置可见度为200米
                  //雾特效的起始距离
                  float startDistance = nearFarScalar.x;
                  //雾特效的起始alpha值
                  float startValue = nearFarScalar.y;
                  //雾特效的结束距离
                  float endDistance = nearFarScalar.z;
                  //雾特效的结束alpha值
                  float endValue = nearFarScalar.w;
                  //根据每段距离占总长度的占比，插值alpha，距离越远，alpha值越大。插值范围0,1。
                  float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);
                  return mix(startValue, endValue, t);
              }
              vec4 alphaBlend(vec4 sourceColor, vec4 destinationColor)
              {
                  return sourceColor * vec4(sourceColor.aaa, 1.0) + destinationColor * (1.0 - sourceColor.a);
              }
              uniform sampler2D colorTexture;
              uniform sampler2D depthTexture;
              uniform vec4 fogByDistance;
              uniform vec4 fogColor;
              in vec2 v_textureCoordinates;
              void main(void)
              {
                  //获取地物距相机的距离
                  float distance = getDistance(depthTexture, v_textureCoordinates);
                  //获取场景原本的纹理颜色
                  vec4 sceneColor = texture(colorTexture, v_textureCoordinates);
                  //根据距离，对alpha进行插值
                  float blendAmount = interpolateByDistance(fogByDistance, distance);
                  //将alpha变化值代入雾的原始颜色中，并将雾与场景原始纹理进行融合
                  vec4 finalFogColor = vec4(fogColor.rgb, fogColor.a * blendAmount);
                  out_FragColor = alphaBlend(finalFogColor, sceneColor);
              }`}open(){const e=this.viewer.scene;this.postProcessState||(this._createPostProcessStage(),e.skyAtmosphere.hueShift=0,e.skyAtmosphere.saturationShift=0,e.skyAtmosphere.brightnessShift=.7,e.fog.density=5e-4,e.fog.minimumBrightness=.03)}close(){const e=this.viewer.scene;this.postProcessState&&(this.collection.remove(this.postProcessState),this.postProcessState=void 0,e.skyAtmosphere.hueShift=0,e.skyAtmosphere.saturationShift=0,e.skyAtmosphere.brightnessShift=.4,e.fog.density=2e-4,e.fog.minimumBrightness=.03)}}const is=window.Cesium.PostProcessStage;class ss{constructor(e){r(this,"viewer");r(this,"collection");r(this,"speed",80);r(this,"size",.02);r(this,"postProcessState");this.viewer=e,this.collection=e.scene.postProcessStages}_createPostProcessStage(){this.postProcessState=new is({name:"czm_snow",fragmentShader:this._getFs(),uniforms:{speed:()=>this.speed,size:()=>this.size}}),this.collection.add(this.postProcessState)}_getFs(){return`uniform sampler2D colorTexture;
    varying vec2 v_textureCoordinates;
    uniform float speed;
    uniform float size;
    float snow(vec2 uv,float scale)
    {
        float time = czm_frameNumber / speed;
        float w=smoothstep(1.,0.,-uv.y*(scale/10.));if(w<.1)return 0.;
        uv+=time/scale;uv.y+=time*2./scale;uv.x+=sin(uv.y+time*.5)/scale;
        uv*=scale;vec2 s=floor(uv),f=fract(uv),p;float k=3.,d;
        p=.5+.35*sin(11.*fract(sin((s+p+scale)*mat2(7,3,6,5))*5.))-f;d=length(p);k=min(d,k);
        k=smoothstep(0.,k,sin(f.x+f.y)*size);
        return k*w;
    }
    void main(void){
        vec2 resolution = czm_viewport.zw;
        vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);
        vec3 finalColor=vec3(0);
        float c = 0.0;
        c+=snow(uv,30.)*.0;
        c+=snow(uv,20.)*.0;
        c+=snow(uv,15.)*.0;
        c+=snow(uv,10.);
        c+=snow(uv,8.);
        c+=snow(uv,6.);
        c+=snow(uv,5.);
        finalColor=(vec3(c)); 
        gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(finalColor,1), 0.5); 
    }
`}open(){const e=this.viewer.scene;this.postProcessState||(this._createPostProcessStage(),e.skyAtmosphere.hueShift=-.8,e.skyAtmosphere.saturationShift=-.7,e.skyAtmosphere.brightnessShift=-.33,e.fog.density=.001,e.fog.minimumBrightness=.8)}close(){const e=this.viewer.scene;this.postProcessState&&(this.collection.remove(this.postProcessState),this.postProcessState=void 0,e.skyAtmosphere.hueShift=0,e.skyAtmosphere.saturationShift=0,e.skyAtmosphere.brightnessShift=.4,e.fog.density=2e-4,e.fog.minimumBrightness=.03)}}const lt=window.Cesium;class os{constructor(e,t){r(this,"viewer");r(this,"options");r(this,"alpha");r(this,"snowcoverStage");this.viewer=e,this.options=t||{},this.alpha=1,this.init()}init(){this.snowcoverStage=new lt.PostProcessStage({name:"czm_snowcover",fragmentShader:this.snowcover(),uniforms:{alpha:()=>this.alpha}}),this.viewer.scene.postProcessStages.add(this.snowcoverStage)}destroy(){this.snowcoverStage&&(this.viewer.scene.postProcessStages.remove(this.snowcoverStage),lt.destroyObject(this.snowcoverStage))}open(){this.snowcoverStage&&(this.snowcoverStage.enabled=!0)}close(){this.snowcoverStage&&(this.snowcoverStage.enabled=!1)}changeAlpha(e){this.snowcoverStage&&(this.snowcoverStage.uniforms.alpha=e)}snowcover(){return`
        uniform float alpha;
        uniform sampler2D colorTexture;
        uniform sampler2D depthTexture;
        in vec2 v_textureCoordinates;
        vec4 toEye(in vec2 uv,in float depth){
            vec2 xy = vec2((uv.x*2.-1.),(uv.y*2.-1.));
            vec4 posInCamera = czm_inverseProjection * vec4(xy,depth,1.);
            posInCamera = posInCamera / posInCamera.w;
            return posInCamera;
        }
        float getDepth(in vec4 depth){
            float z_window = czm_unpackDepth(depth);
            z_window = czm_reverseLogDepth(z_window);
            float n_range = czm_depthRange.near;
            float f_range = czm_depthRange.far;
            return(2.*z_window-n_range-f_range)/(f_range-n_range);
        }
        void main(void)
        {
            vec4 white = vec4(1.0,1.0,1.0,1.0);
            vec4 color = texture(colorTexture, v_textureCoordinates);
            vec4 originDepth = texture(depthTexture, v_textureCoordinates);
            float depth = czm_unpackDepth(originDepth);
            vec4 positionEC = toEye(v_textureCoordinates,depth);
            vec4 positionWC = czm_inverseView * positionEC;
            float padx = czm_pixelRatio / czm_viewport.z;
            float pady = czm_pixelRatio / czm_viewport.w;
            float depth2 = getDepth(texture(depthTexture, v_textureCoordinates + vec2(-padx,0.))); 
            vec4 eyeCoordinates2 = toEye(v_textureCoordinates + vec2(-padx,0.),depth2);
            float depth3 = getDepth(texture(depthTexture, v_textureCoordinates + vec2(padx,0.))); 
            vec4 eyeCoordinates3 = toEye(v_textureCoordinates + vec2(padx,0.),depth3);
            float depth4 = getDepth(texture(depthTexture, v_textureCoordinates + vec2(0.,-pady))); 
            vec4 eyeCoordinates4 = toEye(v_textureCoordinates + vec2(0.,-pady),depth4);
            float depth5 = getDepth(texture(depthTexture, v_textureCoordinates + vec2(0.,pady))); 
            vec4 eyeCoordinates5 = toEye(v_textureCoordinates + vec2(0.,pady),depth5);
            vec3 dx = eyeCoordinates3.xyz - eyeCoordinates2.xyz;
            vec3 dy = eyeCoordinates4.xyz - eyeCoordinates5.xyz;
            vec3 normalEC = normalize(cross(dy,dx));
            vec3 normalWC = czm_inverseViewRotation * normalEC;
            vec3 upWC = normalize(positionWC.xyz);
            float angle = dot(upWC,normalWC);
            if(depth>=1.0){
                out_FragColor = color;
            }else{
                // out_FragColor = mix(color,white,(angle<=0.1?0.1:angle)*alpha);
                out_FragColor = mix(color,white,clamp(angle,0.,1.*alpha));
            }
        }
            `}}const ns="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAYCAYAAADH2bwQAAAAAXNSR0IArs4c6QAAATlJREFUOE9t0jFLllEYxvHfJb5JOARCkUJDQkSLQ07tDeESDk5+AAdBw4IEC4qMhiAyqA8QLQ21Rq1+ghrcqy3BJRsE6cSJR3mf531uOJzh/Lnu+77OFUNVSjmLOzhO8rw+pQOsYg4/kjxtAaWU61jBH2wnOegCm7iMd0l2T5T/tyilzOI+Duud5LgLLOIWviT5MDzXicI9XMFOkr0WUEoZwyuM426SOuRppZQyiRf4naQqtaoCF/AEv5I87AMu4QF+JtnuA85XY7CfpIIjLar/L3GUZG0EaIyqW0xgY2SLBtjAVbxO8q3PqNtYwOckH/uA6mL1oP7gVpK/rb9o2jzGRbxJ8rUPuIklfMezJKWbhzOoKlP4hHN4343cNawPRfFRF7iBZQyaGXa6wDTmmzODty2gk/AKD/4B12Z3rk70mscAAAAASUVORK5CYII=",as="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAuCAYAAABXuSs3AAAAAXNSR0IArs4c6QAABY1JREFUaEPtWG1Mm1UUfk4FUb7KgH2wjfI5PsLX4mKWLBr1x3646TTqD2OWOSMZNupQo3GJLmuzaGY0WUBNN8Woy2L2Q41OR0z846JZshjJYBI+Bi2UfbAB0haYw0GvOe0tvC3v+/altOKS3T+8Kfee+9xzn/Occw/hFh10i+LGbeCRN3f09Jka/q3hgS3nE3GrCfP4he9/sDHgDY89Gvgb75Ew4M6vv3Ex2OKnniyKN2i2lxDgR0+drqkfHWhn8y25eXUN27fGnS5xAS6EMAEwA8gAkDrwY2tj/vCVF4gA9+q8I4WPbGsCcB3ABAAvEfmXegtLAi6ESAGwBkA2AAYfGK7jX520TPrW8rc7PfNy0c5ndiiAMui/AAwT0XSsB4gJuBCC160DsErSTQCYAuD59pezRTs6/zgD4Q/aJpM4WbVpyxMPbmbOZwFIU6y5BuASEfH6RY1FA5deLgFwNwDecEzpvZ5PP7MVT/gOKFE40zLt5Q3PB9RFcUs58gB/A+hfrPcXBVwIwWA3AEgGcINZQUTM3bnR97HDVTA1WSgCZwoOd1rGQOmL1jB1EUKkAuDf7gJwE8AFIuJDGBqGgUtPlUvQPumlsCD78Ph3NXuGutvJH6JJEIMgk/gkv6Lu5Z2Ph6mLDGq+vUwJvseo5w0Bl5yulPRg0H1qvOw63GQr9nnDaBJynzPTbK98tXFBMpK2SyV49niXEc4bBb4ewGpJDzasKme9hz5wFUz5CoPUD0QmkzrwNZhuHijb97pqMpKeZ8cwba4S0cVofIkKXFKkShrqjuR0aAPHsRPVz3V1dCCoOCHY80wnEp9X1tZadz39pxooyfkK+b/OaJQxArwAQC6AUSIa1PJE58F3bCVejypNgjdA6Ddn2av2v6VZuwghDO0l71L7UuQV1knZ0vVC936bq8DnKQSnS0mP0DcRsQxiMNM8UHHQrlm7KG6XT9qul2F1PS6EWMF1EqdqIurVOqLDcaz62c7fO0hBE1U6EIkvq+6ttVp3qdIloEBCsHKlA3AS0bjWntGAWwCsBHCRiK5q0mTf27ai8VENmihWCaA/O9tec+hdPbqwCLAYjBCRO1bgHCycollfJ7WMdL32hqvAM14oVVtXEAbN2QOVh9/Xowt7m70+RUTdsQJnficB6CAizm4LRlOTo7q+7WyYmvyUlAxrSiq4AnPcuI6HZpVLSbRs2lzb2GjVUhfOyrUAZoioPVbg98jAbNNKCudfesVWPDZyIFTZc1Stz8qFh4MUQMnsLDq8YwgGahCGMyfHXvNRsypdZELifQURtSUMOHqH94IE19uSKQI40gxMcynD9eAKYPee8P0FNaJsTbNqAAcDfMnAo1IF7pG1mJ4ZUtbjcPUDP7cCdyQBWx8GLJL+QaR+pCTlw7LysgbwuFDFUHCi98qvINynG5VzN4LfUJZ3v9ZcIURcgtOQHC6gi94JdGjCy4QQcZHDUAKaJKIeTTxqdFGfrEsTCTwuCYjfkYZSviG6iKg0YQXlgm5pKV96wFjhE6kuqpGnrSaL2stIX8VoWYueoXUwJXGKnnvtR2CPpib8lItfWSs9YeghoUsXHZok5CEhgXNSiPp001UXDTVJ6NNNgufA0X0s69DFD/+MBeX5l5T0SfhjeT6bR29PqNJFhSb/WXtCAZ49r9kQQt/wXghF7RK4rnk1WZaGkAK8Zgtu++iEudUz1aVQF/+2rLTKU7kZ3mVtwUVwVLXpaXZea/H5/Rt5bqbJdM5bvKpesW75mp6RuSWyzbzRPba7/Z+bb/K8ujuT3ztnyfnif9Vm1qxd5pMR1NTEUBUZZVLUvkrMm3Cpy0OnhI3ZtpGUH7NxVhcepeovnZjtyoWJ8zjThUdE0lkq4ND6xAGPF0INO7eBJ9jBC8z/C+8LjE3U8aGyAAAAAElFTkSuQmCC",rs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAYCAYAAADH2bwQAAAAAXNSR0IArs4c6QAAAS1JREFUOE990qFrVlEYB+DnN1EwDIO2JRf0H7AYDNq0uLaFgRa7YnAGg4rCxKBhTRBMGwzGBsJgUYxiFCyC2GyfRvGV8+3e8W1+d7ece899OOc97/lF91TVDVzDWpJv/XwmwE00NMLjJL/bv0kwg7u4iI9J3h0C7aOqzuFJe8XDJKODFSa2uoNLeJ9kZxq4gPv4keTpNHACr9HGe/+BrpYHmMerIXAbl/F2CCx2TdsYAgu4ju0hsISrWB8CfS/eDIEVnMfLaX042Y6H8d0c18nvSZ5NA8u4gt0kW4dAVZ3GKk7hUZKfR0Efmi9JWh37gamqdu4Ws1tdcat97HrwHGe7TOwl2TzIZFU1tNZdb5v/MO5g8me8RVWdwQv8wmd8wtckf3swi7nJyX75Nv4D8ft3lTEQxGsAAAAASUVORK5CYII=",I=window.Cesium,ls=Q({__name:"Dimensions",setup(a){const{getMainViewer:e}=he(),t=D(2),i=()=>{t.value=t.value===3?2:3,t.value===3?s(d,!0):o(d,-45)},s=(c,h=!0)=>{const C=c.scene.screenSpaceCameraController;C.enableRotate=!0,C.enableTilt=!h,C.enableZoom=!0;const v=c.container,_=new I.Cartesian2(v.offsetWidth/2,v.offsetHeight/2),f=n(c,_);l(c,f.surfacePosition,-88)},o=(c,h=-45)=>{const C=c.scene.screenSpaceCameraController;C.enableRotate=!0,C.enableTilt=!0,C.enableZoom=!0;const v=c.container,_=new I.Cartesian2(v.offsetWidth/2,v.offsetHeight/2),f=n(c,_);(f.wgs84SurfacePosition??f.wgs84Position)&&l(c,f.surfacePosition,h)},n=(c,h)=>{const C=c.scene,v=C.pick(h),_=C.drillPick(h);let f,u,w,L,T=!1;C.pickPositionSupported&&(f=C.pickPosition(h));const O=c.scene.drillPick(h);for(const k of O)(k&&k.primitive instanceof I.Cesium3DTileFeature||k&&k.primitive instanceof I.Cesium3DTileset||k&&k.primitive instanceof I.Model)&&(T=!0);if(T&&(c.scene.pick(h),f=c.scene.pickPosition(h),f)){const k=I.Cartographic.fromCartesian(f);k.height<0&&(k.height=0);const de=I.Math.toDegrees(k.longitude),ee=I.Math.toDegrees(k.latitude),Se=k.height;f=I.Cartesian3.fromDegrees(de,ee,Se)}if(f){const k=I.Ellipsoid.WGS84.cartesianToCartographic(f);k&&(w={longitude:I.Math.toDegrees(k.longitude),latitude:I.Math.toDegrees(k.latitude),height:k.height})}if(C.mode===I.SceneMode.SCENE3D&&!(c.terrainProvider instanceof I.EllipsoidTerrainProvider)){const k=C.camera.getPickRay(h);u=C.globe.pick(k,C)}else u=C.camera.pickEllipsoid(h,I.Ellipsoid.WGS84);if(u){const k=I.Ellipsoid.WGS84.cartesianToCartographic(u);k&&(L={longitude:I.Math.toDegrees(k.longitude),latitude:I.Math.toDegrees(k.latitude),height:k.height})}if(!f&&(f=u),f&&u){const k=I.Ellipsoid.WGS84.cartesianToCartographic(f).height;I.Ellipsoid.WGS84.cartesianToCartographic(u).height>k&&(f=u)}return{target:v,targets:_.reverse(),windowPosition:h,position:f,wgs84Position:w,surfacePosition:u,wgs84SurfacePosition:L}},l=(c,h,C,v=.5)=>{const _=c.camera.pitch,u=(I.Math.toRadians(C)-_)/v,w=I.Cartesian3.distance(h,c.scene.camera.positionWC),L=I.JulianDate.fromDate(new Date),T=I.JulianDate.addSeconds(L,v,new I.JulianDate);c.clock.startTime=L.clone(),c.clock.stopTime=T.clone(),c.clock.currentTime=L.clone(),c.clock.clockRange=I.ClockRange.CLAMPED,c.clock.clockStep=I.ClockStep.SYSTEM_CLOCK;const O=c.camera.heading,k=()=>{const de=I.JulianDate.secondsDifference(c.clock.currentTime,c.clock.startTime),ee=O,Se=de*u+_;c.camera.lookAt(h.clone(),new I.HeadingPitchRange(ee,Se,w)),c.camera.lookAtTransform(I.Matrix4.IDENTITY),I.JulianDate.greaterThanOrEquals(c.clock.currentTime,c.clock.stopTime)&&c.clock.onTick.removeEventListener(k)};c.clock.onTick.addEventListener(k)};let d=null;return ce(async()=>{d=await e()}),(c,h)=>(F(),B("div",{id:"icon2d",class:"icon2d",onClick:i},J(P(t)===2?"2D":"3D"),1))}}),cs=ie(ls,[["__scopeId","data-v-8c8eb3ec"]]),hs={class:"bottomTool"},ds={style:{margin:"10px 0"}},us=["onClick"],V=window.Cesium,ms=Q({__name:"index",setup(a){const{getMainViewer:e}=he();let t=null,i=0;const s=D("rotatez-t"),o=D(""),n=D([{name:"主页",icon:"iconfont-ms icon-zhuye"},{name:"放大",icon:"el-icon-zoom-in"},{name:"缩小",icon:"el-icon-zoom-out"}]);ce(async()=>{t=await e(),d()});const l=f=>{const u=t;if(f.name==="放大")h(u);else if(f.name==="缩小")C(u);else if(f.name==="主页"){const w=V.Cartesian3.fromDegrees(116.38949654287501,39.906638611739446,58e3);u.camera.flyTo({destination:w,orientation:{heading:0,pitch:V.Math.toRadians(-90),roll:0},duration:.8})}},d=()=>{i&&i(i),i=setTimeout(()=>{t.scene.postRender.addEventListener(()=>{const f=V.Math.toDegrees(t.camera.heading),u=90-V.Math.toDegrees(t.camera.pitch);o.value="transform: rotateX("+u+"deg) rotateZ("+f+"deg)"})},3500)},c=()=>{const f=t.scene,u=t.camera;let w=new V.Cartesian3;if(t.trackedEntity)w=t.trackedEntity.position.getValue(t.clock.currentTime,w);else{const L=new V.Ray(u.positionWC.clone(),u.directionWC.clone());w=f.globe.pick(L,f,w)}w?u.flyToBoundingSphere(new V.BoundingSphere(w,0),{offset:new V.HeadingPitchRange(0,u.pitch,V.Cartesian3.distance(u.position,w)),duration:1}):u.flyTo({destination:u.position,orientation:{heading:0,pitch:u.pitch,roll:u.roll}})},h=f=>{const u=f.scene,w=f.camera,L=u.screenSpaceCameraController;if(u.mode===V.SceneMode.MORPHING||!L.enableInputs||u.mode===V.SceneMode.COLUMBUS_VIEW)return!0;if(u.mode===V.SceneMode.SCENE2D)w.zoomIn(w.positionCartographic.height*.5);else if(u.mode===V.SceneMode.SCENE3D){const T=_(u),O=v(w,T,1/2);w.flyTo({destination:O,orientation:{heading:w.heading,pitch:w.pitch,roll:w.roll},duration:.5})}},C=f=>{const{camera:u,scene:w}=f,L=w.screenSpaceCameraController;if(w.mode===V.SceneMode.MORPHING||!L.enableInputs||w.mode===V.SceneMode.COLUMBUS_VIEW)return!0;if(w.mode===V.SceneMode.SCENE2D)u.zoomOut(u.positionCartographic.height);else if(w.mode===V.SceneMode.SCENE3D){const T=_(w),O=v(u,T,-1);u.flyTo({destination:O,orientation:{heading:u.heading,pitch:u.pitch,roll:u.roll},duration:.5,convert:!1})}},v=(f,u,w)=>{const L=new V.Cartesian3,T=V.Cartesian3.subtract(u,f.position,L),O=V.Cartesian3.multiplyByScalar(T,w,L);return V.Cartesian3.add(f.position,O,L)},_=f=>{const u=new V.Ray(f.camera.positionWC,f.camera.directionWC),w=V.IntersectionTests.rayEllipsoid(u,V.Ellipsoid.WGS84);return w?V.Ray.getPoint(u,w.start):V.IntersectionTests.grazingAltitudeLocation(u,V.Ellipsoid.WGS84)};return(f,u)=>{const w=j("el-tooltip"),L=j("el-icon");return F(),B("div",hs,[g("div",{style:Et(P(o)),class:"zhinan",onClick:c},[u[0]||(u[0]=g("img",{src:ns,class:"left"},null,-1)),x(w,{class:"item",effect:"light",content:"指北针",placement:"left","popper-class":"draw_share_atooltip"},{default:W(()=>[g("img",{src:as,class:Be([P(s),"compass"])},null,2)]),_:1}),u[1]||(u[1]=g("img",{src:rs,class:"right"},null,-1))],4),g("div",ds,[x(cs)]),g("ul",null,[(F(!0),B(ai,null,ri(P(n),(T,O)=>(F(),B("li",{key:O,onClick:k=>l(T)},[Le(x(L,null,{default:W(()=>[x(P(Ci))]),_:2},1536),[[ke,T.name==="主页"]]),Le(x(L,null,{default:W(()=>[x(P(_i))]),_:2},1536),[[ke,T.name==="放大"]]),Le(x(L,null,{default:W(()=>[x(P(yi))]),_:2},1536),[[ke,T.name==="缩小"]])],8,us))),128))])])}}}),Y=window.Cesium;class ps{constructor(e){r(this,"viewer");r(this,"layerMap");r(this,"layerInfoMap");this.viewer=e,this.layerMap=new Map,this.layerInfoMap=new Map}createLayer(e){let t=null;const{type:i}=e,s=e.url||e.layerUrl;return new Promise(o=>{i==="ArcGisMapServer"?Y.ArcGisMapServerImageryProvider.fromUrl(s).then(async n=>{o(n)}):i==="WebMapTile"?(t=new Y.WebMapTileServiceImageryProvider({url:s,layer:e.layer||"",style:e.style||"",format:e.format||"",tileMatrixSetID:e.tileMatrixSetID||""}),o(t)):i==="XYZ"?(t=new Y.UrlTemplateImageryProvider({url:s,tilingScheme:new Y.GeographicTilingScheme,customTags:e.customTags,minimumLevel:e.minimumLevel||0,maximumLevel:e.maximumLevel||21}),o(t)):i==="3DTiles"?Y.Cesium3DTileset.fromUrl(s).then(n=>{n.maximumScreenSpaceError=1,o(n)}):i==="WMS"&&(t=new Y.WebMapServiceImageryProvider({url:s,layers:e.layer,parameters:{service:"WMS",version:"1.1.0",request:"GetMap",format:"image/png",transparent:!0}}),o(t))})}async addLayer(e){const{type:t}=e;let i=await this.createLayer(e);switch(t){case"ArcGisMapServer":i=this.viewer.imageryLayers.addImageryProvider(i);break;case"3DTiles":i._config=e,this.viewer.scene.primitives.add(i);break;case"WMS":i=this.viewer.imageryLayers.addImageryProvider(i);break}this.layerMap.set(e.id,i),this.layerInfoMap.set(e.id,{layerInfo:e,layer:i})}addLayers(e){e.forEach(t=>{this.addLayer(t)})}set3dtilesHeight(e,t){const i=Y.Cartographic.fromCartesian(e.boundingSphere.center),s=Y.Cartesian3.fromRadians(i.longitude,i.latitude,0),o=Y.Cartesian3.fromRadians(i.longitude,i.latitude,t),n=Y.Cartesian3.subtract(o,s,new Y.Cartesian3);e.modelMatrix=Y.Matrix4.fromTranslation(n)}removeLayerById(e){const t=this.layerMap.get(e);let i=!0;return t?(t instanceof Y.ImageryLayer?this.viewer.imageryLayers.remove(t):t instanceof Y.Cesium3DTileset?this.viewer.scene.primitives.remove(t):t instanceof Y.ArcGISTiledElevationTerrainProvider?this.viewer.scene.terrainProvider=new Y.EllipsoidTerrainProvider:i=!1,this.layerMap.delete(e),this.layerInfoMap.delete(e),i):(i=!1,i)}removeLayerByIds(e){e.forEach(t=>{this.removeLayerById(t)})}getLayerById(e){return this.layerMap.get(e)}getLayerInfoById(e){var t;return(t=this.layerInfoMap.get(e))==null?void 0:t.layerInfo}getLayerInfoByName(e){return[...this.layerInfoMap.values()].find(i=>{var s;return((s=i.layerInfo)==null?void 0:s.name)===e})}}const Rt=a=>{let e=[];for(const t of a){const{children:i,...s}=t;e.push(s),i&&i.length&&(e=e.concat(Rt(i)))}return e},gs=fi("LayerTree",{state:()=>({checkedLayerIds:[],layerTreeData:[],checkedLayerNodes:[],layermanager:null}),getters:{},actions:{getLayerTreeData(){return new Promise(a=>{if(this.layerTreeData.length){a(this.layerTreeData);return}fetch("./config/layerconfig.json").then(e=>e.json()).then(e=>{this.layerTreeData=e;const t=Rt(e);this.checkedLayerNodes=t.filter(i=>i.isShow===1),this.checkedLayerIds=t.filter(i=>i.type===2&&i.isShow===1).map(i=>i.id),a(e)})})}}}),fs={class:"layerTree"},ws={class:"layer-tree-node"},vs={key:0,class:"map-icon-ex map-icon-ex-wenjianga-shouqi",style:{color:"#f8d71c"}},Cs={key:1,class:"map-icon-ex map-icon-ex-tuceng-1",style:{color:"#00c1ff"}},_s={key:0,class:"layer-tree-node-function"},ys={class:"pr-5"},Ss=["onClick"],bs=Q({__name:"index",setup(a){const{getMainViewer:e}=he(),t=gs(),i=D(),s=D([]);let o=null,n=null;const l={children:"children",label:"name"},d=Lt(()=>t.layerTreeData),c=()=>{const _=i.value.getCheckedKeys(!1),f=i.value.getCheckedNodes(!1),u=s.value.map(T=>T.id),w=s.value.filter(T=>!_.includes(T.id)&&T.nodeType===2),L=f.filter(T=>!u.includes(T.id)&&T.nodeType===2);s.value=f,C({addLayerList:L,removeLayerList:w}),t.checkedLayerIds=_,t.checkedLayerNodes=i.value.getCheckedNodes(!1).filter(T=>T.nodeType===2&&!T.children)},h=Di.debounce(c,200),C=_=>{const{addLayerList:f,removeLayerList:u}=_,w=u.map(L=>L.id);o&&(o.removeLayerByIds(w),o.addLayers(f))},v=_=>{if(o){const f=o.getLayerById(_.id);f?n.flyTo(f):Dt({message:"请加载后再进行定位",type:"warning"})}};return ce(async()=>{n=await e(),await t.getLayerTreeData(),o=new ps(n),t.layermanager=o;const _=t.checkedLayerIds;_!=null&&_.length&&i.value.setCheckedKeys(_,!0),await kt();const f=i.value.getCheckedNodes(!1);s.value=f,t.checkedLayerNodes=f.filter(u=>u.nodeType===2&&!u.children)}),(_,f)=>{const u=j("el-tooltip"),w=j("el-tree");return F(),B("div",fs,[x(w,{ref_key:"layerTreeRef",ref:i,data:P(d),"show-checkbox":"",indent:12,"node-key":"id","default-expand-all":"",props:l,"expand-on-click-node":!1,onCheck:P(h)},{default:W(({data:L})=>[g("div",ws,[g("div",null,[g("span",null,[L.nodeType===1?(F(),B("i",vs)):(F(),B("i",Cs)),pe(" "+J(L.name),1)])]),L.nodeType===2?(F(),B("div",_s,[g("span",ys,[g("a",{onClick:T=>v(L)},[x(u,{class:"box-item",effect:"dark",content:"定位",placement:"top"},{default:W(()=>f[0]||(f[0]=[g("i",{class:"icon iconfont map-icon-diqiu"},null,-1)])),_:1})],8,Ss)])])):it("",!0)])]),_:1},8,["data","onCheck"])])}}}),xs=ie(bs,[["__scopeId","data-v-28222ba4"]]),It=(a,e,t)=>{const i=document.createElement(a);return i.className=e??"",i},Ps=window.Cesium.Cartesian3,Ms=window.Cesium.SceneTransforms,Ts=window.Cesium.ScreenSpaceEventHandler,ct=window.Cesium.ScreenSpaceEventType;class Ae{constructor(e){r(this,"position",{longitude:0,latitude:0});r(this,"viewer");r(this,"_wrapper");r(this,"_enable",!1);r(this,"content","");r(this,"type","Tooltip");r(this,"handler",new Ts);this.viewer=e,this._wrapper=It("div","gd-map-tool-tip")}get enable(){return this._enable}set enable(e){this._enable!==e&&(this._enable=e,this._enableHook&&this._enableHook())}_enableHook(){this._enable?(!this._wrapper.parentNode&&this.viewer.container.appendChild(this._wrapper),this._bindEvent()):(this._unbindEvent(),this._wrapper.parentNode&&this.viewer.container.removeChild(this._wrapper))}_postRenderEvent(){this.position.latitude===0&&this.position.longitude===0||this._enable&&this.showAt(this.position,this.content)}_bindEvent(){this.viewer.scene.postRender.addEventListener(this._postRenderEvent,this),this.handler.setInputAction(e=>{this._updateWindowCoord(e.endPosition)},ct.MOUSE_MOVE)}_unbindEvent(){this.viewer.scene.postRender.removeEventListener(this._postRenderEvent,this),this.handler.removeInputAction(ct.MOUSE_MOVE)}_updateWindowCoord(e){const t=e.x+20,i=e.y-this._wrapper.offsetHeight/2-5;this._wrapper.style.cssText=`
    visibility:visible;
    z-index:1;
    transform:translate3d(${Math.round(t)}px,${Math.round(i)}px, 0);
    `}_getWindowPosition(e){const t=Ps.fromDegrees(e.longitude,e.latitude,e.height);return Ms.wgs84ToWindowCoordinates(this.viewer.scene,t)}showAt(e,t){this.position=e;const i=this._getWindowPosition(e);return i&&this._updateWindowCoord(i),this.setContent(t),this}hide(){this._enable=!1,this._wrapper&&(this._wrapper.style.cssText="visibility:hidden;")}setContent(e){const t=this._wrapper;if(typeof e=="string")this._wrapper.innerHTML=e;else if(e instanceof Element){for(;this._wrapper.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);t.appendChild(e)}return this.content=e,this}}const S=window.Cesium;let Ds=class{constructor(e,t){r(this,"viewer");r(this,"_observePointColor");r(this,"_visibleColor");r(this,"_inVisibleColor");r(this,"_viewPointHeight");r(this,"results",[]);r(this,"_datasource",new S.CustomDataSource("sight-line"));r(this,"_currentLineDataSource",new S.CustomDataSource("current-sight-line"));r(this,"_observePoint",null);r(this,"_currentViewPoint",null);r(this,"_targetPoints",[]);r(this,"_mouseTip",null);r(this,"_pickHandler",null);r(this,"_currentLineIndex",0);r(this,"_lineCompleteCallback");r(this,"_currentLine1Positions",[]);r(this,"_currentLine2Positions",[]);r(this,"_currentPosition",null);this.viewer=e,this._observePointColor=(t==null?void 0:t.observePointColor)||"#7FEF1C",this._visibleColor=(t==null?void 0:t.visibleColor)||"#7FEF1C",this._inVisibleColor=(t==null?void 0:t.inVisibleColor)||"#FF6363",this._viewPointHeight=(t==null?void 0:t.viewPointHeight)||1.75,this.viewer.dataSources.add(this._datasource),this.viewer.dataSources.add(this._currentLineDataSource)}get viewPointHeight(){return this._viewPointHeight}set viewPointHeight(e){this._viewPointHeight=e,this._currentViewPoint&&(this._observePoint=this._getCartesianOffsetHeight(this._currentViewPoint,e))}activate(e){this.deactivate(),this._lineCompleteCallback=e,this._setInputAction(),this._showMouseTip()}analysis(e,t){let i=0,s=0,o=0,n=!1;return new Promise(l=>{this.getSightResultyMostDetailed(e,t).then(d=>{const c=this.results.length?this.results[this.results.length-1].num+1:1;if(i=S.Cartesian3.distance(e,t),d&&d.position){const C=d.position;s=S.Cartesian3.distance(e,C),o=S.Cartesian3.distance(t,C),n=o<1,s>i&&(n=!0),n?(o=0,this._drawLine([e,t],c,!0)):(this._drawLine([e,C],c,!0),this._drawLine([C,t],c,!1))}else this._drawLine([e,t],c,!0),i=S.Cartesian3.distance(e,t),s=i,o=0,n=!0;this._drawTargetPoint(t.clone(),c,n);const h={name:"L"+c,num:c,visible:n,visibleDistance:s>0?s.toFixed(2):s+"",inVisibleDistance:o>0?o.toFixed(2):o+"",distance:i.toFixed(2)};this.results.push(h),l(h)})})}getSightResult(e,t){const i=S.Cartesian3.normalize(S.Cartesian3.subtract(t,e,new S.Cartesian3),new S.Cartesian3),s=new S.Ray(e,i);return this.viewer.scene.pickFromRay(s)}getSightResultyMostDetailed(e,t){const i=S.Cartesian3.normalize(S.Cartesian3.subtract(t,e,new S.Cartesian3),new S.Cartesian3),s=new S.Ray(e,i);return this.viewer.scene.pickFromRayMostDetailed(s)}deleteLine(e,t){this._datasource.entities.removeById("point-"+e),this._datasource.entities.removeById("greenline-"+e),this._datasource.entities.removeById("redline-"+e),this.results.splice(t,1),this._targetPoints.splice(t,1),this.results.length||this._datasource.entities.removeById("point-0")}destroy(){this.clear(),this._pickHandler&&this._pickHandler.destroy(),this._pickHandler=null,this._datasource&&this.viewer.dataSources.remove(this._datasource),this._currentLineDataSource&&this.viewer.dataSources.remove(this._currentLineDataSource)}clear(){this.deactivate(),this._datasource.entities.removeAll(),this._currentLineDataSource.entities.removeAll(),this._observePoint=null,this._targetPoints=[],this.results=[]}deactivate(){this._pickHandler&&(this._pickHandler.removeInputAction(S.ScreenSpaceEventType.LEFT_CLICK),this._pickHandler.removeInputAction(S.ScreenSpaceEventType.MOUSE_MOVE),this._pickHandler.removeInputAction(S.ScreenSpaceEventType.RIGHT_CLICK)),this._hideMouseTip(),this._mouseTip=null,this._currentLineDataSource.entities.removeAll(),this._currentLine1Positions=[],this._currentLine2Positions=[],this._currentLineIndex=0,this._currentViewPoint=null}_setInputAction(){this._pickHandler||(this._pickHandler=new S.ScreenSpaceEventHandler(this.viewer.scene.canvas)),this._pickHandler.setInputAction(this._leftClickEventHandler.bind(this),S.ScreenSpaceEventType.LEFT_CLICK),this._pickHandler.setInputAction(this._mouseMoveEventHandler.bind(this),S.ScreenSpaceEventType.MOUSE_MOVE),this._pickHandler.setInputAction(this._rightClickEventHandler.bind(this),S.ScreenSpaceEventType.RIGHT_CLICK)}_rightClickEventHandler(){this.deactivate(),this._lineCompleteCallback&&this._lineCompleteCallback()}async _leftClickEventHandler(e){const t=e.position,i=this.viewer.camera.getPickRay(t);if(!S.defined(i))return;const s=this._pickPosition(t);if(S.defined(s))if(this._observePoint){this._currentLineIndex+=1,this._targetPoints.push(s.clone()),this._currentLineDataSource.entities.removeAll();const o=await this.analysis(this._observePoint,s.clone());this._lineCompleteCallback&&this._lineCompleteCallback(o)}else{const o=this._getCartesianOffsetHeight(s,this._viewPointHeight);this._observePoint=o,this._currentViewPoint=s,this._drawObvervePoint(o,this._observePointColor),this._showMouseTip("左键选择目标点， 右键结束"),this._currentLineIndex=0}}_mouseMoveEventHandler(e){const t=e.endPosition,i=this._pickPosition(t);!S.defined(i)||!this._observePoint||this._updateCurrentLine(i)}_drawObvervePoint(e,t){const i=S.Color.fromCssColorString(t),s=new S.Entity({name:"sight-line_obverve",position:e,label:{font:"14px Helvetica",pixelOffset:new S.Cartesian2(0,-12),verticalOrigin:S.VerticalOrigin.BOTTOM,showBackground:!0,backgroundColor:i.withAlpha(.85),backgroundPadding:new S.Cartesian2(8,5),disableDepthTestDistance:Number.POSITIVE_INFINITY},point:{pixelSize:8,outlineColor:S.Color.WHITE,outlineWidth:1,color:i}});this._datasource.entities.add(s)}_drawTargetPoint(e,t,i){const s=new S.Entity({name:"sight-line",id:"point-"+t,position:e,label:{text:"L"+t,font:"14px Helvetica",pixelOffset:new S.Cartesian2(0,-12),verticalOrigin:S.VerticalOrigin.BOTTOM,showBackground:!0,backgroundColor:S.Color.fromCssColorString(i?this._visibleColor:this._inVisibleColor).withAlpha(.85),backgroundPadding:new S.Cartesian2(8,5),disableDepthTestDistance:Number.POSITIVE_INFINITY},point:{pixelSize:8,outlineColor:S.Color.WHITE,outlineWidth:1,color:S.Color.fromCssColorString(i?this._visibleColor:this._inVisibleColor),disableDepthTestDistance:Number.POSITIVE_INFINITY}});this._datasource.entities.add(s)}_drawLine(e,t,i=!0){const s=new S.PolylineGlowMaterialProperty({glowPower:.15,color:S.Color.fromCssColorString(i?this._visibleColor:this._inVisibleColor)}),o=new S.Entity({name:"sight-line",id:(i?"green":"red")+"line-"+t,polyline:{positions:e,width:6,material:s,depthFailMaterial:s}});this._datasource.entities.add(o)}_drawCurrentLine(e,t,i,s){this._currentLine1Positions=e,this._currentLine2Positions=t;const o=new S.PolylineGlowMaterialProperty({glowPower:.15,color:S.Color.fromCssColorString(i?this._visibleColor:this._inVisibleColor)}),n=new S.PolylineGlowMaterialProperty({glowPower:.15,color:S.Color.fromCssColorString(s?this._visibleColor:this._inVisibleColor)});if(this._currentLineDataSource.entities.values.length){const l=this._currentLineDataSource.entities.values.find(h=>h.id==="current-sight-line-one"),d=this._currentLineDataSource.entities.values.find(h=>h.id==="current-sight-line-two"),c=this._currentLineDataSource.entities.values.find(h=>h.id==="current-sight-point-two");l&&(l.polyline.material=o),d&&(d.polyline.material=n),c&&(c.point.color=new S.ConstantProperty(S.Color.fromCssColorString(s?this._visibleColor:this._inVisibleColor)))}else{const l=new S.Entity({id:"current-sight-line-one",name:"current-sight-line",polyline:{positions:new S.CallbackProperty(()=>this._currentLine1Positions,!1),width:6,material:o,depthFailMaterial:o}}),d=new S.Entity({id:"current-sight-line-two",name:"current-sight-line",polyline:{positions:new S.CallbackProperty(()=>this._currentLine2Positions,!1),width:6,material:n,depthFailMaterial:n}});this._currentLineDataSource.entities.add(l),this._currentLineDataSource.entities.add(d)}}_updateCurrentLine(e){const t=this._observePoint;this._currentPosition=e;const i=this.getSightResult(t,e);if(i&&i.position){const s=i.position,n=S.Cartesian3.distance(e,s)<1;this._drawCurrentLine([t,s],[s,e],!0,n)}else this._drawCurrentLine([t,e],[t,e],!0,!0)}_pickPosition(e){const t=this.viewer.scene;let i=t.pickPosition(e),s=!1,o;t.pickPositionSupported&&(i=t.pickPosition(e));const n=t.drillPick(e);for(const l of n)(l&&l.primitive instanceof S.Cesium3DTileFeature||l&&l.primitive instanceof S.Cesium3DTileset||l&&l.primitive instanceof S.Model)&&(s=!0);if(s&&(t.pick(e),i=t.pickPosition(e),i)){const l=S.Cartographic.fromCartesian(i);l.height<0&&(l.height=0);const d=S.Math.toDegrees(l.longitude),c=S.Math.toDegrees(l.latitude),h=l.height;i=S.Cartesian3.fromDegrees(d,c,h)}if(t.mode===S.SceneMode.SCENE3D&&!(this.viewer.terrainProvider instanceof S.EllipsoidTerrainProvider)){const l=t.camera.getPickRay(e);o=t.globe.pick(l,t)}else o=t.camera.pickEllipsoid(e,S.Ellipsoid.WGS84);return!i&&o&&(i=o),i}_showMouseTip(e="左键选择观察点"){this._mouseTip||(this._mouseTip=new Ae(this.viewer)),this._mouseTip.setContent(e),this._mouseTip.enable=!0,this.viewer.canvas.style.cursor="crosshair"}_hideMouseTip(){this._mouseTip&&(this._mouseTip.enable=!1),this.viewer.canvas.style.cursor=""}_getCartesianOffsetHeight(e,t=1.75){const i=S.Cartographic.fromCartesian(e),s=S.Math.toDegrees(i.longitude),o=S.Math.toDegrees(i.latitude),n=i.height+Number(t);return S.Cartesian3.fromDegrees(s,o,n)}};const Es={class:"contents",style:{color:"#f0f2f5"}},Ls={class:"action-box"},ks=Q({__name:"index",setup(a){const{getMainViewer:e}=he();let t=null,i=null;const s=D([]),o=D(1.75),n=D("开始绘制"),l=D(!1),d=D("#77DF7D"),c=D("#FF7273"),h=()=>{v(),l.value=!0,t.activate(u=>{u?s.value.push(u):C()})},C=()=>{n.value="开始绘制"},v=()=>{C(),s.value=[],t&&t.clear(),l.value=!1},_=(u,w)=>{t&&t.deleteLine(u,w),s.value.splice(w,1)},f=u=>{o.value=u,t&&(t.viewPointHeight=u)};return ce(async()=>{i=await e(),t=new Ds(i,{observePointColor:d.value,visibleColor:d.value,inVisibleColor:c.value,viewPointHeight:o.value})}),$e(()=>{t&&t.destroy()}),(u,w)=>{const L=j("el-input-number"),T=j("el-table-column"),O=j("el-button"),k=j("el-table"),de=j("el-divider");return F(),B("div",null,[g("div",Es,[w[1]||(w[1]=g("div",null,"默认高度：",-1)),x(L,{modelValue:P(o),"onUpdate:modelValue":w[0]||(w[0]=ee=>oe(o)?o.value=ee:null),style:{"margin-top":"8px"},"controls-position":"right",disabled:P(l),onChange:f},null,8,["modelValue","disabled"]),w[2]||(w[2]=g("span",{style:{"margin-left":"10px"}},"m",-1))]),x(k,{data:P(s),class:"visible-table",border:"",stripe:"","max-height":"500"},{default:W(()=>[x(T,{prop:"name",label:"通视线",align:"center",width:"60px"}),x(T,{prop:"distance",label:"距离(m)",align:"center"}),x(T,{prop:"visibleDistance",label:"可视距离(m)",align:"center"}),x(T,{prop:"inVisibleDistance",label:"不可视距离(m)",align:"center"}),x(T,{label:"结果",align:"center"},{default:W(ee=>[g("span",{style:Et({color:ee.row.visible?P(d):P(c)})},J(ee.row.visible?"可通视":"不可通视"),5)]),_:1}),x(T,{label:"操作",align:"center"},{default:W(ee=>[x(O,{type:"text",size:"small",class:"del-btn",onClick:Se=>_(ee.row.num,ee.$index)},{default:W(()=>w[3]||(w[3]=[pe("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),x(de),g("div",Ls,[x(O,{onClick:v},{default:W(()=>w[4]||(w[4]=[pe("重置")])),_:1}),x(O,{disabled:P(l),class:"on_button_active",onClick:li(h,["stop"])},{default:W(()=>[w[5]||(w[5]=g("i",{class:"iconfont iconhuizhiquyu"},null,-1)),g("span",null,J(P(n)),1)]),_:1},8,["disabled"])])])}}}),As=ie(ks,[["__scopeId","data-v-e474f37a"]]),p=window.Cesium,Rs=window.Cesium.PrimitiveCollection;let Is=class{constructor(e,t){r(this,"viewer");r(this,"options");r(this,"viewPosition");r(this,"viewHeight");r(this,"viewDistance");r(this,"viewHeading");r(this,"viewPitch");r(this,"horizontalViewAngle");r(this,"verticalViewAngle");r(this,"visibleAreaColor");r(this,"invisibleAreaColor");r(this,"viewPositionEnd");r(this,"enabled");r(this,"softShadows");r(this,"size");r(this,"lightCamera",null);r(this,"shadowMap");r(this,"positions",[]);r(this,"_mouseTip",null);r(this,"_pickHandler",null);r(this,"_postStage",null);r(this,"_primitiveCollection");r(this,"_datasource");r(this,"_onViewShedUpdate");this.viewer=e,this.options=t,this.viewPosition=this.options.viewPosition,this.viewHeight=this.options.viewHeight||1.75,this.viewPositionEnd=this.options.viewPositionEnd,this.viewDistance=this.viewPositionEnd&&this.viewPosition?p.Cartesian3.distance(this.viewPosition,this.viewPositionEnd):this.options.viewDistance||1,this.viewHeading=this.viewPositionEnd&&this.viewPosition?this.getHeading(this.viewPosition,this.viewPositionEnd):this.options.viewHeading||0,this.viewPitch=this.viewPositionEnd&&this.viewPosition?this.getPitch(this.viewPosition,this.viewPositionEnd):this.options.viewPitch||0,this.horizontalViewAngle=this.options.horizontalViewAngle||90,this.verticalViewAngle=this.options.verticalViewAngle||60,this.visibleAreaColor=this.options.visibleAreaColor||p.Color.GREEN.toCssColorString(),this.invisibleAreaColor=this.options.invisibleAreaColor||p.Color.RED.toCssColorString(),this.enabled=typeof this.options.enabled=="boolean"?this.options.enabled:!0,this.softShadows=typeof this.options.softShadows=="boolean"?this.options.softShadows:!0,this.size=this.options.size||2048,this._onViewShedUpdate=t.onViewShedUpdate,this._primitiveCollection=new Rs,this.viewer.scene.primitives.add(this._primitiveCollection),this._datasource=new p.CustomDataSource,this.viewer.dataSources.add(this._datasource)}activate(){this.deactivate(),this._showMouseTip("左键选择观察点"),this._setInputAction()}deactivate(){this._pickHandler&&(this._pickHandler.destroy(),this._pickHandler=null),this.clear()}update(e){const t=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(this.viewPosition),i=p.Math.toDegrees(t.longitude),s=p.Math.toDegrees(t.latitude);this.viewPosition=p.Cartesian3.fromDegrees(i,s,e.viewHeight),this.viewDistance=e.viewDistance,this.horizontalViewAngle=e.horizontalViewAngle,this.verticalViewAngle=e.verticalViewAngle,this.viewHeading=e.viewHeading,this._clearRender(),this._renderViewShed(),this._createShadowMap(),this._createPostStage()}clear(){this._clearRender(),this.positions=[],this.viewHeading=0,this.viewPitch=0,this.viewDistance=1,this.lightCamera=null,this._hideMouseTip()}_renderViewShed(){this._createLightCamera(this.positions),this._drawSketch()}_drawSketch(){if(!this._datasource.entities.values.length){const e=new p.Entity({name:"sketch",position:this.viewPosition,orientation:new p.CallbackProperty(()=>p.Transforms.headingPitchRollQuaternion(this.viewPosition,p.HeadingPitchRoll.fromDegrees(this.viewHeading-90,this.viewPitch,0)),!1),ellipsoid:{radii:new p.CallbackProperty(()=>p.Cartesian3.fromElements(this.viewDistance,this.viewDistance,this.viewDistance),!1),minimumClock:new p.CallbackProperty(()=>p.Math.toRadians(-this.horizontalViewAngle/2),!1),maximumClock:new p.CallbackProperty(()=>p.Math.toRadians(this.horizontalViewAngle/2),!1),minimumCone:new p.CallbackProperty(()=>p.Math.toRadians(90-this.verticalViewAngle/2),!1),maximumCone:new p.CallbackProperty(()=>p.Math.toRadians(180-this.verticalViewAngle/2),!1),fill:!1,outline:!0,outlineColor:p.Color.fromCssColorString("#62DDFF"),subdivisions:128,stackPartitions:32,slicePartitions:64},point:{pixelSize:10,color:p.Color.fromCssColorString("#409eff"),outlineColor:p.Color.WHITE,outlineWidth:2,heightReference:p.HeightReference.NONE,disableDepthTestDistance:Number.POSITIVE_INFINITY}});this._datasource.entities.add(e)}}_drawFrustumOutine(){const e=new p.Cartesian3,t=new p.Matrix3,i=new p.Quaternion,s=this.lightCamera,o=s.directionWC,n=s.upWC;let l=s.rightWC;l=p.Cartesian3.negate(l,e);const d=t;p.Matrix3.setColumn(d,0,l,d),p.Matrix3.setColumn(d,1,n,d),p.Matrix3.setColumn(d,2,o,d);const c=p.Quaternion.fromRotationMatrix(d,i),h=new p.FrustumOutlineGeometry({frustum:s.frustum,origin:this.viewPosition,orientation:c}),C=new p.GeometryInstance({geometry:h,id:"FrustumOutline",attributes:{color:new p.GeometryInstanceAttribute({componentDatatype:p.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0,value:[0,234,0,255]}),show:new p.ShowGeometryInstanceAttribute(!0)}}),v=new p.Primitive({geometryInstances:[C],appearance:new p.PerInstanceColorAppearance({flat:!0,translucent:!1})});this._primitiveCollection.add(v);const _=p.FrustumOutlineGeometry.createGeometry(h);this.positions[1]=_.boundingSphere.center,this.viewPositionEnd=_.boundingSphere.center}_setInputAction(){this._pickHandler||(this._pickHandler=new p.ScreenSpaceEventHandler(this.viewer.scene.canvas)),this._pickHandler.setInputAction(this._leftClickEventHandler.bind(this),p.ScreenSpaceEventType.LEFT_CLICK),this._pickHandler.setInputAction(this._mouseMoveEventHandler.bind(this),p.ScreenSpaceEventType.MOUSE_MOVE)}_leftClickEventHandler(e){const t=e.position,i=this.viewer.camera.getPickRay(t);if(!p.defined(i))return;let s=this._pickPosition(t);if(!this.positions.length){let o=p.Cartographic.fromCartesian(s);o.height<0&&(o.height=0);const n=p.Math.toDegrees(o.longitude),l=p.Math.toDegrees(o.latitude);let d=o.height;d=d+this.viewHeight,s=p.Cartesian3.fromDegrees(n,l,d),o=p.Cartographic.fromDegrees(n,l,d),this.positions.push(s),this._showMouseTip("左键选择目标点结束分析")}this.positions.length===2&&(this._createShadowMap(),this._createPostStage(),this._pickHandler&&(this._pickHandler.destroy(),this._pickHandler=null),this._hideMouseTip(),this._onViewShedUpdate&&(this.viewHeading<0?this.viewHeading=this.viewHeading+360:this.viewHeading>360&&(this.viewHeading=Math.abs(this.viewHeading)%360),this._onViewShedUpdate({viewHeading:this.viewHeading,horizontalViewAngle:this.horizontalViewAngle,verticalViewAngle:this.verticalViewAngle,viewDistance:this.viewDistance}))),this.positions.push(s.clone())}_mouseMoveEventHandler(e){const t=e.endPosition,i=this._pickPosition(t);p.defined(i)&&this.positions.length===2&&(this.positions.pop(),this.positions.push(i.clone()),this.viewPosition=this.positions[0],this.viewPositionEnd=this.positions[1],this.viewHeading=this.getHeading(this.positions[0],this.positions[1]),this.viewHeading<0?this.viewHeading=this.viewHeading+360:this.viewHeading>360&&(this.viewHeading=Math.abs(this.viewHeading)%360),this.viewDistance=p.Cartesian3.distance(this.positions[0],this.positions[1]),this._renderViewShed(),this._createShadowMap(),this._createPostStage())}_createLightCamera(e){if(this.lightCamera||(this.lightCamera=new p.Camera(this.viewer.scene)),this.lightCamera.position=this.viewPosition,this.viewPositionEnd){const n=p.Cartesian3.normalize(p.Cartesian3.subtract(e[1],e[0],new p.Cartesian3),new p.Cartesian3);this.lightCamera.direction=n}this.lightCamera.frustum.near=1e-4,this.lightCamera.frustum.far=this.viewDistance;const t=p.Math.toRadians(this.horizontalViewAngle),i=p.Math.toRadians(this.verticalViewAngle),s=this.viewDistance*Math.tan(t/2)*2/(this.viewDistance*Math.tan(i/2)*2),o=this.lightCamera.frustum;o.aspectRatio=s,t>i?o.fov=t:o.fov=i,this.lightCamera.setView({destination:this.viewPosition,orientation:{heading:p.Math.toRadians(this.viewHeading||0),pitch:p.Math.toRadians(this.viewPitch||0),roll:0}})}_createShadowMap(){const e=p.ShadowMap,t=this.shadowMap=new e({context:this.viewer.scene.context,lightCamera:this.lightCamera,enabled:!0,isPointLight:!0,pointLightRadius:this.viewDistance,cascadesEnabled:!0,size:this.size,softShadows:this.softShadows,normalOffset:!0,fromLightSource:!1});this.viewer.scene.shadowMap=t}_createPostStage(){const e=`
     #define USE_CUBE_MAP_SHADOW true
     precision mediump float;
     uniform sampler2D colorTexture;
     uniform sampler2D depthTexture;
     varying vec2 v_textureCoordinates;
     uniform mat4 camera_projection_matrix;
     uniform mat4 camera_view_matrix;
     uniform float far;
     uniform samplerCube shadowMap_textureCube;
     uniform mat4 shadowMap_matrix;
     uniform vec4 shadowMap_lightPositionEC;
     uniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness;
     uniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth;
     struct zx_shadowParameters
     {
         vec3 texCoords;
         float depthBias;
         float depth;
         float nDotL;
         vec2 texelStepSize;
         float normalShadingSmooth;
         float darkness;
     };
     float czm_shadowVisibility(samplerCube shadowMap, zx_shadowParameters shadowParameters)
     {
         float depthBias = shadowParameters.depthBias;
         float depth = shadowParameters.depth;
         float nDotL = shadowParameters.nDotL;
         float normalShadingSmooth = shadowParameters.normalShadingSmooth;
         float darkness = shadowParameters.darkness;
         vec3 uvw = shadowParameters.texCoords;
         depth -= depthBias;
         float visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);
         return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);
     }
     vec4 getPositionEC(){
         return czm_windowToEyeCoordinates(gl_FragCoord);
     }
     vec3 getNormalEC(){
         return vec3(1.);
     }
     vec4 toEye(in vec2 uv,in float depth){
         vec2 xy=vec2((uv.x*2.-1.),(uv.y*2.-1.));
         vec4 posInCamera=czm_inverseProjection*vec4(xy,depth,1.);
         posInCamera=posInCamera/posInCamera.w;
         return posInCamera;
     }
     vec3 pointProjectOnPlane(in vec3 planeNormal,in vec3 planeOrigin,in vec3 point){
         vec3 v01=point-planeOrigin;
         float d=dot(planeNormal,v01);
         return(point-planeNormal*d);
     }
     float getDepth(in vec4 depth){
         float z_window=czm_unpackDepth(depth);
         z_window=czm_reverseLogDepth(z_window);
         float n_range=czm_depthRange.near;
         float f_range=czm_depthRange.far;
         return(2.*z_window-n_range-f_range)/(f_range-n_range);
     }
     float shadow( in vec4 positionEC ){
         vec3 normalEC=getNormalEC();
         zx_shadowParameters shadowParameters;
         shadowParameters.texelStepSize=shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy;
         shadowParameters.depthBias=shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z;
         shadowParameters.normalShadingSmooth=shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w;
         shadowParameters.darkness=shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w;
         vec3 directionEC=positionEC.xyz-shadowMap_lightPositionEC.xyz;
         float distance=length(directionEC);
         directionEC=normalize(directionEC);
         float radius=shadowMap_lightPositionEC.w;
         if(distance>radius)
         {
             return 2.0;
         }
         vec3 directionWC=czm_inverseViewRotation*directionEC;
         shadowParameters.depth=distance/radius-0.0003;
         shadowParameters.nDotL=clamp(dot(normalEC,-directionEC),0.,1.);
         shadowParameters.texCoords=directionWC;
         float visibility=czm_shadowVisibility(shadowMap_textureCube,shadowParameters);
         return visibility;
     }
     bool visible(in vec4 result)
     {
         result.x/=result.w;
         result.y/=result.w;
         result.z/=result.w;
         return result.x>=-1.&&result.x<=1.
         &&result.y>=-1.&&result.y<=1.
         &&result.z>=-1.&&result.z<=1.;
     }
     void main(){
         // 得到釉色=结构二维(彩色纹理,纹理坐标)
         gl_FragColor=texture2D(colorTexture,v_textureCoordinates);
         // 深度=(釉色=结构二维(深度纹理,纹理坐标))
         float depth=getDepth(texture2D(depthTexture,v_textureCoordinates));
         // 视角=(纹理坐标,深度)
         vec4 viewPos=toEye(v_textureCoordinates,depth);
         // 世界坐标
         vec4 wordPos=czm_inverseView*viewPos;
         // 虚拟相机中坐标
         vec4 vcPos=camera_view_matrix*wordPos;
         float near=.001*far;
         float dis=length(vcPos.xyz);
         if(dis>near&&dis<far){
             // 透视投影
             vec4 posInEye=camera_projection_matrix*vcPos;
             // 可视区颜色
             vec4 v_color=vec4(0.,1.,0.,1.);
             vec4 inv_color=vec4(1.,0.,0.,.5);
             if(visible(posInEye)){
                 float vis=shadow(viewPos);
                 if(vis>0.01){
                     gl_FragColor=mix(gl_FragColor,v_color,.5);
                 } else{
                     gl_FragColor=mix(gl_FragColor,inv_color,.5);
                 }
             }
         }
     }`,t=this.shadowMap,i=this.lightCamera,s=i.frustum;this._postStage&&this.viewer.scene.postProcessStages.contains(this._postStage)&&(this.viewer.scene.postProcessStages.remove(this._postStage),this._postStage=null),this._postStage=new p.PostProcessStage({fragmentShader:e,uniforms:{camera_projection_matrix:()=>s.projectionMatrix,camera_view_matrix:()=>i.viewMatrix,far:()=>this.viewDistance,shadowMap_textureCube:()=>Reflect.get(t,"_shadowMapTexture"),shadowMap_matrix:()=>Reflect.get(t,"_shadowMapMatrix"),shadowMap_lightPositionEC:()=>Reflect.get(t,"_lightPositionEC"),shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:()=>{const o=t._pointBias;return p.Cartesian4.fromElements(o.normalOffsetScale,t._distance,t.maximumDistance,0,new p.Cartesian4)},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:()=>{const o=t._pointBias,l=new p.Cartesian2;return l.x=1/t._textureSize.x,l.y=1/t._textureSize.y,p.Cartesian4.fromElements(l.x,l.y,o.depthBias,o.normalShadingSmooth,new p.Cartesian4)}}}),this.viewer.scene.postProcessStages.add(this._postStage)}getHeading(e,t){const i=new p.Cartesian3,s=p.Transforms.eastNorthUpToFixedFrame(e);return p.Matrix4.inverse(s,s),p.Matrix4.multiplyByPoint(s,t,i),p.Cartesian3.normalize(i,i),p.Math.toDegrees(Math.atan2(i.x,i.y))}getPitch(e,t){const i=new p.Cartesian3,s=p.Transforms.eastNorthUpToFixedFrame(e);return p.Matrix4.inverse(s,s),p.Matrix4.multiplyByPoint(s,t,i),p.Cartesian3.normalize(i,i),p.Math.toDegrees(Math.asin(i.z))}_showMouseTip(e="左键选择观察点"){this._mouseTip||(this._mouseTip=new Ae(this.viewer)),this._mouseTip.setContent(e),this._mouseTip.enable=!0,this.viewer.canvas.style.cursor="crosshair"}_hideMouseTip(){this._mouseTip&&(this._mouseTip.enable=!1),this.viewer.canvas.style.cursor=""}_clearRender(){this._datasource&&this.viewer.dataSources.contains(this._datasource)&&this._datasource.entities.removeAll(),this._postStage&&this.viewer.scene.postProcessStages.contains(this._postStage)&&(this.viewer.scene.postProcessStages.remove(this._postStage),this._postStage=null),this._clearFrustum()}_clearFrustum(){this._primitiveCollection&&this.viewer.scene.primitives.contains(this._primitiveCollection)&&this._primitiveCollection.removeAll()}_pickPosition(e){const t=this.viewer.scene;let i=t.pickPosition(e),s=!1,o;t.pickPositionSupported&&(i=t.pickPosition(e));const n=t.drillPick(e);for(const l of n)(l&&l.primitive instanceof p.Cesium3DTileFeature||l&&l.primitive instanceof p.Cesium3DTileset||l&&l.primitive instanceof p.Model)&&(s=!0);if(s&&(t.pick(e),i=t.pickPosition(e),i)){const l=p.Cartographic.fromCartesian(i);l.height<0&&(l.height=0);const d=p.Math.toDegrees(l.longitude),c=p.Math.toDegrees(l.latitude),h=l.height;i=p.Cartesian3.fromDegrees(d,c,h)}if(t.mode===p.SceneMode.SCENE3D&&!(this.viewer.terrainProvider instanceof p.EllipsoidTerrainProvider)){const l=t.camera.getPickRay(e);o=t.globe.pick(l,t)}else o=t.camera.pickEllipsoid(e,p.Ellipsoid.WGS84);return!i&&o&&(i=o),i}};const Hs={class:"slider-block"},zs={class:"item"},Vs={class:"item"},Ns={class:"item"},Us={class:"item"},Fs={class:"btn-group"},Os=Q({__name:"index",setup(a){const{getMainViewer:e}=he();let t,i;const s=D(0),o=D(0),n=D(500),l=D(90),d=D(60),c=()=>{i&&i.deactivate()},h=()=>{i&&i.activate()},C=()=>{i&&i.update({viewHeight:s.value,viewDistance:n.value,horizontalViewAngle:l.value,verticalViewAngle:d.value,viewHeading:o.value})};return ce(async()=>{t=await e(),i=new Is(t,{viewHeight:s.value,viewDistance:n.value,horizontalViewAngle:l.value,verticalViewAngle:d.value,onViewShedUpdate:v=>{n.value=v.viewDistance,l.value=v.horizontalViewAngle,d.value=v.verticalViewAngle,o.value=v.viewHeading}})}),$e(()=>{i&&i.deactivate(),i=null}),(v,_)=>{const f=j("el-slider"),u=j("el-button");return F(),B("div",null,[g("div",Hs,[g("div",zs,[_[4]||(_[4]=g("div",{class:"label"},"方向：",-1)),x(f,{modelValue:P(o),"onUpdate:modelValue":_[0]||(_[0]=w=>oe(o)?o.value=w:null),"show-input":"",size:"small",min:0,max:360,onInput:C},null,8,["modelValue"])]),g("div",Vs,[_[5]||(_[5]=g("div",{class:"label"},"可视半径：",-1)),x(f,{modelValue:P(n),"onUpdate:modelValue":_[1]||(_[1]=w=>oe(n)?n.value=w:null),"show-input":"",size:"small",min:1,max:2e3,onInput:C},null,8,["modelValue"])]),g("div",Ns,[_[6]||(_[6]=g("div",{class:"label"},"水平视角：",-1)),x(f,{modelValue:P(l),"onUpdate:modelValue":_[2]||(_[2]=w=>oe(l)?l.value=w:null),"show-input":"",size:"small",min:1,max:120,onInput:C},null,8,["modelValue"])]),g("div",Us,[_[7]||(_[7]=g("div",{class:"label"},"垂直视角：",-1)),x(f,{modelValue:P(d),"onUpdate:modelValue":_[3]||(_[3]=w=>oe(d)?d.value=w:null),"show-input":"",size:"small",min:1,max:90,onInput:C},null,8,["modelValue"])])]),g("div",Fs,[x(u,{onClick:c},{default:W(()=>_[8]||(_[8]=[pe("重置")])),_:1}),x(u,{class:"startBtn",onClick:h},{default:W(()=>_[9]||(_[9]=[g("i",{class:"el-icon-edit",style:{"margin-right":"8px"}},null,-1),pe("开始绘制")])),_:1})])])}}}),Bs=ie(Os,[["__scopeId","data-v-5646b3fc"]]);class _e{constructor(e){r(this,"longitude");r(this,"latitude");r(this,"height");r(this,"type","point");this.longitude=e.longitude??0,this.latitude=e.latitude??0,this.height=e.height??0}toString(){return`${this.longitude},${this.latitude},${this.height}`}serialize(){return JSON.stringify(this)}toJSON(){const e={};return Object.entries(this).forEach(([t,i])=>{e[t]=i}),e}toCartesian(){return ge(this)}toCartographic(){return zt(this)}toWindowCoordinates(e){return qs(this,e)}toWebMercator(){return Zs(this)}clone(){return _e.fromJSON({longitude:this.longitude??0,latitude:this.latitude??0,height:this.height??0})}static fromJSON(e){return new _e(e)}static fromGeoJson(e){const[t,i]=e;return _e.fromJSON({longitude:t,latitude:i})}static fromArcGISJson(e){return _e.fromJSON({longitude:e.x,latitude:e.y,height:e.z??0})}}const ht=window.Cesium.Cartesian3,st=window.Cesium.Ellipsoid,Ht=window.Cesium.Math,tt=window.Cesium.Cartographic,Ws=window.Cesium.WebMercatorProjection,$s=window.Cesium.SceneMode,Gs=window.Cesium.SceneTransforms,js=new Ws,G=a=>Ht.toDegrees(a),Pe=a=>Ht.toRadians(a),ge=a=>a?ht.fromDegrees(a.longitude,a.latitude,a.height,st.WGS84):ht.ZERO,q=a=>{let e={longitude:0,latitude:0,height:0};if(a){const t=st.WGS84.cartesianToCartographic(a);e=Ys(t)}return new _e(e)},Ys=a=>({longitude:G(a.longitude),latitude:G(a.latitude),height:a.height}),zt=a=>a?tt.fromDegrees(a.longitude,a.latitude,a.height):tt.ZERO,Ee=a=>a?a.map(e=>ge(e)):[],Zs=a=>{const e=js.project(tt.fromDegrees(a.longitude,a.latitude,a.height||0));return new _e({longitude:e.x,latitude:e.y,height:e.z})},dt=(a,e)=>{const t=e.scene;let i;if(t.mode===$s.SCENE3D){const s=t.camera.getPickRay(a);i=t.globe.pick(s,t)}else i=t.camera.pickEllipsoid(a,st.WGS84);return q(i)},qs=(a,e)=>{const t=e.scene;return Gs.wgs84ToWindowCoordinates(t,ge(a))},K=Math.PI,We=Math.PI*3e3/180,ut=6378245,mt=.006693421622965943,Js=(a,e)=>{const t=+a-.0065,i=+e-.006,s=Math.sqrt(t*t+i*i)-2e-5*Math.sin(i*We),o=Math.atan2(i,t)-3e-6*Math.cos(t*We),n=s*Math.cos(o),l=s*Math.sin(o);return[n,l]},Xs=(a,e)=>{e=+e,a=+a;const t=Math.sqrt(a*a+e*e)+2e-5*Math.sin(e*We),i=Math.atan2(e,a)+3e-6*Math.cos(a*We),s=t*Math.cos(i)+.0065,o=t*Math.sin(i)+.006;return[s,o]},Vt=(a,e)=>{if(e=+e,a=+a,Ft(a,e))return[a,e];{const t=Ut(a,e);return[a+t[0],e+t[1]]}},Nt=(a,e)=>{if(e=+e,a=+a,Ft(a,e))return[a,e];{const t=Ut(a,e),i=a+t[0],s=e+t[1];return[a*2-i,e*2-s]}},Ut=(a,e)=>{let t=Ks(a-105,e-35),i=Qs(a-105,e-35);const s=e/180*K;let o=Math.sin(s);o=1-mt*o*o;const n=Math.sqrt(o);return t=t*180/(ut/n*Math.cos(s)*K),i=i*180/(ut*(1-mt)/(o*n)*K),[t,i]},Ks=(a,e)=>{e=+e,a=+a;let t=300+a+2*e+.1*a*a+.1*a*e+.1*Math.sqrt(Math.abs(a));return t+=(20*Math.sin(6*a*K)+20*Math.sin(2*a*K))*2/3,t+=(20*Math.sin(a*K)+40*Math.sin(a/3*K))*2/3,t+=(150*Math.sin(a/12*K)+300*Math.sin(a/30*K))*2/3,t},Qs=(a,e)=>{e=+e,a=+a;let t=-100+2*a+3*e+.2*e*e+.1*a*e+.2*Math.sqrt(Math.abs(a));return t+=(20*Math.sin(6*a*K)+20*Math.sin(2*a*K))*2/3,t+=(20*Math.sin(e*K)+40*Math.sin(e/3*K))*2/3,t+=(160*Math.sin(e/12*K)+320*Math.sin(e*K/30))*2/3,t},Ft=(a,e)=>(e=+e,a=+a,!(a>73.66&&a<135.05&&e>3.86&&e<53.55)),eo=window.Cesium.Cartesian2,pt=window.Cesium.Cartographic,to=window.Cesium.WebMercatorProjection,io=window.Cesium.WebMercatorTilingScheme;class so extends io{constructor(e){super(e);const t=new to;this._projection.project=(i,s)=>{const o=Vt(G(i.longitude),G(i.latitude));return s=t.project(new pt(Pe(o[0]),Pe(o[1]))),new eo(s.x,s.y)},this._projection.unproject=function(i,s){const o=t.unproject(i),n=Nt(G(o.longitude),G(o.latitude));return s=new pt(Pe(n[0]),Pe(n[1])),s}}}const oo=window.Cesium.UrlTemplateImageryProvider,no="https://webst{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",ao="https://webrd{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",ro="https://webst{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}";class Ot extends oo{constructor(e){e.url=(e==null?void 0:e.style)==="img"?no:(e==null?void 0:e.style)==="cva"?ro:ao,e.subdomains=e.subdomains||["01","02","03","04"],e.crs==="WGS84"&&(e.tilingScheme=new so),super(e)}}const lo=a=>{a[0].longitude!==a[a.length-1].longitude&&a.push({...a[0]});const e=[a.map(({longitude:i,latitude:s})=>[i,s])];return Li(e)},co=a=>{const e=lo(a),t=Ei(e),[i,s]=t.geometry.coordinates;return{longitude:i,latitude:s}};window.Cesium.Rectangle;const je=window.Cesium.Math,ho=window.Cesium.Cartesian3;window.Cesium.Entity;window.Cesium.Color;window.Cesium.BoundingSphere;window.Cesium.HeadingPitchRange;window.Cesium.Transforms;window.Cesium.Camera;window.Cesium.Matrix4;const uo=(a,e,t)=>{const{longitude:i,latitude:s,height:o,heading:n,pitch:l,roll:d}=e;return new Promise(c=>{const h=ho.fromDegrees(i,s,o||0);a.camera.flyTo({destination:h,orientation:{heading:je.toRadians(n||0),pitch:je.toRadians(l||-90),roll:je.toRadians(d||0)},duration:t,complete:()=>{c(!0)},cancel:()=>{c(!1)}})})},mo=window.Cesium.Viewer;window.Cesium.Cartesian2;window.Cesium.Cartesian3;window.Cesium.Rectangle;window.Cesium.Ellipsoid;window.Cesium.Ray;window.Cesium.EllipsoidTerrainProvider;window.Cesium.SceneMode;window.Cesium.Math;window.Cesium.BoundingSphere;window.Cesium.HeadingPitchRange;window.Cesium.IntersectionTests;window.Cesium.Cesium3DTileFeature;window.Cesium.Cesium3DTileset;window.Cesium.Model;window.Cesium.Cartographic;window.Cesium.ClockRange;window.Cesium.ClockStep;window.Cesium.JulianDate;window.Cesium.Matrix4;const Ye=window.Cesium.CameraEventType,po=window.Cesium.Color,gt=window.Cesium.ScreenSpaceEventType;window.Cesium.ScreenSpaceEventHandler;const go=(a,e)=>{if(!a){console.warn(`container ${a} is not available`);return}const t=new mo(a,{contextOptions:{webgl:{alpha:!0},requestWebgl1:!0},...e}),i=t.cesiumWidget.creditContainer;i.style.display="none";const s=t.scene.screenSpaceCameraController;return s.tiltEventTypes=Ye.RIGHT_DRAG,s.zoomEventTypes=[Ye.WHEEL,Ye.PINCH],s.minimumZoomDistance=20,t.cesiumWidget.screenSpaceEventHandler.removeInputAction(gt.LEFT_CLICK),t.scene.screenSpaceCameraController.inertiaSpin=.2,t.scene.screenSpaceCameraController.inertiaTranslate=.2,t.scene.screenSpaceCameraController.inertiaZoom=.2,t.scene.globe.baseColor=po.fromCssColorString("#576b21"),t.imageryLayers.removeAll(),t.cesiumWidget.screenSpaceEventHandler.removeInputAction(gt.LEFT_DOUBLE_CLICK),t},Ze=window.Cesium.Cartesian2,ue=window.Cesium.Cartesian3,ze=window.Cesium.defined,ft=window.Cesium.Color,fo=window.Cesium.ScreenSpaceEventHandler,qe=window.Cesium.ScreenSpaceEventType,wo=window.Cesium.Entity,vo=window.Cesium.PolygonHierarchy,Co=window.Cesium.CustomDataSource,Ve=window.Cesium.ConstantProperty,_o=window.Cesium.HeadingPitchRoll,Je=window.Cesium.Math,yo=window.Cesium.SceneMode,So=window.Cesium.HeightReference,bo=window.Cesium.ClassificationType;class xo{constructor(e,t){r(this,"mainViewer");r(this,"hawkeyemapViewer");r(this,"hawkeyemapContainer");r(this,"overlay");r(this,"positions",[]);r(this,"_activeMove",!1);r(this,"datasource");this.mainViewer=e,this.hawkeyemapContainer=document.getElementById(t),this.hawkeyemapViewer=go(this.hawkeyemapContainer,{sceneMode:yo.COLUMBUS_VIEW,animation:!1,baseLayerPicker:!1,fullscreenButton:!1,vrButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,shouldAnimate:!0}),this.hawkeyemapViewer.scene.globe.maximumScreenSpaceError=1.4,this.hawkeyemapViewer.scene.msaaSamples=4,this.hawkeyemapViewer.resolutionScale=1,this.hawkeyemapViewer.scene.postProcessStages.fxaa.enabled=!0,this.hawkeyemapViewer.scene.screenSpaceCameraController.enableRotate=!1,this.hawkeyemapViewer.scene.screenSpaceCameraController.enableTranslate=!1,this.hawkeyemapViewer.scene.screenSpaceCameraController.enableTilt=!1,this.hawkeyemapViewer.scene.screenSpaceCameraController.enableZoom=!1,this.hawkeyemapViewer.scene.screenSpaceCameraController.enableLook=!1;const i=new Ot({url:"",style:"vec",crs:"WGS84"});this.hawkeyemapViewer.imageryLayers.addImageryProvider(i),this.hawkeyemapViewer.scene.screenSpaceCameraController.enableRotate=!1,this.datasource=new Co,this.hawkeyemapViewer.dataSources.add(this.datasource),this._syncMapViewport()}syncView(){this._mainMapCameraChange()}_syncMapViewport(){this.mainViewer.camera.changed.addEventListener(this._mainMapCameraChange,this)}_mainMapCameraChange(){const e=this.mainViewer,t=new Ze(Math.floor(this.mainViewer.canvas.clientWidth/2),Math.floor(this.mainViewer.canvas.clientHeight/2)),i=e.camera;this.hawkeyemapViewer.camera.setView({destination:i.positionWC,orientation:_o.fromDegrees(Je.toDegrees(i.heading),Je.toDegrees(i.pitch),Je.toDegrees(i.roll))});const s=this.mainViewer.scene.camera.pickEllipsoid(t,this.mainViewer.scene.globe.ellipsoid);if(ze(s)){const c=ue.distance(s,this.mainViewer.camera.positionWC);this.hawkeyemapViewer.camera.lookAt(s,new ue(0,0,c*2.5))}const o=e.container,n=parseInt(window.getComputedStyle(o).height),l=parseInt(window.getComputedStyle(o).width),d=this.positions=this._getViewRect(l,n);this.overlay?this._activeMove||(this.overlay.polygon.hierarchy=new Ve(this._computeHierarchy()),this.overlay.polyline.positions=new Ve(Ee(this.positions))):(this.overlay=new wo({polygon:{hierarchy:this._computeHierarchy(),material:ft.TRANSPARENT,heightReference:So.CLAMP_TO_GROUND,outline:!1},polyline:{positions:Ee(d),material:ft.RED,clampToGround:!0,classificationType:bo.BOTH,width:1.5}}),this.datasource.entities.add(this.overlay),this._addEventListener())}_computeHierarchy(){const e=new vo;return e.positions=Ee(this.positions),e}_addEventListener(){const e=this.hawkeyemapViewer,t=new fo(e.canvas);t.setInputAction(i=>{const s=e.scene.pick(i.position);ze(s)&&s.id===this.overlay&&(this._activeMove=!0)},qe.LEFT_DOWN),t.setInputAction(i=>{if(!this._activeMove||!this.overlay)return;const s=dt(i.startPosition,e),o=dt(i.endPosition,e),n=ge(s),l=ge(o);if(l&&n){const d=ue.subtract(l,n,new ue);this.positions=this.positions.map(C=>{const v=ge(C),_=ue.add(v,d,new ue);return q(_)}),this.overlay.polygon.hierarchy=new Ve(this._computeHierarchy()),this.overlay.polyline.positions=new Ve(Ee(this.positions));const c=co(this.positions),h=this.mainViewer.camera.positionCartographic.height;uo(this.mainViewer,{...c,height:h},0)}},qe.MOUSE_MOVE),t.setInputAction(()=>{this._activeMove=!1},qe.LEFT_UP)}_getViewRect(e,t){const i=this.mainViewer;let s=new ue,o=new ue;const n=[],l=i.camera.getPickRay(new Ze(0,0));if(s=i.scene.globe.pick(l,i.scene),!ze(s))return[];n.push(q(s));const d=i.camera.getPickRay(new Ze(e,t));return o=i.scene.globe.pick(d,i.scene),ze(o)?(n.push({longitude:q(o).longitude,latitude:q(s).latitude}),n.push(q(o)),n.push({longitude:q(s).longitude,latitude:q(o).latitude}),n.push(q(s)),n):[]}}const Po={class:"hawkeyemap-wrapper"},Mo=["title"],wt="打开鹰眼",To="关闭鹰眼",vt="open-toggle",Do="close-toggle",Eo=Q({__name:"index",props:{visible:{type:Boolean,default:!1},arrowDirection:{default:"bottom-left"}},setup(a){const{getMainViewer:e}=he();let t;const i=a,s=D(),o=ci({visible:i.visible,arrowDirection:i.arrowDirection,style:vt,title:wt,width:"135"});xe(()=>o.arrowDirection,async d=>{await kt();const c=document.getElementById("hawkeyemap-toggle"),h=s.value;h.style.transformOrigin=d==="bottom-left"?"left bottom":"right bottom",c.style.right=d==="bottom-left"?"unset":"0px",c.style.left=d==="bottom-left"?"0px":"unset"},{immediate:!0});const n=()=>{o.visible=!o.visible,o.style=o.visible?Do:vt,o.title=o.visible?To:wt,o.visible?o.width="135":o.width="0",l(o.visible),t&&o.visible&&t.syncView()},l=d=>{s.value.style.visibility=d?"visible":"hidden"};return ce(async()=>{const d=await e();t=new xo(d,"hawkeyemap-container")}),(d,c)=>(F(),B("div",Po,[g("div",{ref_key:"hawkeyemapRef",ref:s,id:"hawkeyemap-container",class:Be({"box-scale":!o.visible})},null,2),g("div",{id:"hawkeyemap-toggle",class:Be(o.style),title:o.title,onClick:n},[x(P(si),null,{default:W(()=>[!o.visible&&o.arrowDirection==="bottom-right"?(F(),De(P(Si),{key:0})):o.visible&&o.arrowDirection==="bottom-right"?(F(),De(P(bi),{key:1})):!o.visible&&o.arrowDirection==="bottom-left"?(F(),De(P(xi),{key:2})):o.visible&&o.arrowDirection==="bottom-left"?(F(),De(P(Pi),{key:3})):it("",!0)]),_:1})],10,Mo)]))}}),Lo=ie(Eo,[["__scopeId","data-v-bc30f703"]]),ko={class:"location-bar"},Ao={class:"number"},Ro={class:"number"},Io={class:"number"},Ho={class:"number"},zo={class:"number"},Vo={class:"number"},No={class:"number"},ne=window.Cesium,Uo=Q({__name:"index",setup(a){const{getMainViewer:e}=he();let t=null,i=null;const s=D(!0),o=D("0"),n=D("0"),l=D("0"),d=D("0"),c=D("0"),h=D("0"),C=D("0"),v=()=>{t=new ne.ScreenSpaceEventHandler(i.scene.canvas),t.setInputAction(f=>{const u=i.scene.pickPosition(f.endPosition);if(!u)return;const w=ne.Cartographic.fromCartesian(u),L=ne.Math.toDegrees(w.longitude),T=ne.Math.toDegrees(w.latitude),O=w.height,k=6;o.value=L.toFixed(k),n.value=T.toFixed(k),O!==0&&O>-500&&(l.value=O.toFixed(6)),i.scene.terrainProvider instanceof ne.EllipsoidTerrainProvider&&O<0&&(l.value="0"),C.value=i.camera.positionCartographic.height.toFixed(2)},ne.ScreenSpaceEventType.MOUSE_MOVE),i.scene.camera.changed.addEventListener(_)},_=()=>{d.value=ne.Math.toDegrees(i.camera.roll).toFixed(2),h.value=ne.Math.toDegrees(i.camera.heading).toFixed(2),c.value=ne.Math.toDegrees(i.camera.pitch).toFixed(2),C.value=i.camera.positionCartographic.height.toFixed(2)};return ce(async()=>{i=await e();const u=i.camera.positionCartographic;n.value=ne.Math.toDegrees(u.latitude).toFixed(6),o.value=ne.Math.toDegrees(u.longitude).toFixed(6),v(),s.value=!0}),$e(()=>{t&&(t.destroy(),t=null),i.scene.camera.changed.removeEventListener(_)}),(f,u)=>Le((F(),B("div",ko,[g("div",null,[u[0]||(u[0]=g("span",{class:"text"},"航向角：",-1)),g("span",Ao,J(P(h)),1)]),g("div",null,[u[1]||(u[1]=g("span",{class:"text"},"俯仰角：",-1)),g("span",Ro,J(P(c)),1)]),g("div",null,[u[2]||(u[2]=g("span",{class:"text"},"翻滚角：",-1)),g("span",Io,J(P(d)),1)]),g("div",null,[u[3]||(u[3]=g("span",{class:"text"},"经度：",-1)),g("span",Ho,J(P(o)),1)]),g("div",null,[u[4]||(u[4]=g("span",{class:"text"},"纬度：",-1)),g("span",zo,J(P(n)),1)]),g("div",null,[u[5]||(u[5]=g("span",{class:"text"},"相机高度：",-1)),g("span",Vo,J(P(C)),1)]),g("div",null,[u[6]||(u[6]=g("span",{class:"text"},"海拔：",-1)),g("span",No,J(P(l)),1)])],512)),[[ke,P(s)]])}}),Fo=ie(Uo,[["__scopeId","data-v-3a6d5db9"]]),Me=[{Rgb:[0,0,0],Name:"黑色"},{Rgb:[41,36,33],Name:"象牙黑"},{Rgb:[128,138,135],Name:"冷灰"},{Rgb:[192,192,192],Name:"灰色"},{Rgb:[128,118,105],Name:"暖灰"},{Rgb:[118,128,105],Name:"石板灰"},{Rgb:[252,245,245],Name:"白烟灰"},{Rgb:[255,245,238],Name:"贝壳灰"},{Rgb:[255,235,205],Name:"杏仁灰"},{Rgb:[250,240,230],Name:"亚麻灰"},{Rgb:[251,255,242],Name:"象牙灰"},{Rgb:[202,235,216],Name:"天蓝灰"},{Rgb:[255,255,255],Name:"白色"},{Rgb:[0,255,0],Name:"绿色"},{Rgb:[127,255,0],Name:"黄绿色"},{Rgb:[34,139,34],Name:"森林绿"},{Rgb:[107,142,35],Name:"草绿色"},{Rgb:[85,102,0],Name:"黑黄"},{Rgb:[0,255,255],Name:"青色"},{Rgb:[64,224,205],Name:"青绿色"},{Rgb:[3,168,158],Name:"锰蓝"},{Rgb:[8,46,84],Name:"靛青色"},{Rgb:[0,0,255],Name:"蓝色"},{Rgb:[25,25,112],Name:"深蓝"},{Rgb:[0,199,140],Name:"土耳其蓝"},{Rgb:[255,255,0],Name:"黄色"},{Rgb:[255,227,132],Name:"粉黄"},{Rgb:[227,207,87],Name:"香蕉黄"},{Rgb:[255,215,0],Name:"金黄"},{Rgb:[255,153,18],Name:"镉黄"},{Rgb:[255,125,64],Name:"肉黄"},{Rgb:[255,128,0],Name:"橘黄"},{Rgb:[237,145,33],Name:"萝卜黄"},{Rgb:[255,0,0],Name:"红色"},{Rgb:[227,23,13],Name:"镉红"},{Rgb:[255,192,203],Name:"粉红"},{Rgb:[172,23,31],Name:"印度红"},{Rgb:[116,0,0],Name:"黑红"},{Rgb:[255,0,255],Name:"深红"},{Rgb:[255,127,80],Name:"珊瑚红"},{Rgb:[255,99,71],Name:"番茄红"},{Rgb:[188,143,143],Name:"玫瑰红"},{Rgb:[199,97,20],Name:"土色"},{Rgb:[156,102,31],Name:"砖红"},{Rgb:[199,97,20],Name:"肖贡土色"},{Rgb:[244,164,95],Name:"沙棕色"},{Rgb:[210,180,140],Name:"棕褐色"},{Rgb:[128,42,42],Name:"棕色"},{Rgb:[160,82,45],Name:"赫色"},{Rgb:[252,230,202],Name:"蛋壳灰"},{Rgb:[160,32,240],Name:"肖贡土色"},{Rgb:[138,43,226],Name:"紫罗兰"},{Rgb:[153,51,250],Name:"胡紫色"},{Rgb:[218,112,214],Name:"淡紫色"}],Oo={class:"prompt"},Bo={class:"promptTitle"},Wo=Q({__name:"TitleTool",props:{title:{type:String,default:""},showIcon:{type:Boolean,default:!1},isClose:{type:Boolean,default:!1}},emits:["isOpen"],setup(a,{emit:e}){return(t,i)=>(F(),B("div",Oo,[g("span",Bo,J(a.title),1)]))}}),be=ie(Wo,[["__scopeId","data-v-293c0872"]]),$o={class:"piechart"},Go=Q({__name:"PieChart",props:{pieData:{type:Object,default:()=>{}}},setup(a){const e=D(),t=a;ce(()=>{e.value=Ii(document.getElementById("Charts"),"light"),i(t.pieData)}),xe(()=>t.pieData,s=>{i(s)});function i(s){const o=[],n=[],l=[];for(const c in s)o.push(c),n.push({name:c,value:s[c].count}),l.push(s[c].color);const d={tooltip:{show:!1,trigger:"item",formatter:"{a0} <br/>{b0} : {c0} ({d0}%)"},legend:{show:!0,padding:[0,10],itemWidth:15,itemHeight:30,bottom:"20px",data:o,icon:"circle",textStyle:{width:60,fontSize:8,color:"#ffffff"}},color:l,series:[{name:"颜色",type:"pie",radius:"42%",center:["50%","38%"],label:{formatter:"{b|{b}} {per|{d}%} ",rich:{per:{color:"#ffffff",fontSize:10,lineHeight:50},b:{color:"#78f5f9",fontSize:10,lineHeight:50,borderRadius:2}}},data:n,labelLine:{length:15,length2:25,lineStyle:{color:"#ffffff"}},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"#ffffff"}}}],markLine:{label:{show:!1,position:"start"}},toolbox:{show:!1,right:15,top:10,iconStyle:{color:"#7AFAFE",borderWidth:0},feature:{saveAsImage:{backgroundColor:"#f8f8fa",pixelRatio:3,show:!0,icon:"path://M928 704a32 32 0 0 1 31.488 26.24l0.512 5.76v128a96 96 0 0 1-86.784 95.552L864 960h-704a96 96 0 0 1-95.552-86.784L64 864v-128a32 32 0 0 1 63.488-5.76L128 736v128a32 32 0 0 0 26.24 31.488L160 896h704a32 32 0 0 0 31.488-26.24L896 864v-128a32 32 0 0 1 32-32zM512 64c15.552 0 28.544 11.264 31.232 26.176l0.512 5.76v563.2l170.112-171.136a31.616 31.616 0 0 1 44.8 0 32 32 0 0 1 3.712 40.704l-3.648 4.416-224.32 225.536a31.616 31.616 0 0 1-40.448 3.712l-4.352-3.712L265.28 533.12a32 32 0 0 1 0-45.12 31.616 31.616 0 0 1 40.448-3.712l4.416 3.712 170.112 171.072v-563.2l0.256-3.712A31.808 31.808 0 0 1 512 64z",excludeComponents:["toolbox"],name:new Date().getTime()}}}};e.value.setOption(d,!0)}return(s,o)=>(F(),B("div",$o,o[0]||(o[0]=[g("div",{id:"Charts",style:{width:"100%",height:"260px"}},null,-1)])))}}),jo=ie(Go,[["__scopeId","data-v-74be8972"]]),ae=window.Cesium;class Yo{constructor(e){r(this,"viewer");r(this,"leftDownFlag",!1);r(this,"dragStartPosition",null);r(this,"dragEndPosition",null);r(this,"handler");r(this,"isDuringNewDraging",!1);r(this,"isFinishADragAction",!1);r(this,"rightDownFlag",!1);r(this,"callBack4MouseMove");this.viewer=e.viewer,this.leftDownFlag=!1,this.dragEndPosition=null,this.handler=new ae.ScreenSpaceEventHandler(this.viewer.scene.canvas),this.isDuringNewDraging=!1,this.isFinishADragAction=!1,this.callBack4MouseMove=e.callBack4MouseMove,this.handlers()}handlers(){this.leftDownAction(),this.mouseMoveAction(),this.leftUpAction()}leftDownAction(){this.handler.setInputAction(e=>{this.dragStartPosition=e.position,this.leftDownFlag=!0,this.isFinishADragAction=!1,this.isDuringNewDraging=!0,this.viewer.scene.screenSpaceCameraController.enableRotate=!1,this.viewer.scene.screenSpaceCameraController.enableTilt=!1,this.viewer.container.classList.add("screenshotCursor")},ae.ScreenSpaceEventType.LEFT_DOWN),this.handler.setInputAction(e=>{this.dragStartPosition=e.position,this.rightDownFlag=!0,this.isFinishADragAction=!1,this.isDuringNewDraging=!0,this.viewer.scene.screenSpaceCameraController.enableRotate=!1,this.viewer.scene.screenSpaceCameraController.enableTilt=!1,this.viewer.container.classList.add("screenshotCursor")},ae.ScreenSpaceEventType.RIGHT_DOWN)}mouseMoveAction(){this.handler.setInputAction(e=>{this.leftDownFlag&&this.isDuringNewDraging&&!this.isFinishADragAction&&this.dragStartPosition&&this.callBack4MouseMove(this.dragStartPosition,e.endPosition)},ae.ScreenSpaceEventType.MOUSE_MOVE)}leftUpAction(){this.handler.setInputAction(e=>{this.leftDownFlag&&(this.dragEndPosition=e.position,this.leftDownFlag=!1,this.isFinishADragAction=!0,this.isDuringNewDraging=!1,this.viewer.scene.screenSpaceCameraController.enableRotate=!0,this.viewer.scene.screenSpaceCameraController.enableTilt=!0,this.viewer.container.classList.remove("screenshotCursor"))},ae.ScreenSpaceEventType.LEFT_UP),this.handler.setInputAction(e=>{this.rightDownFlag&&(this.dragEndPosition=e.position,this.rightDownFlag=!1,this.isFinishADragAction=!0,this.isDuringNewDraging=!1,this.viewer.scene.screenSpaceCameraController.enableRotate=!0,this.viewer.scene.screenSpaceCameraController.enableTilt=!0,this.viewer.container.classList.remove("screenshotCursor"))},ae.ScreenSpaceEventType.RIGHT_UP)}removeAction(){this.handler.removeInputAction(ae.ScreenSpaceEventType.LEFT_DOWN),this.handler.removeInputAction(ae.ScreenSpaceEventType.LEFT_UP),this.handler.removeInputAction(ae.ScreenSpaceEventType.RIGHT_DOWN),this.handler.removeInputAction(ae.ScreenSpaceEventType.RIGHT_UP),this.handler.removeInputAction(ae.ScreenSpaceEventType.MOUSE_MOVE),this.dragStartPosition=null,this.dragEndPosition=null,this.viewer.scene.screenSpaceCameraController.enableRotate=!0,this.viewer.scene.screenSpaceCameraController.enableTilt=!0}}const Zo={class:"color-wrapper"},qo={class:"user-body"},Jo={class:"radio-way"},Xo={class:"block lng-lat-text"},Ko={class:"label"},Qo={class:"label"},en={class:"analysis-box"},tn={class:"viewpoint-box"},sn={class:"viewpoint-item"},on={class:"slide-box"},nn={class:"input-box"},an={class:"viewpoint-item"},rn={class:"slide-box"},ln={class:"input-box"},cn={class:"viewpoint-item"},hn={class:"slide-box"},dn={class:"input-box"},un={class:"btn_wrapper"},mn={key:0,class:"charts-box"},N=window.Cesium,pn=Q({__name:"index",setup(a){const{getMainViewer:e}=he();let t=null,i=null,s=null;const o=D(!0),n=D("全屏"),l=D(0),d=D(0),c=D(0),h=D(0),C=D(0),v=D(!1),_=D({}),f=D(!1),u=D(!0),w=D([{key1:"经度",key2:"",key3:"纬度",key4:""},{key1:"高度",key2:"",key3:"方位角",key4:""},{key1:"倾斜角",key2:""}]),L=Lt(()=>s==null?void 0:s.isFinishADragAction);let T;xe(L,()=>{s&&(T={x:s.dragStartPosition.x,y:s.dragStartPosition.y,width:s.dragEndPosition.x-s.dragStartPosition.x,height:s.dragEndPosition.y-s.dragStartPosition.y})}),xe(c,y=>{if(i){const m=i.camera,E=N.Math.toDegrees(m.positionCartographic.latitude),b=N.Math.toDegrees(m.positionCartographic.longitude);m.flyTo({destination:N.Cartesian3.fromDegrees(b,E,y),orientation:{heading:m.heading,pitch:m.pitch,roll:m.roll},duration:0})}}),xe(h,y=>{if(i){const m=i.camera,E=N.Math.toDegrees(m.positionCartographic.latitude),b=N.Math.toDegrees(m.positionCartographic.longitude),R=m.positionCartographic.height;m.flyTo({destination:N.Cartesian3.fromDegrees(b,E,R),orientation:{heading:N.Math.toRadians(y),pitch:m.pitch,roll:m.roll},duration:0})}}),xe(C,y=>{if(i){const m=i.camera,E=N.Math.toDegrees(m.positionCartographic.latitude),b=N.Math.toDegrees(m.positionCartographic.longitude),R=m.positionCartographic.height;m.flyTo({destination:N.Cartesian3.fromDegrees(b,E,R),orientation:{heading:m.heading,pitch:N.Math.toRadians(-y),roll:m.roll},duration:0})}}),ce(async()=>{i=await e();const y=i.camera,m=N.Math.toDegrees(y.positionCartographic.latitude),E=N.Math.toDegrees(y.positionCartographic.longitude),b=y.positionCartographic.height;l.value=E,d.value=m,h.value=N.Math.toDegrees(y.heading),C.value=-N.Math.toDegrees(y.pitch),c.value=b;const R=new N.ScreenSpaceEventHandler(i.canvas);R.setInputAction(z=>{const X=i.scene.pickPosition(z.endPosition),H=N.Cartographic.fromCartesian(X);l.value=N.Math.toDegrees(H.longitude),d.value=N.Math.toDegrees(H.latitude)},N.ScreenSpaceEventType.MOUSE_MOVE),i.scene.postRender.addEventListener(()=>{h.value=N.Math.toDegrees(i.camera.heading),C.value=-N.Math.toDegrees(i.camera.pitch),c.value=i.camera.positionCartographic.height}),R.setInputAction(()=>{c.value=i.camera.positionCartographic.height},N.ScreenSpaceEventType.WHEEL)}),$e(()=>{at(),s&&s.removeAction()});function O(){at();let y=document.getElementById("maskDivs");switch(!y&&i&&(y=document.createElement("div"),y.id="maskDivs",y.style.cssText=`
      position: absolute;
      background: rgba(75, 128, 221, 0.1);
      border: 2px dashed rgb(75, 128, 221);
      z-index: 999;
      pointer-events: none;
    `,i.container.appendChild(y)),y.classList.add("hide"),i.scene.screenSpaceCameraController.enableRotate=!0,i.scene.screenSpaceCameraController.enableTilt=!0,s&&s.removeAction(),n.value){case"全屏":break;case"区域":qt(),Xt();break}}function k(){u.value=!1}async function de(){f.value=!0;const y=i,m=y.camera,E=N.Math.toDegrees(m.positionCartographic.longitude),b=N.Math.toDegrees(m.positionCartographic.latitude),R=N.Math.toDegrees(m.heading),z=N.Math.toDegrees(m.pitch);w.value[0].key2=E.toFixed(1),w.value[0].key4=b.toFixed(1),w.value[1].key2=m.positionCartographic.height.toFixed(1),w.value[1].key4=R.toFixed(2)+"°",w.value[2].key2=z+"°";let X=null;const H=y.canvas;if(n.value==="区域"){if(!T)return f.value=!1,Dt({message:"请移到地图上绘制区域!",type:"warning"});X=await Se(y,T),f.value=!1}else X=await Jt(H.toDataURL("image/png")),f.value=!1;ee(X.data)}function ee(y){const m={},E=[];for(let b=0,R=y.length;b<R;b+=4){if(y[b]===80&&y[b+1]===107&&y[b+2]===47||y[b]===0&&y[b+1]===0&&y[b+2]===0)continue;const z=[y[b],y[b+1],y[b+2]];let X=nt(z,Me[0].Rgb),H=Me[0];for(let se=0,Re=Me.length;se<Re;se++){const rt=nt(z,Me[se].Rgb);X>rt&&(X=rt,H=Me[se])}E.push(H)}for(let b=0,R=E.length;b<R;b++)m[E[b].Name]&&m[E[b].Name].count?m[E[b].Name].count+=1:(m[E[b].Name]={},m[E[b].Name].count=1),m[E[b].Name].color="rgb("+E[b].Rgb.toString()+")";_.value=Yt(m),v.value=!0,f.value=!1}function Se(y,m){return new Promise(E=>{const R=y.scene.canvas,z=document.createElement("canvas");z.width=m.width,z.height=m.height;const X=z.getContext("2d");X.drawImage(R,m.x,m.y,m.width,m.height,0,0,m.width,m.height),E(X.getImageData(0,0,z.width,z.height))})}function nt(y,m){const E=(y[0]+m[0])/2,b=y[0]-m[0],R=y[1]-m[1],z=y[2]-m[2];return Math.sqrt((2+E/256)*b*b+4*R*R+(2+(255-E)/256)*z*z)}function Yt(y){const m=Object.keys(y).sort(function(R,z){return y[z].count-y[R].count}),E={},b=m.length>20?20:m.length;for(let R=0;R<b;R++)E[m[R]]=y[m[R]];return Zt(E)}function Zt(y){let m=0;for(const b in y)m+=y[b].count;let E=0;for(const b in y)y[b].count<m/100&&(E+=y[b].count,delete y[b]);return y.其他={count:E,color:"rgb(255,255,255)"},y}function qt(){t||(t=new Ae(i)),t.enable=!0,t.setContent("<span>请拖动绘制一个区域</span>")}function at(){t&&(t.enable=!1),t=null}function Jt(y){const m=y.replace(/^data:image\/\w+;base64,/,""),E=atob(m),b=E.length,R=new Uint8ClampedArray(b);for(let H=0;H<b;H++)R[H]=E.charCodeAt(H);const z=document.createElement("canvas"),X=new Blob([R],{type:"image/png"});return new Promise(H=>{fetch(URL.createObjectURL(X)).then(se=>se.blob()).then(se=>createImageBitmap(se)).then(se=>{z.width=se.width,z.height=se.height;const Re=z.getContext("2d");Re.drawImage(se,0,0),H(Re.getImageData(0,0,z.width,z.height))})})}function Xt(){s=new Yo({viewer:i,callBack4MouseMove:Kt})}function Kt(y,m){const E={x:y.x,y:y.y,width:m.x-y.x,height:m.y-y.y};T=E,Qt(E)}function Qt(y){const m=document.getElementById("maskDivs");y&&m&&m.classList&&(m.classList.remove("hide"),m.style.transform=`translate(${y.x}px, ${y.y}px)`,m.style.width=y.width+"px",m.style.height=y.height+"px")}return(y,m)=>{const E=j("el-radio"),b=j("el-radio-group"),R=j("el-slider"),z=j("el-input-number"),X=j("el-button");return F(),B("div",Zo,[g("div",{ref:"currentComponent",class:"colorAnalysis",onClick:k},[Le(g("div",qo,[x(be,{title:"色彩分析对象"}),g("div",Jo,[x(b,{modelValue:P(n),"onUpdate:modelValue":m[0]||(m[0]=H=>oe(n)?n.value=H:null),onChange:O},{default:W(()=>[x(E,{label:"全屏"},{default:W(()=>m[7]||(m[7]=[pe("全屏")])),_:1}),x(E,{label:"区域"},{default:W(()=>m[8]||(m[8]=[pe("区域")])),_:1})]),_:1},8,["modelValue"])]),x(be,{title:"色彩分析视野"}),g("div",Xo,[g("div",Ko,"X："+J(P(l).toFixed(6)),1),g("div",Qo,"Y："+J(P(d).toFixed(6)),1)]),g("div",en,[g("div",tn,[x(be,{title:"高度",style:{background:"none"}}),g("div",sn,[g("div",on,[x(R,{modelValue:P(c),"onUpdate:modelValue":m[1]||(m[1]=H=>oe(c)?c.value=H:null),min:100,max:1e5,"show-tooltip":!1},null,8,["modelValue"])]),g("div",nn,[x(z,{modelValue:P(c),"onUpdate:modelValue":m[2]||(m[2]=H=>oe(c)?c.value=H:null),min:100,max:1e5,step:10,"controls-position":"right"},null,8,["modelValue"])])]),x(be,{title:"方位角",style:{background:"none"}}),g("div",an,[g("div",rn,[x(R,{modelValue:P(h),"onUpdate:modelValue":m[3]||(m[3]=H=>oe(h)?h.value=H:null),min:0,max:359,step:1,"show-tooltip":!1},null,8,["modelValue"])]),g("div",ln,[x(z,{modelValue:P(h),"onUpdate:modelValue":m[4]||(m[4]=H=>oe(h)?h.value=H:null),min:0,max:359,step:1,"controls-position":"right"},null,8,["modelValue"])])]),x(be,{title:"倾斜角",style:{background:"none"}}),g("div",cn,[g("div",hn,[x(R,{modelValue:P(C),"onUpdate:modelValue":m[5]||(m[5]=H=>oe(C)?C.value=H:null),min:0,max:90,step:1,"show-tooltip":!1},null,8,["modelValue"])]),g("div",dn,[x(z,{modelValue:P(C),"onUpdate:modelValue":m[6]||(m[6]=H=>oe(C)?C.value=H:null),min:0,max:90,step:1,"controls-position":"right"},null,8,["modelValue"])])])])]),g("div",un,[x(X,{loading:P(f),type:"primary",style:{width:"100%"},onClick:de},{default:W(()=>m[9]||(m[9]=[pe("开始分析")])),_:1},8,["loading"])]),P(v)?(F(),B("div",mn,[x(be,{title:"主要色彩分布"}),x(jo,{ref:"pie","pie-data":P(_)},null,8,["pie-data"])])):it("",!0)],512),[[ke,P(o)]])],512)])}}}),gn=ie(pn,[["__scopeId","data-v-edaff2d9"]]),fn={Navigation:ms,LayerTree:xs,SightLine:As,ViewShed:Bs,HawkeyeMap:Lo,StatusBar:Fo,ColorAnalysis:gn},wn={class:"right-toolCard"},vn={class:"right-toolCard-header"},Cn={class:"right-header-name fx-r fx-r-c"},_n={class:"content"},yn=Q({__name:"index",props:{title:{default:""},onClose:{type:Function,default:void 0}},setup(a){const e=a,t=D(!0),i=()=>{var s;t.value=!1,(s=e.onClose)==null||s.call(e)};return(s,o)=>(F(),B("div",wn,[g("div",vn,[g("div",Cn,[g("span",null,J(s.title),1)]),g("span",null,[g("i",{class:"map-icon-ex map-icon-ex-guanbi",onClick:i})])]),g("div",_n,[hi(s.$slots,"default",{},void 0,!0)])]))}}),Sn=ie(yn,[["__scopeId","data-v-8f43dc97"]]),bn={InfoDialog:Sn},$=window.Cesium;class xn{constructor(e){r(this,"viewer");r(this,"duration",7200*1e3);r(this,"currentTime",0);r(this,"step",10);r(this,"offsetHeight",10);r(this,"datasource",new $.CustomDataSource);r(this,"aroundPoint");r(this,"aroundRequest");r(this,"handler");r(this,"mouseTip");r(this,"isArounding",!1);r(this,"currentHeading",0);r(this,"rotationSpeed",.15);this.viewer=e,this.viewer.dataSources.add(this.datasource),this.mouseTip=new Ae(this.viewer),this.mouseTip.setContent("<span>左键点击选点</span>")}start(){this.exit(),this._addClickEventListener(),this.mouseTip.enable=!0}parse(){this.aroundRequest&&cancelAnimationFrame(this.aroundRequest),this.isArounding=!1}continue(){this.animationFrame()}exit(){this.isArounding=!1,this.aroundRequest&&cancelAnimationFrame(this.aroundRequest),this.aroundRequest=0,this.datasource.entities.removeAll(),this._removeClickEventListener(),this.mouseTip.enable=!1}destroy(){this.exit(),this.viewer.dataSources.remove(this.datasource),this.handler&&this.handler.destroy()}_addClickEventListener(){this.handler||(this.handler=new $.ScreenSpaceEventHandler(this.viewer.canvas)),this._removeClickEventListener(),this.handler.setInputAction(e=>{let t=this.viewer.scene.pickPosition(e.position);if(!t){const o=this.viewer.scene.globe.ellipsoid;t=this.viewer.scene.camera.pickEllipsoid(e.position,o)}const i=$.Cartographic.fromCartesian(t);this.offsetHeight=this.viewer.camera.positionCartographic.height;const s={longitude:$.Math.toDegrees(i.longitude),latitude:$.Math.toDegrees(i.latitude),height:i.height};this.aroundPoint=s,this._drawPoint(s),this.mouseTip.enable=!1,this.animationFrame()},$.ScreenSpaceEventType.LEFT_CLICK)}_removeClickEventListener(){this.handler&&this.handler.removeInputAction($.ScreenSpaceEventType.LEFT_CLICK)}_addMouseMoveEventListener(){this.handler||(this.handler=new $.ScreenSpaceEventHandler(this.viewer.canvas)),this._removeClickEventListener(),this.handler.setInputAction(()=>{},$.ScreenSpaceEventType.MOUSE_MOVE)}_removeMouseMoveEventListener(){this.handler&&this.handler.removeInputAction($.ScreenSpaceEventType.MOUSE_MOVE)}animationFrame(){if(this.currentTime+=this.step,this.currentTime>=this.duration)this.exit();else{this.isArounding=!0;const e=this.aroundPoint,t=this.viewer.camera.heading;this.currentHeading=t,this.viewer.camera.setView({destination:$.Cartesian3.fromDegrees(e.longitude,e.latitude,(e.height??0)+this.offsetHeight),orientation:{heading:t,pitch:this.offsetHeight?$.Math.toRadians(-70):$.Math.toRadians(0),roll:0}}),this.currentHeading+=this.rotationSpeed*1,this.aroundRequest&&(cancelAnimationFrame(this.aroundRequest),this.aroundRequest=0),this.aroundRequest=requestAnimationFrame(this.animationFrame.bind(this))}}_drawPoint(e){const t=new $.Entity({point:new $.PointGraphics({color:new $.Color(1,1,0),pixelSize:20,outlineColor:new $.Color(0,1,1)}),position:$.Cartesian3.fromDegrees(e.longitude,e.latitude,(e.height??0)+this.offsetHeight)});this.datasource.entities.removeAll(),this.datasource.entities.add(t)}}window.Cesium.Cartesian3;const Pn=window.Cesium.Cartographic,Mn=window.Cesium.Cesium3DTileFeature,Tn=window.Cesium.Cesium3DTileset,Dn=window.Cesium.Model,Xe=window.Cesium.Ellipsoid,En=window.Cesium.SceneMode,Ln=window.Cesium.EllipsoidTerrainProvider,Ct=(a,e)=>{const t=a.scene,i=t.pick(e);let s,o,n,l,d=!1;t.pickPositionSupported&&(s=t.pickPosition(e));const c=a.scene.drillPick(e);for(const h of c)(h&&h.primitive instanceof Mn||h&&h.primitive instanceof Tn||h&&h.primitive instanceof Dn)&&(d=!0);if(d&&(s=a.scene.pickPosition(e),s)){const h=Pn.fromCartesian(s);h.height<0&&(h.height=0);const C=G(h.longitude),v=G(h.latitude),_=h.height;s=ge({longitude:C,latitude:v,height:_})}if(s){const h=Xe.WGS84.cartesianToCartographic(s);h&&(n={longitude:G(h.longitude),latitude:G(h.latitude),height:h.height})}if(t.mode===En.SCENE3D&&!(a.terrainProvider instanceof Ln)){const h=t.camera.getPickRay(e);o=t.globe.pick(h,t)}else o=t.camera.pickEllipsoid(e,Xe.WGS84);if(o){const h=Xe.WGS84.cartesianToCartographic(o);h&&(l={longitude:G(h.longitude),latitude:G(h.latitude),height:h.height})}if(!s&&(s=o),s&&o){const h=q(s).height;q(o).height>h&&(s=o)}return{target:i,targets:c,windowPosition:e,position:s,wgs84Position:n,surfacePosition:o,wgs84SurfacePosition:l}},M=window.Cesium,_t={width:3,material:M.Color.fromCssColorString("#1be0e1").withAlpha(.8),clampToGround:!0},yt={material:M.Color.fromCssColorString("#cecece").withAlpha(.1),outline:!0,outlineColor:M.Color.fromCssColorString("#1be0e1").withAlpha(.5),outlineWidth:2,heightReference:M.HeightReference.CLAMP_TO_GROUND},St={color:M.Color.fromCssColorString("#00f7fe"),heightReference:M.HeightReference.CLAMP_TO_GROUND,outlineColor:M.Color.fromCssColorString("#ffffff"),outlineWidth:1.5,pixelSize:8},Ke={material:M.Color.fromCssColorString("#00f7fe"),outline:!0,heightReference:M.HeightReference.CLAMP_TO_GROUND},re="polygon",fe="polyline",Te="point",Ne="circle";class Bt{constructor(e,t){r(this,"viewer");r(this,"drawScreenSpaceEventHandler");r(this,"drawCompleteCallback");r(this,"drawStepCompleteCallback");r(this,"drawLineStyle");r(this,"drawFillStyle");r(this,"drawPointStyle");r(this,"drawCircleStyle");r(this,"drawDataSource");r(this,"drawHostEntity");r(this,"drawPointCount");r(this,"drawPositionDatas");r(this,"pointPosition");r(this,"drawType");r(this,"tipElement");r(this,"circleRadius",0);this.viewer=e,this.viewer.scene.postProcessStages.fxaa.enabled=!0,this.drawScreenSpaceEventHandler=new M.ScreenSpaceEventHandler(e.canvas),this.drawCompleteCallback=t==null?void 0:t.drawCompleteCallback,this.drawStepCompleteCallback=t==null?void 0:t.drawStepCompleteCallback,this.drawLineStyle=t!=null&&t.drawLineStyle?{..._t,...t.drawLineStyle}:_t,this.drawFillStyle=t!=null&&t.drawFillStyle?{...yt,...t.drawFillStyle}:yt,this.drawPointStyle=t!=null&&t.drawPointStyle?{...St,...t.drawPointStyle}:St,this.drawCircleStyle=t!=null&&t.drawCircleStyle?{...Ke,...t.drawCircleStyle}:Ke,this.drawDataSource=new M.CustomDataSource("draw-tool-datasource"),this.viewer.dataSources.add(this.drawDataSource),this.drawHostEntity=void 0,this.drawPointCount=0,this.drawPositionDatas=[],this.pointPosition=null,this._createTip()}activate(e=re){this.deactivate(),[re,fe,Te].includes(e)&&(this.drawType=e,this._addDrawEventListener(),this._draw())}deactivate(){this._removeDrawEventListener(),this._hideTip(),this._clearDarw()}destroy(){this.drawCompleteCallback&&(this.drawCompleteCallback=void 0),this.drawStepCompleteCallback&&(this.drawStepCompleteCallback=void 0),this.deactivate()}_draw(){this._clearDarw(),this._drawMountedHook()}_addDrawEventListener(){this._removeDrawEventListener(),this.drawScreenSpaceEventHandler.setInputAction(e=>{this.tipElement&&(this.tipElement.style.display="block",this.tipElement.style.bottom=`${this.viewer.canvas.clientHeight-e.endPosition.y+10}px`,this.tipElement.style.left=`${e.endPosition.x+5}px`,this.tipElement.innerText=this._getTip());const i=Ct(this.viewer,e.endPosition).surfacePosition;this.drawType===fe?this.drawPointCount>1&&(this.drawPositionDatas[this.drawPositionDatas.length-1]=i):this.drawType===re?this.drawPointCount>1&&(this.drawPositionDatas[this.drawPositionDatas.length-1]=i):this.drawType===Ne&&this.drawPointCount>1&&(this.drawPositionDatas[this.drawPositionDatas.length-1]=i)},M.ScreenSpaceEventType.MOUSE_MOVE),this.drawScreenSpaceEventHandler.setInputAction(e=>{this._leftClickHandle(e)},M.ScreenSpaceEventType.LEFT_CLICK),this.drawScreenSpaceEventHandler.setInputAction(()=>{this.drawPositionDatas.length>1&&this.drawType===re&&(this.drawPositionDatas[this.drawPositionDatas.length-1]=this.drawPositionDatas[0]),this._drawStopHook()},M.ScreenSpaceEventType.RIGHT_CLICK)}_drawMountedHook(){switch(this.drawType){case Te:this.drawHostEntity=new M.Entity({position:new M.CallbackProperty(()=>this.pointPosition,!1),point:{...this.drawPointStyle,disableDepthTestDistance:Number.POSITIVE_INFINITY}});break;case fe:this.drawHostEntity=new M.Entity({polyline:{positions:new M.CallbackProperty(()=>{if(this.drawPositionDatas.length>0)return this.drawPositionDatas},!1),...this.drawLineStyle}});break;case re:this.drawHostEntity=new M.Entity({polygon:{hierarchy:new M.CallbackProperty(()=>this.drawPositionDatas.length>2?new M.PolygonHierarchy([...this.drawPositionDatas,this.drawPositionDatas[0]]):null,!1),...this.drawFillStyle},polyline:{positions:new M.CallbackProperty(()=>{if(this.drawPositionDatas.length>0&&this.drawPositionDatas.length<=2)return this.drawPositionDatas;if(this.drawPositionDatas.length>2)return[...this.drawPositionDatas,this.drawPositionDatas[0]]},!1),...this.drawLineStyle}});break;case Ne:this.drawHostEntity=new M.Entity({position:new M.CallbackProperty(()=>this.pointPosition,!1),ellipse:{semiMinorAxis:new M.CallbackProperty(()=>{const e=this.drawPositionDatas,t=Math.sqrt(Math.pow(e[0].x-e[e.length-1].x,2)+Math.pow(e[0].y-e[e.length-1].y,2));return this.circleRadius=t||t+1,this.circleRadius},!1),semiMajorAxis:new M.CallbackProperty(()=>{const e=this.drawPositionDatas,t=Math.sqrt(Math.pow(e[0].x-e[e.length-1].x,2)+Math.pow(e[0].y-e[e.length-1].y,2));return this.circleRadius=t||t+1,this.circleRadius},!1),...Ke}});break}this.drawHostEntity&&this.drawDataSource.entities.add(this.drawHostEntity)}_drawStopHook(){var e;if(this._removeDrawEventListener(),this._hideTip(),this.drawCompleteCallback){const t={cartesian3Array:[],positions:[]};if(this.drawPositionDatas.length>0&&this.drawPositionDatas.forEach(i=>{const s=M.Cartesian3.clone(i);t.cartesian3Array.push(s),t.positions.push(q(s))}),[fe,re].includes(this.drawType)&&(t.cartesian3Array.pop(),t.positions.pop()),this.drawType===Ne){const i=q(this.pointPosition),s=this.circleRadius,n=ki([i.longitude,i.latitude],s,{steps:720,units:"meters"}).geometry.coordinates[0].map(l=>{const[d,c]=l;return{longitude:d,latitude:c}});t.positions=n,t.cartesian3Array=Ee(n)}(e=this.drawCompleteCallback)==null||e.call(this,t)}}_clearDarw(){this.drawHostEntity&&(this.drawDataSource.entities.remove(this.drawHostEntity),this.drawHostEntity=void 0),this.drawPositionDatas=[],this.drawPointCount=0,this.pointPosition=M.Cartesian3.ZERO}_removeDrawEventListener(){this.drawScreenSpaceEventHandler.removeInputAction(M.ScreenSpaceEventType.MOUSE_MOVE),this.drawScreenSpaceEventHandler.removeInputAction(M.ScreenSpaceEventType.LEFT_CLICK),this.drawScreenSpaceEventHandler.removeInputAction(M.ScreenSpaceEventType.RIGHT_CLICK)}_leftClickHandle(e){var o;const s=Ct(this.viewer,e.position).surfacePosition;if(this.drawHostEntity&&(this.drawType===Te?(this.pointPosition=s,this.drawPositionDatas.push(s)):this.drawType===fe?this.drawPointCount===0?(this.drawPositionDatas.push(s),this.drawPositionDatas.push(s),this.drawPointCount=2):(this.drawPositionDatas.push(s),this.drawPointCount++):this.drawType===re?this.drawPointCount===0?(this.drawPositionDatas.push(s),this.drawPositionDatas.push(s),this.drawPointCount=2):(this.drawPositionDatas.push(s),this.drawPointCount++):this.drawType===Ne&&(this.drawPointCount===0?(this.drawPositionDatas.push(s),this.drawPositionDatas.push(s),this.drawPointCount=2):(this.drawPositionDatas.push(s),this.drawPointCount++))),this.drawStepCompleteCallback){const n={cartesian3Array:[],positions:[],currentCartesian3:new M.Cartesian3};this.drawPositionDatas.length>0&&this.drawPositionDatas.forEach(l=>{const d=M.Cartesian3.clone(l);n.cartesian3Array.push(d),n.positions.push(q(d))}),n.currentCartesian3=s,[fe,re].includes(this.drawType)&&(n.cartesian3Array.pop(),n.positions.pop()),(o=this.drawStepCompleteCallback)==null||o.call(this,n)}this.drawType===Te&&this._drawStopHook()}_getMousePickInfo(e){const t=this.viewer,i=t.scene,s=i.pick(e),o=i.drillPick(e);let n,l,d,c,h=!1;i.pickPositionSupported&&(n=i.pickPosition(e));const C=t.scene.drillPick(e);for(const v of C)(v&&v.primitive instanceof M.Cesium3DTileFeature||v&&v.primitive instanceof M.Cesium3DTileset||v&&v.primitive instanceof M.Model)&&(h=!0);if(h&&(t.scene.pick(e),n=t.scene.pickPosition(e),n)){const v=M.Cartographic.fromCartesian(n);v.height<0&&(v.height=0);const _=M.Math.toDegrees(v.longitude),f=M.Math.toDegrees(v.latitude),u=v.height;n=ge({longitude:_,latitude:f,height:u})}if(n){const v=M.Ellipsoid.WGS84.cartesianToCartographic(n);v&&(d={longitude:G(v.longitude),latitude:G(v.latitude),height:v.height})}if(i.mode===M.SceneMode.SCENE3D&&!(t.terrainProvider instanceof M.EllipsoidTerrainProvider)){const v=i.camera.getPickRay(e);l=i.globe.pick(v,i)}else l=i.camera.pickEllipsoid(e,M.Ellipsoid.WGS84);if(l){const v=M.Ellipsoid.WGS84.cartesianToCartographic(l);v&&(c={longitude:G(v.longitude),latitude:G(v.latitude),height:v.height})}if(!n&&(n=l),n&&l){const v=q(n).height;q(l).height>v&&(n=l)}return{target:s,targets:o.reverse(),windowPosition:e,position:n,wgs84Position:d,surfacePosition:l,wgs84SurfacePosition:c}}_getTip(){let e="";switch(this.drawType){case Te:e="左击选择点位";break;case fe:case re:this.drawPositionDatas.length===0?e="左击选择起点,右击结束":e="继续左击选择下一点,右击结束";break}return e}_hideTip(){this.tipElement&&(this.tipElement.style.display="none")}_createTip(){const e="F171343D-1187-464F-A132-F5BC0D9D1B60";return this.tipElement=document.getElementById(e),this.tipElement||(this.tipElement=document.createElement("div"),this.viewer.container.appendChild(this.tipElement),this.tipElement.style.cssText=`    
        display: none;
        position: absolute;
        font-size: 13px;
        bottom: 731px;
        left: 894px;
        pointer-events: none;
        padding: 4px;
        color: white;
        background-color: #163a41;
        border: solid #00f6fd 1px;`),this.tipElement}}const kn={MouseTip:Ae,PointLookAround:xn,Draw:Bt},An=""+new URL("../img/excavationregion_side.CX9OodjT.jpg",import.meta.url).href,A=window.Cesium;class Rn{constructor(e){r(this,"viewer");r(this,"drawTool");r(this,"deep",0);r(this,"interpolationPointSize",50);r(this,"datasource");r(this,"excavateEntity",null);r(this,"depthTestAgainstTerrain",!0);this.viewer=e,this.drawTool=new Bt(e),this.datasource=new A.CustomDataSource,this.viewer.dataSources.add(this.datasource),this.depthTestAgainstTerrain=this.viewer.scene.globe.depthTestAgainstTerrain}execute(e){this.clear(),this.deep=e,this.drawTool.activate("polygon"),this.drawTool.drawCompleteCallback=t=>{const{positions:i}=t;i.push(i[0]),this._startExcavate(i)}}clear(){this.datasource.entities.removeAll(),this.drawTool.deactivate(),this.viewer.scene.globe.depthTestAgainstTerrain=this.depthTestAgainstTerrain,this.viewer.scene.globe.clippingPlanes=null}async _startExcavate(e){this.viewer.scene.globe.depthTestAgainstTerrain=!0;const t=e.map(h=>[h.longitude,h.latitude,h.height]),i=Ai(t);Ri(i)&&t.reverse();const o=[];t.forEach(h=>{o.push(A.Cartesian3.fromDegrees(h[0],h[1],h[2]))});const n=[];for(let h=0;h<o.length-1;h++){const C=(h+1)%o.length;let v=A.Cartesian3.add(o[h],o[C],new A.Cartesian3);v=A.Cartesian3.multiplyByScalar(v,.5,v);const _=A.Cartesian3.normalize(v,new A.Cartesian3);let f=A.Cartesian3.subtract(o[C],v,new A.Cartesian3);f=A.Cartesian3.normalize(f,f);let u=A.Cartesian3.cross(f,_,new A.Cartesian3);u=A.Cartesian3.normalize(u,u);const w=new A.Plane(u,0),L=A.Plane.getPointDistance(w,v);n.push(new A.ClippingPlane(u,L))}let l=o;const d=!(this.viewer.terrainProvider instanceof A.EllipsoidTerrainProvider);let c=0;if(d){const h=this.prepareWall(o),C=await A.sampleTerrainMostDetailed(this.viewer.terrainProvider,h.lerp_pos);c=Math.min(...C.map(f=>f.height));const v=[];for(let f=0;f<C.length;f++){const u=C[f],w=A.Cartesian3.fromRadians(u.longitude,u.latitude,u.height);v.push(w)}l=v,this.excavateEntity&&(this.datasource.entities.remove(this.excavateEntity),this.excavateEntity=null),this.excavateEntity=new A.Entity({polygon:{hierarchy:l,material:new A.ImageMaterialProperty({image:An}),closeTop:!1,extrudedHeight:d?-this.deep+c:-this.deep,perPositionHeight:d,heightReference:A.HeightReference.CLAMP_TO_GROUND}}),this.datasource.entities.add(this.excavateEntity);const _=this.viewer.scene.globe;_.depthTestAgainstTerrain=!0,_.clippingPlanes=new A.ClippingPlaneCollection({modelMatrix:this.excavateEntity.computeModelMatrix(A.JulianDate.now()),planes:n,edgeWidth:1,edgeColor:A.Color.WHITE,enabled:!0}),_.backFaceCulling=!0,_.showSkirts=!0}}prepareWall(e){const t=e.length,i=-this.deep,s=[],o=[],n=[];for(let l=0;l<t;l++){const d=l===t-1?0:l+1,c=[A.Cartographic.fromCartesian(e[l]).longitude,A.Cartographic.fromCartesian(e[l]).latitude],h=[A.Cartographic.fromCartesian(e[d]).longitude,A.Cartographic.fromCartesian(e[d]).latitude];l===0&&(n.push(new A.Cartographic(c[0],c[1])),o.push(A.Cartesian3.fromRadians(c[0],c[1],i)),s.push(A.Cartesian3.fromRadians(c[0],c[1],0)));for(let C=1;C<=this.interpolationPointSize;C++){const v=A.Math.lerp(c[0],h[0],C/this.interpolationPointSize),_=A.Math.lerp(c[1],h[1],C/this.interpolationPointSize);l===t-1&&C===this.interpolationPointSize||(n.push(new A.Cartographic(v,_)),o.push(A.Cartesian3.fromRadians(v,_,i)),s.push(A.Cartesian3.fromRadians(v,_,0)))}}return{lerp_pos:n,bottom_pos:o,no_height_top:s}}}const le=window.Cesium;class In{constructor(e,t){r(this,"localMatrix");r(this,"tileset");r(this,"option");r(this,"flatHeight");r(this,"center");r(this,"matrix");r(this,"regionList",[]);r(this,"localPositionsArr",[]);r(this,"getUniqueArray",e=>e.filter((t,i,s)=>s.indexOf(t,0)===i));var i;this.tileset=e,this.option=t,this.flatHeight=((i=this.option)==null?void 0:i.flatHeight)||0,this.center=e.boundingSphere.center.clone(),this.matrix=le.Transforms.eastNorthUpToFixedFrame(this.center.clone()),this.localMatrix=le.Matrix4.inverse(this.matrix,new le.Matrix4)}addRegion(e){let{id:t}=e||{};t||(t=new Date().getTime()+""+Number(Math.random()*1e3).toFixed(0)),this.regionList.push(e);for(let o=0;o<this.regionList.length;o++){const l=this.regionList[o].positions,d=this.cartesiansToLocal(l);this.localPositionsArr.push(d)}const i=this.getIsinPolygonFun(this.localPositionsArr);let s="";for(let o=0;o<this.localPositionsArr.length;o++){const n=this.localPositionsArr[o],l=n.length;let d="";n.forEach((c,h)=>{d+=`points_${l}[${h}] = vec2(${c[0]}, ${c[1]});
`}),s+=`
                ${d}
                if(isPointInPolygon_${l}(position2D)){
                    vec4 tileset_local_position_transformed = vec4(tileset_local_position.x, tileset_local_position.y, ground_z, 1.0);
                    vec4 model_local_position_transformed = czm_inverseModel * u_tileset_localToWorldMatrix * tileset_local_position_transformed;
                    vsOutput.positionMC.xy = model_local_position_transformed.xy;
                    vsOutput.positionMC.z = model_local_position_transformed.z+ modelMC.z*0.002;
                    return;
                }`}this.updateShader(i,s)}removeRegionById(e){if(!e)return;this.regionList=this.regionList.filter(s=>s.id!==e),this.localPositionsArr=[];for(let s=0;s<this.regionList.length;s++){const n=this.regionList[s].positions,l=this.cartesiansToLocal(n);this.localPositionsArr.push(l)}const t=this.getIsinPolygonFun(this.localPositionsArr);let i="";for(let s=0;s<this.localPositionsArr.length;s++){const o=this.localPositionsArr[s],n=o.length;let l="";o.forEach((d,c)=>{l+=`points_${n}[${c}] = vec2(${d[0]}, ${d[1]});
`}),i+=`
                ${l}
                if(isPointInPolygon_${n}(position2D)){
                    vec4 tileset_local_position_transformed = vec4(tileset_local_position.x, tileset_local_position.y, ground_z, 1.0);
                    vec4 model_local_position_transformed = czm_inverseModel * u_tileset_localToWorldMatrix * tileset_local_position_transformed;
                    vsOutput.positionMC.xy = model_local_position_transformed.xy;
                    vsOutput.positionMC.z = model_local_position_transformed.z+ modelMC.z*0.002;
                    return;
                }`}this.updateShader(t,i)}destroy(){this.tileset.customShader=void 0}getIsinPolygonFun(e){const t=e.map(o=>o.length),i=this.getUniqueArray(t);let s="";return i.forEach(o=>{s+=`
                vec2 points_${o}[${o}];
                bool isPointInPolygon_${o}(vec2 point){
                int nCross = 0; // 交点数
                const int n = ${o}; 
                for(int i = 0; i < n; i++){
                    vec2 p1 = points_${o}[i];
                    vec2 p2 = points_${o}[int(mod(float(i+1),float(n)))];
                    if(p1[1] == p2[1]){
                        continue;
                    }
                    if(point[1] < min(p1[1], p2[1])){
                        continue;
                    }
                    if(point[1] >= max(p1[1], p2[1])){
                        continue;
                    }
                    float x = p1[0] + ((point[1] - p1[1]) * (p2[0] - p1[0])) / (p2[1] - p1[1]);
                    if(x > point[0]){
                     nCross++;
                    }
                }

                return int(mod(float(nCross), float(2))) == 1;
                }
            `}),s}updateShader(e,t){const i=new le.CustomShader({uniforms:{u_tileset_localToWorldMatrix:{type:le.UniformType.MAT4,value:this.matrix},u_tileset_worldToLocalMatrix:{type:le.UniformType.MAT4,value:this.localMatrix},u_flatHeight:{type:le.UniformType.FLOAT,value:this.flatHeight}},vertexShaderText:`
            // 所有isPointInPolygon函数
            ${e}
            void vertexMain(VertexInput vsInput, inout czm_modelVertexOutput vsOutput){
                vec3 modelMC = vsInput.attributes.positionMC;
                vec4 model_local_position = vec4(modelMC.x, modelMC.y, modelMC.z, 1.0);
                vec4 tileset_local_position = u_tileset_worldToLocalMatrix * czm_model * model_local_position;
                vec2 position2D = vec2(tileset_local_position.x,tileset_local_position.y);
                float ground_z = 0.0 + u_flatHeight;
                // 多个多边形区域
                ${t}
            }`});this.tileset.customShader=i}cartesiansToLocal(e){const t=[];for(let i=0;i<e.length;i++){const s=e[i],o=le.Matrix4.multiplyByPoint(this.localMatrix,s,new le.Cartesian3);t.push([o.x,o.y])}return t}}const Z=window.Cesium;class Hn{constructor(e,t=[]){r(this,"viewer");r(this,"direction","horizontal");r(this,"opened",!1);r(this,"rollerLayers",[]);r(this,"rollerSliderBar");r(this,"handler",null);r(this,"rollerShutterConfig",{mode:1,splitPosition:.5});this.viewer=e,this.rollerLayers=t}setRollerShutter(e,t){this.rollerLayers=e,t&&(this.rollerShutterConfig=t),this.createRollerElement(this.direction),this.opened=!0,this.startRollerShutterSplit(this.rollerLayers)}close(){this.opened=!1,this.rollerSliderBar&&(this.rollerSliderBar.style.display="none",this.rollerSliderBar.style.left="50%"),this.handler&&(this.handler.destroy(),this.handler=null);const e=this.viewer.imageryLayers;for(let i=0;i<e.length;i++){const s=e.get(i);s.splitDirection=Z.SplitDirection.NONE}const t=this.viewer.scene.primitives;for(let i=0;i<t.length;i++){const s=t.get(i);s instanceof Z.Cesium3DTileset&&(s.splitDirection=Z.SplitDirection.NONE)}}startRollerShutterSplit(e){this.rollerLayers=e,this.viewer.scene.splitPosition=this.rollerShutterConfig.splitPosition;const i=this.rollerShutterConfig.mode===1?Z.SplitDirection.RIGHT:Z.SplitDirection.LEFT;this.rollerLayers.forEach(n=>{n.splitDirection=this.opened?i:Z.SplitDirection.NONE});const s=this.viewer.imageryLayers;for(let n=0;n<s.length;n++){const l=s.get(n);this.rollerLayers.includes(l)||(l.splitDirection=Z.SplitDirection.NONE)}const o=this.viewer.scene.primitives;for(let n=0;n<o.length;n++){const l=o.get(n);!this.rollerLayers.includes(l)&&l instanceof Z.Cesium3DTileset&&(l.splitDirection=Z.SplitDirection.NONE)}}createRollerElement(e){if(this.rollerSliderBar){this.rollerSliderBar.style.display="block";return}if(e==="horizontal"){const t=document.createElement("div");t.style.cssText=`
        position: absolute;
        left: 50%;
        top: 0px;
        background-color: #d3d3d3;
        width: 5px;
        cursor: ew-resize;
        height: 100%;
        z-index: 5;
      `,this.rollerSliderBar=t,this.viewer.container.appendChild(this.rollerSliderBar)}this.addRollerSliderEventListener()}addRollerSliderEventListener(){this.handler||(this.handler=new Z.ScreenSpaceEventHandler(this.rollerSliderBar));const e=this.rollerSliderBar,t=this.viewer.container.clientWidth;let i=!1;const s=o=>{if(!i)return;const n=o.endPosition.x,l=(e.offsetLeft+n)/t;e.style.left=l*e.parentElement.clientWidth+"px",this.rollerShutterConfig.splitPosition=l,this.setRollerShutter(this.rollerLayers,this.rollerShutterConfig)};this.handler.setInputAction(function(){i=!0},Z.ScreenSpaceEventType.LEFT_DOWN),this.handler.setInputAction(function(){i=!0},Z.ScreenSpaceEventType.PINCH_START),this.handler.setInputAction(s,Z.ScreenSpaceEventType.MOUSE_MOVE),this.handler.setInputAction(s,Z.ScreenSpaceEventType.PINCH_MOVE),this.handler.setInputAction(()=>{i=!1},Z.ScreenSpaceEventType.LEFT_UP),this.handler.setInputAction(()=>{i=!1},Z.ScreenSpaceEventType.PINCH_END)}}const zn={TerrainExcavate:Rn,TilesetFlat:In,RollerShuter:Hn},Ce=window.Cesium,Vn=(a,e)=>{const t=new Ce.CustomShader({lightingModel:Ce.LightingModel.UNLIT,varyings:{v_normalMC:Ce.VaryingType.VEC3},uniforms:{u_texture:{value:new Ce.TextureUniform({url:e}),type:Ce.UniformType.SAMPLER_2D}},vertexShaderText:`
      void vertexMain(VertexInput vsInput, inout czm_modelVertexOutput vsOutput) {
        v_normalMC = vsInput.attributes.normalMC; // 顶点法向量
      }
    `,fragmentShaderText:`
      void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {
          vec3 positionMC = fsInput.attributes.positionMC; // 片元坐标
          float width = 75.0;
          float height = 75.0;
          vec3 axis_z = vec3(0.0, 0.0, 1.0);
          vec3 axis_y = vec3(0.0, 1.0, 0.0);

          if (dot(axis_y, v_normalMC) > 0.95) { // z轴上 不贴图
            material.diffuse = vec3(0.079, 0.107, 0.111);
          } else {
            float textureX = 0.0;
            float dotYAxis = dot(axis_z, v_normalMC);

            if (dotYAxis > 0.71 || dotYAxis < -0.71) {
              textureX = mod(positionMC.x, width) / width;
            } else {
              textureX = mod(positionMC.z, width) / width;
            }

            float textureY = mod(positionMC.y, height) / height;
            vec3 rgb = texture(u_texture, vec2(textureX, textureY)).rgb;
            material.diffuse = rgb;
        }
      }
`});a.customShader=t},Nn=()=>new Ce.CustomShader({mode:Ce.CustomShaderMode.MODIFY_MATERIAL,lightingModel:0,fragmentShaderText:`
    void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {
        vec3 positionMC = fsInput.attributes.positionMC;
        float bottomH = 0.0;  // 底部高度
        float breakH = 80.0;  // 泛光分割高度
        float fsheight = fsInput.attributes.positionMC.y-bottomH; // 当前像素点高度
        // 底色
        float fgvec = (fsheight / breakH) * 1.5;
        material.diffuse *= vec3(fgvec, fgvec, fgvec); // 夸张亮度 亮的更亮 暗的更暗

        float ringMaxH = 100.0; // 光环高度范围
        float heightRate = clamp(fsheight / ringMaxH, 0.0, 1.0); // 高度比例
        // ========== 居中红色光环 ========
        // vec3 bkcolor = vec3(1.0,0.0,0.0);
        // float zs = fract(czm_frameNumber / 120.0);
        // float showH = 60.0;
        // float diff_red = step(0.01,abs((heightRate - zs) - showH / ringMaxH));
        // material.diffuse += bkcolor * (1.0 - diff_red);
        // material.alpha = 1.0;

        // ========== 光环1 ===========
        float moveRate = fract(czm_frameNumber / 360.0); // 利用当前第几帧 来进行光环移动
        moveRate = abs(moveRate - 0.5) * 2.0; // 光环上下扫描
        float diff = step(0.01, abs(heightRate - moveRate)); // 设置光环宽度
        material.diffuse += material.diffuse * (1.0 - diff);
    }
        `}),Un=`
void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material) {
              float _baseHeight = 0.0; // 物体的基础高度，需要修改成一个合适的建筑基础高度
              float _heightRange = 60.0; // 高亮的范围
              float _glowRange = 300.0; // 光环的移动范围(高度)
                float vtxf_height = fsInput.attributes.positionMC.z-_baseHeight;
                float vtxf_a11 = fract(czm_frameNumber / 120.0) * 3.14159265 * 2.0;
                float vtxf_a12 = vtxf_height / _heightRange + sin(vtxf_a11) * 0.1;
                material.diffuse*= vec3(vtxf_a12, vtxf_a12, vtxf_a12);
                float vtxf_a13 = fract(czm_frameNumber / 360.0);
                float vtxf_h = clamp(vtxf_height / _glowRange, 0.0, 1.0);
                vtxf_a13 = abs(vtxf_a13 - 0.5) * 2.0;
                float vtxf_diff = step(0.005, abs(vtxf_h - vtxf_a13));
                material.diffuse += material.diffuse * (1.0 - vtxf_diff);
            }
`,Fn={setBuildingCustomShader:Vn,getBlueCustomShader:Nn,fragmentShaderText:Un},we=window.Cesium;class On{constructor(e,t){this.opt=t||{},this.tileset=e,this.lights=t.lights||[],!(this.lights.length<1)&&(this.customShader=this.getUnformsShader(),this.tileset.customShader=this.customShader)}getUnformsShader(){const e={};let t="";const i=[];for(let n=0;n<this.lights.length;n++){const l=this.lights[n],d=l.position;l.te,l.targetPosition;const c=l.color,h=l.length;l.innerRange,l.outRange;const C=l.intensity;d&&(te=te||new Date().getTime()+"-"+Math.ceil(Math.random()*1e3),i.push(te),e[`u_lightPosition_${te}`]={type:we.UniformType.VEC3,value:d},e[`u_lightColor_${te}`]={type:we.UniformType.VEC4,value:c||we.Color.RED},e[`u_length_${te}`]={type:we.UniformType.FLOAT,value:h||500},e[`u_intensity_${te}`]={type:we.UniformType.FLOAT,value:C||10},t+=`
                vec4 fcolor_${te} = pointLight(
                    u_lightColor_${te},
                    u_lightPosition_${te},
                    positionWC,
                    positionEC,
                    normalEC,
                    pbrParameters,
                    u_intensity_${te},
                    u_length_${te}
                );
            `)}let s="";i.length>1?(s=`
            vec3 finalColor = mix(
                fcolor_${i[0]}.rgb, 
                fcolor_${i[1]}.rgb,
                0.5);
            `,i.forEach((n,l)=>{l>1&&(s+=`
                    finalColor = mix(
                            finalColor.rgb,
                            fcolor_${n}.rgb,
                            0.5
                        );
                `)})):s=`vec3 finalColor = fcolor_${i[0]}.rgb;`;const o=`
          struct czm_pbrParameters
              {
                  vec3 diffuseColor;
                  float roughness;
                  vec3 f0;
              };
            vec4 pointLight(
                vec4 lightColor,
                vec3 lightPosition,
                vec3 positionWC,
                vec3 positionEC,
                vec3 normalEC,
                czm_pbrParameters pbrParameters,
                float intensity,
                float plength
                ){
                    // 光源-片元向量
                    vec3 lightToPoint = (czm_view * vec4(lightPosition,1.0)).xyz - positionEC;
                    vec3 lightToPoint_dir = normalize(lightToPoint);
                    // 计算光源位置-偏远位置组成的向量 与 光线向量的 点乘，即当前片元的颜色
                    // 颜色插值
                    float inLight = 1.0;;
                    // 判断点光源和片元的位置关系 0-垂直 1-正上方
                    float light = inLight * clamp(dot(normalEC,lightToPoint_dir),0.0,1.0); //漫反射
                    // 光线衰减
                    vec3 light1Dir = positionWC - lightPosition;
                    float lDistance = 1.0;
                    // 根据与光源距离 计算强度
                    lDistance = 1.0 - min( ( length( light1Dir ) / plength ), 1.0 );
                    // 超出范围 变为模型黑色  范围内 光强递减
                    if(lDistance < 0.00001 ) {
                        return vec4(0.0);
                    }else{
                        vec3 diffuseColor = pbrParameters.diffuseColor;
                        // 边缘变黑 如果不想变黑 就去掉light
                        diffuseColor *= light * lightColor.rgb; 
                        diffuseColor *=  lDistance * intensity;
                        return vec4(diffuseColor,lDistance);
                    }
                }

            void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material){
                    material.diffuse = vec3(1.0,1.0,1.0); // 设置模型基地色为白色 防止出现颜色偏差
                    vec3 positionWC = fsInput.attributes.positionWC;
                    vec3 normalEC = fsInput.attributes.normalEC;
                    vec3 positionEC = fsInput.attributes.positionEC;
                    czm_pbrParameters pbrParameters;
                    pbrParameters.diffuseColor = material.diffuse;
                    // 设置反射率
                    pbrParameters.f0 = vec3(0.5);
                    // 设置粗糙程度
                    pbrParameters.roughness = 1.0;
                    // 设置照明参数
                    ${t};
                    ${s};
                    material.diffuse *= finalColor;
                }
            `;return new we.CustomShader({lightingModel:we.LightingModel.UNLIT,uniforms:e,fragmentShaderText:o})}destroy(){this.tileset.customShader=void 0}}const U=window.Cesium,me=U,Bn=`
    uniform samplerCube u_cubeMap;
    varying vec3 v_texCoord;
    void main()
    {
      vec4 color = textureCube(u_cubeMap, normalize(v_texCoord));
      gl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);
    }
  `,Wn=`
    attribute vec3 position; 
    varying vec3 v_texCoord;
    uniform mat3 u_rotateMatrix;
    void main()
    {
      vec3 p = czm_viewRotation * u_rotateMatrix * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));
      gl_Position = czm_projection * vec4(p, 1.0);
      v_texCoord = position.xyz;
    }
  `;class $n{constructor(e,t){r(this,"viewer");r(this,"sources");r(this,"show");r(this,"_sources");r(this,"_command");r(this,"_cubeMap");r(this,"defaultSkyBox");r(this,"skyListener");r(this,"_useHdr");r(this,"_attributeLocations");this.viewer=e,this.sources=t.sources,this._sources=void 0,this.show=U.defaultValue(t.show,!0);const i=me.DrawCommand;this._command=new i({modelMatrix:U.Matrix4.clone(U.Matrix4.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0,this.skyListener=null,this.defaultSkyBox=e.scene.skyBox}renderer(e){this.skyListener=()=>{const t=this.viewer.scene.camera.positionCartographic.height,i=22e4,s=15e4,o=12e4,n=1e4,l=this.viewer.scene.skyAtmosphere;if(t<i&&U.defined(e)){let c=(t-o)/(i-o);c>1?c=1:c<0&&(c=0);let h=(t-o)/(s-o);h>1?h=1:h<0&&(h=0),e.alpha=1-h,t>o?(l.show=!0,l.alpha=c,this.viewer.scene.skyBox=e):this.viewer.scene.skyAtmosphere.show=!1}else l.alpha=1,this.viewer.scene.skyBox=this.defaultSkyBox;const d=this.viewer.scene.screenSpaceCameraController;if(this.viewer.scene.skyBox!==this.defaultSkyBox)t>o-2*n&&t<s+3*n?d.zoomFactor=.4:d.zoomFactor=5;else{const c=this.viewer.scene.skyBox;c.alpha=1;const h=this.viewer.scene.skyAtmosphere;h.alpha=1,d.zoomFactor=5}},this.viewer.scene.postRender.addEventListener(this.skyListener)}update(e,t){if(!this.show||e.mode!==U.SceneMode.SCENE3D&&e.mode!==U.SceneMode.MORPHING||!e.passes.render)return;const i=e.context;if(this._sources!==this.sources){this._sources=this.sources;const o=this.sources;if(!U.defined(o.positiveX)||!U.defined(o.negativeX)||!U.defined(o.positiveY)||!U.defined(o.negativeY)||!U.defined(o.positiveZ)||!U.defined(o.negativeZ))throw new U.DeveloperError("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");if(typeof o.positiveX!=typeof o.negativeX||typeof o.positiveX!=typeof o.positiveY||typeof o.positiveX!=typeof o.negativeY||typeof o.positiveX!=typeof o.positiveZ||typeof o.positiveX!=typeof o.negativeZ)throw new U.DeveloperError("this.sources properties must all be the same type.");typeof o.positiveX=="string"?me.loadCubeMap(i,this._sources).then(n=>{this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=n}):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new me.CubeMap({context:i,source:o}))}const s=this._command;if(s.modelMatrix=U.Transforms.eastNorthUpToFixedFrame(e.camera._positionWC),!U.defined(s.vertexArray)){s.uniformMap={u_cubeMap:()=>this._cubeMap,u_rotateMatrix:function(){return U.Matrix4.getRotation(s.modelMatrix,new U.Matrix3)}};const o=U.BoxGeometry.createGeometry(U.BoxGeometry.fromDimensions({dimensions:new U.Cartesian3(2,2,2),vertexFormat:U.VertexFormat.POSITION_ONLY})),n=this._attributeLocations=U.GeometryPipeline.createAttributeLocations(o);s.vertexArray=me.VertexArray.fromGeometry({context:i,geometry:o,attributeLocations:n,bufferUsage:me.BufferUsage._DRAW}),s.renderState=me.RenderState.fromCache({blending:U.BlendingState.ALPHA_BLEND})}if(!U.defined(s.shaderProgram)||this._useHdr!==t){const o=new me.ShaderSource({defines:[t?"HDR":""],sources:[Bn]});s.shaderProgram=me.ShaderProgram.fromCache({context:i,vertexShaderSource:Wn,fragmentShaderSource:o,attributeLocations:this._attributeLocations}),this._useHdr=t}if(U.defined(this._cubeMap))return s}destroy(){const e=this._command;e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this.viewer.scene.skyBox=this.defaultSkyBox,this.skyListener&&this.viewer.scene.postRender.removeEventListener(this.skyListener)}}const Gn={Building3Dtiles:Fn,PointLight:On,GroundSkyBox:$n},jn=637099681e-2,bt=[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],Ue=[75,60,45,30,15,0],Yn=[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],xt=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,64779557466716e-5,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]];class Zn{constructor(){r(this,"isWgs84",!1)}getDistanceByMC(e,t){if(!e||!t)return 0;const i=this.convertMC2LL(e);if(!i)return 0;const s=this.toRadians(i.longitude),o=this.toRadians(i.latitude),n=this.convertMC2LL(t);if(!n)return 0;const l=this.toRadians(n.longitude),d=this.toRadians(n.latitude);return this.getDistance(s,l,o,d)}getDistanceByLL(e,t){if(!e||!t)return 0;e.longitude=this.getLoop(e.longitude,-180,180),e.latitude=this.getRange(e.latitude,-74,74),t.longitude=this.getLoop(t.longitude,-180,180),t.latitude=this.getRange(t.latitude,-74,74);const i=this.toRadians(e.longitude),s=this.toRadians(e.latitude),o=this.toRadians(t.longitude),n=this.toRadians(t.latitude);return this.getDistance(i,o,s,n)}convertMC2LL(e){if(!e)return{longitude:0,latitude:0};let t={longitude:0,latitude:0};if(this.isWgs84){t.longitude=e.longitude/2003750834e-2*180;const o=e.latitude/2003750834e-2*180;return t.latitude=180/Math.PI*(2*Math.atan(Math.exp(o*Math.PI/180))-Math.PI/2),{longitude:Number.parseFloat(t.longitude.toFixed(8)),latitude:Number.parseFloat(t.latitude.toFixed(8))}}const i={longitude:Math.abs(e.longitude),latitude:Math.abs(e.latitude)};let s=[];for(let o=0;o<bt.length;o++)if(i.latitude>=bt[o]){s=Yn[o];break}return t=this.convertor(e,s),{longitude:Number.parseFloat(t.longitude.toFixed(8)),latitude:Number.parseFloat(t.latitude.toFixed(8))}}convertLL2MC(e){if(!e)return{longitude:0,latitude:0};if(e.longitude>180||e.longitude<-180||e.latitude>90||e.latitude<-90)return e;if(this.isWgs84){const o={longitude:0,latitude:0},n=6378137;o.longitude=e.longitude*Math.PI/180*n;const l=e.latitude*Math.PI/180;return o.latitude=n/2*Math.log((1+Math.sin(l))/(1-Math.sin(l))),{longitude:parseFloat(o.longitude.toFixed(2)),latitude:parseFloat(o.latitude.toFixed(2))}}e.longitude=this.getLoop(e.longitude,-180,180),e.latitude=this.getRange(e.latitude,-74,74);const t={longitude:e.longitude,latitude:e.latitude};let i=[];for(let o=0;o<Ue.length;o++)if(t.latitude>=Ue[o]){i=xt[o];break}if(!i.length){for(let o=0;o<Ue.length;o++)if(t.latitude<=-Ue[o]){i=xt[o];break}}const s=this.convertor(e,i);return{longitude:parseFloat(s.longitude.toFixed(2)),latitude:parseFloat(s.latitude.toFixed(2))}}convertor(e,t){if(!e||!t)return{longitude:0,latitude:0};let i=t[0]+t[1]*Math.abs(e.longitude);const s=Math.abs(e.latitude)/t[9];let o=t[2]+t[3]*s+t[4]*s*s+t[5]*s*s*s+t[6]*s*s*s*s+t[7]*s*s*s*s*s+t[8]*s*s*s*s*s*s;return i*=e.longitude<0?-1:1,o*=e.latitude<0?-1:1,{longitude:i,latitude:o}}getDistance(e,t,i,s){return jn*Math.acos(Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos(t-e))}toRadians(e){return Math.PI*e/180}toDegrees(e){return 180*e/Math.PI}getRange(e,t,i){return t!=null&&(e=Math.max(e,t)),i!=null&&(e=Math.min(e,i)),e}getLoop(e,t,i){for(;e>i;)e-=i-t;for(;e<t;)e+=i-t;return e}lngLatToMercator(e){return this.convertLL2MC(e)}lngLatToPoint(e){const t=this.convertLL2MC(e);return{x:t.longitude,y:t.latitude}}mercatorToLngLat(e){return this.convertMC2LL(e)}pointToLngLat(e){const t={longitude:e.x,latitude:e.y};return this.convertMC2LL(t)}pointToPixel(e,t,i,s){if(!e)return{x:0,y:0};e=this.lngLatToMercator(e);const o=this.getZoomUnits(t),n=Math.round((e.longitude-i.longitude)/o+s.width/2),l=Math.round((i.latitude-e.latitude)/o+s.height/2);return{x:n,y:l}}pixelToPoint(e,t,i,s){if(!e)return{longitude:0,latitude:0};const o=this.getZoomUnits(t),n=i.longitude+o*(e.x-s.width/2),l=i.latitude-o*(e.y-s.height/2),d={longitude:n,latitude:l};return this.mercatorToLngLat(d)}getZoomUnits(e){return Math.pow(2,18-e)}}const Pt=window.Cesium.Cartesian2,qn=window.Cesium.Cartographic,Mt=window.Cesium.Rectangle,Qe=window.Cesium.defined,Jn=window.Cesium.WebMercatorTilingScheme;class Xn extends Jn{constructor(e){super(e);const t=new Zn;this._projection.project=i=>{const s=Vt(G(i.longitude),G(i.latitude)),o=Xs(s[0],s[1]),n=[];n[0]=Math.min(o[0],180),n[0]=Math.max(n[0],-180),n[1]=Math.min(o[1],74.000022),n[1]=Math.max(n[1],-71.988531);const l=t.lngLatToPoint({longitude:n[0],latitude:n[1]});return new Pt(l.x,l.y)},this._projection.unproject=i=>{const s=t.mercatorToLngLat({longitude:i.x,latitude:i.y});let o=Js(s.longitude,s.latitude);return o=Nt(o[0],o[1]),new qn(Pe(o[0]),Pe(o[1]))},this.resolutions=(e==null?void 0:e.resolutions)||[]}tileXYToNativeRectangle(e,t,i,s){const o=this.resolutions[i],n=e*o,l=(e+1)*o,d=((t=-t)+1)*o,c=t*o;return Qe(s)?(s.west=n,s.south=c,s.east=l,s.north=d,s):new Mt(n,c,l,d)}positionToTileXY(e,t,i){const s=this._rectangle;if(!Mt.contains(s,e))return;const n=this._projection.project(e);if(!Qe(n))return;const l=this.resolutions[t],d=Math.floor(n.x/l),c=-Math.floor(n.y/l);return Qe(i)?(i.x=d,i.y=c,i):new Pt(d,c)}}const Fe=window.Cesium.Cartesian2,Kn=window.Cesium.WebMercatorTilingScheme,ve=window.Cesium.DeveloperError,Qn=window.Cesium.ImageryProvider,ea="https://shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46",ta="https://its.map.baidu.com:8002/traffic/TrafficTileService?time={time}&label={labelStyle}&v=016&level={z}&x={x}&y={y}&scaler=2";class ia{constructor(e){r(this,"_url");r(this,"_labelStyle");r(this,"_tileWidth");r(this,"_tileHeight");r(this,"_maximumLevel");r(this,"_crs");r(this,"_tilingScheme");r(this,"_rectangle");r(this,"_credit");r(this,"_token");r(this,"_style");r(this,"_scaler");if(this._scaler=e.scaler??1,this._url=this.getUrl(e.style),this._labelStyle=e.labelStyle||"web2D",this._tileWidth=256,this._tileHeight=256,this._maximumLevel=18,this._crs=e.crs||"BD09",e.crs==="WGS84"){const t=[];for(let i=0;i<19;i++)t[i]=256*Math.pow(2,18-i);this._tilingScheme=new Xn({resolutions:t,rectangleSouthwestInMeters:new Fe(-2003772637e-2,-1247410417e-2),rectangleNortheastInMeters:new Fe(2003772637e-2,1247410417e-2)})}else this._tilingScheme=new Kn({rectangleSouthwestInMeters:new Fe(-33554054,-33746824),rectangleNortheastInMeters:new Fe(33554054,33746824)});this._rectangle=this._tilingScheme.rectangle,this._token=void 0,this._style=e.style||"normal"}get url(){return this._url}get token(){return this._token}get tileWidth(){if(!this.ready)throw new ve("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}get tileHeight(){if(!this.ready)throw new ve("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}get maximumLevel(){if(!this.ready)throw new ve("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}get minimumLevel(){if(!this.ready)throw new ve("minimumLevel must not be called before the imagery provider is ready.");return 0}get tilingScheme(){if(!this.ready)throw new ve("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}get rectangle(){if(!this.ready)throw new ve("rectangle must not be called before the imagery provider is ready.");return this._rectangle}get ready(){return!!this._url}get credit(){return this._credit}get hasAlphaChannel(){return!0}getUrl(e){return e==="img"?ea:e==="vec"?`https://online{s}.map.bdimg.com/onlinelabel/?qt=tile&x={x}&y={y}&z={z}&styles=pl&scaler=${this._scaler}&p=1`:e==="traffic"?ta:"https://api{s}.map.bdimg.com/customimage/tile?&x={x}&y={y}&z={z}&scale=1&customid="+this._style}requestImage(e,t,i){if(!this.ready)throw new ve("requestImage must not be called before the imagery provider is ready.");const s=this._tilingScheme.getNumberOfXTilesAtLevel(i),o=this._tilingScheme.getNumberOfYTilesAtLevel(i);let n=this._url.replace("{z}",i+"").replace("{s}",String(1)).replace("{style}",this._style).replace("{labelStyle}",this._labelStyle).replace("{time}",String(new Date().getTime()));return this._crs==="WGS84"?n=n.replace("{x}",String(e)).replace("{y}",String(-t)):n=n.replace("{x}",String(e-s/2)).replace("{y}",String(o/2-t-1)),Qn.loadImage(this,n)}}const sa=window.Cesium.UrlTemplateImageryProvider,Tt={img:"https://p{s}.map.gtimg.com/sateTiles/{z}/{sx}/{sy}/{x}_{reverseY}.jpg?version=400",elec:"https://rt{s}.map.gtimg.com/tile?z={z}&x={x}&y={reverseY}&styleid={style}&scene=0&version=347"};class oa extends sa{constructor(e){const t=e.url||[e.protocol||"",Tt[e.style]||Tt.elec].join("");e.url=t.replace("{style}",e.style||1),e.subdomains=e.subdomains||["1","2","3"],e.style==="img"&&(e.customTags={sx:(i,s,o,n)=>s>>4,sy:(i,s,o,n)=>(1<<n)-o>>4}),super(e)}}const Oe=window.Cesium;class na{constructor(e){r(this,"options");r(this,"scales84");r(this,"scalesweb");r(this,"delegate");this.options=Object.assign({},{minimumLevel:0,maximumLevel:18,epsgcode:3857,token:""},e),this.scales84=[338032714321e-20,676065428641e-20,1352130857282e-20,2704261714564e-20,5408523429128e-20,10817046858257e-20,21634093716514e-20,43268187433028e-20,86536374866056e-20,173072749732112e-20,346145499464224e-20,692290998928448e-20,13845819978568952e-21,27691639957137904e-21,5538327991427581e-20,.00011076655982855162,.00022153311965710323,.00044306623931420646,.0008861324786284129,.0017722649572568258,.0035445299145136517,.007089059829027303],this.scalesweb=[16901635716e-19,338032714321e-20,676065428641e-20,1352130857282e-20,2704261714564e-20,5408523429128e-20,10817046858257e-20,21634093716514e-20,43268187433028e-20,86536374866056e-20,173072749732112e-20,346145499464224e-20,692290998928448e-20,13845819978568952e-21,27691639957137904e-21,5538327991427581e-20,.00011076655982855162,.00022153311965710323,.00044306623931420646,.0008861324786284129,.0017722649572568258,.0035445299145136517,.007089059829027303],this.delegate=this.createSuperMapLayer(this.options)}createSuperMapLayer(e){const t=Oe.Rectangle.fromDegrees(-180,-90,180,90),i=e.epsgcode;let s,o=0,n=22,l=0,d=0;i===4326&&(s=new Oe.GeographicTilingScheme({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1}),l=-180,d=90,e.minimumLevel!==void 0?o=e.minimumLevel:o=0,e.maximumLevel!==void 0?n=e.maximumLevel:n=22),i===3857&&(s=new Oe.WebMercatorTilingScheme,l=-2003750834e-2,d=2003750834e-2,e.minimumLevel!==void 0?(console.log("not undefined"),o=e.minimumLevel):o=0,e.maximumLevel!==void 0?n=e.maximumLevel:n=22);const c=`{"x":${l},"y":${d}}`,h=`${this.options.url}/tileImage.png?transparent=true&cacheEnabled=true&width=256&height=256&x={x}&y={y}&scale={scale}&redirect=false&overlapDisplayed=false&origin={origin}`;return new Oe.UrlTemplateImageryProvider({url:h,rectangle:t,minimumLevel:o||0,maximumLevel:n||22,tilingScheme:s,customTags:{scale:(v,_,f,u)=>{if(i===4326)return this.scales84[u];if(i===3857)return this.scalesweb[u]},origin:()=>c}})}}const aa={BaiduImageryProvider:ia,AmapImageryProvider:Ot,TencentImageryProvider:oa,SuperMapImagryProvider:na},ra={class:"map-prompt"},la={class:"prompt-content-container"},ca={class:"prompt-content",id:"prompt-content-17289623705283219"},ha={class:"html-box"},da={class:"html-body"},ua=Q({__name:"LabelOverlay",props:{title:{default:""}},setup(a){return(e,t)=>(F(),B("div",ra,[g("div",la,[g("div",ca,[g("div",ha,[t[0]||(t[0]=g("div",{class:"html-line"},[g("span"),g("p")],-1)),g("div",da,[g("label",null,J(e.title),1)])])])])]))}}),ma=ie(ua,[["__scopeId","data-v-20f73a84"]]),et=window.Cesium;class pa{constructor(e,t,i=!1){r(this,"viewer");r(this,"point");r(this,"position");r(this,"delegate");r(this,"_content");r(this,"_clampToGround",!1);r(this,"_title","");r(this,"_renderRemoveCallback");r(this,"type","html-overlay");this.point=e,this.position=et.Cartesian3.fromDegrees(e.longitude,e.latitude,e.height),this._clampToGround=i,this._title=t,this.delegate=It("div",this.type);const s={title:this._title},o=di(ma,s);this._content=o}addToViewer(e){this.viewer=e;const t=this._content,i=e.container;if(t&&typeof t=="string")this.delegate.innerHTML=t;else if(t&&t instanceof Element){for(;this.delegate.hasChildNodes();)this.delegate.removeChild(this.delegate.firstChild);this.delegate.appendChild(t)}else ui(t)&&mi(t,this.delegate);const s=e.scene;this._renderRemoveCallback=this.viewer.scene.postRender.addEventListener(()=>{if(this.position){const o=this.position;if(this._clampToGround){const l=zt(this.point);this.point.height=e.scene.sampleHeight(l),this.position=et.Cartesian3.fromDegrees(this.point.longitude,this.point.latitude,this.point.height)}const n=et.SceneTransforms.worldToWindowCoordinates(s,o);this.updatePosition(n)}},this),i.appendChild(this.delegate)}updatePosition(e){if(!e)return;const{x:t,y:i}=e,s="scale3d(1,1,1)",o=34,n=50,l=42,d=45,c=n+12-59.4,h=`${Math.round(t)-c-o/2}`,C=`${Math.round(i)-l-59.4*Math.cos(d)}`,v=`translate3d(${h}px,${C}px, 0)`;this.delegate.style.left="0px",this.delegate.style.top="0px",this.delegate.style.position="absolute",this.delegate.style.transform=`${v} ${s}`}remove(){this.viewer&&(this.viewer.container.removeChild(this.delegate),this._renderRemoveCallback&&this.viewer.scene.postRender.removeEventListener(this._renderRemoveCallback))}}const ga={HtmlOverlay:pa},fa=new URL(""+new URL("../img/world_b.CKToTiVD.jpg",import.meta.url).href,import.meta.url).href,wa=new URL(""+new URL("../img/world_img.BGGjUUzF.jpg",import.meta.url).href,import.meta.url).href,va=new URL(""+new URL("../img/backGroundImg.CHcdoOpt.jpg",import.meta.url).href,import.meta.url).href,Wt={positiveX:new URL(""+new URL("../img/Right.DvICu_nL.jpg",import.meta.url).href,import.meta.url).href,negativeX:new URL(""+new URL("../img/Left.Beb91ZrI.jpg",import.meta.url).href,import.meta.url).href,positiveY:new URL(""+new URL("../img/Front.CNsTSgXm.jpg",import.meta.url).href,import.meta.url).href,negativeY:new URL(""+new URL("../img/Back.Cc3mBCf3.jpg",import.meta.url).href,import.meta.url).href,positiveZ:new URL(""+new URL("../img/Up.Bw1YxhIs.jpg",import.meta.url).href,import.meta.url).href,negativeZ:new URL(""+new URL("../img/Down.BvGcIg6o.jpg",import.meta.url).href,import.meta.url).href},$t={positiveX:new URL(""+new URL("../img/Right.DdlANBEa.jpg",import.meta.url).href,import.meta.url).href,negativeX:new URL(""+new URL("../img/Left.B8rfaA0r.jpg",import.meta.url).href,import.meta.url).href,positiveY:new URL(""+new URL("../img/Front.DPEAmiXi.jpg",import.meta.url).href,import.meta.url).href,negativeY:new URL(""+new URL("../img/Back.DJrVM9dN.jpg",import.meta.url).href,import.meta.url).href,positiveZ:new URL(""+new URL("../img/Up.CMCoYR6m.jpg",import.meta.url).href,import.meta.url).href,negativeZ:new URL(""+new URL("../img/Down.lnNfcNjB.jpg",import.meta.url).href,import.meta.url).href},Gt={positiveX:new URL(""+new URL("../img/Right.D5T4YmHC.png",import.meta.url).href,import.meta.url).href,negativeX:new URL(""+new URL("../img/Left.CvRmAvgL.png",import.meta.url).href,import.meta.url).href,positiveY:new URL(""+new URL("../img/Front.2o9Lxxyg.png",import.meta.url).href,import.meta.url).href,negativeY:new URL(""+new URL("../img/Back.C49sX_sW.png",import.meta.url).href,import.meta.url).href,positiveZ:new URL(""+new URL("../img/Up.B-I1Cg_a.png",import.meta.url).href,import.meta.url).href,negativeZ:new URL(""+new URL("../img/Down.CRKe6wcu.png",import.meta.url).href,import.meta.url).href},jt={positiveX:new URL(""+new URL("../img/Right.DfXBh-Je.jpg",import.meta.url).href,import.meta.url).href,negativeX:new URL(""+new URL("../img/Left.DAu_0SLw.jpg",import.meta.url).href,import.meta.url).href,positiveY:new URL(""+new URL("../img/Front.Cu5ZW8wg.jpg",import.meta.url).href,import.meta.url).href,negativeY:new URL(""+new URL("../img/Back.DzIrvXSv.jpg",import.meta.url).href,import.meta.url).href,positiveZ:new URL(""+new URL("../img/Up.CPesry4o.jpg",import.meta.url).href,import.meta.url).href,negativeZ:new URL(""+new URL("../img/Down.BHPfJ1nb.jpg",import.meta.url).href,import.meta.url).href},Ca={GroundSkyBoxSun:$t,GroundSkyBoxSunsetGlow:Gt,GroundSkyBoxNight:jt,GroundSkyBoxBlueSky:Wt},_a={buildingMaterial003:new URL("@/map/resource/images/material/building-003.jpg",import.meta.url).href,ground:new URL(""+new URL("../img/ground.DLYFNGkx.jpg",import.meta.url).href,import.meta.url).href,excavate:new URL(""+new URL("../img/excavationregion_side.CX9OodjT.jpg",import.meta.url).href,import.meta.url).href,buildingMaterialPath:new URL("@/map/resource/images/material/building/",import.meta.url).href},ya={BaseMapWorld_Blue:fa,BaseMapWorld_Image:wa,SceneBackGroundImg:va,SkyBoxResource:Ca,MaterialResource:_a,GroundSkyBoxBlueSky:Wt,GroundSkyBoxSun:$t,GroundSkyBoxSunsetGlow:Gt,GroundSkyBoxNight:jt},Sa={HZ_BAIMO_WITH_HEIGHT:2767744,WZ_3DTILES:1633341},ba={accessToken:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmZTA1MDQ2NC0wZmYwLTRhZWMtYWY4OC1jY2JkMDU1NjVmOGMiLCJpZCI6NDM0MzQsImlhdCI6MTY0OTkzNjc0Mn0.nafX1X_3586auU738TC3DxvsiSvPxnQ3TmamqUkb8kw"},ot={dat:Ti,Lightning:Ji,Rain:Xi,Fog:ts,Snow:ss,SnowCover:os,Overlay:ga,ImageryLayers:aa,Widgets:fn,MapTools:kn,Analysis:zn,Effect:Gn,Components:bn,Resource:ya,useViewerHook:he,CesiumIonAssetConf:Sa,CesiumAccessTokenConf:ba};for(const[a,e]of Object.entries(ot))Reflect.defineProperty(window,a,{value:e});const ye=pi(zi);Ni(ye);for(const[a,e]of Object.entries(Mi))ye.component(a,e);for(const[a,e]of Object.entries(ot.Widgets))ye.component(a,e);for(const[a,e]of Object.entries(ot.Components))ye.component(a,e);ye.component("IconSvg",Zi);ye.use(oi,{locale:ni});ye.use(Bi).mount("#app");export{ie as _};
