import{p as Rl}from"./point-in-polygon-hao.CVtqB2KT.js";import{s as Al}from"./sweepline-intersections.D78iGcFZ.js";import{g as io}from"./geojson-equality-ts.385IDfwq.js";import{e as Tn}from"./fast-deep-equal.BZWWD7KU.js";import{g as Dl}from"./d3-geo.B8ycIn1u.js";import"./d3-array.0UpHvbR7.js";import{c as Fl}from"./concaveman.D4rCrqp7.js";import{s as Bl}from"./skmeans.Df_G8q9F.js";import{m as ql}from"./topojson-client.C_Q_XF1Z.js";import{t as Yl}from"./topojson-server.BJ5ICLc2.js";import{i as yt}from"./polygon-clipping.C7RG_Bzj.js";import{i as Xl,a as Gl}from"./marchingsquares.DR8wX6S2.js";import{v as zl}from"./d3-voronoi.DD4zjRyK.js";var Ul=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function so(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function Xd(i){if(i.__esModule)return i;var n=i.default;if(typeof n=="function"){var t=function a(){return this instanceof a?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(a){var u=Object.getOwnPropertyDescriptor(i,a);Object.defineProperty(t,a,u.get?u:{enumerable:!0,get:function(){return i[a]}})}),t}var Ae=63710088e-1,Or={centimeters:Ae*100,centimetres:Ae*100,degrees:360/(2*Math.PI),feet:Ae*3.28084,inches:Ae*39.37,kilometers:Ae/1e3,kilometres:Ae/1e3,meters:Ae,metres:Ae,miles:Ae/1609.344,millimeters:Ae*1e3,millimetres:Ae*1e3,nauticalmiles:Ae/1852,radians:1,yards:Ae*1.0936},Lr={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Oe(i,n,t={}){const a={type:"Feature"};return(t.id===0||t.id)&&(a.id=t.id),t.bbox&&(a.bbox=t.bbox),a.properties=n||{},a.geometry=i,a}function ao(i,n,t={}){switch(i){case"Point":return re(n).geometry;case"LineString":return he(n).geometry;case"Polygon":return j(n).geometry;case"MultiPoint":return jn(n).geometry;case"MultiLineString":return St(n).geometry;case"MultiPolygon":return Ze(n).geometry;default:throw new Error(i+" is invalid")}}function re(i,n,t={}){if(!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!De(i[0])||!De(i[1]))throw new Error("coordinates must contain numbers");return Oe({type:"Point",coordinates:i},n,t)}function oo(i,n,t={}){return G(i.map(a=>re(a,n)),t)}function j(i,n,t={}){for(const u of i){if(u.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(u[u.length-1].length!==u[0].length)throw new Error("First and last Position are not equivalent.");for(let h=0;h<u[u.length-1].length;h++)if(u[u.length-1][h]!==u[0][h])throw new Error("First and last Position are not equivalent.")}return Oe({type:"Polygon",coordinates:i},n,t)}function uo(i,n,t={}){return G(i.map(a=>j(a,n)),t)}function he(i,n,t={}){if(i.length<2)throw new Error("coordinates must be an array of two or more positions");return Oe({type:"LineString",coordinates:i},n,t)}function lo(i,n,t={}){return G(i.map(a=>he(a,n)),t)}function G(i,n={}){const t={type:"FeatureCollection"};return n.id&&(t.id=n.id),n.bbox&&(t.bbox=n.bbox),t.features=i,t}function St(i,n,t={}){return Oe({type:"MultiLineString",coordinates:i},n,t)}function jn(i,n,t={}){return Oe({type:"MultiPoint",coordinates:i},n,t)}function Ze(i,n,t={}){return Oe({type:"MultiPolygon",coordinates:i},n,t)}function Bi(i,n,t={}){return Oe({type:"GeometryCollection",geometries:i},n,t)}function ho(i,n=0){if(n&&!(n>=0))throw new Error("precision must be a positive number");const t=Math.pow(10,n||0);return Math.round(i*t)/t}function er(i,n="kilometers"){const t=Or[n];if(!t)throw new Error(n+" units is invalid");return i*t}function vn(i,n="kilometers"){const t=Or[n];if(!t)throw new Error(n+" units is invalid");return i/t}function Rr(i,n){return Yt(vn(i,n))}function gn(i){let n=i%360;return n<0&&(n+=360),n}function co(i){return i=i%360,i>0?i>180?i-360:i:i<-180?i+360:i}function Yt(i){return i%(2*Math.PI)*180/Math.PI}function Te(i){return i%360*Math.PI/180}function Xt(i,n="kilometers",t="kilometers"){if(!(i>=0))throw new Error("length must be a positive number");return er(vn(i,n),t)}function qi(i,n="meters",t="kilometers"){if(!(i>=0))throw new Error("area must be a positive number");const a=Lr[n];if(!a)throw new Error("invalid original units");const u=Lr[t];if(!u)throw new Error("invalid final units");return i/a*u}function De(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function de(i){return i!==null&&typeof i=="object"&&!Array.isArray(i)}function Sr(i){if(!i)throw new Error("bbox is required");if(!Array.isArray(i))throw new Error("bbox must be an Array");if(i.length!==4&&i.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");i.forEach(n=>{if(!De(n))throw new Error("bbox must only contain numbers")})}function fo(i){if(!i)throw new Error("id is required");if(["string","number"].indexOf(typeof i)===-1)throw new Error("id must be a number or a string")}const Vl=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:Lr,azimuthToBearing:co,bearingToAzimuth:gn,convertArea:qi,convertLength:Xt,degreesToRadians:Te,earthRadius:Ae,factors:Or,feature:Oe,featureCollection:G,geometry:ao,geometryCollection:Bi,isNumber:De,isObject:de,lengthToDegrees:Rr,lengthToRadians:vn,lineString:he,lineStrings:lo,multiLineString:St,multiPoint:jn,multiPolygon:Ze,point:re,points:oo,polygon:j,polygons:uo,radiansToDegrees:Yt,radiansToLength:er,round:ho,validateBBox:Sr,validateId:fo},Symbol.toStringTag,{value:"Module"}));function ye(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function J(i){if(Array.isArray(i))return i;if(i.type==="Feature"){if(i.geometry!==null)return i.geometry.coordinates}else if(i.coordinates)return i.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Yi(i){if(i.length>1&&De(i[0])&&De(i[1]))return!0;if(Array.isArray(i[0])&&i[0].length)return Yi(i[0]);throw new Error("coordinates must only contain numbers")}function go(i,n,t){if(!n||!t)throw new Error("type and name required");if(!i||i.type!==n)throw new Error("Invalid input to "+t+": must be a "+n+", given "+i.type)}function zn(i,n,t){if(!i)throw new Error("No feature passed");if(!t)throw new Error(".featureOf() requires a name");if(!i||i.type!=="Feature"||!i.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!i.geometry||i.geometry.type!==n)throw new Error("Invalid input to "+t+": must be a "+n+", given "+i.geometry.type)}function Mt(i,n,t){if(!i)throw new Error("No featureCollection passed");if(!t)throw new Error(".collectionOf() requires a name");if(!i||i.type!=="FeatureCollection")throw new Error("Invalid input to "+t+", FeatureCollection required");for(const a of i.features){if(!a||a.type!=="Feature"||!a.geometry)throw new Error("Invalid input to "+t+", Feature with geometry required");if(!a.geometry||a.geometry.type!==n)throw new Error("Invalid input to "+t+": must be a "+n+", given "+a.geometry.type)}}function ke(i){return i.type==="Feature"?i.geometry:i}function We(i,n){return i.type==="FeatureCollection"?"FeatureCollection":i.type==="GeometryCollection"?"GeometryCollection":i.type==="Feature"&&i.geometry!==null?i.geometry.type:i.type}const $l=Object.freeze(Object.defineProperty({__proto__:null,collectionOf:Mt,containsNumber:Yi,featureOf:zn,geojsonType:go,getCoord:ye,getCoords:J,getGeom:ke,getType:We},Symbol.toStringTag,{value:"Module"}));function kt(i,n,t={}){if(t.final===!0)return Hl(i,n);const a=ye(i),u=ye(n),h=Te(a[0]),c=Te(u[0]),g=Te(a[1]),d=Te(u[1]),m=Math.sin(c-h)*Math.cos(d),p=Math.cos(g)*Math.sin(d)-Math.sin(g)*Math.cos(d)*Math.cos(c-h);return Yt(Math.atan2(m,p))}function Hl(i,n){let t=kt(n,i);return t=(t+180)%360,t}function It(i,n,t,a={}){const u=ye(i),h=Te(u[0]),c=Te(u[1]),g=Te(t),d=vn(n,a.units),m=Math.asin(Math.sin(c)*Math.cos(d)+Math.cos(c)*Math.sin(d)*Math.cos(g)),p=h+Math.atan2(Math.sin(g)*Math.sin(d)*Math.cos(c),Math.cos(d)-Math.sin(c)*Math.sin(m)),x=Yt(p),I=Yt(m);return re([x,I],a.properties)}function me(i,n,t={}){var a=ye(i),u=ye(n),h=Te(u[1]-a[1]),c=Te(u[0]-a[0]),g=Te(a[1]),d=Te(u[1]),m=Math.pow(Math.sin(h/2),2)+Math.pow(Math.sin(c/2),2)*Math.cos(g)*Math.cos(d);return er(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),t.units)}function Zl(i,n,t={}){const u=ke(i).coordinates;let h=0;for(let c=0;c<u.length&&!(n>=h&&c===u.length-1);c++)if(h>=n){const g=n-h;if(g){const d=kt(u[c],u[c-1])-180;return It(u[c],g,d,t)}else return re(u[c])}else h+=me(u[c],u[c+1],t);return re(u[u.length-1])}function Gt(i,n,t={}){let a;return t.final?a=Ks(ye(n),ye(i)):a=Ks(ye(i),ye(n)),a>180?-(360-a):a}function Ks(i,n){const t=Te(i[1]),a=Te(n[1]);let u=Te(n[0]-i[0]);u>Math.PI&&(u-=2*Math.PI),u<-Math.PI&&(u+=2*Math.PI);const h=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(t/2+Math.PI/4)),c=Math.atan2(u,h);return(Yt(c)+360)%360}function Wl(i,n,t,a={}){if(!de(a))throw new Error("options is invalid");if(!i)throw new Error("startPoint is required");if(!n)throw new Error("midPoint is required");if(!t)throw new Error("endPoint is required");const u=i,h=n,c=t,g=gn(a.mercator!==!0?kt(u,h):Gt(u,h)),d=gn(a.mercator!==!0?kt(c,h):Gt(c,h)),m=Math.abs(g-d);return a.explementary===!0?360-m:m}function Me(i,n,t){if(i!==null)for(var a,u,h,c,g,d,m,p=0,x=0,I,w=i.type,k=w==="FeatureCollection",C=w==="Feature",D=k?i.features.length:1,R=0;R<D;R++){m=k?i.features[R].geometry:C?i.geometry:i,I=m?m.type==="GeometryCollection":!1,g=I?m.geometries.length:1;for(var P=0;P<g;P++){var S=0,A=0;if(c=I?m.geometries[P]:m,c!==null){d=c.coordinates;var O=c.type;switch(p=t&&(O==="Polygon"||O==="MultiPolygon")?1:0,O){case null:break;case"Point":if(n(d,x,R,S,A)===!1)return!1;x++,S++;break;case"LineString":case"MultiPoint":for(a=0;a<d.length;a++){if(n(d[a],x,R,S,A)===!1)return!1;x++,O==="MultiPoint"&&S++}O==="LineString"&&S++;break;case"Polygon":case"MultiLineString":for(a=0;a<d.length;a++){for(u=0;u<d[a].length-p;u++){if(n(d[a][u],x,R,S,A)===!1)return!1;x++}O==="MultiLineString"&&S++,O==="Polygon"&&A++}O==="Polygon"&&S++;break;case"MultiPolygon":for(a=0;a<d.length;a++){for(A=0,u=0;u<d[a].length;u++){for(h=0;h<d[a][u].length-p;h++){if(n(d[a][u][h],x,R,S,A)===!1)return!1;x++}A++}S++}break;case"GeometryCollection":for(a=0;a<c.geometries.length;a++)if(Me(c.geometries[a],n,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Xi(i,n,t,a){var u=t;return Me(i,function(h,c,g,d,m){c===0&&t===void 0?u=h:u=n(u,h,c,g,d,m)},a),u}function Gi(i,n){var t;switch(i.type){case"FeatureCollection":for(t=0;t<i.features.length&&n(i.features[t].properties,t)!==!1;t++);break;case"Feature":n(i.properties,0);break}}function vo(i,n,t){var a=t;return Gi(i,function(u,h){h===0&&t===void 0?a=u:a=n(a,u,h)}),a}function ce(i,n){if(i.type==="Feature")n(i,0);else if(i.type==="FeatureCollection")for(var t=0;t<i.features.length&&n(i.features[t],t)!==!1;t++);}function zi(i,n,t){var a=t;return ce(i,function(u,h){h===0&&t===void 0?a=u:a=n(a,u,h)}),a}function Un(i){var n=[];return Me(i,function(t){n.push(t)}),n}function Ge(i,n){var t,a,u,h,c,g,d,m,p,x,I=0,w=i.type==="FeatureCollection",k=i.type==="Feature",C=w?i.features.length:1;for(t=0;t<C;t++){for(g=w?i.features[t].geometry:k?i.geometry:i,m=w?i.features[t].properties:k?i.properties:{},p=w?i.features[t].bbox:k?i.bbox:void 0,x=w?i.features[t].id:k?i.id:void 0,d=g?g.type==="GeometryCollection":!1,c=d?g.geometries.length:1,u=0;u<c;u++){if(h=d?g.geometries[u]:g,h===null){if(n(null,I,m,p,x)===!1)return!1;continue}switch(h.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(n(h,I,m,p,x)===!1)return!1;break}case"GeometryCollection":{for(a=0;a<h.geometries.length;a++)if(n(h.geometries[a],I,m,p,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}I++}}function Ui(i,n,t){var a=t;return Ge(i,function(u,h,c,g,d){h===0&&t===void 0?a=u:a=n(a,u,h,c,g,d)}),a}function Ye(i,n){Ge(i,function(t,a,u,h,c){var g=t===null?null:t.type;switch(g){case null:case"Point":case"LineString":case"Polygon":return n(Oe(t,u,{bbox:h,id:c}),a,0)===!1?!1:void 0}var d;switch(g){case"MultiPoint":d="Point";break;case"MultiLineString":d="LineString";break;case"MultiPolygon":d="Polygon";break}for(var m=0;m<t.coordinates.length;m++){var p=t.coordinates[m],x={type:d,coordinates:p};if(n(Oe(x,u),a,m)===!1)return!1}})}function mo(i,n,t){var a=t;return Ye(i,function(u,h,c){h===0&&c===0&&t===void 0?a=u:a=n(a,u,h,c)}),a}function wt(i,n){Ye(i,function(t,a,u){var h=0;if(t.geometry){var c=t.geometry.type;if(!(c==="Point"||c==="MultiPoint")){var g,d=0,m=0,p=0;if(Me(t,function(x,I,w,k,C){if(g===void 0||a>d||k>m||C>p){g=x,d=a,m=k,p=C,h=0;return}var D=he([g,x],t.properties);if(n(D,a,u,C,h)===!1)return!1;h++,g=x})===!1)return!1}}})}function Vi(i,n,t){var a=t,u=!1;return wt(i,function(h,c,g,d,m){u===!1&&t===void 0?a=h:a=n(a,h,c,g,d,m),u=!0}),a}function $i(i,n){if(!i)throw new Error("geojson is required");Ye(i,function(t,a,u){if(t.geometry!==null){var h=t.geometry.type,c=t.geometry.coordinates;switch(h){case"LineString":if(n(t,a,u,0,0)===!1)return!1;break;case"Polygon":for(var g=0;g<c.length;g++)if(n(he(c[g],t.properties),a,u,g)===!1)return!1;break}}})}function Hi(i,n,t){var a=t;return $i(i,function(u,h,c,g){h===0&&t===void 0?a=u:a=n(a,u,h,c,g)}),a}function yo(i,n){if(n=n||{},!de(n))throw new Error("options is invalid");var t=n.featureIndex||0,a=n.multiFeatureIndex||0,u=n.geometryIndex||0,h=n.segmentIndex||0,c=n.properties,g;switch(i.type){case"FeatureCollection":t<0&&(t=i.features.length+t),c=c||i.features[t].properties,g=i.features[t].geometry;break;case"Feature":c=c||i.properties,g=i.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":g=i;break;default:throw new Error("geojson is invalid")}if(g===null)return null;var d=g.coordinates;switch(g.type){case"Point":case"MultiPoint":return null;case"LineString":return h<0&&(h=d.length+h-1),he([d[h],d[h+1]],c,n);case"Polygon":return u<0&&(u=d.length+u),h<0&&(h=d[u].length+h-1),he([d[u][h],d[u][h+1]],c,n);case"MultiLineString":return a<0&&(a=d.length+a),h<0&&(h=d[a].length+h-1),he([d[a][h],d[a][h+1]],c,n);case"MultiPolygon":return a<0&&(a=d.length+a),u<0&&(u=d[a].length+u),h<0&&(h=d[a][u].length-h-1),he([d[a][u][h],d[a][u][h+1]],c,n)}throw new Error("geojson is invalid")}function po(i,n){if(n=n||{},!de(n))throw new Error("options is invalid");var t=n.featureIndex||0,a=n.multiFeatureIndex||0,u=n.geometryIndex||0,h=n.coordIndex||0,c=n.properties,g;switch(i.type){case"FeatureCollection":t<0&&(t=i.features.length+t),c=c||i.features[t].properties,g=i.features[t].geometry;break;case"Feature":c=c||i.properties,g=i.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":g=i;break;default:throw new Error("geojson is invalid")}if(g===null)return null;var d=g.coordinates;switch(g.type){case"Point":return re(d,c,n);case"MultiPoint":return a<0&&(a=d.length+a),re(d[a],c,n);case"LineString":return h<0&&(h=d.length+h),re(d[h],c,n);case"Polygon":return u<0&&(u=d.length+u),h<0&&(h=d[u].length+h),re(d[u][h],c,n);case"MultiLineString":return a<0&&(a=d.length+a),h<0&&(h=d[a].length+h),re(d[a][h],c,n);case"MultiPolygon":return a<0&&(a=d.length+a),u<0&&(u=d[a].length+u),h<0&&(h=d[a][u].length-h),re(d[a][u][h],c,n)}throw new Error("geojson is invalid")}const Jl=Object.freeze(Object.defineProperty({__proto__:null,coordAll:Un,coordEach:Me,coordReduce:Xi,featureEach:ce,featureReduce:zi,findPoint:po,findSegment:yo,flattenEach:Ye,flattenReduce:mo,geomEach:Ge,geomReduce:Ui,lineEach:$i,lineReduce:Hi,propEach:Gi,propReduce:vo,segmentEach:wt,segmentReduce:Vi},Symbol.toStringTag,{value:"Module"}));function tr(i){return Ui(i,(n,t)=>n+Kl(t),0)}function Kl(i){let n=0,t;switch(i.type){case"Polygon":return Qs(i.coordinates);case"MultiPolygon":for(t=0;t<i.coordinates.length;t++)n+=Qs(i.coordinates[t]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function Qs(i){let n=0;if(i&&i.length>0){n+=Math.abs(js(i[0]));for(let t=1;t<i.length;t++)n-=Math.abs(js(i[t]))}return n}var Ql=Ae*Ae/2,vi=Math.PI/180;function js(i){const n=i.length-1;if(n<=2)return 0;let t=0,a=0;for(;a<n;){const u=i[a],h=i[a+1===n?0:a+1],c=i[a+2>=n?(a+2)%n:a+2],g=u[0]*vi,d=h[1]*vi,m=c[0]*vi;t+=(m-g)*Math.sin(d),a++}return t*Ql}function _e(i,n={}){if(i.bbox!=null&&n.recompute!==!0)return i.bbox;const t=[1/0,1/0,-1/0,-1/0];return Me(i,a=>{t[0]>a[0]&&(t[0]=a[0]),t[1]>a[1]&&(t[1]=a[1]),t[2]<a[0]&&(t[2]=a[0]),t[3]<a[1]&&(t[3]=a[1])}),t}function jl(i,n,t){var a=i.length,u=hn(i[0],n),h=[],c,g,d;let m,p;for(t||(t=[]),c=1;c<a;c++){for(m=i[c-1],p=i[c],g=d=hn(p,n);;)if(u|g){if(u&g)break;u?(m=Si(m,p,u,n),u=hn(m,n)):(p=Si(m,p,g,n),g=hn(p,n))}else{h.push(m),g!==d?(h.push(p),c<a-1&&(t.push(h),h=[])):c===a-1&&h.push(p);break}u=d}return h.length&&t.push(h),t}function eh(i,n){var t,a,u,h,c,g,d;for(a=1;a<=8;a*=2){for(t=[],u=i[i.length-1],h=!(hn(u,n)&a),c=0;c<i.length;c++)g=i[c],d=!(hn(g,n)&a),d!==h&&t.push(Si(u,g,a,n)),d&&t.push(g),u=g,h=d;if(i=t,!i.length)break}return t}function Si(i,n,t,a){return t&8?[i[0]+(n[0]-i[0])*(a[3]-i[1])/(n[1]-i[1]),a[3]]:t&4?[i[0]+(n[0]-i[0])*(a[1]-i[1])/(n[1]-i[1]),a[1]]:t&2?[a[2],i[1]+(n[1]-i[1])*(a[2]-i[0])/(n[0]-i[0])]:t&1?[a[0],i[1]+(n[1]-i[1])*(a[0]-i[0])/(n[0]-i[0])]:null}function hn(i,n){var t=0;return i[0]<n[0]?t|=1:i[0]>n[2]&&(t|=2),i[1]<n[1]?t|=4:i[1]>n[3]&&(t|=8),t}function th(i,n){const t=ke(i),a=t.type,u=i.type==="Feature"?i.properties:{};let h=t.coordinates;switch(a){case"LineString":case"MultiLineString":{const c=[];return a==="LineString"&&(h=[h]),h.forEach(g=>{jl(g,n,c)}),c.length===1?he(c[0],u):St(c,u)}case"Polygon":return j(ea(h,n),u);case"MultiPolygon":return Ze(h.map(c=>ea(c,n)),u);default:throw new Error("geometry "+a+" not supported")}}function ea(i,n){const t=[];for(const a of i){const u=eh(a,n);u.length>0&&((u[0][0]!==u[u.length-1][0]||u[0][1]!==u[u.length-1][1])&&u.push(u[0]),u.length>=4&&t.push(u))}return t}function nr(i,n={}){const t=Number(i[0]),a=Number(i[1]),u=Number(i[2]),h=Number(i[3]);if(i.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const c=[t,a];return j([[c,[u,a],[u,h],[t,h],c]],n.properties,{bbox:i,id:n.id})}var nh=class{constructor(i){this.points=i.points||[],this.duration=i.duration||1e4,this.sharpness=i.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=i.stepLength||60,this.length=this.points.length,this.delay=0;for(let n=0;n<this.length;n++)this.points[n].z=this.points[n].z||0;for(let n=0;n<this.length-1;n++){const t=this.points[n],a=this.points[n+1];this.centers.push({x:(t.x+a.x)/2,y:(t.y+a.y)/2,z:(t.z+a.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(let n=0;n<this.centers.length-1;n++){const t=this.points[n+1].x-(this.centers[n].x+this.centers[n+1].x)/2,a=this.points[n+1].y-(this.centers[n].y+this.centers[n+1].y)/2,u=this.points[n+1].z-(this.centers[n].y+this.centers[n+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[n+1].x+this.sharpness*(this.centers[n].x+t),y:(1-this.sharpness)*this.points[n+1].y+this.sharpness*(this.centers[n].y+a),z:(1-this.sharpness)*this.points[n+1].z+this.sharpness*(this.centers[n].z+u)},{x:(1-this.sharpness)*this.points[n+1].x+this.sharpness*(this.centers[n+1].x+t),y:(1-this.sharpness)*this.points[n+1].y+this.sharpness*(this.centers[n+1].y+a),z:(1-this.sharpness)*this.points[n+1].z+this.sharpness*(this.centers[n+1].z+u)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}cacheSteps(i){const n=[];let t=this.pos(0);n.push(0);for(let a=0;a<this.duration;a+=10){const u=this.pos(a);Math.sqrt((u.x-t.x)*(u.x-t.x)+(u.y-t.y)*(u.y-t.y)+(u.z-t.z)*(u.z-t.z))>i&&(n.push(a),t=u)}return n}vector(i){const n=this.pos(i+10),t=this.pos(i-10);return{angle:180*Math.atan2(n.y-t.y,n.x-t.x)/3.14,speed:Math.sqrt((t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y)+(t.z-n.z)*(t.z-n.z))}}pos(i){let n=i-this.delay;n<0&&(n=0),n>this.duration&&(n=this.duration-1);const t=n/this.duration;if(t>=1)return this.points[this.length-1];const a=Math.floor((this.points.length-1)*t),u=(this.length-1)*t-a;return rh(u,this.points[a],this.controls[a][1],this.controls[a+1][0],this.points[a+1])}};function rh(i,n,t,a,u){const h=ih(i);return{x:u.x*h[0]+a.x*h[1]+t.x*h[2]+n.x*h[3],y:u.y*h[0]+a.y*h[1]+t.y*h[2]+n.y*h[3],z:u.z*h[0]+a.z*h[1]+t.z*h[2]+n.z*h[3]}}function ih(i){const n=i*i;return[n*i,3*n*(1-i),3*i*(1-i)*(1-i),(1-i)*(1-i)*(1-i)]}function sh(i,n={}){const t=n.resolution||1e4,a=n.sharpness||.85,u=[],h=ke(i).coordinates.map(m=>({x:m[0],y:m[1]})),c=new nh({duration:t,points:h,sharpness:a}),g=m=>{var p=c.pos(m);Math.floor(m/100)%2===0&&u.push([p.x,p.y])};for(var d=0;d<c.duration;d+=10)g(d);return g(c.duration),he(u,n.properties)}function br(i){const n=J(i);let t=0,a=1,u,h;for(;a<n.length;)u=h||n[0],h=n[a],t+=(h[0]-u[0])*(h[1]+u[1]),a++;return t>0}function ah(i){const n=ke(i).coordinates;if(n[0].length<=4)return!1;let t=!1;const a=n[0].length-1;for(let u=0;u<a;u++){const h=n[0][(u+2)%a][0]-n[0][(u+1)%a][0],c=n[0][(u+2)%a][1]-n[0][(u+1)%a][1],g=n[0][u][0]-n[0][(u+1)%a][0],d=n[0][u][1]-n[0][(u+1)%a][1],m=h*d-c*g;if(u===0)t=m>0;else if(t!==m>0)return!0}return!1}function ne(i,n,t={}){if(!i)throw new Error("point is required");if(!n)throw new Error("polygon is required");const a=ye(i),u=ke(n),h=u.type,c=n.bbox;let g=u.coordinates;if(c&&oh(a,c)===!1)return!1;h==="Polygon"&&(g=[g]);let d=!1;for(var m=0;m<g.length;++m){const p=Rl(a,g[m]);if(p===0)return!t.ignoreBoundary;p&&(d=!0)}return d}function oh(i,n){return n[0]<=i[0]&&n[1]<=i[1]&&n[2]>=i[0]&&n[3]>=i[1]}function se(i,n,t={}){const a=ye(i),u=J(n);for(let h=0;h<u.length-1;h++){let c=!1;if(t.ignoreEndVertices&&(h===0&&(c="start"),h===u.length-2&&(c="end"),h===0&&h+1===u.length-1&&(c="both")),uh(u[h],u[h+1],a,c,typeof t.epsilon>"u"?null:t.epsilon))return!0}return!1}function uh(i,n,t,a,u){const h=t[0],c=t[1],g=i[0],d=i[1],m=n[0],p=n[1],x=t[0]-g,I=t[1]-d,w=m-g,k=p-d,C=x*k-I*w;if(u!==null){if(Math.abs(C)>u)return!1}else if(C!==0)return!1;if(a){if(a==="start")return Math.abs(w)>=Math.abs(k)?w>0?g<h&&h<=m:m<=h&&h<g:k>0?d<c&&c<=p:p<=c&&c<d;if(a==="end")return Math.abs(w)>=Math.abs(k)?w>0?g<=h&&h<m:m<h&&h<=g:k>0?d<=c&&c<p:p<c&&c<=d;if(a==="both")return Math.abs(w)>=Math.abs(k)?w>0?g<h&&h<m:m<h&&h<g:k>0?d<c&&c<p:p<c&&c<d}else return Math.abs(w)>=Math.abs(k)?w>0?g<=h&&h<=m:m<=h&&h<=g:k>0?d<=c&&c<=p:p<=c&&c<=d;return!1}function lh(i,n){const t=ke(i),a=ke(n),u=t.type,h=a.type,c=t.coordinates,g=a.coordinates;switch(u){case"Point":switch(h){case"Point":return Zi(c,g);default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiPoint":switch(h){case"Point":return ch(t,a);case"MultiPoint":return fh(t,a);default:throw new Error("feature2 "+h+" geometry not supported")}case"LineString":switch(h){case"Point":return se(a,t,{ignoreEndVertices:!0});case"LineString":return vh(t,a);case"MultiPoint":return gh(t,a);default:throw new Error("feature2 "+h+" geometry not supported")}case"Polygon":switch(h){case"Point":return ne(a,t,{ignoreBoundary:!0});case"LineString":return mh(t,a);case"Polygon":return _o(t,a);case"MultiPoint":return dh(t,a);default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiPolygon":switch(h){case"Polygon":return hh(t,a);default:throw new Error("feature2 "+h+" geometry not supported")}default:throw new Error("feature1 "+u+" geometry not supported")}}function hh(i,n){return i.coordinates.some(t=>_o({type:"Polygon",coordinates:t},n))}function ch(i,n){let t,a=!1;for(t=0;t<i.coordinates.length;t++)if(Zi(i.coordinates[t],n.coordinates)){a=!0;break}return a}function fh(i,n){for(const t of n.coordinates){let a=!1;for(const u of i.coordinates)if(Zi(t,u)){a=!0;break}if(!a)return!1}return!0}function gh(i,n){let t=!1;for(const a of n.coordinates)if(se(a,i,{ignoreEndVertices:!0})&&(t=!0),!se(a,i))return!1;return!!t}function dh(i,n){for(const t of n.coordinates)if(!ne(t,i,{ignoreBoundary:!0}))return!1;return!0}function vh(i,n){let t=!1;for(const a of n.coordinates)if(se({type:"Point",coordinates:a},i,{ignoreEndVertices:!0})&&(t=!0),!se({type:"Point",coordinates:a},i,{ignoreEndVertices:!1}))return!1;return t}function mh(i,n){let t=!1,a=0;const u=_e(i),h=_e(n);if(!xo(u,h))return!1;for(a;a<n.coordinates.length-1;a++){const c=yh(n.coordinates[a],n.coordinates[a+1]);if(ne({type:"Point",coordinates:c},i,{ignoreBoundary:!0})){t=!0;break}}return t}function _o(i,n){if(i.type==="Feature"&&i.geometry===null||n.type==="Feature"&&n.geometry===null)return!1;const t=_e(i),a=_e(n);if(!xo(t,a))return!1;const u=ke(n).coordinates;for(const h of u)for(const c of h)if(!ne(c,i))return!1;return!0}function xo(i,n){return!(i[0]>n[0]||i[2]<n[2]||i[1]>n[1]||i[3]<n[3])}function Zi(i,n){return i[0]===n[0]&&i[1]===n[1]}function yh(i,n){return[(i[0]+n[0])/2,(i[1]+n[1])/2]}var ph=Al;function ht(i,n,t={}){const{removeDuplicates:a=!0,ignoreSelfIntersections:u=!1}=t;let h=[];i.type==="FeatureCollection"?h=h.concat(i.features):i.type==="Feature"?h.push(i):(i.type==="LineString"||i.type==="Polygon"||i.type==="MultiLineString"||i.type==="MultiPolygon")&&h.push(Oe(i)),n.type==="FeatureCollection"?h=h.concat(n.features):n.type==="Feature"?h.push(n):(n.type==="LineString"||n.type==="Polygon"||n.type==="MultiLineString"||n.type==="MultiPolygon")&&h.push(Oe(n));const c=ph(G(h),u);let g=[];if(a){const d={};c.forEach(m=>{const p=m.join(",");d[p]||(d[p]=!0,g.push(m))})}else g=c;return G(g.map(d=>re(d)))}function Vn(i,n={}){const t=ke(i);switch(!n.properties&&i.type==="Feature"&&(n.properties=i.properties),t.type){case"Polygon":return _h(t,n);case"MultiPolygon":return xh(t,n);default:throw new Error("invalid poly")}}function _h(i,n={}){const a=ke(i).coordinates,u=n.properties?n.properties:i.type==="Feature"?i.properties:{};return Eo(a,u)}function xh(i,n={}){const a=ke(i).coordinates,u=n.properties?n.properties:i.type==="Feature"?i.properties:{},h=[];return a.forEach(c=>{h.push(Eo(c,u))}),G(h)}function Eo(i,n){return i.length>1?St(i,n):he(i[0],n)}function wo(i,n){var t=ke(i),a=ke(n),u=t.type,h=a.type;switch(u){case"MultiPoint":switch(h){case"LineString":return ta(t,a);case"Polygon":return ra(t,a);default:throw new Error("feature2 "+h+" geometry not supported")}case"LineString":switch(h){case"MultiPoint":return ta(a,t);case"LineString":return Eh(t,a);case"Polygon":return na(t,a);default:throw new Error("feature2 "+h+" geometry not supported")}case"Polygon":switch(h){case"MultiPoint":return ra(a,t);case"LineString":return na(a,t);default:throw new Error("feature2 "+h+" geometry not supported")}default:throw new Error("feature1 "+u+" geometry not supported")}}function ta(i,n){for(var t=!1,a=!1,u=i.coordinates.length,h=0;h<u&&!t&&!a;){for(var c=0;c<n.coordinates.length-1;c++){var g=!0;(c===0||c===n.coordinates.length-2)&&(g=!1),ko(n.coordinates[c],n.coordinates[c+1],i.coordinates[h],g)?t=!0:a=!0}h++}return t&&a}function Eh(i,n){var t=ht(i,n);if(t.features.length>0)for(var a=0;a<i.coordinates.length-1;a++)for(var u=0;u<n.coordinates.length-1;u++){var h=!0;if((u===0||u===n.coordinates.length-2)&&(h=!1),ko(i.coordinates[a],i.coordinates[a+1],n.coordinates[u],h))return!0}return!1}function na(i,n){const t=Vn(n);return ht(i,t).features.length>0}function ra(i,n){var t=!1,a=!1,u=i.coordinates.length;for(let h=0;h<u&&(!t||!a);h++)ne(re(i.coordinates[h]),n)?t=!0:a=!0;return a&&t}function ko(i,n,t,a){var u=t[0]-i[0],h=t[1]-i[1],c=n[0]-i[0],g=n[1]-i[1],d=u*g-h*c;return d!==0?!1:a?Math.abs(c)>=Math.abs(g)?c>0?i[0]<=t[0]&&t[0]<=n[0]:n[0]<=t[0]&&t[0]<=i[0]:g>0?i[1]<=t[1]&&t[1]<=n[1]:n[1]<=t[1]&&t[1]<=i[1]:Math.abs(c)>=Math.abs(g)?c>0?i[0]<t[0]&&t[0]<n[0]:n[0]<t[0]&&t[0]<i[0]:g>0?i[1]<t[1]&&t[1]<n[1]:n[1]<t[1]&&t[1]<i[1]}function Wi(i,n,t={}){var a;const u=(a=t.ignoreSelfIntersections)!=null?a:!1;let h=!0;return Ye(i,c=>{Ye(n,g=>{if(h===!1)return!1;h=wh(c.geometry,g.geometry,u)})}),h}function wh(i,n,t){switch(i.type){case"Point":switch(n.type){case"Point":return!Mh(i.coordinates,n.coordinates);case"LineString":return!ia(n,i);case"Polygon":return!ne(i,n)}break;case"LineString":switch(n.type){case"Point":return!ia(i,n);case"LineString":return!kh(i,n,t);case"Polygon":return!sa(n,i,t)}break;case"Polygon":switch(n.type){case"Point":return!ne(n,i);case"LineString":return!sa(i,n,t);case"Polygon":return!Ih(n,i,t)}}return!1}function ia(i,n){for(let t=0;t<i.coordinates.length-1;t++)if(Nh(i.coordinates[t],i.coordinates[t+1],n.coordinates))return!0;return!1}function kh(i,n,t){return ht(i,n,{ignoreSelfIntersections:t}).features.length>0}function sa(i,n,t){for(const u of n.coordinates)if(ne(u,i))return!0;return ht(n,Vn(i),{ignoreSelfIntersections:t}).features.length>0}function Ih(i,n,t){for(const u of i.coordinates[0])if(ne(u,n))return!0;for(const u of n.coordinates[0])if(ne(u,i))return!0;return ht(Vn(i),Vn(n),{ignoreSelfIntersections:t}).features.length>0}function Nh(i,n,t){const a=t[0]-i[0],u=t[1]-i[1],h=n[0]-i[0],c=n[1]-i[1];return a*c-u*h!==0?!1:Math.abs(h)>=Math.abs(c)?h>0?i[0]<=t[0]&&t[0]<=n[0]:n[0]<=t[0]&&t[0]<=i[0]:c>0?i[1]<=t[1]&&t[1]<=n[1]:n[1]<=t[1]&&t[1]<=i[1]}function Mh(i,n){return i[0]===n[0]&&i[1]===n[1]}function zt(i,n={}){var t=typeof n=="object"?n.mutate:n;if(!i)throw new Error("geojson is required");var a=We(i),u=[];switch(a){case"LineString":u=mi(i,a);break;case"MultiLineString":case"Polygon":J(i).forEach(function(c){u.push(mi(c,a))});break;case"MultiPolygon":J(i).forEach(function(c){var g=[];c.forEach(function(d){g.push(mi(d,a))}),u.push(g)});break;case"Point":return i;case"MultiPoint":var h={};J(i).forEach(function(c){var g=c.join("-");Object.prototype.hasOwnProperty.call(h,g)||(u.push(c),h[g]=!0)});break;default:throw new Error(a+" geometry not supported")}return i.coordinates?t===!0?(i.coordinates=u,i):{type:a,coordinates:u}:t===!0?(i.geometry.coordinates=u,i):Oe({type:a,coordinates:u},i.properties,{bbox:i.bbox,id:i.id})}function mi(i,n){var t=J(i);if(t.length===2&&!aa(t[0],t[1]))return t;var a=[],u=t.length-1,h=a.length;a.push(t[0]);for(var c=1;c<u;c++){var g=a[a.length-1];t[c][0]===g[0]&&t[c][1]===g[1]||(a.push(t[c]),h=a.length,h>2&&oa(a[h-3],a[h-1],a[h-2])&&a.splice(a.length-2,1))}if(a.push(t[t.length-1]),h=a.length,(n==="Polygon"||n==="MultiPolygon")&&aa(t[0],t[t.length-1])&&h<4)throw new Error("invalid polygon");return n==="LineString"&&h<3||oa(a[h-3],a[h-1],a[h-2])&&a.splice(a.length-2,1),a}function aa(i,n){return i[0]===n[0]&&i[1]===n[1]}function oa(i,n,t){var a=t[0],u=t[1],h=i[0],c=i[1],g=n[0],d=n[1],m=a-h,p=u-c,x=g-h,I=d-c,w=m*I-p*x;return w!==0?!1:Math.abs(x)>=Math.abs(I)?x>0?h<=a&&a<=g:g<=a&&a<=h:I>0?c<=u&&u<=d:d<=u&&u<=c}function Ph(i,n,t={}){let a=t.precision;if(a=a==null||isNaN(a)?6:a,typeof a!="number"||!(a>=0))throw new Error("precision must be a positive number");const u=ke(i).type,h=ke(n).type;return u!==h?!1:io(zt(i),zt(n),{precision:a})}function Io(i,n,t={}){var a;const u=(a=t.ignoreSelfIntersections)!=null?a:!1;let h=!1;return Ye(i,c=>{Ye(n,g=>{if(h===!0)return!0;h=!Wi(c.geometry,g.geometry,{ignoreSelfIntersections:u})})}),h}function Lh(i,n,t,a,u){No(i,n,t||0,a||i.length-1,u||Sh)}function No(i,n,t,a,u){for(;a>t;){if(a-t>600){var h=a-t+1,c=n-t+1,g=Math.log(h),d=.5*Math.exp(2*g/3),m=.5*Math.sqrt(g*d*(h-d)/h)*(c-h/2<0?-1:1),p=Math.max(t,Math.floor(n-c*d/h+m)),x=Math.min(a,Math.floor(n+(h-c)*d/h+m));No(i,n,p,x,u)}var I=i[n],w=t,k=a;for(Ln(i,t,n),u(i[a],I)>0&&Ln(i,t,a);w<k;){for(Ln(i,w,k),w++,k--;u(i[w],I)<0;)w++;for(;u(i[k],I)>0;)k--}u(i[t],I)===0?Ln(i,t,k):(k++,Ln(i,k,a)),k<=n&&(t=k+1),n<=k&&(a=k-1)}}function Ln(i,n,t){var a=i[n];i[n]=i[t],i[t]=a}function Sh(i,n){return i<n?-1:i>n?1:0}let mt=class{constructor(n=9){this._maxEntries=Math.max(4,n),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(n){let t=this.data;const a=[];if(!vr(n,t))return a;const u=this.toBBox,h=[];for(;t;){for(let c=0;c<t.children.length;c++){const g=t.children[c],d=t.leaf?u(g):g;vr(n,d)&&(t.leaf?a.push(g):pi(n,d)?this._all(g,a):h.push(g))}t=h.pop()}return a}collides(n){let t=this.data;if(!vr(n,t))return!1;const a=[];for(;t;){for(let u=0;u<t.children.length;u++){const h=t.children[u],c=t.leaf?this.toBBox(h):h;if(vr(n,c)){if(t.leaf||pi(n,c))return!0;a.push(h)}}t=a.pop()}return!1}load(n){if(!(n&&n.length))return this;if(n.length<this._minEntries){for(let a=0;a<n.length;a++)this.insert(n[a]);return this}let t=this._build(n.slice(),0,n.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const a=this.data;this.data=t,t=a}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(n){return n&&this._insert(n,this.data.height-1),this}clear(){return this.data=an([]),this}remove(n,t){if(!n)return this;let a=this.data;const u=this.toBBox(n),h=[],c=[];let g,d,m;for(;a||h.length;){if(a||(a=h.pop(),d=h[h.length-1],g=c.pop(),m=!0),a.leaf){const p=bh(n,a.children,t);if(p!==-1)return a.children.splice(p,1),h.push(a),this._condense(h),this}!m&&!a.leaf&&pi(a,u)?(h.push(a),c.push(g),g=0,d=a,a=a.children[0]):d?(g++,a=d.children[g],m=!1):a=null}return this}toBBox(n){return n}compareMinX(n,t){return n.minX-t.minX}compareMinY(n,t){return n.minY-t.minY}toJSON(){return this.data}fromJSON(n){return this.data=n,this}_all(n,t){const a=[];for(;n;)n.leaf?t.push(...n.children):a.push(...n.children),n=a.pop();return t}_build(n,t,a,u){const h=a-t+1;let c=this._maxEntries,g;if(h<=c)return g=an(n.slice(t,a+1)),tn(g,this.toBBox),g;u||(u=Math.ceil(Math.log(h)/Math.log(c)),c=Math.ceil(h/Math.pow(c,u-1))),g=an([]),g.leaf=!1,g.height=u;const d=Math.ceil(h/c),m=d*Math.ceil(Math.sqrt(c));ua(n,t,a,m,this.compareMinX);for(let p=t;p<=a;p+=m){const x=Math.min(p+m-1,a);ua(n,p,x,d,this.compareMinY);for(let I=p;I<=x;I+=d){const w=Math.min(I+d-1,x);g.children.push(this._build(n,I,w,u-1))}}return tn(g,this.toBBox),g}_chooseSubtree(n,t,a,u){for(;u.push(t),!(t.leaf||u.length-1===a);){let h=1/0,c=1/0,g;for(let d=0;d<t.children.length;d++){const m=t.children[d],p=yi(m),x=Oh(n,m)-p;x<c?(c=x,h=p<h?p:h,g=m):x===c&&p<h&&(h=p,g=m)}t=g||t.children[0]}return t}_insert(n,t,a){const u=a?n:this.toBBox(n),h=[],c=this._chooseSubtree(u,this.data,t,h);for(c.children.push(n),Rn(c,u);t>=0&&h[t].children.length>this._maxEntries;)this._split(h,t),t--;this._adjustParentBBoxes(u,h,t)}_split(n,t){const a=n[t],u=a.children.length,h=this._minEntries;this._chooseSplitAxis(a,h,u);const c=this._chooseSplitIndex(a,h,u),g=an(a.children.splice(c,a.children.length-c));g.height=a.height,g.leaf=a.leaf,tn(a,this.toBBox),tn(g,this.toBBox),t?n[t-1].children.push(g):this._splitRoot(a,g)}_splitRoot(n,t){this.data=an([n,t]),this.data.height=n.height+1,this.data.leaf=!1,tn(this.data,this.toBBox)}_chooseSplitIndex(n,t,a){let u,h=1/0,c=1/0;for(let g=t;g<=a-t;g++){const d=On(n,0,g,this.toBBox),m=On(n,g,a,this.toBBox),p=Rh(d,m),x=yi(d)+yi(m);p<h?(h=p,u=g,c=x<c?x:c):p===h&&x<c&&(c=x,u=g)}return u||a-t}_chooseSplitAxis(n,t,a){const u=n.leaf?this.compareMinX:Ch,h=n.leaf?this.compareMinY:Th,c=this._allDistMargin(n,t,a,u),g=this._allDistMargin(n,t,a,h);c<g&&n.children.sort(u)}_allDistMargin(n,t,a,u){n.children.sort(u);const h=this.toBBox,c=On(n,0,t,h),g=On(n,a-t,a,h);let d=dr(c)+dr(g);for(let m=t;m<a-t;m++){const p=n.children[m];Rn(c,n.leaf?h(p):p),d+=dr(c)}for(let m=a-t-1;m>=t;m--){const p=n.children[m];Rn(g,n.leaf?h(p):p),d+=dr(g)}return d}_adjustParentBBoxes(n,t,a){for(let u=a;u>=0;u--)Rn(t[u],n)}_condense(n){for(let t=n.length-1,a;t>=0;t--)n[t].children.length===0?t>0?(a=n[t-1].children,a.splice(a.indexOf(n[t]),1)):this.clear():tn(n[t],this.toBBox)}};function bh(i,n,t){if(!t)return n.indexOf(i);for(let a=0;a<n.length;a++)if(t(i,n[a]))return a;return-1}function tn(i,n){On(i,0,i.children.length,n,i)}function On(i,n,t,a,u){u||(u=an(null)),u.minX=1/0,u.minY=1/0,u.maxX=-1/0,u.maxY=-1/0;for(let h=n;h<t;h++){const c=i.children[h];Rn(u,i.leaf?a(c):c)}return u}function Rn(i,n){return i.minX=Math.min(i.minX,n.minX),i.minY=Math.min(i.minY,n.minY),i.maxX=Math.max(i.maxX,n.maxX),i.maxY=Math.max(i.maxY,n.maxY),i}function Ch(i,n){return i.minX-n.minX}function Th(i,n){return i.minY-n.minY}function yi(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function dr(i){return i.maxX-i.minX+(i.maxY-i.minY)}function Oh(i,n){return(Math.max(n.maxX,i.maxX)-Math.min(n.minX,i.minX))*(Math.max(n.maxY,i.maxY)-Math.min(n.minY,i.minY))}function Rh(i,n){const t=Math.max(i.minX,n.minX),a=Math.max(i.minY,n.minY),u=Math.min(i.maxX,n.maxX),h=Math.min(i.maxY,n.maxY);return Math.max(0,u-t)*Math.max(0,h-a)}function pi(i,n){return i.minX<=n.minX&&i.minY<=n.minY&&n.maxX<=i.maxX&&n.maxY<=i.maxY}function vr(i,n){return n.minX<=i.maxX&&n.minY<=i.maxY&&n.maxX>=i.minX&&n.maxY>=i.minY}function an(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ua(i,n,t,a,u){const h=[n,t];for(;h.length;){if(t=h.pop(),n=h.pop(),t-n<=a)continue;const c=n+Math.ceil((t-n)/a/2)*a;Lh(i,c,n,t,u),h.push(n,c,c,t)}}function Ar(i){var n=new mt(i);return n.insert=function(t){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:_e(t),mt.prototype.insert.call(this,t)},n.load=function(t){var a=[];return Array.isArray(t)?t.forEach(function(u){if(u.type!=="Feature")throw new Error("invalid features");u.bbox=u.bbox?u.bbox:_e(u),a.push(u)}):ce(t,function(u){if(u.type!=="Feature")throw new Error("invalid features");u.bbox=u.bbox?u.bbox:_e(u),a.push(u)}),mt.prototype.load.call(this,a)},n.remove=function(t,a){if(t.type!=="Feature")throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:_e(t),mt.prototype.remove.call(this,t,a)},n.clear=function(){return mt.prototype.clear.call(this)},n.search=function(t){var a=mt.prototype.search.call(this,this.toBBox(t));return G(a)},n.collides=function(t){return mt.prototype.collides.call(this,this.toBBox(t))},n.all=function(){var t=mt.prototype.all.call(this);return G(t)},n.toJSON=function(){return mt.prototype.toJSON.call(this)},n.fromJSON=function(t){return mt.prototype.fromJSON.call(this,t)},n.toBBox=function(t){var a;if(t.bbox)a=t.bbox;else if(Array.isArray(t)&&t.length===4)a=t;else if(Array.isArray(t)&&t.length===6)a=[t[0],t[1],t[3],t[4]];else if(t.type==="Feature")a=_e(t);else if(t.type==="FeatureCollection")a=_e(t);else throw new Error("invalid geojson");return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}},n}function $n(i){if(!i)throw new Error("geojson is required");const n=[];return Ye(i,t=>{Ah(t,n)}),G(n)}function Ah(i,n){let t=[];const a=i.geometry;if(a!==null){switch(a.type){case"Polygon":t=J(a);break;case"LineString":t=[J(a)]}t.forEach(u=>{Dh(u,i.properties).forEach(c=>{c.id=n.length,n.push(c)})})}}function Dh(i,n){const t=[];return i.reduce((a,u)=>{const h=he([a,u],n);return h.bbox=Fh(a,u),t.push(h),u}),t}function Fh(i,n){const t=i[0],a=i[1],u=n[0],h=n[1],c=t<u?t:u,g=a<h?a:h,d=t>u?t:u,m=a>h?a:h;return[c,g,d,m]}var Bh=Object.defineProperty,qh=Object.defineProperties,Yh=Object.getOwnPropertyDescriptors,la=Object.getOwnPropertySymbols,Xh=Object.prototype.hasOwnProperty,Gh=Object.prototype.propertyIsEnumerable,ha=(i,n,t)=>n in i?Bh(i,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[n]=t,Bt=(i,n)=>{for(var t in n||(n={}))Xh.call(n,t)&&ha(i,t,n[t]);if(la)for(var t of la(n))Gh.call(n,t)&&ha(i,t,n[t]);return i},qt=(i,n)=>qh(i,Yh(n));function Lt(i,n,t={}){if(!i||!n)throw new Error("lines and pt are required arguments");let a=re([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),u=0;return Ye(i,function(h,c,g){const d=J(h);for(let m=0;m<d.length-1;m++){const p=re(d[m]);p.properties.dist=me(n,p,t);const x=re(d[m+1]);x.properties.dist=me(n,x,t);const I=me(p,x,t),w=Math.max(p.properties.dist,x.properties.dist),k=kt(p,x),C=It(n,w,k+90,t),D=It(n,w,k-90,t),R=ht(he([C.geometry.coordinates,D.geometry.coordinates]),he([p.geometry.coordinates,x.geometry.coordinates]));let P;R.features.length>0&&R.features[0]&&(P=qt(Bt({},R.features[0]),{properties:{dist:me(n,R.features[0],t),multiFeatureIndex:g,location:u+me(p,R.features[0],t)}})),p.properties.dist<a.properties.dist&&(a=qt(Bt({},p),{properties:qt(Bt({},p.properties),{index:m,multiFeatureIndex:g,location:u})})),x.properties.dist<a.properties.dist&&(a=qt(Bt({},x),{properties:qt(Bt({},x.properties),{index:m+1,multiFeatureIndex:g,location:u+I})})),P&&P.properties.dist<a.properties.dist&&(a=qt(Bt({},P),{properties:qt(Bt({},P.properties),{index:m})})),u+=I}}),a}function Mo(i,n,t={}){if(t=t||{},!de(t))throw new Error("options is invalid");var a=t.tolerance||0,u=[],h=Ar();const c=$n(i);h.load(c);var g;let d=[];return wt(n,function(m){var p=!1;m&&(ce(h.search(m),function(x){if(p===!1){var I=J(m).sort(),w=J(x).sort();if(Tn(I,w))p=!0,g?g=_i(g,m)||g:g=m;else if(a===0?se(I[0],x)&&se(I[1],x):Lt(x,I[0]).properties.dist<=a&&Lt(x,I[1]).properties.dist<=a)p=!0,g?g=_i(g,m)||g:g=m;else if(a===0?se(w[0],m)&&se(w[1],m):Lt(m,w[0]).properties.dist<=a&&Lt(m,w[1]).properties.dist<=a)if(g){const k=_i(g,x);k?g=k:d.push(x)}else g=x}}),p===!1&&g&&(u.push(g),d.length&&(u=u.concat(d),d=[]),g=void 0))}),g&&u.push(g),G(u)}function _i(i,n){var t=J(n),a=J(i),u=a[0],h=a[a.length-1],c=i.geometry.coordinates;if(Tn(t[0],u))c.unshift(t[1]);else if(Tn(t[0],h))c.push(t[1]);else if(Tn(t[1],u))c.unshift(t[0]);else if(Tn(t[1],h))c.push(t[0]);else return;return i}function zh(i,n){const t=ke(i),a=ke(n),u=t.type,h=a.type;if(u==="MultiPoint"&&h!=="MultiPoint"||(u==="LineString"||u==="MultiLineString")&&h!=="LineString"&&h!=="MultiLineString"||(u==="Polygon"||u==="MultiPolygon")&&h!=="Polygon"&&h!=="MultiPolygon")throw new Error("features must be of the same type");if(u==="Point")throw new Error("Point geometry not supported");if(io(i,n,{precision:6}))return!1;let c=0;switch(u){case"MultiPoint":for(var g=0;g<t.coordinates.length;g++)for(var d=0;d<a.coordinates.length;d++){var m=t.coordinates[g],p=a.coordinates[d];if(m[0]===p[0]&&m[1]===p[1])return!0}return!1;case"LineString":case"MultiLineString":wt(i,x=>{wt(n,I=>{Mo(x,I).features.length&&c++})});break;case"Polygon":case"MultiPolygon":wt(i,x=>{wt(n,I=>{ht(x,I).features.length&&c++})});break}return c>0}function Uh(i,n){if(!i)throw new Error("line1 is required");if(!n)throw new Error("line2 is required");var t=ca(i,"line1");if(t!=="LineString")throw new Error("line1 must be a LineString");var a=ca(n,"line2");if(a!=="LineString")throw new Error("line2 must be a LineString");for(var u=$n(zt(i)).features,h=$n(zt(n)).features,c=0;c<u.length;c++){var g=u[c].geometry.coordinates;if(!h[c])break;var d=h[c].geometry.coordinates;if(!Vh(g,d))return!1}return!0}function Vh(i,n){var t=gn(Gt(i[0],i[1])),a=gn(Gt(n[0],n[1]));return t===a||(a-t)%180===0}function ca(i,n){if(i.geometry&&i.geometry.type)return i.geometry.type;if(i.type)return i.type;throw new Error("Invalid GeoJSON object for "+n)}function $h(i,n){var t=ke(i),a=ke(n),u=t.type,h=a.type;switch(u){case"Point":switch(h){case"LineString":return Ue(t,a);case"MultiLineString":for(var c=!1,g=0;g<a.coordinates.length;g++)Ue(t,{type:"LineString",coordinates:a.coordinates[g]})&&(c=!0);return c;case"Polygon":for(var d=0;d<a.coordinates.length;d++)if(se(t,{type:"LineString",coordinates:a.coordinates[d]}))return!0;return!1;case"MultiPolygon":for(var d=0;d<a.coordinates.length;d++)for(var g=0;g<a.coordinates[d].length;g++)if(se(t,{type:"LineString",coordinates:a.coordinates[d][g]}))return!0;return!1;default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiPoint":switch(h){case"LineString":for(var c=!1,d=0;d<t.coordinates.length;d++)if(c||Ue({type:"Point",coordinates:t.coordinates[d]},a)&&(c=!0),se({type:"Point",coordinates:t.coordinates[d]},a,{ignoreEndVertices:!0}))return!1;return c;case"MultiLineString":for(var c=!1,d=0;d<t.coordinates.length;d++)for(var g=0;g<a.coordinates.length;g++)if(c||Ue({type:"Point",coordinates:t.coordinates[d]},{type:"LineString",coordinates:a.coordinates[g]})&&(c=!0),se({type:"Point",coordinates:t.coordinates[d]},{type:"LineString",coordinates:a.coordinates[g]},{ignoreEndVertices:!0}))return!1;return c;case"Polygon":for(var c=!1,d=0;d<t.coordinates.length;d++)if(c||se({type:"Point",coordinates:t.coordinates[d]},{type:"LineString",coordinates:a.coordinates[0]})&&(c=!0),ne({type:"Point",coordinates:t.coordinates[d]},a,{ignoreBoundary:!0}))return!1;return c;case"MultiPolygon":for(var c=!1,d=0;d<t.coordinates.length;d++)for(var g=0;g<a.coordinates.length;g++)if(c||se({type:"Point",coordinates:t.coordinates[d]},{type:"LineString",coordinates:a.coordinates[g][0]})&&(c=!0),ne({type:"Point",coordinates:t.coordinates[d]},{type:"Polygon",coordinates:a.coordinates[g]},{ignoreBoundary:!0}))return!1;return c;default:throw new Error("feature2 "+h+" geometry not supported")}case"LineString":switch(h){case"Point":return Ue(a,t);case"MultiPoint":for(var c=!1,d=0;d<a.coordinates.length;d++)if(c||Ue({type:"Point",coordinates:a.coordinates[d]},t)&&(c=!0),se({type:"Point",coordinates:a.coordinates[d]},t,{ignoreEndVertices:!0}))return!1;return c;case"LineString":var m=!1;if(Ue({type:"Point",coordinates:t.coordinates[0]},a)&&(m=!0),Ue({type:"Point",coordinates:t.coordinates[t.coordinates.length-1]},a)&&(m=!0),m===!1)return!1;for(var d=0;d<t.coordinates.length;d++)if(se({type:"Point",coordinates:t.coordinates[d]},a,{ignoreEndVertices:!0}))return!1;return m;case"MultiLineString":for(var m=!1,d=0;d<a.coordinates.length;d++){Ue({type:"Point",coordinates:t.coordinates[0]},{type:"LineString",coordinates:a.coordinates[d]})&&(m=!0),Ue({type:"Point",coordinates:t.coordinates[t.coordinates.length-1]},{type:"LineString",coordinates:a.coordinates[d]})&&(m=!0);for(var g=0;g<t.coordinates[d].length;g++)if(se({type:"Point",coordinates:t.coordinates[g]},{type:"LineString",coordinates:a.coordinates[d]},{ignoreEndVertices:!0}))return!1}return m;case"Polygon":for(var c=!1,d=0;d<t.coordinates.length;d++)if(c||se({type:"Point",coordinates:t.coordinates[d]},{type:"LineString",coordinates:a.coordinates[0]})&&(c=!0),ne({type:"Point",coordinates:t.coordinates[d]},a,{ignoreBoundary:!0}))return!1;return c;case"MultiPolygon":for(var c=!1,d=0;d<t.coordinates.length;d++){for(var g=0;g<a.coordinates.length;g++)c||se({type:"Point",coordinates:t.coordinates[d]},{type:"LineString",coordinates:a.coordinates[g][0]})&&(c=!0);if(ne({type:"Point",coordinates:t.coordinates[d]},a,{ignoreBoundary:!0}))return!1}return c;default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiLineString":switch(h){case"Point":for(var d=0;d<t.coordinates.length;d++)if(Ue(a,{type:"LineString",coordinates:t.coordinates[d]}))return!0;return!1;case"MultiPoint":for(var c=!1,d=0;d<t.coordinates.length;d++)for(var g=0;g<a.coordinates.length;g++)if(c||Ue({type:"Point",coordinates:a.coordinates[g]},{type:"LineString",coordinates:t.coordinates[g]})&&(c=!0),se({type:"Point",coordinates:a.coordinates[g]},{type:"LineString",coordinates:t.coordinates[g]},{ignoreEndVertices:!0}))return!1;return c;case"LineString":for(var m=!1,d=0;d<t.coordinates.length;d++){Ue({type:"Point",coordinates:t.coordinates[d][0]},a)&&(m=!0),Ue({type:"Point",coordinates:t.coordinates[d][t.coordinates[d].length-1]},a)&&(m=!0);for(var g=0;g<a.coordinates.length;g++)if(se({type:"Point",coordinates:a.coordinates[g]},{type:"LineString",coordinates:t.coordinates[d]},{ignoreEndVertices:!0}))return!1}return m;case"MultiLineString":for(var m=!1,d=0;d<t.coordinates.length;d++)for(var g=0;g<a.coordinates.length;g++){Ue({type:"Point",coordinates:t.coordinates[d][0]},{type:"LineString",coordinates:a.coordinates[g]})&&(m=!0),Ue({type:"Point",coordinates:t.coordinates[d][t.coordinates[d].length-1]},{type:"LineString",coordinates:a.coordinates[g]})&&(m=!0);for(var p=0;p<t.coordinates[d].length;p++)if(se({type:"Point",coordinates:t.coordinates[d][p]},{type:"LineString",coordinates:a.coordinates[g]},{ignoreEndVertices:!0}))return!1}return m;case"Polygon":for(var c=!1,d=0;d<t.coordinates.length;d++)for(var g=0;g<t.coordinates.length;g++)if(c||se({type:"Point",coordinates:t.coordinates[d][g]},{type:"LineString",coordinates:a.coordinates[0]})&&(c=!0),ne({type:"Point",coordinates:t.coordinates[d][g]},a,{ignoreBoundary:!0}))return!1;return c;case"MultiPolygon":for(var c=!1,d=0;d<a.coordinates[0].length;d++)for(var g=0;g<t.coordinates.length;g++)for(var p=0;p<t.coordinates[g].length;p++)if(c||se({type:"Point",coordinates:t.coordinates[g][p]},{type:"LineString",coordinates:a.coordinates[0][d]})&&(c=!0),ne({type:"Point",coordinates:t.coordinates[g][p]},{type:"Polygon",coordinates:[a.coordinates[0][d]]},{ignoreBoundary:!0}))return!1;return c;default:throw new Error("feature2 "+h+" geometry not supported")}case"Polygon":switch(h){case"Point":for(var d=0;d<t.coordinates.length;d++)if(se(a,{type:"LineString",coordinates:t.coordinates[d]}))return!0;return!1;case"MultiPoint":for(var c=!1,d=0;d<a.coordinates.length;d++)if(c||se({type:"Point",coordinates:a.coordinates[d]},{type:"LineString",coordinates:t.coordinates[0]})&&(c=!0),ne({type:"Point",coordinates:a.coordinates[d]},t,{ignoreBoundary:!0}))return!1;return c;case"LineString":for(var c=!1,d=0;d<a.coordinates.length;d++)if(c||se({type:"Point",coordinates:a.coordinates[d]},{type:"LineString",coordinates:t.coordinates[0]})&&(c=!0),ne({type:"Point",coordinates:a.coordinates[d]},t,{ignoreBoundary:!0}))return!1;return c;case"MultiLineString":for(var c=!1,d=0;d<a.coordinates.length;d++)for(var g=0;g<a.coordinates[d].length;g++)if(c||se({type:"Point",coordinates:a.coordinates[d][g]},{type:"LineString",coordinates:t.coordinates[0]})&&(c=!0),ne({type:"Point",coordinates:a.coordinates[d][g]},t,{ignoreBoundary:!0}))return!1;return c;case"Polygon":for(var c=!1,d=0;d<t.coordinates[0].length;d++)if(c||se({type:"Point",coordinates:t.coordinates[0][d]},{type:"LineString",coordinates:a.coordinates[0]})&&(c=!0),ne({type:"Point",coordinates:t.coordinates[0][d]},a,{ignoreBoundary:!0}))return!1;return c;case"MultiPolygon":for(var c=!1,d=0;d<a.coordinates[0].length;d++)for(var g=0;g<t.coordinates[0].length;g++)if(c||se({type:"Point",coordinates:t.coordinates[0][g]},{type:"LineString",coordinates:a.coordinates[0][d]})&&(c=!0),ne({type:"Point",coordinates:t.coordinates[0][g]},{type:"Polygon",coordinates:a.coordinates[0][d]},{ignoreBoundary:!0}))return!1;return c;default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiPolygon":switch(h){case"Point":for(var d=0;d<t.coordinates[0].length;d++)if(se(a,{type:"LineString",coordinates:t.coordinates[0][d]}))return!0;return!1;case"MultiPoint":for(var c=!1,d=0;d<t.coordinates[0].length;d++)for(var g=0;g<a.coordinates.length;g++)if(c||se({type:"Point",coordinates:a.coordinates[g]},{type:"LineString",coordinates:t.coordinates[0][d]})&&(c=!0),ne({type:"Point",coordinates:a.coordinates[g]},{type:"Polygon",coordinates:t.coordinates[0][d]},{ignoreBoundary:!0}))return!1;return c;case"LineString":for(var c=!1,d=0;d<t.coordinates[0].length;d++)for(var g=0;g<a.coordinates.length;g++)if(c||se({type:"Point",coordinates:a.coordinates[g]},{type:"LineString",coordinates:t.coordinates[0][d]})&&(c=!0),ne({type:"Point",coordinates:a.coordinates[g]},{type:"Polygon",coordinates:t.coordinates[0][d]},{ignoreBoundary:!0}))return!1;return c;case"MultiLineString":for(var c=!1,d=0;d<t.coordinates.length;d++)for(var g=0;g<a.coordinates.length;g++)for(var p=0;p<a.coordinates[g].length;p++)if(c||se({type:"Point",coordinates:a.coordinates[g][p]},{type:"LineString",coordinates:t.coordinates[d][0]})&&(c=!0),ne({type:"Point",coordinates:a.coordinates[g][p]},{type:"Polygon",coordinates:[t.coordinates[d][0]]},{ignoreBoundary:!0}))return!1;return c;case"Polygon":for(var c=!1,d=0;d<t.coordinates[0].length;d++)for(var g=0;g<t.coordinates[0][d].length;g++)if(c||se({type:"Point",coordinates:t.coordinates[0][d][g]},{type:"LineString",coordinates:a.coordinates[0]})&&(c=!0),ne({type:"Point",coordinates:t.coordinates[0][d][g]},a,{ignoreBoundary:!0}))return!1;return c;case"MultiPolygon":for(var c=!1,d=0;d<t.coordinates[0].length;d++)for(var g=0;g<a.coordinates[0].length;g++)for(var p=0;p<t.coordinates[0].length;p++)if(c||se({type:"Point",coordinates:t.coordinates[0][d][p]},{type:"LineString",coordinates:a.coordinates[0][g]})&&(c=!0),ne({type:"Point",coordinates:t.coordinates[0][d][p]},{type:"Polygon",coordinates:a.coordinates[0][g]},{ignoreBoundary:!0}))return!1;return c;default:throw new Error("feature2 "+h+" geometry not supported")}default:throw new Error("feature1 "+u+" geometry not supported")}}function Ue(i,n){return!!(fa(n.coordinates[0],i.coordinates)||fa(n.coordinates[n.coordinates.length-1],i.coordinates))}function fa(i,n){return i[0]===n[0]&&i[1]===n[1]}function Hh(i){if(!i.type)return!1;const n=ke(i),t=n.type,a=n.coordinates;switch(t){case"Point":return a.length>1;case"MultiPoint":for(var u=0;u<a.length;u++)if(a[u].length<2)return!1;return!0;case"LineString":if(a.length<2)return!1;for(var u=0;u<a.length;u++)if(a[u].length<2)return!1;return!0;case"MultiLineString":if(a.length<2)return!1;for(var u=0;u<a.length;u++)if(a[u].length<2)return!1;return!0;case"Polygon":for(var u=0;u<n.coordinates.length;u++)if(a[u].length<4||!ga(a[u])||da(a[u])||u>0&&ht(j([a[0]]),j([a[u]])).features.length>1)return!1;return!0;case"MultiPolygon":for(var u=0;u<n.coordinates.length;u++)for(var h=n.coordinates[u],c=0;c<h.length;c++)if(h[c].length<4||!ga(h[c])||da(h[c])||c===0&&!Zh(h,n.coordinates,u)||c>0&&ht(j([h[0]]),j([h[c]])).features.length>1)return!1;return!0;default:return!1}}function ga(i){return i[0][0]===i[i.length-1][0]&&i[0][1]===i[i.length-1][1]}function da(i){for(var n=0;n<i.length-1;n++)for(var t=i[n],a=n+1;a<i.length-2;a++){var u=[i[a],i[a+1]];if(se(t,he(u)))return!0}return!1}function Zh(i,n,t){for(var a=j(i),u=t+1;u<n.length;u++)if(!Wi(a,j(n[u]))&&wo(a,he(n[u][0])))return!1;return!0}function Po(i,n){var t=ke(i),a=ke(n),u=t.type,h=a.type;switch(u){case"Point":switch(h){case"MultiPoint":return Wh(t,a);case"LineString":return se(t,a,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return ne(t,a,{ignoreBoundary:!0});default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiPoint":switch(h){case"MultiPoint":return Jh(t,a);case"LineString":return Kh(t,a);case"Polygon":case"MultiPolygon":return Qh(t,a);default:throw new Error("feature2 "+h+" geometry not supported")}case"LineString":switch(h){case"LineString":return jh(t,a);case"Polygon":case"MultiPolygon":return ec(t,a);default:throw new Error("feature2 "+h+" geometry not supported")}case"Polygon":switch(h){case"Polygon":case"MultiPolygon":return tc(t,a);default:throw new Error("feature2 "+h+" geometry not supported")}default:throw new Error("feature1 "+u+" geometry not supported")}}function Wh(i,n){var t,a=!1;for(t=0;t<n.coordinates.length;t++)if(So(n.coordinates[t],i.coordinates)){a=!0;break}return a}function Jh(i,n){for(var t=0;t<i.coordinates.length;t++){for(var a=!1,u=0;u<n.coordinates.length;u++)So(i.coordinates[t],n.coordinates[u])&&(a=!0);if(!a)return!1}return!0}function Kh(i,n){for(var t=!1,a=0;a<i.coordinates.length;a++){if(!se(i.coordinates[a],n))return!1;t||(t=se(i.coordinates[a],n,{ignoreEndVertices:!0}))}return t}function Qh(i,n){for(var t=!0,a=!1,u=0;u<i.coordinates.length;u++){if(a=ne(i.coordinates[u],n),!a){t=!1;break}a=ne(i.coordinates[u],n,{ignoreBoundary:!0})}return t&&a}function jh(i,n){for(var t=0;t<i.coordinates.length;t++)if(!se(i.coordinates[t],n))return!1;return!0}function ec(i,n){var t=_e(n),a=_e(i);if(!Lo(t,a))return!1;for(var u=!1,h=0;h<i.coordinates.length;h++){if(!ne(i.coordinates[h],n))return!1;if(u||(u=ne(i.coordinates[h],n,{ignoreBoundary:!0})),!u&&h<i.coordinates.length-1){var c=nc(i.coordinates[h],i.coordinates[h+1]);u=ne(c,n,{ignoreBoundary:!0})}}return u}function tc(i,n){var t=_e(i),a=_e(n);if(!Lo(a,t))return!1;for(var u=0;u<i.coordinates[0].length;u++)if(!ne(i.coordinates[0][u],n))return!1;return!0}function Lo(i,n){return!(i[0]>n[0]||i[2]<n[2]||i[1]>n[1]||i[3]<n[3])}function So(i,n){return i[0]===n[0]&&i[1]===n[1]}function nc(i,n){return[(i[0]+n[0])/2,(i[1]+n[1])/2]}function Dr(i,n={}){const t=_e(i),a=(t[0]+t[2])/2,u=(t[1]+t[3])/2;return re([a,u],n.properties,n)}var bo={exports:{}};(function(i,n){(function(t,a){i.exports=a()})(Ul,function(){function t(l,e){if(!(l instanceof e))throw new TypeError("Cannot call a class as a function")}function a(l,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(l,s.key,s)}}function u(l,e,r){return e&&a(l.prototype,e),r&&a(l,r),l}function h(l,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(e&&e.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),e&&g(l,e)}function c(l){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(l)}function g(l,e){return g=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},g(l,e)}function d(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m(l,e,r){return m=d()?Reflect.construct:function(s,o,f){var v=[null];v.push.apply(v,o);var y=new(Function.bind.apply(s,v));return f&&g(y,f.prototype),y},m.apply(null,arguments)}function p(l){var e=typeof Map=="function"?new Map:void 0;return p=function(r){if(r===null||(s=r,Function.toString.call(s).indexOf("[native code]")===-1))return r;var s;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(r))return e.get(r);e.set(r,o)}function o(){return m(r,arguments,c(this).constructor)}return o.prototype=Object.create(r.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),g(o,r)},p(l)}function x(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l}function I(l,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x(l)}function w(l){var e=d();return function(){var r,s=c(l);if(e){var o=c(this).constructor;r=Reflect.construct(s,arguments,o)}else r=s.apply(this,arguments);return I(this,r)}}function k(l,e,r){return k=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(s,o,f){var v=function(_,E){for(;!Object.prototype.hasOwnProperty.call(_,E)&&(_=c(_))!==null;);return _}(s,o);if(v){var y=Object.getOwnPropertyDescriptor(v,o);return y.get?y.get.call(f):y.value}},k(l,e,r||l)}function C(l){return function(e){if(Array.isArray(e))return R(e)}(l)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(l)||D(l)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function D(l,e){if(l){if(typeof l=="string")return R(l,e);var r=Object.prototype.toString.call(l).slice(8,-1);return r==="Object"&&l.constructor&&(r=l.constructor.name),r==="Map"||r==="Set"?Array.from(l):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?R(l,e):void 0}}function R(l,e){(e==null||e>l.length)&&(e=l.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=l[r];return s}function P(l,e){var r=typeof Symbol<"u"&&l[Symbol.iterator]||l["@@iterator"];if(!r){if(Array.isArray(l)||(r=D(l))||e){r&&(l=r);var s=0,o=function(){};return{s:o,n:function(){return s>=l.length?{done:!0}:{done:!1,value:l[s++]}},e:function(_){throw _},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,v=!0,y=!1;return{s:function(){r=r.call(l)},n:function(){var _=r.next();return v=_.done,_},e:function(_){y=!0,f=_},f:function(){try{v||r.return==null||r.return()}finally{if(y)throw f}}}}var S=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(e){this._quadrantSegments=e,this._quadrantSegments===0&&(this._joinStyle=l.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=l.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==l.JOIN_ROUND&&(this._quadrantSegments=l.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(e){this._joinStyle=e}},{key:"setSimplifyFactor",value:function(e){this._simplifyFactor=e<0?0:e}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(e){this._endCapStyle=e}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(e){this._mitreLimit=e}},{key:"setSingleSided",value:function(e){this._isSingleSided=e}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=l.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=l.CAP_ROUND,this._joinStyle=l.JOIN_ROUND,this._mitreLimit=l.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=l.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setQuadrantSegments(e)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.setQuadrantSegments(r),this.setEndCapStyle(s)}else if(arguments.length===4){var o=arguments[0],f=arguments[1],v=arguments[2],y=arguments[3];this.setQuadrantSegments(o),this.setEndCapStyle(f),this.setJoinStyle(v),this.setMitreLimit(y)}}}},{key:"bufferDistanceError",value:function(e){var r=Math.PI/2/e;return 1-Math.cos(r/2)}}]),l}();S.CAP_ROUND=1,S.CAP_FLAT=2,S.CAP_SQUARE=3,S.JOIN_ROUND=1,S.JOIN_MITRE=2,S.JOIN_BEVEL=3,S.DEFAULT_QUADRANT_SEGMENTS=8,S.DEFAULT_MITRE_LIMIT=5,S.DEFAULT_SIMPLIFY_FACTOR=.01;var A=function(l){h(r,l);var e=w(r);function r(s){var o;return t(this,r),(o=e.call(this,s)).name=Object.keys({Exception:r})[0],o}return u(r,[{key:"toString",value:function(){return this.message}}]),r}(p(Error)),O=function(l){h(r,l);var e=w(r);function r(s){var o;return t(this,r),(o=e.call(this,s)).name=Object.keys({IllegalArgumentException:r})[0],o}return r}(A),fe=function(){function l(){t(this,l)}return u(l,[{key:"filter",value:function(e){}}]),l}();function X(){}function Z(){}function H(){}var ae,ie,ve,Ie,Pe,Ne,ue,Fe,Le=function(){function l(){t(this,l)}return u(l,null,[{key:"equalsWithTolerance",value:function(e,r,s){return Math.abs(e-r)<=s}}]),l}(),le=function(){function l(e,r){t(this,l),this.low=r||0,this.high=e||0}return u(l,null,[{key:"toBinaryString",value:function(e){var r,s="";for(r=2147483648;r>0;r>>>=1)s+=(e.high&r)===r?"1":"0";for(r=2147483648;r>0;r>>>=1)s+=(e.low&r)===r?"1":"0";return s}}]),l}();function z(){}function et(){}z.NaN=NaN,z.isNaN=function(l){return Number.isNaN(l)},z.isInfinite=function(l){return!Number.isFinite(l)},z.MAX_VALUE=Number.MAX_VALUE,z.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,z.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(Ne=2146435072,ue=new Float64Array(1),Fe=new Int32Array(ue.buffer),z.doubleToLongBits=function(l){ue[0]=l;var e=0|Fe[0],r=0|Fe[1];return(r&Ne)===Ne&&1048575&r&&e!==0&&(e=0,r=2146959360),new le(r,e)},z.longBitsToDouble=function(l){return Fe[0]=l.low,Fe[1]=l.high,ue[0]}):(ae=1023,ie=Math.log2,ve=Math.floor,Ie=Math.pow,Pe=function(){for(var l=53;l>0;l--){var e=Ie(2,l)-1;if(ve(ie(e))+1===l)return e}return 0}(),z.doubleToLongBits=function(l){var e,r,s,o,f,v,y,_,E;if(l<0||1/l===Number.NEGATIVE_INFINITY?(v=1<<31,l=-l):v=0,l===0)return new le(_=v,E=0);if(l===1/0)return new le(_=2146435072|v,E=0);if(l!=l)return new le(_=2146959360,E=0);if(o=0,E=0,(e=ve(l))>1)if(e<=Pe)(o=ve(ie(e)))<=20?(E=0,_=e<<20-o&1048575):(E=e%(r=Ie(2,s=o-20))<<32-s,_=e/r&1048575);else for(s=e,E=0;(s=ve(r=s/2))!==0;)o++,E>>>=1,E|=(1&_)<<31,_>>>=1,r!==s&&(_|=524288);if(y=o+ae,f=e===0,e=l-e,o<52&&e!==0)for(s=0;;){if((r=2*e)>=1?(e=r-1,f?(y--,f=!1):(s<<=1,s|=1,o++)):(e=r,f?--y==0&&(o++,f=!1):(s<<=1,o++)),o===20)_|=s,s=0;else if(o===52){E|=s;break}if(r===1){o<20?_|=s<<20-o:o<52&&(E|=s<<52-o);break}}return _|=y<<20,new le(_|=v,E)},z.longBitsToDouble=function(l){var e,r,s,o,f=l.high,v=l.low,y=f&1<<31?-1:1;for(s=((2146435072&f)>>20)-ae,o=0,r=1<<19,e=1;e<=20;e++)f&r&&(o+=Ie(2,-e)),r>>>=1;for(r=1<<31,e=21;e<=52;e++)v&r&&(o+=Ie(2,-e)),r>>>=1;if(s===-1023){if(o===0)return 0*y;s=-1022}else{if(s===1024)return o===0?y/0:NaN;o+=1}return y*o*Ie(2,s)});var Be=function(l){h(r,l);var e=w(r);function r(s){var o;return t(this,r),(o=e.call(this,s)).name=Object.keys({RuntimeException:r})[0],o}return r}(A),xe=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,null,[{key:"constructor_",value:function(){if(arguments.length===0)Be.constructor_.call(this);else if(arguments.length===1){var s=arguments[0];Be.constructor_.call(this,s)}}}]),r}(Be),U=function(){function l(){t(this,l)}return u(l,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)l.shouldNeverReachHere(null);else if(arguments.length===1){var e=arguments[0];throw new xe("Should never reach here"+(e!==null?": "+e:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var e=arguments[0];l.isTrue(e,null)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];if(!r)throw s===null?new xe:new xe(s)}}},{key:"equals",value:function(){if(arguments.length===2){var e=arguments[0],r=arguments[1];l.equals(e,r,null)}else if(arguments.length===3){var s=arguments[0],o=arguments[1],f=arguments[2];if(!o.equals(s))throw new xe("Expected "+s+" but encountered "+o+(f!==null?": "+f:""))}}}]),l}(),Re=new ArrayBuffer(8),He=new Float64Array(Re),Ve=new Int32Array(Re),b=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getM",value:function(){return z.NaN}},{key:"setOrdinate",value:function(e,r){switch(e){case l.X:this.x=r;break;case l.Y:this.y=r;break;case l.Z:this.setZ(r);break;default:throw new O("Invalid ordinate index: "+e)}}},{key:"equals2D",value:function(){if(arguments.length===1){var e=arguments[0];return this.x===e.x&&this.y===e.y}if(arguments.length===2){var r=arguments[0],s=arguments[1];return!!Le.equalsWithTolerance(this.x,r.x,s)&&!!Le.equalsWithTolerance(this.y,r.y,s)}}},{key:"setM",value:function(e){throw new O("Invalid ordinate index: "+l.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(e){switch(e){case l.X:return this.x;case l.Y:return this.y;case l.Z:return this.getZ()}throw new O("Invalid ordinate index: "+e)}},{key:"equals3D",value:function(e){return this.x===e.x&&this.y===e.y&&(this.getZ()===e.getZ()||z.isNaN(this.getZ())&&z.isNaN(e.getZ()))}},{key:"equals",value:function(e){return e instanceof l&&this.equals2D(e)}},{key:"equalInZ",value:function(e,r){return Le.equalsWithTolerance(this.getZ(),e.getZ(),r)}},{key:"setX",value:function(e){this.x=e}},{key:"compareTo",value:function(e){var r=e;return this.x<r.x?-1:this.x>r.x?1:this.y<r.y?-1:this.y>r.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(e){this.z=e}},{key:"clone",value:function(){try{return null}catch(e){if(e instanceof CloneNotSupportedException)return U.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw e}}},{key:"copy",value:function(){return new l(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(e){var r=this.x-e.x,s=this.y-e.y,o=this.getZ()-e.getZ();return Math.sqrt(r*r+s*s+o*o)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(e){this.y=e}},{key:"distance",value:function(e){var r=this.x-e.x,s=this.y-e.y;return Math.sqrt(r*r+s*s)}},{key:"hashCode",value:function(){var e=17;return e=37*(e=37*e+l.hashCode(this.x))+l.hashCode(this.y)}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ()}},{key:"interfaces_",get:function(){return[X,Z,H]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)l.constructor_.call(this,0,0);else if(arguments.length===1){var e=arguments[0];l.constructor_.call(this,e.x,e.y,e.getZ())}else if(arguments.length===2){var r=arguments[0],s=arguments[1];l.constructor_.call(this,r,s,l.NULL_ORDINATE)}else if(arguments.length===3){var o=arguments[0],f=arguments[1],v=arguments[2];this.x=o,this.y=f,this.z=v}}},{key:"hashCode",value:function(e){return He[0]=e,Ve[0]^Ve[1]}}]),l}(),Vt=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"compare",value:function(e,r){var s=l.compare(e.x,r.x);if(s!==0)return s;var o=l.compare(e.y,r.y);return o!==0?o:this._dimensionsToTest<=2?0:l.compare(e.getZ(),r.getZ())}},{key:"interfaces_",get:function(){return[et]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)l.constructor_.call(this,2);else if(arguments.length===1){var e=arguments[0];if(e!==2&&e!==3)throw new O("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}}},{key:"compare",value:function(e,r){return e<r?-1:e>r?1:z.isNaN(e)?z.isNaN(r)?0:-1:z.isNaN(r)?1:0}}]),l}();b.DimensionalComparator=Vt,b.NULL_ORDINATE=z.NaN,b.X=0,b.Y=1,b.Z=2,b.M=3;var we=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(e){if(!(e instanceof l))return!1;var r=e;return this.isNull()?r.isNull():this._maxx===r.getMaxX()&&this._maxy===r.getMaxY()&&this._minx===r.getMinX()&&this._miny===r.getMinY()}},{key:"intersection",value:function(e){if(this.isNull()||e.isNull()||!this.intersects(e))return new l;var r=this._minx>e._minx?this._minx:e._minx,s=this._miny>e._miny?this._miny:e._miny;return new l(r,this._maxx<e._maxx?this._maxx:e._maxx,s,this._maxy<e._maxy?this._maxy:e._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof b){var e=arguments[0];return this.covers(e.x,e.y)}if(arguments[0]instanceof l){var r=arguments[0];return!this.isNull()&&!r.isNull()&&r.getMinX()>=this._minx&&r.getMaxX()<=this._maxx&&r.getMinY()>=this._miny&&r.getMaxY()<=this._maxy}}else if(arguments.length===2){var s=arguments[0],o=arguments[1];return!this.isNull()&&s>=this._minx&&s<=this._maxx&&o>=this._miny&&o<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof l){var e=arguments[0];return!this.isNull()&&!e.isNull()&&!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}if(arguments[0]instanceof b){var r=arguments[0];return this.intersects(r.x,r.y)}}else if(arguments.length===2){if(arguments[0]instanceof b&&arguments[1]instanceof b){var s=arguments[0],o=arguments[1];if(this.isNull())return!1;var f=s.x<o.x?s.x:o.x;if(f>this._maxx)return!1;var v=s.x>o.x?s.x:o.x;if(v<this._minx)return!1;var y=s.y<o.y?s.y:o.y;if(y>this._maxy)return!1;var _=s.y>o.y?s.y:o.y;return!(_<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var E=arguments[0],M=arguments[1];return!this.isNull()&&!(E>this._maxx||E<this._minx||M>this._maxy||M<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var e=this.getWidth(),r=this.getHeight();return Math.sqrt(e*e+r*r)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof b){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof l){var r=arguments[0];if(r.isNull())return null;this.isNull()?(this._minx=r.getMinX(),this._maxx=r.getMaxX(),this._miny=r.getMinY(),this._maxy=r.getMaxY()):(r._minx<this._minx&&(this._minx=r._minx),r._maxx>this._maxx&&(this._maxx=r._maxx),r._miny<this._miny&&(this._miny=r._miny),r._maxy>this._maxy&&(this._maxy=r._maxy))}}else if(arguments.length===2){var s=arguments[0],o=arguments[1];this.isNull()?(this._minx=s,this._maxx=s,this._miny=o,this._maxy=o):(s<this._minx&&(this._minx=s),s>this._maxx&&(this._maxx=s),o<this._miny&&(this._miny=o),o>this._maxy&&(this._maxy=o))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var e=this.getWidth(),r=this.getHeight();return e<r?e:r}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(e){var r=e;return this.isNull()?r.isNull()?0:-1:r.isNull()?1:this._minx<r._minx?-1:this._minx>r._minx?1:this._miny<r._miny?-1:this._miny>r._miny?1:this._maxx<r._maxx?-1:this._maxx>r._maxx?1:this._maxy<r._maxy?-1:this._maxy>r._maxy?1:0}},{key:"translate",value:function(e,r){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+r,this.getMaxY()+r)}},{key:"copy",value:function(){return new l(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(e){return!(!this.isNull()&&!e.isNull())||e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var e=this.getWidth(),r=this.getHeight();return e>r?e:r}},{key:"expandBy",value:function(){if(arguments.length===1){var e=arguments[0];this.expandBy(e,e)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];if(this.isNull())return null;this._minx-=r,this._maxx+=r,this._miny-=s,this._maxy+=s,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof l){var e=arguments[0];return this.covers(e)}if(arguments[0]instanceof b){var r=arguments[0];return this.covers(r)}}else if(arguments.length===2){var s=arguments[0],o=arguments[1];return this.covers(s,o)}}},{key:"centre",value:function(){return this.isNull()?null:new b((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof b){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof l){var r=arguments[0];this._minx=r._minx,this._maxx=r._maxx,this._miny=r._miny,this._maxy=r._maxy}}else if(arguments.length===2){var s=arguments[0],o=arguments[1];this.init(s.x,o.x,s.y,o.y)}else if(arguments.length===4){var f=arguments[0],v=arguments[1],y=arguments[2],_=arguments[3];f<v?(this._minx=f,this._maxx=v):(this._minx=v,this._maxx=f),y<_?(this._miny=y,this._maxy=_):(this._miny=_,this._maxy=y)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(e){if(this.intersects(e))return 0;var r=0;this._maxx<e._minx?r=e._minx-this._maxx:this._minx>e._maxx&&(r=this._minx-e._maxx);var s=0;return this._maxy<e._miny?s=e._miny-this._maxy:this._miny>e._maxy&&(s=this._miny-e._maxy),r===0?s:s===0?r:Math.sqrt(r*r+s*s)}},{key:"hashCode",value:function(){var e=17;return e=37*(e=37*(e=37*(e=37*e+b.hashCode(this._minx))+b.hashCode(this._maxx))+b.hashCode(this._miny))+b.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[X,H]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof b){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof l){var r=arguments[0];this.init(r)}}else if(arguments.length===2){var s=arguments[0],o=arguments[1];this.init(s.x,o.x,s.y,o.y)}else if(arguments.length===4){var f=arguments[0],v=arguments[1],y=arguments[2],_=arguments[3];this.init(f,v,y,_)}}},{key:"intersects",value:function(){if(arguments.length===3){var e=arguments[0],r=arguments[1],s=arguments[2];return s.x>=(e.x<r.x?e.x:r.x)&&s.x<=(e.x>r.x?e.x:r.x)&&s.y>=(e.y<r.y?e.y:r.y)&&s.y<=(e.y>r.y?e.y:r.y)}if(arguments.length===4){var o=arguments[0],f=arguments[1],v=arguments[2],y=arguments[3],_=Math.min(v.x,y.x),E=Math.max(v.x,y.x),M=Math.min(o.x,f.x),L=Math.max(o.x,f.x);return!(M>E)&&!(L<_)&&(_=Math.min(v.y,y.y),E=Math.max(v.y,y.y),M=Math.min(o.y,f.y),L=Math.max(o.y,f.y),!(M>E)&&!(L<_))}}}]),l}(),V=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===l.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(e){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(e){return this===e||this.equalsExact(e,0)}},{key:"geometryChanged",value:function(){this.apply(l.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(e){return e!==null&&this.norm().equalsExact(e.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var e;if(arguments.length===1){var r=arguments[0];return e=r,this.getTypeCode()!==e.getTypeCode()?this.getTypeCode()-e.getTypeCode():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(r)}if(arguments.length===2){var s=arguments[0],o=arguments[1];return e=s,this.getTypeCode()!==e.getTypeCode()?this.getTypeCode()-e.getTypeCode():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(s,o)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(e){if(e.getTypeCode()===l.TYPECODE_GEOMETRYCOLLECTION)throw new O("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(e,r,s){return s===0?e.equals(r):e.distance(r)<=s}},{key:"norm",value:function(){var e=this.copy();return e.normalize(),e}},{key:"reverse",value:function(){var e=this.reverseInternal();return this.envelope!=null&&(e.envelope=this.envelope.copy()),e.setSRID(this.getSRID()),e}},{key:"copy",value:function(){var e=this.copyInternal();return e.envelope=this._envelope==null?null:this._envelope.copy(),e._SRID=this._SRID,e._userData=this._userData,e}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new we(this._envelope)}},{key:"setSRID",value:function(e){this._SRID=e}},{key:"setUserData",value:function(e){this._userData=e}},{key:"compare",value:function(e,r){for(var s=e.iterator(),o=r.iterator();s.hasNext()&&o.hasNext();){var f=s.next(),v=o.next(),y=f.compareTo(v);if(y!==0)return y}return s.hasNext()?1:o.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(e){return this.getClass()===e.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===l.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===l.TYPECODE_MULTIPOINT||this.getTypeCode()===l.TYPECODE_MULTILINESTRING||this.getTypeCode()===l.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Z,X,H]}},{key:"getClass",value:function(){return l}}],[{key:"hasNonEmptyElements",value:function(e){for(var r=0;r<e.length;r++)if(!e[r].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(e){for(var r=0;r<e.length;r++)if(e[r]===null)return!0;return!1}}]),l}();V.constructor_=function(l){l&&(this._envelope=null,this._userData=null,this._factory=l,this._SRID=l.getSRID())},V.TYPECODE_POINT=0,V.TYPECODE_MULTIPOINT=1,V.TYPECODE_LINESTRING=2,V.TYPECODE_LINEARRING=3,V.TYPECODE_MULTILINESTRING=4,V.TYPECODE_POLYGON=5,V.TYPECODE_MULTIPOLYGON=6,V.TYPECODE_GEOMETRYCOLLECTION=7,V.TYPENAME_POINT="Point",V.TYPENAME_MULTIPOINT="MultiPoint",V.TYPENAME_LINESTRING="LineString",V.TYPENAME_LINEARRING="LinearRing",V.TYPENAME_MULTILINESTRING="MultiLineString",V.TYPENAME_POLYGON="Polygon",V.TYPENAME_MULTIPOLYGON="MultiPolygon",V.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",V.geometryChangedFilter={get interfaces_(){return[fe]},filter:function(l){l.geometryChangedAction()}};var N=function(){function l(){t(this,l)}return u(l,null,[{key:"toLocationSymbol",value:function(e){switch(e){case l.EXTERIOR:return"e";case l.BOUNDARY:return"b";case l.INTERIOR:return"i";case l.NONE:return"-"}throw new O("Unknown location value: "+e)}}]),l}();N.INTERIOR=0,N.BOUNDARY=1,N.EXTERIOR=2,N.NONE=-1;var tt=function(){function l(){t(this,l)}return u(l,[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}]),l}(),$t=function(l){h(r,l);var e=w(r);function r(s){var o;return t(this,r),(o=e.call(this,s)).name=Object.keys({NoSuchElementException:r})[0],o}return r}(A),ct=function(l){h(r,l);var e=w(r);function r(s){var o;return t(this,r),(o=e.call(this,s)).name=Object.keys({UnsupportedOperationException:r})[0],o}return r}(A),os=function(l){h(r,l);var e=w(r);function r(){return t(this,r),e.apply(this,arguments)}return u(r,[{key:"contains",value:function(){}}]),r}(tt),Zr=function(l,e){h(s,l);var r=w(s);function s(o){var f;return t(this,s),(f=r.call(this)).map=new Map,o instanceof tt&&f.addAll(o),f}return u(s,[{key:"contains",value:function(o){var f=o.hashCode?o.hashCode():o;return!!this.map.has(f)}},{key:"add",value:function(o){var f=o.hashCode?o.hashCode():o;return!this.map.has(f)&&!!this.map.set(f,o)}},{key:"addAll",value:function(o){var f,v=P(o);try{for(v.s();!(f=v.n()).done;){var y=f.value;this.add(y)}}catch(_){v.e(_)}finally{v.f()}return!0}},{key:"remove",value:function(){throw new ct}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new Lu(this.map)}},{key:e,value:function(){return this.map}}]),s}(os,Symbol.iterator),Lu=function(){function l(e){t(this,l),this.iterator=e.values();var r=this.iterator.next(),s=r.done,o=r.value;this.done=s,this.value=o}return u(l,[{key:"next",value:function(){if(this.done)throw new $t;var e=this.value,r=this.iterator.next(),s=r.done,o=r.value;return this.done=s,this.value=o,e}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new ct}}]),l}(),q=function(){function l(){t(this,l)}return u(l,null,[{key:"opposite",value:function(e){return e===l.LEFT?l.RIGHT:e===l.RIGHT?l.LEFT:e}}]),l}();q.ON=0,q.LEFT=1,q.RIGHT=2;var us=function(l){h(r,l);var e=w(r);function r(s){var o;return t(this,r),(o=e.call(this,s)).name=Object.keys({EmptyStackException:r})[0],o}return r}(A),ls=function(l){h(r,l);var e=w(r);function r(s){var o;return t(this,r),(o=e.call(this,s)).name=Object.keys({IndexOutOfBoundsException:r})[0],o}return r}(A),bt=function(l){h(r,l);var e=w(r);function r(){return t(this,r),e.apply(this,arguments)}return u(r,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}]),r}(tt),Su=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),(s=e.call(this)).array=[],s}return u(r,[{key:"add",value:function(s){return this.array.push(s),!0}},{key:"get",value:function(s){if(s<0||s>=this.size())throw new ls;return this.array[s]}},{key:"push",value:function(s){return this.array.push(s),s}},{key:"pop",value:function(){if(this.array.length===0)throw new us;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new us;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(s){return this.array.indexOf(s)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}]),r}(bt);function oe(l,e){return l.interfaces_&&l.interfaces_.indexOf(e)>-1}var yn=function(){function l(e){t(this,l),this.str=e}return u(l,[{key:"append",value:function(e){this.str+=e}},{key:"setCharAt",value:function(e,r){this.str=this.str.substr(0,e)+r+this.str.substr(e+1)}},{key:"toString",value:function(){return this.str}}]),l}(),rr=function(){function l(e){t(this,l),this.value=e}return u(l,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(e){return this.value<e?-1:this.value>e?1:0}}],[{key:"compare",value:function(e,r){return e<r?-1:e>r?1:0}},{key:"isNan",value:function(e){return Number.isNaN(e)}},{key:"valueOf",value:function(e){return new l(e)}}]),l}(),Wr=function(){function l(){t(this,l)}return u(l,null,[{key:"isWhitespace",value:function(e){return e<=32&&e>=0||e===127}},{key:"toUpperCase",value:function(e){return e.toUpperCase()}}]),l}(),Q=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"le",value:function(e){return this._hi<e._hi||this._hi===e._hi&&this._lo<=e._lo}},{key:"extractSignificantDigits",value:function(e,r){var s=this.abs(),o=l.magnitude(s._hi),f=l.TEN.pow(o);(s=s.divide(f)).gt(l.TEN)?(s=s.divide(l.TEN),o+=1):s.lt(l.ONE)&&(s=s.multiply(l.TEN),o-=1);for(var v=o+1,y=new yn,_=l.MAX_PRINT_DIGITS-1,E=0;E<=_;E++){e&&E===v&&y.append(".");var M=Math.trunc(s._hi);if(M<0)break;var L=!1,T=0;M>9?(L=!0,T="9"):T="0"+M,y.append(T),s=s.subtract(l.valueOf(M)).multiply(l.TEN),L&&s.selfAdd(l.TEN);var B=!0,F=l.magnitude(s._hi);if(F<0&&Math.abs(F)>=_-E&&(B=!1),!B)break}return r[0]=o,y.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof l){var e=arguments[0];return this.add(e.negate())}if(typeof arguments[0]=="number"){var r=arguments[0];return this.add(-r)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof l){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof l){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}if(typeof arguments[0]=="number"){var r=arguments[0];return this.isNaN()?this:this.selfAdd(-r,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(e){return this.le(e)?this:e}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof l){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}if(typeof arguments[0]=="number"){var r=arguments[0];return this.selfDivide(r,0)}}else if(arguments.length===2){var s=arguments[0],o=arguments[1],f=null,v=null,y=null,_=null,E=null,M=null,L=null,T=null;return E=this._hi/s,T=(f=(M=l.SPLIT*E)-(f=M-E))*(y=(T=l.SPLIT*s)-(y=T-s))-(L=E*s)+f*(_=s-y)+(v=E-f)*y+v*_,T=E+(M=(this._hi-L-T+this._lo-E*o)/s),this._hi=T,this._lo=E-T+M,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof l){var e=arguments[0],r=null,s=null,o=null,f=null,v=null,y=null,_=null,E=null;s=(v=this._hi/e._hi)-(r=(y=l.SPLIT*v)-(r=y-v)),E=r*(o=(E=l.SPLIT*e._hi)-(o=E-e._hi))-(_=v*e._hi)+r*(f=e._hi-o)+s*o+s*f;var M=E=v+(y=(this._hi-_-E+this._lo-v*e._lo)/e._hi),L=v-E+y;return new l(M,L)}if(typeof arguments[0]=="number"){var T=arguments[0];return z.isNaN(T)?l.createNaN():l.copy(this).selfDivide(T,0)}}},{key:"ge",value:function(e){return this._hi>e._hi||this._hi===e._hi&&this._lo>=e._lo}},{key:"pow",value:function(e){if(e===0)return l.valueOf(1);var r=new l(this),s=l.valueOf(1),o=Math.abs(e);if(o>1)for(;o>0;)o%2==1&&s.selfMultiply(r),(o/=2)>0&&(r=r.sqr());else s=r;return e<0?s.reciprocal():s}},{key:"ceil",value:function(){if(this.isNaN())return l.NaN;var e=Math.ceil(this._hi),r=0;return e===this._hi&&(r=Math.ceil(this._lo)),new l(e,r)}},{key:"compareTo",value:function(e){var r=e;return this._hi<r._hi?-1:this._hi>r._hi?1:this._lo<r._lo?-1:this._lo>r._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof l){var e=arguments[0];return this.init(e),this}if(typeof arguments[0]=="number"){var r=arguments[0];return this.init(r),this}}},{key:"max",value:function(e){return this.ge(e)?this:e}},{key:"sqrt",value:function(){if(this.isZero())return l.valueOf(0);if(this.isNegative())return l.NaN;var e=1/Math.sqrt(this._hi),r=this._hi*e,s=l.valueOf(r),o=this.subtract(s.sqr())._hi*(.5*e);return s.add(o)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof l){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}if(typeof arguments[0]=="number"){var r=arguments[0],s=null,o=null,f=null,v=null,y=null,_=null;return v=(f=this._hi+r)-(y=f-this._hi),o=(_=(v=r-y+(this._hi-v))+this._lo)+(f-(s=f+_)),this._hi=s+o,this._lo=o+(s-this._hi),this}}else if(arguments.length===2){var E=arguments[0],M=arguments[1],L=null,T=null,B=null,F=null,$=null,W=null,te=null;F=this._hi+E,T=this._lo+M,$=F-(W=F-this._hi),B=T-(te=T-this._lo);var Ee=(L=F+(W=($=E-W+(this._hi-$))+T))+(W=(B=M-te+(this._lo-B))+(W+(F-L))),be=W+(L-Ee);return this._hi=Ee,this._lo=be,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof l){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}if(typeof arguments[0]=="number"){var r=arguments[0];return this.selfMultiply(r,0)}}else if(arguments.length===2){var s=arguments[0],o=arguments[1],f=null,v=null,y=null,_=null,E=null,M=null;f=(E=l.SPLIT*this._hi)-this._hi,M=l.SPLIT*s,f=E-f,v=this._hi-f,y=M-s;var L=(E=this._hi*s)+(M=f*(y=M-y)-E+f*(_=s-y)+v*y+v*_+(this._hi*o+this._lo*s)),T=M+(f=E-L);return this._hi=L,this._lo=T,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return l.NaN;var e=Math.floor(this._hi),r=0;return e===this._hi&&(r=Math.floor(this._lo)),new l(e,r)}},{key:"negate",value:function(){return this.isNaN()?this:new l(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(e){if(e instanceof CloneNotSupportedException)return null;throw e}}},{key:"multiply",value:function(){if(arguments[0]instanceof l){var e=arguments[0];return e.isNaN()?l.createNaN():l.copy(this).selfMultiply(e)}if(typeof arguments[0]=="number"){var r=arguments[0];return z.isNaN(r)?l.createNaN():l.copy(this).selfMultiply(r,0)}}},{key:"isNaN",value:function(){return z.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var e=l.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var e=this.getSpecialNumberString();if(e!==null)return e;var r=new Array(1).fill(null),s=this.extractSignificantDigits(!0,r),o=r[0]+1,f=s;if(s.charAt(0)===".")f="0"+s;else if(o<0)f="0."+l.stringOfChar("0",-o)+s;else if(s.indexOf(".")===-1){var v=o-s.length;f=s+l.stringOfChar("0",v)+".0"}return this.isNegative()?"-"+f:f}},{key:"reciprocal",value:function(){var e,r,s,o,f=null,v=null,y=null,_=null;e=(s=1/this._hi)-(f=(y=l.SPLIT*s)-(f=y-s)),v=(_=l.SPLIT*this._hi)-this._hi;var E=s+(y=(1-(o=s*this._hi)-(_=f*(v=_-v)-o+f*(r=this._hi-v)+e*v+e*r)-s*this._lo)/this._hi);return new l(E,s-E+y)}},{key:"toSciNotation",value:function(){if(this.isZero())return l.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(e!==null)return e;var r=new Array(1).fill(null),s=this.extractSignificantDigits(!1,r),o=l.SCI_NOT_EXPONENT_CHAR+r[0];if(s.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+s);var f="";s.length>1&&(f=s.substring(1));var v=s.charAt(0)+"."+f;return this.isNegative()?"-"+v+o:v+o}},{key:"abs",value:function(){return this.isNaN()?l.NaN:this.isNegative()?this.negate():new l(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(e){return this._hi<e._hi||this._hi===e._hi&&this._lo<e._lo}},{key:"add",value:function(){if(arguments[0]instanceof l){var e=arguments[0];return l.copy(this).selfAdd(e)}if(typeof arguments[0]=="number"){var r=arguments[0];return l.copy(this).selfAdd(r)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this._hi=e,this._lo=0}else if(arguments[0]instanceof l){var r=arguments[0];this._hi=r._hi,this._lo=r._lo}}else if(arguments.length===2){var s=arguments[0],o=arguments[1];this._hi=s,this._lo=o}}},{key:"gt",value:function(e){return this._hi>e._hi||this._hi===e._hi&&this._lo>e._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?l.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[H,X,Z]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof l){var r=arguments[0];this.init(r)}else if(typeof arguments[0]=="string"){var s=arguments[0];l.constructor_.call(this,l.parse(s))}}else if(arguments.length===2){var o=arguments[0],f=arguments[1];this.init(o,f)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];return l.determinant(l.valueOf(e),l.valueOf(r),l.valueOf(s),l.valueOf(o))}if(arguments[3]instanceof l&&arguments[2]instanceof l&&arguments[0]instanceof l&&arguments[1]instanceof l){var f=arguments[0],v=arguments[1],y=arguments[2],_=arguments[3],E=f.multiply(_).selfSubtract(v.multiply(y));return E}}},{key:"sqr",value:function(e){return l.valueOf(e).selfMultiply(e)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var e=arguments[0];return l.parse(e)}if(typeof arguments[0]=="number"){var r=arguments[0];return new l(r)}}},{key:"sqrt",value:function(e){return l.valueOf(e).sqrt()}},{key:"parse",value:function(e){for(var r=0,s=e.length;Wr.isWhitespace(e.charAt(r));)r++;var o=!1;if(r<s){var f=e.charAt(r);f!=="-"&&f!=="+"||(r++,f==="-"&&(o=!0))}for(var v=new l,y=0,_=0,E=0,M=!1;!(r>=s);){var L=e.charAt(r);if(r++,Wr.isDigit(L)){var T=L-"0";v.selfMultiply(l.TEN),v.selfAdd(T),y++}else{if(L!=="."){if(L==="e"||L==="E"){var B=e.substring(r);try{E=rr.parseInt(B)}catch(Ee){throw Ee instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+B+" in string "+e):Ee}break}throw new NumberFormatException("Unexpected character '"+L+"' at position "+r+" in string "+e)}_=y,M=!0}}var F=v;M||(_=y);var $=y-_-E;if($===0)F=v;else if($>0){var W=l.TEN.pow($);F=v.divide(W)}else if($<0){var te=l.TEN.pow(-$);F=v.multiply(te)}return o?F.negate():F}},{key:"createNaN",value:function(){return new l(z.NaN,z.NaN)}},{key:"copy",value:function(e){return new l(e)}},{key:"magnitude",value:function(e){var r=Math.abs(e),s=Math.log(r)/Math.log(10),o=Math.trunc(Math.floor(s));return 10*Math.pow(10,o)<=r&&(o+=1),o}},{key:"stringOfChar",value:function(e,r){for(var s=new yn,o=0;o<r;o++)s.append(e);return s.toString()}}]),l}();Q.PI=new Q(3.141592653589793,12246467991473532e-32),Q.TWO_PI=new Q(6.283185307179586,24492935982947064e-32),Q.PI_2=new Q(1.5707963267948966,6123233995736766e-32),Q.E=new Q(2.718281828459045,14456468917292502e-32),Q.NaN=new Q(z.NaN,z.NaN),Q.EPS=123259516440783e-46,Q.SPLIT=134217729,Q.MAX_PRINT_DIGITS=32,Q.TEN=Q.valueOf(10),Q.ONE=Q.valueOf(1),Q.SCI_NOT_EXPONENT_CHAR="E",Q.SCI_NOT_ZERO="0.0E0";var Jr=function(){function l(){t(this,l)}return u(l,null,[{key:"orientationIndex",value:function(e,r,s){var o=l.orientationIndexFilter(e,r,s);if(o<=1)return o;var f=Q.valueOf(r.x).selfAdd(-e.x),v=Q.valueOf(r.y).selfAdd(-e.y),y=Q.valueOf(s.x).selfAdd(-r.x),_=Q.valueOf(s.y).selfAdd(-r.y);return f.selfMultiply(_).selfSubtract(v.selfMultiply(y)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof Q&&arguments[2]instanceof Q&&arguments[0]instanceof Q&&arguments[1]instanceof Q){var e=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],f=e.multiply(o).selfSubtract(r.multiply(s));return f.signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var v=arguments[0],y=arguments[1],_=arguments[2],E=arguments[3],M=Q.valueOf(v),L=Q.valueOf(y),T=Q.valueOf(_),B=Q.valueOf(E),F=M.multiply(B).selfSubtract(L.multiply(T));return F.signum()}}},{key:"intersection",value:function(e,r,s,o){var f=new Q(e.y).selfSubtract(r.y),v=new Q(r.x).selfSubtract(e.x),y=new Q(e.x).selfMultiply(r.y).selfSubtract(new Q(r.x).selfMultiply(e.y)),_=new Q(s.y).selfSubtract(o.y),E=new Q(o.x).selfSubtract(s.x),M=new Q(s.x).selfMultiply(o.y).selfSubtract(new Q(o.x).selfMultiply(s.y)),L=v.multiply(M).selfSubtract(E.multiply(y)),T=_.multiply(y).selfSubtract(f.multiply(M)),B=f.multiply(E).selfSubtract(_.multiply(v)),F=L.selfDivide(B).doubleValue(),$=T.selfDivide(B).doubleValue();return z.isNaN(F)||z.isInfinite(F)||z.isNaN($)||z.isInfinite($)?null:new b(F,$)}},{key:"orientationIndexFilter",value:function(e,r,s){var o=null,f=(e.x-s.x)*(r.y-s.y),v=(e.y-s.y)*(r.x-s.x),y=f-v;if(f>0){if(v<=0)return l.signum(y);o=f+v}else{if(!(f<0)||v>=0)return l.signum(y);o=-f-v}var _=l.DP_SAFE_EPSILON*o;return y>=_||-y>=_?l.signum(y):2}},{key:"signum",value:function(e){return e>0?1:e<0?-1:0}}]),l}();Jr.DP_SAFE_EPSILON=1e-15;var ge=function(){function l(){t(this,l)}return u(l,[{key:"getM",value:function(e){if(this.hasM()){var r=this.getDimension()-this.getMeasures();return this.getOrdinate(e,r)}return z.NaN}},{key:"setOrdinate",value:function(e,r,s){}},{key:"getZ",value:function(e){return this.hasZ()?this.getOrdinate(e,2):z.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(e,r){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(e){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(e){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(e){}},{key:"copy",value:function(){}},{key:"getY",value:function(e){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[Z]}}]),l}();ge.X=0,ge.Y=1,ge.Z=2,ge.M=3;var ee=function(){function l(){t(this,l)}return u(l,null,[{key:"index",value:function(e,r,s){return Jr.orientationIndex(e,r,s)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var e=arguments[0],r=e.length-1;if(r<3)throw new O("Ring has fewer than 4 points, so orientation cannot be determined");for(var s=e[0],o=0,f=1;f<=r;f++){var v=e[f];v.y>s.y&&(s=v,o=f)}var y=o;do(y-=1)<0&&(y=r);while(e[y].equals2D(s)&&y!==o);var _=o;do _=(_+1)%r;while(e[_].equals2D(s)&&_!==o);var E=e[y],M=e[_];if(E.equals2D(s)||M.equals2D(s)||E.equals2D(M))return!1;var L=l.index(E,s,M),T=null;return T=L===0?E.x>M.x:L>0,T}if(oe(arguments[0],ge)){var B=arguments[0],F=B.size()-1;if(F<3)throw new O("Ring has fewer than 4 points, so orientation cannot be determined");for(var $=B.getCoordinate(0),W=0,te=1;te<=F;te++){var Ee=B.getCoordinate(te);Ee.y>$.y&&($=Ee,W=te)}var be=null,ze=W;do(ze-=1)<0&&(ze=F),be=B.getCoordinate(ze);while(be.equals2D($)&&ze!==W);var je=null,lt=W;do lt=(lt+1)%F,je=B.getCoordinate(lt);while(je.equals2D($)&&lt!==W);if(be.equals2D($)||je.equals2D($)||be.equals2D(je))return!1;var Et=l.index(be,$,je);return Et===0?be.x>je.x:Et>0}}}]),l}();ee.CLOCKWISE=-1,ee.RIGHT=ee.CLOCKWISE,ee.COUNTERCLOCKWISE=1,ee.LEFT=ee.COUNTERCLOCKWISE,ee.COLLINEAR=0,ee.STRAIGHT=ee.COLLINEAR;var bu=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(e,r){var s=this.getRightmostSideOfSegment(e,r);return s<0&&(s=this.getRightmostSideOfSegment(e,r-1)),s<0&&(this._minCoord=null,this.checkForRightmostCoordinate(e)),s}},{key:"findRightmostEdgeAtVertex",value:function(){var e=this._minDe.getEdge().getCoordinates();U.isTrue(this._minIndex>0&&this._minIndex<e.length,"rightmost point expected to be interior vertex of edge");var r=e[this._minIndex-1],s=e[this._minIndex+1],o=ee.index(this._minCoord,s,r),f=!1;(r.y<this._minCoord.y&&s.y<this._minCoord.y&&o===ee.COUNTERCLOCKWISE||r.y>this._minCoord.y&&s.y>this._minCoord.y&&o===ee.CLOCKWISE)&&(f=!0),f&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(e,r){var s=e.getEdge().getCoordinates();if(r<0||r+1>=s.length||s[r].y===s[r+1].y)return-1;var o=q.LEFT;return s[r].y<s[r+1].y&&(o=q.RIGHT),o}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(e){for(var r=e.getEdge().getCoordinates(),s=0;s<r.length-1;s++)(this._minCoord===null||r[s].x>this._minCoord.x)&&(this._minDe=e,this._minIndex=s,this._minCoord=r[s])}},{key:"findRightmostEdgeAtNode",value:function(){var e=this._minDe.getNode().getEdges();this._minDe=e.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(e){for(var r=e.iterator();r.hasNext();){var s=r.next();s.isForward()&&this.checkForRightmostCoordinate(s)}U.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===q.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}]),l}(),pt=function(l){h(r,l);var e=w(r);function r(s,o){var f;return t(this,r),(f=e.call(this,o?s+" [ "+o+" ]":s)).pt=o?new b(o):void 0,f.name=Object.keys({TopologyException:r})[0],f}return u(r,[{key:"getCoordinate",value:function(){return this.pt}}]),r}(Be),Cu=function(){function l(){t(this,l),this.array=[]}return u(l,[{key:"addLast",value:function(e){this.array.push(e)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}]),l}(),K=function(l,e){h(s,l);var r=w(s);function s(o){var f;return t(this,s),(f=r.call(this)).array=[],o instanceof tt&&f.addAll(o),f}return u(s,[{key:"interfaces_",get:function(){return[bt,tt]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(o){return arguments.length===1?this.array.push(o):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(o){var f,v=P(o);try{for(v.s();!(f=v.n()).done;){var y=f.value;this.array.push(y)}}catch(_){v.e(_)}finally{v.f()}}},{key:"set",value:function(o,f){var v=this.array[o];return this.array[o]=f,v}},{key:"iterator",value:function(){return new Tu(this)}},{key:"get",value:function(o){if(o<0||o>=this.size())throw new ls;return this.array[o]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(o){o?this.array.sort(function(f,v){return o.compare(f,v)}):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(o){for(var f=0,v=this.array.length;f<v;f++)if(this.array[f]===o)return!!this.array.splice(f,1);return!1}},{key:e,value:function(){return this.array.values()}}]),s}(bt,Symbol.iterator),Tu=function(){function l(e){t(this,l),this.arrayList=e,this.position=0}return u(l,[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new $t;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(e){return this.arrayList.set(this.position-1,e)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}]),l}(),Ou=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"clearVisitedEdges",value:function(){for(var e=this._dirEdgeList.iterator();e.hasNext();)e.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(e){for(var r=null,s=e.getEdges().iterator();s.hasNext();){var o=s.next();if(o.isVisited()||o.getSym().isVisited()){r=o;break}}if(r===null)throw new pt("unable to find edge to compute depths at "+e.getCoordinate());e.getEdges().computeDepths(r);for(var f=e.getEdges().iterator();f.hasNext();){var v=f.next();v.setVisited(!0),this.copySymDepths(v)}}},{key:"computeDepth",value:function(e){this.clearVisitedEdges();var r=this._finder.getEdge();r.getNode(),r.getLabel(),r.setEdgeDepths(q.RIGHT,e),this.copySymDepths(r),this.computeDepths(r)}},{key:"create",value:function(e){this.addReachable(e),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var r=e.next();r.getDepth(q.RIGHT)>=1&&r.getDepth(q.LEFT)<=0&&!r.isInteriorAreaEdge()&&r.setInResult(!0)}}},{key:"computeDepths",value:function(e){var r=new Zr,s=new Cu,o=e.getNode();for(s.addLast(o),r.add(o),e.setVisited(!0);!s.isEmpty();){var f=s.removeFirst();r.add(f),this.computeNodeDepth(f);for(var v=f.getEdges().iterator();v.hasNext();){var y=v.next().getSym();if(!y.isVisited()){var _=y.getNode();r.contains(_)||(s.addLast(_),r.add(_))}}}}},{key:"compareTo",value:function(e){var r=e;return this._rightMostCoord.x<r._rightMostCoord.x?-1:this._rightMostCoord.x>r._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var e=new we,r=this._dirEdgeList.iterator();r.hasNext();)for(var s=r.next().getEdge().getCoordinates(),o=0;o<s.length-1;o++)e.expandToInclude(s[o]);this._env=e}return this._env}},{key:"addReachable",value:function(e){var r=new Su;for(r.add(e);!r.empty();){var s=r.pop();this.add(s,r)}}},{key:"copySymDepths",value:function(e){var r=e.getSym();r.setDepth(q.LEFT,e.getDepth(q.RIGHT)),r.setDepth(q.RIGHT,e.getDepth(q.LEFT))}},{key:"add",value:function(e,r){e.setVisited(!0),this._nodes.add(e);for(var s=e.getEdges().iterator();s.hasNext();){var o=s.next();this._dirEdgeList.add(o);var f=o.getSym().getNode();f.isVisited()||r.push(f)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new K,this._nodes=new K,this._rightMostCoord=null,this._env=null,this._finder=new bu}}]),l}(),Kr=function(){function l(){t(this,l)}return u(l,null,[{key:"intersection",value:function(e,r,s,o){var f=e.x<r.x?e.x:r.x,v=e.y<r.y?e.y:r.y,y=e.x>r.x?e.x:r.x,_=e.y>r.y?e.y:r.y,E=s.x<o.x?s.x:o.x,M=s.y<o.y?s.y:o.y,L=s.x>o.x?s.x:o.x,T=s.y>o.y?s.y:o.y,B=((f>E?f:E)+(y<L?y:L))/2,F=((v>M?v:M)+(_<T?_:T))/2,$=e.x-B,W=e.y-F,te=r.x-B,Ee=r.y-F,be=s.x-B,ze=s.y-F,je=o.x-B,lt=o.y-F,Et=W-Ee,Ft=te-$,Mn=$*Ee-te*W,Pn=ze-lt,en=je-be,Ws=be*lt-je*ze,Js=Et*en-Pn*Ft,gi=(Ft*Ws-en*Mn)/Js,di=(Pn*Mn-Et*Ws)/Js;return z.isNaN(gi)||z.isInfinite(gi)||z.isNaN(di)||z.isInfinite(di)?null:new b(gi+B,di+F)}}]),l}(),nt=function(){function l(){t(this,l)}return u(l,null,[{key:"arraycopy",value:function(e,r,s,o,f){for(var v=0,y=r;y<r+f;y++)s[o+v]=e[y],v++}},{key:"getProperty",value:function(e){return{"line.separator":`
`}[e]}}]),l}(),pn=function(){function l(){t(this,l)}return u(l,null,[{key:"log10",value:function(e){var r=Math.log(e);return z.isInfinite(r)||z.isNaN(r)?r:r/l.LOG_10}},{key:"min",value:function(e,r,s,o){var f=e;return r<f&&(f=r),s<f&&(f=s),o<f&&(f=o),f}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],r=arguments[1],s=arguments[2];return e<r?r:e>s?s:e}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var o=arguments[0],f=arguments[1],v=arguments[2];return o<f?f:o>v?v:o}}},{key:"wrap",value:function(e,r){return e<0?r- -e%r:e%r}},{key:"max",value:function(){if(arguments.length===3){var e=arguments[0],r=arguments[1],s=arguments[2],o=e;return r>o&&(o=r),s>o&&(o=s),o}if(arguments.length===4){var f=arguments[0],v=arguments[1],y=arguments[2],_=arguments[3],E=f;return v>E&&(E=v),y>E&&(E=y),_>E&&(E=_),E}}},{key:"average",value:function(e,r){return(e+r)/2}}]),l}();pn.LOG_10=Math.log(10);var ft=function(){function l(){t(this,l)}return u(l,null,[{key:"segmentToSegment",value:function(e,r,s,o){if(e.equals(r))return l.pointToSegment(e,s,o);if(s.equals(o))return l.pointToSegment(o,e,r);var f=!1;if(we.intersects(e,r,s,o)){var v=(r.x-e.x)*(o.y-s.y)-(r.y-e.y)*(o.x-s.x);if(v===0)f=!0;else{var y=(e.y-s.y)*(o.x-s.x)-(e.x-s.x)*(o.y-s.y),_=((e.y-s.y)*(r.x-e.x)-(e.x-s.x)*(r.y-e.y))/v,E=y/v;(E<0||E>1||_<0||_>1)&&(f=!0)}}else f=!0;return f?pn.min(l.pointToSegment(e,s,o),l.pointToSegment(r,s,o),l.pointToSegment(s,e,r),l.pointToSegment(o,e,r)):0}},{key:"pointToSegment",value:function(e,r,s){if(r.x===s.x&&r.y===s.y)return e.distance(r);var o=(s.x-r.x)*(s.x-r.x)+(s.y-r.y)*(s.y-r.y),f=((e.x-r.x)*(s.x-r.x)+(e.y-r.y)*(s.y-r.y))/o;if(f<=0)return e.distance(r);if(f>=1)return e.distance(s);var v=((r.y-e.y)*(s.x-r.x)-(r.x-e.x)*(s.y-r.y))/o;return Math.abs(v)*Math.sqrt(o)}},{key:"pointToLinePerpendicular",value:function(e,r,s){var o=(s.x-r.x)*(s.x-r.x)+(s.y-r.y)*(s.y-r.y),f=((r.y-e.y)*(s.x-r.x)-(r.x-e.x)*(s.y-r.y))/o;return Math.abs(f)*Math.sqrt(o)}},{key:"pointToSegmentString",value:function(e,r){if(r.length===0)throw new O("Line array must contain at least one vertex");for(var s=e.distance(r[0]),o=0;o<r.length-1;o++){var f=l.pointToSegment(e,r[o],r[o+1]);f<s&&(s=f)}return s}}]),l}(),hs=function(){function l(){t(this,l)}return u(l,[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||oe(arguments[0],ge);else if(arguments.length!==2){if(arguments.length===3){var e=arguments[0],r=arguments[1];return this.create(e,r)}}}}]),l}(),ir=function(){function l(){t(this,l)}return u(l,[{key:"filter",value:function(e){}}]),l}(),Ru=function(){function l(){t(this,l)}return u(l,null,[{key:"ofLine",value:function(e){var r=e.size();if(r<=1)return 0;var s=0,o=new b;e.getCoordinate(0,o);for(var f=o.x,v=o.y,y=1;y<r;y++){e.getCoordinate(y,o);var _=o.x,E=o.y,M=_-f,L=E-v;s+=Math.sqrt(M*M+L*L),f=_,v=E}return s}}]),l}(),cs=function l(){t(this,l)},Ct=function(){function l(){t(this,l)}return u(l,null,[{key:"copyCoord",value:function(e,r,s,o){for(var f=Math.min(e.getDimension(),s.getDimension()),v=0;v<f;v++)s.setOrdinate(o,v,e.getOrdinate(r,v))}},{key:"isRing",value:function(e){var r=e.size();return r===0||!(r<=3)&&e.getOrdinate(0,ge.X)===e.getOrdinate(r-1,ge.X)&&e.getOrdinate(0,ge.Y)===e.getOrdinate(r-1,ge.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(oe(arguments[0],ge)&&Number.isInteger(arguments[1])){var e=arguments[0],r=arguments[1];l.scroll(e,r,l.isRing(e))}else if(oe(arguments[0],ge)&&arguments[1]instanceof b){var s=arguments[0],o=arguments[1],f=l.indexOf(o,s);if(f<=0)return null;l.scroll(s,f)}}else if(arguments.length===3){var v=arguments[0],y=arguments[1],_=arguments[2],E=y;if(E<=0)return null;for(var M=v.copy(),L=_?v.size()-1:v.size(),T=0;T<L;T++)for(var B=0;B<v.getDimension();B++)v.setOrdinate(T,B,M.getOrdinate((y+T)%L,B));if(_)for(var F=0;F<v.getDimension();F++)v.setOrdinate(L,F,v.getOrdinate(0,F))}}},{key:"isEqual",value:function(e,r){var s=e.size();if(s!==r.size())return!1;for(var o=Math.min(e.getDimension(),r.getDimension()),f=0;f<s;f++)for(var v=0;v<o;v++){var y=e.getOrdinate(f,v),_=r.getOrdinate(f,v);if(e.getOrdinate(f,v)!==r.getOrdinate(f,v)&&(!z.isNaN(y)||!z.isNaN(_)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var e=arguments[0];return l.minCoordinateIndex(e,0,e.size()-1)}if(arguments.length===3){for(var r=arguments[0],s=arguments[1],o=arguments[2],f=-1,v=null,y=s;y<=o;y++){var _=r.getCoordinate(y);(v===null||v.compareTo(_)>0)&&(v=_,f=y)}return f}}},{key:"extend",value:function(e,r,s){var o=e.create(s,r.getDimension()),f=r.size();if(l.copy(r,0,o,0,f),f>0)for(var v=f;v<s;v++)l.copy(r,f-1,o,v,1);return o}},{key:"reverse",value:function(e){for(var r=e.size()-1,s=Math.trunc(r/2),o=0;o<=s;o++)l.swap(e,o,r-o)}},{key:"swap",value:function(e,r,s){if(r===s)return null;for(var o=0;o<e.getDimension();o++){var f=e.getOrdinate(r,o);e.setOrdinate(r,o,e.getOrdinate(s,o)),e.setOrdinate(s,o,f)}}},{key:"copy",value:function(e,r,s,o,f){for(var v=0;v<f;v++)l.copyCoord(e,r+v,s,o+v)}},{key:"ensureValidRing",value:function(e,r){var s=r.size();return s===0?r:s<=3?l.createClosedRing(e,r,4):r.getOrdinate(0,ge.X)===r.getOrdinate(s-1,ge.X)&&r.getOrdinate(0,ge.Y)===r.getOrdinate(s-1,ge.Y)?r:l.createClosedRing(e,r,s+1)}},{key:"indexOf",value:function(e,r){for(var s=0;s<r.size();s++)if(e.x===r.getOrdinate(s,ge.X)&&e.y===r.getOrdinate(s,ge.Y))return s;return-1}},{key:"createClosedRing",value:function(e,r,s){var o=e.create(s,r.getDimension()),f=r.size();l.copy(r,0,o,0,f);for(var v=f;v<s;v++)l.copy(r,0,o,v,1);return o}},{key:"minCoordinate",value:function(e){for(var r=null,s=0;s<e.size();s++){var o=e.getCoordinate(s);(r===null||r.compareTo(o)>0)&&(r=o)}return r}}]),l}(),Y=function(){function l(){t(this,l)}return u(l,null,[{key:"toDimensionSymbol",value:function(e){switch(e){case l.FALSE:return l.SYM_FALSE;case l.TRUE:return l.SYM_TRUE;case l.DONTCARE:return l.SYM_DONTCARE;case l.P:return l.SYM_P;case l.L:return l.SYM_L;case l.A:return l.SYM_A}throw new O("Unknown dimension value: "+e)}},{key:"toDimensionValue",value:function(e){switch(Wr.toUpperCase(e)){case l.SYM_FALSE:return l.FALSE;case l.SYM_TRUE:return l.TRUE;case l.SYM_DONTCARE:return l.DONTCARE;case l.SYM_P:return l.P;case l.SYM_L:return l.L;case l.SYM_A:return l.A}throw new O("Unknown dimension symbol: "+e)}}]),l}();Y.P=0,Y.L=1,Y.A=2,Y.FALSE=-1,Y.TRUE=-2,Y.DONTCARE=-3,Y.SYM_FALSE="F",Y.SYM_TRUE="T",Y.SYM_DONTCARE="*",Y.SYM_P="0",Y.SYM_L="1",Y.SYM_A="2";var sr=function(){function l(){t(this,l)}return u(l,[{key:"filter",value:function(e){}}]),l}(),ar=function(){function l(){t(this,l)}return u(l,[{key:"filter",value:function(e,r){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}]),l}(),_n=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new we:this._points.expandEnvelope(new we)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new r(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var s=arguments[0],o=arguments[1];if(!this.isEquivalentClass(s))return!1;var f=s;if(this._points.size()!==f._points.size())return!1;for(var v=0;v<this._points.size();v++)if(!this.equal(this._points.getCoordinate(v),f._points.getCoordinate(v),o))return!1;return!0}return k(c(r.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var s=0;s<Math.trunc(this._points.size()/2);s++){var o=this._points.size()-1-s;if(!this._points.getCoordinate(s).equals(this._points.getCoordinate(o))){if(this._points.getCoordinate(s).compareTo(this._points.getCoordinate(o))>0){var f=this._points.copy();Ct.reverse(f),this._points=f}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?Y.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var s=this._points.copy();return Ct.reverse(s),this.getFactory().createLineString(s)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return V.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return Ru.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var s=arguments[0],o=s,f=0,v=0;f<this._points.size()&&v<o._points.size();){var y=this._points.getCoordinate(f).compareTo(o._points.getCoordinate(v));if(y!==0)return y;f++,v++}return f<this._points.size()?1:v<o._points.size()?-1:0}if(arguments.length===2){var _=arguments[0],E=arguments[1],M=_;return E.compare(this._points,M._points)}}},{key:"apply",value:function(){if(oe(arguments[0],ir))for(var s=arguments[0],o=0;o<this._points.size();o++)s.filter(this._points.getCoordinate(o));else if(oe(arguments[0],ar)){var f=arguments[0];if(this._points.size()===0)return null;for(var v=0;v<this._points.size()&&(f.filter(this._points,v),!f.isDone());v++);f.isGeometryChanged()&&this.geometryChanged()}else if(oe(arguments[0],sr)){var y=arguments[0];y.filter(this)}else if(oe(arguments[0],fe)){var _=arguments[0];_.filter(this)}}},{key:"getBoundary",value:function(){throw new ct}},{key:"isEquivalentClass",value:function(s){return s instanceof r}},{key:"getCoordinateN",value:function(s){return this._points.getCoordinate(s)}},{key:"getGeometryType",value:function(){return V.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(s){if(s===null&&(s=this.getFactory().getCoordinateSequenceFactory().create([])),s.size()===1)throw new O("Invalid number of points in LineString (found "+s.size()+" - must be 0 or >= 2)");this._points=s}},{key:"isCoordinate",value:function(s){for(var o=0;o<this._points.size();o++)if(this._points.getCoordinate(o).equals(s))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(s){return this.getFactory().createPoint(this._points.getCoordinate(s))}},{key:"interfaces_",get:function(){return[cs]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var s=arguments[0],o=arguments[1];V.constructor_.call(this,o),this.init(s)}}}}]),r}(V),fs=function l(){t(this,l)},Qr=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new we;var s=new we;return s.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),s}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new r(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var s=arguments[0],o=arguments[1];return!!this.isEquivalentClass(s)&&(!(!this.isEmpty()||!s.isEmpty())||this.isEmpty()===s.isEmpty()&&this.equal(s.getCoordinate(),this.getCoordinate(),o))}return k(c(r.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return Y.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return V.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var s=arguments[0],o=s;return this.getCoordinate().compareTo(o.getCoordinate())}if(arguments.length===2){var f=arguments[0],v=arguments[1],y=f;return v.compare(this._coordinates,y._coordinates)}}},{key:"apply",value:function(){if(oe(arguments[0],ir)){var s=arguments[0];if(this.isEmpty())return null;s.filter(this.getCoordinate())}else if(oe(arguments[0],ar)){var o=arguments[0];if(this.isEmpty())return null;o.filter(this._coordinates,0),o.isGeometryChanged()&&this.geometryChanged()}else if(oe(arguments[0],sr)){var f=arguments[0];f.filter(this)}else if(oe(arguments[0],fe)){var v=arguments[0];v.filter(this)}}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return V.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(s){s===null&&(s=this.getFactory().getCoordinateSequenceFactory().create([])),U.isTrue(s.size()<=1),this._coordinates=s}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[fs]}}],[{key:"constructor_",value:function(){this._coordinates=null;var s=arguments[0],o=arguments[1];V.constructor_.call(this,o),this.init(s)}}]),r}(V),gs=function(){function l(){t(this,l)}return u(l,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var e=arguments[0];return Math.abs(l.ofRingSigned(e))}if(oe(arguments[0],ge)){var r=arguments[0];return Math.abs(l.ofRingSigned(r))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var r=0,s=e[0].x,o=1;o<e.length-1;o++){var f=e[o].x-s,v=e[o+1].y,y=e[o-1].y;r+=f*(y-v)}return r/2}if(oe(arguments[0],ge)){var _=arguments[0],E=_.size();if(E<3)return 0;var M=new b,L=new b,T=new b;_.getCoordinate(0,L),_.getCoordinate(1,T);var B=L.x;T.x-=B;for(var F=0,$=1;$<E-1;$++)M.y=L.y,L.x=T.x,L.y=T.y,_.getCoordinate($+1,T),T.x-=B,F+=L.x*(M.y-T.y);return F/2}}}]),l}(),Tt=function(){function l(){t(this,l)}return u(l,null,[{key:"sort",value:function(){var e=arguments,r=arguments[0];if(arguments.length===1)r.sort(function(B,F){return B.compareTo(F)});else if(arguments.length===2)r.sort(function(B,F){return e[1].compare(B,F)});else if(arguments.length===3){var s=r.slice(arguments[1],arguments[2]);s.sort();var o=r.slice(0,arguments[1]).concat(s,r.slice(arguments[2],r.length));r.splice(0,r.length);var f,v=P(o);try{for(v.s();!(f=v.n()).done;){var y=f.value;r.push(y)}}catch(B){v.e(B)}finally{v.f()}}else if(arguments.length===4){var _=r.slice(arguments[1],arguments[2]);_.sort(function(B,F){return e[3].compare(B,F)});var E=r.slice(0,arguments[1]).concat(_,r.slice(arguments[2],r.length));r.splice(0,r.length);var M,L=P(E);try{for(L.s();!(M=L.n()).done;){var T=M.value;r.push(T)}}catch(B){L.e(B)}finally{L.f()}}}},{key:"asList",value:function(e){var r,s=new K,o=P(e);try{for(o.s();!(r=o.n()).done;){var f=r.value;s.add(f)}}catch(v){o.e(v)}finally{o.f()}return s}},{key:"copyOf",value:function(e,r){return e.slice(0,r)}}]),l}(),ds=function l(){t(this,l)},or=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var s=new Array(this.getNumPoints()).fill(null),o=-1,f=this._shell.getCoordinates(),v=0;v<f.length;v++)s[++o]=f[v];for(var y=0;y<this._holes.length;y++)for(var _=this._holes[y].getCoordinates(),E=0;E<_.length;E++)s[++o]=_[E];return s}},{key:"getArea",value:function(){var s=0;s+=gs.ofRing(this._shell.getCoordinateSequence());for(var o=0;o<this._holes.length;o++)s-=gs.ofRing(this._holes[o].getCoordinateSequence());return s}},{key:"copyInternal",value:function(){for(var s=this._shell.copy(),o=new Array(this._holes.length).fill(null),f=0;f<this._holes.length;f++)o[f]=this._holes[f].copy();return new r(s,o,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var s=this._shell.getCoordinateSequence(),o=this.getEnvelopeInternal(),f=0;f<5;f++){var v=s.getX(f);if(v!==o.getMinX()&&v!==o.getMaxX())return!1;var y=s.getY(f);if(y!==o.getMinY()&&y!==o.getMaxY())return!1}for(var _=s.getX(0),E=s.getY(0),M=1;M<=4;M++){var L=s.getX(M),T=s.getY(M);if(L!==_==(T!==E))return!1;_=L,E=T}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var s=arguments[0],o=arguments[1];if(!this.isEquivalentClass(s))return!1;var f=s,v=this._shell,y=f._shell;if(!v.equalsExact(y,o)||this._holes.length!==f._holes.length)return!1;for(var _=0;_<this._holes.length;_++)if(!this._holes[_].equalsExact(f._holes[_],o))return!1;return!0}return k(c(r.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var s=0;s<this._holes.length;s++)this._holes[s]=this.normalized(this._holes[s],!1);Tt.sort(this._holes)}else if(arguments.length===2){var o=arguments[0],f=arguments[1];if(o.isEmpty())return null;var v=o.getCoordinateSequence(),y=Ct.minCoordinateIndex(v,0,v.size()-2);Ct.scroll(v,y,!0),ee.isCCW(v)===f&&Ct.reverse(v)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var s=this.getExteriorRing().reverse(),o=new Array(this.getNumInteriorRing()).fill(null),f=0;f<o.length;f++)o[f]=this.getInteriorRingN(f).reverse();return this.getFactory().createPolygon(s,o)}},{key:"getTypeCode",value:function(){return V.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var s=0;s+=this._shell.getLength();for(var o=0;o<this._holes.length;o++)s+=this._holes[o].getLength();return s}},{key:"getNumPoints",value:function(){for(var s=this._shell.getNumPoints(),o=0;o<this._holes.length;o++)s+=this._holes[o].getNumPoints();return s}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(s,o){var f=s.copy();return this.normalize(f,o),f}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var s=arguments[0],o=this._shell,f=s._shell;return o.compareToSameClass(f)}if(arguments.length===2){var v=arguments[0],y=arguments[1],_=v,E=this._shell,M=_._shell,L=E.compareToSameClass(M,y);if(L!==0)return L;for(var T=this.getNumInteriorRing(),B=_.getNumInteriorRing(),F=0;F<T&&F<B;){var $=this.getInteriorRingN(F),W=_.getInteriorRingN(F),te=$.compareToSameClass(W,y);if(te!==0)return te;F++}return F<T?1:F<B?-1:0}}},{key:"apply",value:function(){if(oe(arguments[0],ir)){var s=arguments[0];this._shell.apply(s);for(var o=0;o<this._holes.length;o++)this._holes[o].apply(s)}else if(oe(arguments[0],ar)){var f=arguments[0];if(this._shell.apply(f),!f.isDone())for(var v=0;v<this._holes.length&&(this._holes[v].apply(f),!f.isDone());v++);f.isGeometryChanged()&&this.geometryChanged()}else if(oe(arguments[0],sr)){var y=arguments[0];y.filter(this)}else if(oe(arguments[0],fe)){var _=arguments[0];_.filter(this),this._shell.apply(_);for(var E=0;E<this._holes.length;E++)this._holes[E].apply(_)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var s=new Array(this._holes.length+1).fill(null);s[0]=this._shell;for(var o=0;o<this._holes.length;o++)s[o+1]=this._holes[o];return s.length<=1?this.getFactory().createLinearRing(s[0].getCoordinateSequence()):this.getFactory().createMultiLineString(s)}},{key:"getGeometryType",value:function(){return V.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(s){return this._holes[s]}},{key:"interfaces_",get:function(){return[ds]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var s=arguments[0],o=arguments[1],f=arguments[2];if(V.constructor_.call(this,f),s===null&&(s=this.getFactory().createLinearRing()),o===null&&(o=[]),V.hasNullElements(o))throw new O("holes must not contain null elements");if(s.isEmpty()&&V.hasNonEmptyElements(o))throw new O("shell is empty but holes are not");this._shell=s,this._holes=o}}]),r}(V),Au=function(l){h(r,l);var e=w(r);function r(){return t(this,r),e.apply(this,arguments)}return r}(os),vs=function(l){h(r,l);var e=w(r);function r(s){var o;return t(this,r),(o=e.call(this)).array=[],s instanceof tt&&o.addAll(s),o}return u(r,[{key:"contains",value:function(s){var o,f=P(this.array);try{for(f.s();!(o=f.n()).done;)if(o.value.compareTo(s)===0)return!0}catch(v){f.e(v)}finally{f.f()}return!1}},{key:"add",value:function(s){if(this.contains(s))return!1;for(var o=0,f=this.array.length;o<f;o++)if(this.array[o].compareTo(s)===1)return!!this.array.splice(o,0,s);return this.array.push(s),!0}},{key:"addAll",value:function(s){var o,f=P(s);try{for(f.s();!(o=f.n()).done;){var v=o.value;this.add(v)}}catch(y){f.e(y)}finally{f.f()}return!0}},{key:"remove",value:function(){throw new ct}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new Du(this.array)}}]),r}(Au),Du=function(){function l(e){t(this,l),this.array=e,this.position=0}return u(l,[{key:"next",value:function(){if(this.position===this.array.length)throw new $t;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new ct}}]),l}(),Je=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"computeEnvelopeInternal",value:function(){for(var s=new we,o=0;o<this._geometries.length;o++)s.expandToInclude(this._geometries[o].getEnvelopeInternal());return s}},{key:"getGeometryN",value:function(s){return this._geometries[s]}},{key:"getCoordinates",value:function(){for(var s=new Array(this.getNumPoints()).fill(null),o=-1,f=0;f<this._geometries.length;f++)for(var v=this._geometries[f].getCoordinates(),y=0;y<v.length;y++)s[++o]=v[y];return s}},{key:"getArea",value:function(){for(var s=0,o=0;o<this._geometries.length;o++)s+=this._geometries[o].getArea();return s}},{key:"copyInternal",value:function(){for(var s=new Array(this._geometries.length).fill(null),o=0;o<s.length;o++)s[o]=this._geometries[o].copy();return new r(s,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var s=arguments[0],o=arguments[1];if(!this.isEquivalentClass(s))return!1;var f=s;if(this._geometries.length!==f._geometries.length)return!1;for(var v=0;v<this._geometries.length;v++)if(!this._geometries[v].equalsExact(f._geometries[v],o))return!1;return!0}return k(c(r.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var s=0;s<this._geometries.length;s++)this._geometries[s].normalize();Tt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var s=Y.FALSE,o=0;o<this._geometries.length;o++)s=Math.max(s,this._geometries[o].getBoundaryDimension());return s}},{key:"reverseInternal",value:function(){for(var s=this._geometries.length,o=new K(s),f=0;f<s;f++)o.add(this._geometries[f].reverse());return this.getFactory().buildGeometry(o)}},{key:"getTypeCode",value:function(){return V.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var s=Y.FALSE,o=0;o<this._geometries.length;o++)s=Math.max(s,this._geometries[o].getDimension());return s}},{key:"getLength",value:function(){for(var s=0,o=0;o<this._geometries.length;o++)s+=this._geometries[o].getLength();return s}},{key:"getNumPoints",value:function(){for(var s=0,o=0;o<this._geometries.length;o++)s+=this._geometries[o].getNumPoints();return s}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var s=arguments[0],o=new vs(Tt.asList(this._geometries)),f=new vs(Tt.asList(s._geometries));return this.compare(o,f)}if(arguments.length===2){for(var v=arguments[0],y=arguments[1],_=v,E=this.getNumGeometries(),M=_.getNumGeometries(),L=0;L<E&&L<M;){var T=this.getGeometryN(L),B=_.getGeometryN(L),F=T.compareToSameClass(B,y);if(F!==0)return F;L++}return L<E?1:L<M?-1:0}}},{key:"apply",value:function(){if(oe(arguments[0],ir))for(var s=arguments[0],o=0;o<this._geometries.length;o++)this._geometries[o].apply(s);else if(oe(arguments[0],ar)){var f=arguments[0];if(this._geometries.length===0)return null;for(var v=0;v<this._geometries.length&&(this._geometries[v].apply(f),!f.isDone());v++);f.isGeometryChanged()&&this.geometryChanged()}else if(oe(arguments[0],sr)){var y=arguments[0];y.filter(this);for(var _=0;_<this._geometries.length;_++)this._geometries[_].apply(y)}else if(oe(arguments[0],fe)){var E=arguments[0];E.filter(this);for(var M=0;M<this._geometries.length;M++)this._geometries[M].apply(E)}}},{key:"getBoundary",value:function(){return V.checkNotGeometryCollection(this),U.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return V.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var s=0;s<this._geometries.length;s++)if(!this._geometries[s].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var s=arguments[0],o=arguments[1];if(V.constructor_.call(this,o),s===null&&(s=[]),V.hasNullElements(s))throw new O("geometries must not contain null elements");this._geometries=s}}}}]),r}(V),jr=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"copyInternal",value:function(){for(var s=new Array(this._geometries.length).fill(null),o=0;o<s.length;o++)s[o]=this._geometries[o].copy();return new r(s,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var s=arguments[0],o=arguments[1];return!!this.isEquivalentClass(s)&&k(c(r.prototype),"equalsExact",this).call(this,s,o)}return k(c(r.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var s=arguments[0];return this._geometries[s].getCoordinate()}return k(c(r.prototype),"getCoordinate",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return Y.FALSE}},{key:"getTypeCode",value:function(){return V.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return V.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[fs]}}],[{key:"constructor_",value:function(){var s=arguments[0],o=arguments[1];Je.constructor_.call(this,s,o)}}]),r}(Je),xn=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"copyInternal",value:function(){return new r(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return Y.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||k(c(r.prototype),"isClosed",this).call(this)}},{key:"reverseInternal",value:function(){var s=this._points.copy();return Ct.reverse(s),this.getFactory().createLinearRing(s)}},{key:"getTypeCode",value:function(){return V.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!k(c(r.prototype),"isClosed",this).call(this))throw new O("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<r.MINIMUM_VALID_SIZE)throw new O("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return V.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var s=arguments[0],o=arguments[1];_n.constructor_.call(this,s,o),this.validateConstruction()}}]),r}(_n);xn.MINIMUM_VALID_SIZE=4;var Ot=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"setOrdinate",value:function(s,o){switch(s){case r.X:this.x=o;break;case r.Y:this.y=o;break;default:throw new O("Invalid ordinate index: "+s)}}},{key:"getZ",value:function(){return b.NULL_ORDINATE}},{key:"getOrdinate",value:function(s){switch(s){case r.X:return this.x;case r.Y:return this.y}throw new O("Invalid ordinate index: "+s)}},{key:"setZ",value:function(s){throw new O("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new r(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(s){this.x=s.x,this.y=s.y,this.z=s.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)b.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof r){var s=arguments[0];b.constructor_.call(this,s.x,s.y)}else if(arguments[0]instanceof b){var o=arguments[0];b.constructor_.call(this,o.x,o.y)}}else if(arguments.length===2){var f=arguments[0],v=arguments[1];b.constructor_.call(this,f,v,b.NULL_ORDINATE)}}}]),r}(b);Ot.X=0,Ot.Y=1,Ot.Z=-1,Ot.M=-1;var Rt=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(s,o){switch(s){case r.X:this.x=o;break;case r.Y:this.y=o;break;case r.M:this._m=o;break;default:throw new O("Invalid ordinate index: "+s)}}},{key:"setM",value:function(s){this._m=s}},{key:"getZ",value:function(){return b.NULL_ORDINATE}},{key:"getOrdinate",value:function(s){switch(s){case r.X:return this.x;case r.Y:return this.y;case r.M:return this._m}throw new O("Invalid ordinate index: "+s)}},{key:"setZ",value:function(s){throw new O("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new r(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(s){this.x=s.x,this.y=s.y,this.z=s.getZ(),this._m=s.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)b.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof r){var s=arguments[0];b.constructor_.call(this,s.x,s.y),this._m=s._m}else if(arguments[0]instanceof b){var o=arguments[0];b.constructor_.call(this,o.x,o.y),this._m=this.getM()}}else if(arguments.length===3){var f=arguments[0],v=arguments[1],y=arguments[2];b.constructor_.call(this,f,v,b.NULL_ORDINATE),this._m=y}}}]),r}(b);Rt.X=0,Rt.Y=1,Rt.Z=-1,Rt.M=2;var ei=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(s,o){switch(s){case b.X:this.x=o;break;case b.Y:this.y=o;break;case b.Z:this.z=o;break;case b.M:this._m=o;break;default:throw new O("Invalid ordinate index: "+s)}}},{key:"setM",value:function(s){this._m=s}},{key:"getOrdinate",value:function(s){switch(s){case b.X:return this.x;case b.Y:return this.y;case b.Z:return this.getZ();case b.M:return this.getM()}throw new O("Invalid ordinate index: "+s)}},{key:"copy",value:function(){return new r(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(s){this.x=s.x,this.y=s.y,this.z=s.getZ(),this._m=s.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)b.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof r){var s=arguments[0];b.constructor_.call(this,s),this._m=s._m}else if(arguments[0]instanceof b){var o=arguments[0];b.constructor_.call(this,o),this._m=this.getM()}}else if(arguments.length===4){var f=arguments[0],v=arguments[1],y=arguments[2],_=arguments[3];b.constructor_.call(this,f,v,y),this._m=_}}}]),r}(b),ur=function(){function l(){t(this,l)}return u(l,null,[{key:"measures",value:function(e){return e instanceof Ot?0:e instanceof Rt||e instanceof ei?1:0}},{key:"dimension",value:function(e){return e instanceof Ot?2:e instanceof Rt?3:e instanceof ei?4:3}},{key:"create",value:function(){if(arguments.length===1){var e=arguments[0];return l.create(e,0)}if(arguments.length===2){var r=arguments[0],s=arguments[1];return r===2?new Ot:r===3&&s===0?new b:r===3&&s===1?new Rt:r===4&&s===1?new ei:new b}}}]),l}(),En=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"getCoordinate",value:function(s){return this.get(s)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&oe(arguments[0],tt)){for(var s=arguments[0],o=arguments[1],f=!1,v=s.iterator();v.hasNext();)this.add(v.next(),o),f=!0;return f}return k(c(r.prototype),"addAll",this).apply(this,arguments)}},{key:"clone",value:function(){for(var s=k(c(r.prototype),"clone",this).call(this),o=0;o<this.size();o++)s.add(o,this.get(o).clone());return s}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(r.coordArrayType);if(arguments.length===1){var s=arguments[0];if(s)return this.toArray(r.coordArrayType);for(var o=this.size(),f=new Array(o).fill(null),v=0;v<o;v++)f[v]=this.get(o-v-1);return f}}},{key:"add",value:function(){if(arguments.length===1){var s=arguments[0];return k(c(r.prototype),"add",this).call(this,s)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var o=arguments[0],f=arguments[1];return this.add(o,f,!0),!0}if(arguments[0]instanceof b&&typeof arguments[1]=="boolean"){var v=arguments[0],y=arguments[1];if(!y&&this.size()>=1){var _=this.get(this.size()-1);if(_.equals2D(v))return null}k(c(r.prototype),"add",this).call(this,v)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var E=arguments[0],M=arguments[1];return this.add(E,M),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var L=arguments[0],T=arguments[1],B=arguments[2];if(B)for(var F=0;F<L.length;F++)this.add(L[F],T);else for(var $=L.length-1;$>=0;$--)this.add(L[$],T);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof b){var W=arguments[0],te=arguments[1],Ee=arguments[2];if(!Ee){var be=this.size();if(be>0){if(W>0){var ze=this.get(W-1);if(ze.equals2D(te))return null}if(W<be){var je=this.get(W);if(je.equals2D(te))return null}}}k(c(r.prototype),"add",this).call(this,W,te)}}else if(arguments.length===4){var lt=arguments[0],Et=arguments[1],Ft=arguments[2],Mn=arguments[3],Pn=1;Ft>Mn&&(Pn=-1);for(var en=Ft;en!==Mn;en+=Pn)this.add(lt[en],Et);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var s=this.get(0).copy();this.add(s,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var s=arguments[0];this.ensureCapacity(s.length),this.add(s,!0)}else if(arguments.length===2){var o=arguments[0],f=arguments[1];this.ensureCapacity(o.length),this.add(o,f)}}}}]),r}(K);En.coordArrayType=new Array(0).fill(null);var qe=function(){function l(){t(this,l)}return u(l,null,[{key:"isRing",value:function(e){return!(e.length<4)&&!!e[0].equals2D(e[e.length-1])}},{key:"ptNotInList",value:function(e,r){for(var s=0;s<e.length;s++){var o=e[s];if(l.indexOf(o,r)<0)return o}return null}},{key:"scroll",value:function(e,r){var s=l.indexOf(r,e);if(s<0)return null;var o=new Array(e.length).fill(null);nt.arraycopy(e,s,o,0,e.length-s),nt.arraycopy(e,0,o,e.length-s,s),nt.arraycopy(o,0,e,0,e.length)}},{key:"equals",value:function(){if(arguments.length===2){var e=arguments[0],r=arguments[1];if(e===r)return!0;if(e===null||r===null||e.length!==r.length)return!1;for(var s=0;s<e.length;s++)if(!e[s].equals(r[s]))return!1;return!0}if(arguments.length===3){var o=arguments[0],f=arguments[1],v=arguments[2];if(o===f)return!0;if(o===null||f===null||o.length!==f.length)return!1;for(var y=0;y<o.length;y++)if(v.compare(o[y],f[y])!==0)return!1;return!0}}},{key:"intersection",value:function(e,r){for(var s=new En,o=0;o<e.length;o++)r.intersects(e[o])&&s.add(e[o],!0);return s.toCoordinateArray()}},{key:"measures",value:function(e){if(e===null||e.length===0)return 0;var r,s=0,o=P(e);try{for(o.s();!(r=o.n()).done;){var f=r.value;s=Math.max(s,ur.measures(f))}}catch(v){o.e(v)}finally{o.f()}return s}},{key:"hasRepeatedPoints",value:function(e){for(var r=1;r<e.length;r++)if(e[r-1].equals(e[r]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(e){return l.hasRepeatedPoints(e)?new En(e,!1).toCoordinateArray():e}},{key:"reverse",value:function(e){for(var r=e.length-1,s=Math.trunc(r/2),o=0;o<=s;o++){var f=e[o];e[o]=e[r-o],e[r-o]=f}}},{key:"removeNull",value:function(e){for(var r=0,s=0;s<e.length;s++)e[s]!==null&&r++;var o=new Array(r).fill(null);if(r===0)return o;for(var f=0,v=0;v<e.length;v++)e[v]!==null&&(o[f++]=e[v]);return o}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var e=arguments[0],r=new Array(e.length).fill(null),s=0;s<e.length;s++)r[s]=e[s].copy();return r}if(arguments.length===5)for(var o=arguments[0],f=arguments[1],v=arguments[2],y=arguments[3],_=arguments[4],E=0;E<_;E++)v[y+E]=o[f+E].copy()}},{key:"isEqualReversed",value:function(e,r){for(var s=0;s<e.length;s++){var o=e[s],f=r[e.length-s-1];if(o.compareTo(f)!==0)return!1}return!0}},{key:"envelope",value:function(e){for(var r=new we,s=0;s<e.length;s++)r.expandToInclude(e[s]);return r}},{key:"toCoordinateArray",value:function(e){return e.toArray(l.coordArrayType)}},{key:"dimension",value:function(e){if(e===null||e.length===0)return 3;var r,s=0,o=P(e);try{for(o.s();!(r=o.n()).done;){var f=r.value;s=Math.max(s,ur.dimension(f))}}catch(v){o.e(v)}finally{o.f()}return s}},{key:"atLeastNCoordinatesOrNothing",value:function(e,r){return r.length>=e?r:[]}},{key:"indexOf",value:function(e,r){for(var s=0;s<r.length;s++)if(e.equals(r[s]))return s;return-1}},{key:"increasingDirection",value:function(e){for(var r=0;r<Math.trunc(e.length/2);r++){var s=e.length-1-r,o=e[r].compareTo(e[s]);if(o!==0)return o}return 1}},{key:"compare",value:function(e,r){for(var s=0;s<e.length&&s<r.length;){var o=e[s].compareTo(r[s]);if(o!==0)return o;s++}return s<r.length?-1:s<e.length?1:0}},{key:"minCoordinate",value:function(e){for(var r=null,s=0;s<e.length;s++)(r===null||r.compareTo(e[s])>0)&&(r=e[s]);return r}},{key:"extract",value:function(e,r,s){r=pn.clamp(r,0,e.length);var o=(s=pn.clamp(s,-1,e.length))-r+1;s<0&&(o=0),r>=e.length&&(o=0),s<r&&(o=0);var f=new Array(o).fill(null);if(o===0)return f;for(var v=0,y=r;y<=s;y++)f[v++]=e[y];return f}}]),l}(),Fu=function(){function l(){t(this,l)}return u(l,[{key:"compare",value:function(e,r){var s=e,o=r;return qe.compare(s,o)}},{key:"interfaces_",get:function(){return[et]}}]),l}(),Bu=function(){function l(){t(this,l)}return u(l,[{key:"compare",value:function(e,r){var s=e,o=r;if(s.length<o.length)return-1;if(s.length>o.length)return 1;if(s.length===0)return 0;var f=qe.compare(s,o);return qe.isEqualReversed(s,o)?0:f}},{key:"OLDcompare",value:function(e,r){var s=e,o=r;if(s.length<o.length)return-1;if(s.length>o.length)return 1;if(s.length===0)return 0;for(var f=qe.increasingDirection(s),v=qe.increasingDirection(o),y=f>0?0:s.length-1,_=v>0?0:s.length-1,E=0;E<s.length;E++){var M=s[y].compareTo(o[_]);if(M!==0)return M;y+=f,_+=v}return 0}},{key:"interfaces_",get:function(){return[et]}}]),l}();qe.ForwardComparator=Fu,qe.BidirectionalComparator=Bu,qe.coordArrayType=new Array(0).fill(null);var lr=function(){function l(e){t(this,l),this.str=e}return u(l,[{key:"append",value:function(e){this.str+=e}},{key:"setCharAt",value:function(e,r){this.str=this.str.substr(0,e)+r+this.str.substr(e+1)}},{key:"toString",value:function(){return this.str}}]),l}(),wn=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getM",value:function(e){return this.hasM()?this._coordinates[e].getM():z.NaN}},{key:"setOrdinate",value:function(e,r,s){switch(r){case ge.X:this._coordinates[e].x=s;break;case ge.Y:this._coordinates[e].y=s;break;default:this._coordinates[e].setOrdinate(r,s)}}},{key:"getZ",value:function(e){return this.hasZ()?this._coordinates[e].getZ():z.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(e,r){switch(r){case ge.X:return this._coordinates[e].x;case ge.Y:return this._coordinates[e].y;default:return this._coordinates[e].getOrdinate(r)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var e=arguments[0];return this._coordinates[e]}if(arguments.length===2){var r=arguments[0],s=arguments[1];s.setCoordinate(this._coordinates[r])}}},{key:"getCoordinateCopy",value:function(e){var r=this.createCoordinate();return r.setCoordinate(this._coordinates[e]),r}},{key:"createCoordinate",value:function(){return ur.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(e){return this._coordinates[e].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(e){for(var r=0;r<this._coordinates.length;r++)e.expandToInclude(this._coordinates[r]);return e}},{key:"copy",value:function(){for(var e=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++){var s=this.createCoordinate();s.setCoordinate(this._coordinates[r]),e[r]=s}return new l(e,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var e=new lr(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var r=1;r<this._coordinates.length;r++)e.append(", "),e.append(this._coordinates[r]);return e.append(")"),e.toString()}return"()"}},{key:"getY",value:function(e){return this._coordinates[e].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[ge,H]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];l.constructor_.call(this,e,qe.dimension(e),qe.measures(e))}else if(Number.isInteger(arguments[0])){var r=arguments[0];this._coordinates=new Array(r).fill(null);for(var s=0;s<r;s++)this._coordinates[s]=new b}else if(oe(arguments[0],ge)){var o=arguments[0];if(o===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=o.getDimension(),this._measures=o.getMeasures(),this._coordinates=new Array(o.size()).fill(null);for(var f=0;f<this._coordinates.length;f++)this._coordinates[f]=o.getCoordinateCopy(f)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var v=arguments[0],y=arguments[1];l.constructor_.call(this,v,y,qe.measures(v))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var _=arguments[0],E=arguments[1];this._coordinates=new Array(_).fill(null),this._dimension=E;for(var M=0;M<_;M++)this._coordinates[M]=ur.create(E)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var L=arguments[0],T=arguments[1],B=arguments[2];this._dimension=T,this._measures=B,this._coordinates=L===null?new Array(0).fill(null):L}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var F=arguments[0],$=arguments[1],W=arguments[2];this._coordinates=new Array(F).fill(null),this._dimension=$,this._measures=W;for(var te=0;te<F;te++)this._coordinates[te]=this.createCoordinate()}}}}]),l}(),ti=function(){function l(){t(this,l)}return u(l,[{key:"readResolve",value:function(){return l.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return new wn(e)}if(oe(arguments[0],ge)){var r=arguments[0];return new wn(r)}}else{if(arguments.length===2){var s=arguments[0],o=arguments[1];return o>3&&(o=3),o<2&&(o=2),new wn(s,o)}if(arguments.length===3){var f=arguments[0],v=arguments[1],y=arguments[2],_=v-y;return y>1&&(y=1),_>3&&(_=3),_<2&&(_=2),new wn(f,_+y,y)}}}},{key:"interfaces_",get:function(){return[hs,H]}}],[{key:"instance",value:function(){return l.instanceObject}}]),l}();ti.instanceObject=new ti;var ni=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"copyInternal",value:function(){for(var s=new Array(this._geometries.length).fill(null),o=0;o<s.length;o++)s[o]=this._geometries[o].copy();return new r(s,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var s=arguments[0],o=arguments[1];return!!this.isEquivalentClass(s)&&k(c(r.prototype),"equalsExact",this).call(this,s,o)}return k(c(r.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return V.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var s=new K,o=0;o<this._geometries.length;o++)for(var f=this._geometries[o].getBoundary(),v=0;v<f.getNumGeometries();v++)s.add(f.getGeometryN(v));var y=new Array(s.size()).fill(null);return this.getFactory().createMultiLineString(s.toArray(y))}},{key:"getGeometryType",value:function(){return V.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[ds]}}],[{key:"constructor_",value:function(){var s=arguments[0],o=arguments[1];Je.constructor_.call(this,s,o)}}]),r}(Je),ms=function(){function l(){t(this,l)}return u(l,[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}]),l}(),qu=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),(s=e.call(this)).map=new Map,s}return u(r,[{key:"get",value:function(s){return this.map.get(s)||null}},{key:"put",value:function(s,o){return this.map.set(s,o),o}},{key:"values",value:function(){for(var s=new K,o=this.map.values(),f=o.next();!f.done;)s.add(f.value),f=o.next();return s}},{key:"entrySet",value:function(){var s=new Zr;return this.map.entries().forEach(function(o){return s.add(o)}),s}},{key:"size",value:function(){return this.map.size()}}]),r}(ms),ot=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"equals",value:function(e){if(!(e instanceof l))return!1;var r=e;return this._modelType===r._modelType&&this._scale===r._scale}},{key:"compareTo",value:function(e){var r=e,s=this.getMaximumSignificantDigits(),o=r.getMaximumSignificantDigits();return rr.compare(s,o)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===l.FLOATING||this._modelType===l.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var e="UNKNOWN";return this._modelType===l.FLOATING?e="Floating":this._modelType===l.FLOATING_SINGLE?e="Floating-Single":this._modelType===l.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var e=arguments[0];return z.isNaN(e)||this._modelType===l.FLOATING_SINGLE?e:this._modelType===l.FIXED?Math.round(e*this._scale)/this._scale:e}if(arguments[0]instanceof b){var r=arguments[0];if(this._modelType===l.FLOATING)return null;r.x=this.makePrecise(r.x),r.y=this.makePrecise(r.y)}}},{key:"getMaximumSignificantDigits",value:function(){var e=16;return this._modelType===l.FLOATING?e=16:this._modelType===l.FLOATING_SINGLE?e=6:this._modelType===l.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e}},{key:"setScale",value:function(e){this._scale=Math.abs(e)}},{key:"interfaces_",get:function(){return[H,X]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=l.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Ht){var e=arguments[0];this._modelType=e,e===l.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var r=arguments[0];this._modelType=l.FIXED,this.setScale(r)}else if(arguments[0]instanceof l){var s=arguments[0];this._modelType=s._modelType,this._scale=s._scale}}}},{key:"mostPrecise",value:function(e,r){return e.compareTo(r)>=0?e:r}}]),l}(),Ht=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"readResolve",value:function(){return l.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){this._name=null;var e=arguments[0];this._name=e,l.nameToTypeMap.put(e,this)}}]),l}();Ht.nameToTypeMap=new qu,ot.Type=Ht,ot.FIXED=new Ht("FIXED"),ot.FLOATING=new Ht("FLOATING"),ot.FLOATING_SINGLE=new Ht("FLOATING SINGLE"),ot.maximumPreciseValue=9007199254740992;var ri=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"copyInternal",value:function(){for(var s=new Array(this._geometries.length).fill(null),o=0;o<s.length;o++)s[o]=this._geometries[o].copy();return new r(s,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var s=arguments[0],o=arguments[1];return!!this.isEquivalentClass(s)&&k(c(r.prototype),"equalsExact",this).call(this,s,o)}return k(c(r.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?Y.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var s=0;s<this._geometries.length;s++)if(!this._geometries[s].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return V.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new ct}},{key:"getGeometryType",value:function(){return V.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[cs]}}],[{key:"constructor_",value:function(){var s=arguments[0],o=arguments[1];Je.constructor_.call(this,s,o)}}]),r}(Je),Zt=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"createEmpty",value:function(e){switch(e){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new O("Invalid dimension: "+e)}}},{key:"toGeometry",value:function(e){return e.isNull()?this.createPoint():e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new b(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new b(e.getMinX(),e.getMinY()),new b(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new b(e.getMinX(),e.getMinY()),new b(e.getMinX(),e.getMaxY()),new b(e.getMaxX(),e.getMaxY()),new b(e.getMaxX(),e.getMinY()),new b(e.getMinX(),e.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLineString(e!==null?this.getCoordinateSequenceFactory().create(e):null)}if(oe(arguments[0],ge)){var r=arguments[0];return new _n(r,this)}}}},{key:"createMultiLineString",value:function(){if(arguments.length===0)return new ri(null,this);if(arguments.length===1){var e=arguments[0];return new ri(e,this)}}},{key:"buildGeometry",value:function(e){for(var r=null,s=!1,o=!1,f=e.iterator();f.hasNext();){var v=f.next(),y=v.getTypeCode();r===null&&(r=y),y!==r&&(s=!0),v instanceof Je&&(o=!0)}if(r===null)return this.createGeometryCollection();if(s||o)return this.createGeometryCollection(l.toGeometryArray(e));var _=e.iterator().next();if(e.size()>1){if(_ instanceof or)return this.createMultiPolygon(l.toPolygonArray(e));if(_ instanceof _n)return this.createMultiLineString(l.toLineStringArray(e));if(_ instanceof Qr)return this.createMultiPoint(l.toPointArray(e));U.shouldNeverReachHere("Unhandled geometry type: "+_.getGeometryType())}return _}},{key:"createMultiPointFromCoords",value:function(e){return this.createMultiPoint(e!==null?this.getCoordinateSequenceFactory().create(e):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof b){var e=arguments[0];return this.createPoint(e!==null?this.getCoordinateSequenceFactory().create([e]):null)}if(oe(arguments[0],ge)){var r=arguments[0];return new Qr(r,this)}}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(oe(arguments[0],ge)){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Array){var r=arguments[0];return this.createPolygon(this.createLinearRing(r))}if(arguments[0]instanceof xn){var s=arguments[0];return this.createPolygon(s,null)}}else if(arguments.length===2){var o=arguments[0],f=arguments[1];return new or(o,f,this)}}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){if(arguments.length===0)return new Je(null,this);if(arguments.length===1){var e=arguments[0];return new Je(e,this)}}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(e!==null?this.getCoordinateSequenceFactory().create(e):null)}if(oe(arguments[0],ge)){var r=arguments[0];return new xn(r,this)}}}},{key:"createMultiPolygon",value:function(){if(arguments.length===0)return new ni(null,this);if(arguments.length===1){var e=arguments[0];return new ni(e,this)}}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new jr(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return new jr(e,this)}if(oe(arguments[0],ge)){var r=arguments[0];if(r===null)return this.createMultiPoint(new Array(0).fill(null));for(var s=new Array(r.size()).fill(null),o=0;o<r.size();o++){var f=this.getCoordinateSequenceFactory().create(1,r.getDimension(),r.getMeasures());Ct.copy(r,o,f,0,1),s[o]=this.createPoint(f)}return this.createMultiPoint(s)}}}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)l.constructor_.call(this,new ot,0);else if(arguments.length===1){if(oe(arguments[0],hs)){var e=arguments[0];l.constructor_.call(this,new ot,0,e)}else if(arguments[0]instanceof ot){var r=arguments[0];l.constructor_.call(this,r,0,l.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var s=arguments[0],o=arguments[1];l.constructor_.call(this,s,o,l.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var f=arguments[0],v=arguments[1],y=arguments[2];this._precisionModel=f,this._coordinateSequenceFactory=y,this._SRID=v}}},{key:"toMultiPolygonArray",value:function(e){var r=new Array(e.size()).fill(null);return e.toArray(r)}},{key:"toGeometryArray",value:function(e){if(e===null)return null;var r=new Array(e.size()).fill(null);return e.toArray(r)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return ti.instance()}},{key:"toMultiLineStringArray",value:function(e){var r=new Array(e.size()).fill(null);return e.toArray(r)}},{key:"toLineStringArray",value:function(e){var r=new Array(e.size()).fill(null);return e.toArray(r)}},{key:"toMultiPointArray",value:function(e){var r=new Array(e.size()).fill(null);return e.toArray(r)}},{key:"toLinearRingArray",value:function(e){var r=new Array(e.size()).fill(null);return e.toArray(r)}},{key:"toPointArray",value:function(e){var r=new Array(e.size()).fill(null);return e.toArray(r)}},{key:"toPolygonArray",value:function(e){var r=new Array(e.size()).fill(null);return e.toArray(r)}},{key:"createPointFromInternalCoord",value:function(e,r){return r.getPrecisionModel().makePrecise(e),r.getFactory().createPoint(e)}}]),l}(),ii="XY",Yu="XYZ",Xu="XYM",Gu="XYZM",ys={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},ps="EMPTY",hr=1,_t=2,Pt=3,_s=4,Wt=5,zu=6;for(var Uu in ys)ys[Uu].toUpperCase();var Vu=function(){function l(e){t(this,l),this.wkt=e,this.index_=-1}return u(l,[{key:"isAlpha_",value:function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}},{key:"isNumeric_",value:function(e,r){return e>="0"&&e<="9"||e=="."&&!(r!==void 0&&r)}},{key:"isWhiteSpace_",value:function(e){return e==" "||e=="	"||e=="\r"||e==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var e,r=this.nextChar_(),s=this.index_,o=r;if(r=="(")e=_t;else if(r==",")e=Wt;else if(r==")")e=Pt;else if(this.isNumeric_(r)||r=="-")e=_s,o=this.readNumber_();else if(this.isAlpha_(r))e=hr,o=this.readText_();else{if(this.isWhiteSpace_(r))return this.nextToken();if(r!=="")throw new Error("Unexpected character: "+r);e=zu}return{position:s,value:o,type:e}}},{key:"readNumber_",value:function(){var e,r=this.index_,s=!1,o=!1;do e=="."?s=!0:e!="e"&&e!="E"||(o=!0),e=this.nextChar_();while(this.isNumeric_(e,s)||!o&&(e=="e"||e=="E")||o&&(e=="-"||e=="+"));return parseFloat(this.wkt.substring(r,this.index_--))}},{key:"readText_",value:function(){var e,r=this.index_;do e=this.nextChar_();while(this.isAlpha_(e));return this.wkt.substring(r,this.index_--).toUpperCase()}}]),l}(),$u=function(){function l(e,r){t(this,l),this.lexer_=e,this.token_,this.layout_=ii,this.factory=r}return u(l,[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(e){return this.token_.type==e}},{key:"match",value:function(e){var r=this.isTokenType(e);return r&&this.consume_(),r}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var e=ii,r=this.token_;if(this.isTokenType(hr)){var s=r.value;s==="Z"?e=Yu:s==="M"?e=Xu:s==="ZM"&&(e=Gu),e!==ii&&this.consume_()}return e}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(_t)){var e=[];do e.push(this.parseGeometry_());while(this.match(Wt));if(this.match(Pt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(_t)){var e=this.parsePoint_();if(this.match(Pt))return e}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(_t)){var e=this.parsePointList_();if(this.match(Pt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(_t)){var e=this.parseLineStringTextList_();if(this.match(Pt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var e;if(this.match(_t)){if(e=this.token_.type==_t?this.parsePointTextList_():this.parsePointList_(),this.match(Pt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(_t)){var e=this.parseLineStringTextList_();if(this.match(Pt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(_t)){var e=this.parsePolygonTextList_();if(this.match(Pt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var e=[],r=this.layout_.length,s=0;s<r;++s){var o=this.token_;if(!this.match(_s))break;e.push(o.value)}if(e.length==r)return e;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var e=[this.parsePoint_()];this.match(Wt);)e.push(this.parsePoint_());return e}},{key:"parsePointTextList_",value:function(){for(var e=[this.parsePointText_()];this.match(Wt);)e.push(this.parsePointText_());return e}},{key:"parseLineStringTextList_",value:function(){for(var e=[this.parseLineStringText_()];this.match(Wt);)e.push(this.parseLineStringText_());return e}},{key:"parsePolygonTextList_",value:function(){for(var e=[this.parsePolygonText_()];this.match(Wt);)e.push(this.parsePolygonText_());return e}},{key:"isEmptyGeometry_",value:function(){var e=this.isTokenType(hr)&&this.token_.value==ps;return e&&this.consume_(),e}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var e=this.factory,r=function(W){return m(b,C(W))},s=function(W){var te=W.map(function(Ee){return e.createLinearRing(Ee.map(r))});return te.length>1?e.createPolygon(te[0],te.slice(1)):e.createPolygon(te[0])},o=this.token_;if(this.match(hr)){var f=o.value;if(this.layout_=this.parseGeometryLayout_(),f=="GEOMETRYCOLLECTION"){var v=this.parseGeometryCollectionText_();return e.createGeometryCollection(v)}switch(f){case"POINT":var y=this.parsePointText_();return y?e.createPoint(m(b,C(y))):e.createPoint();case"LINESTRING":var _=this.parseLineStringText_().map(r);return e.createLineString(_);case"LINEARRING":var E=this.parseLineStringText_().map(r);return e.createLinearRing(E);case"POLYGON":var M=this.parsePolygonText_();return M&&M.length!==0?s(M):e.createPolygon();case"MULTIPOINT":var L=this.parseMultiPointText_();if(!L||L.length===0)return e.createMultiPoint();var T=L.map(r).map(function(W){return e.createPoint(W)});return e.createMultiPoint(T);case"MULTILINESTRING":var B=this.parseMultiLineStringText_().map(function(W){return e.createLineString(W.map(r))});return e.createMultiLineString(B);case"MULTIPOLYGON":var F=this.parseMultiPolygonText_();if(!F||F.length===0)return e.createMultiPolygon();var $=F.map(s);return e.createMultiPolygon($);default:throw new Error("Invalid geometry type: "+f)}}throw new Error(this.formatErrorMessage_())}}]),l}();function xs(l){if(l.isEmpty())return"";var e=l.getCoordinate(),r=[e.x,e.y];return e.z===void 0||Number.isNaN(e.z)||r.push(e.z),e.m===void 0||Number.isNaN(e.m)||r.push(e.m),r.join(" ")}function kn(l){for(var e=l.getCoordinates().map(function(f){var v=[f.x,f.y];return f.z===void 0||Number.isNaN(f.z)||v.push(f.z),f.m===void 0||Number.isNaN(f.m)||v.push(f.m),v}),r=[],s=0,o=e.length;s<o;++s)r.push(e[s].join(" "));return r.join(", ")}function Es(l){var e=[];e.push("("+kn(l.getExteriorRing())+")");for(var r=0,s=l.getNumInteriorRing();r<s;++r)e.push("("+kn(l.getInteriorRingN(r))+")");return e.join(", ")}var Hu={Point:xs,LineString:kn,LinearRing:kn,Polygon:Es,MultiPoint:function(l){for(var e=[],r=0,s=l.getNumGeometries();r<s;++r)e.push("("+xs(l.getGeometryN(r))+")");return e.join(", ")},MultiLineString:function(l){for(var e=[],r=0,s=l.getNumGeometries();r<s;++r)e.push("("+kn(l.getGeometryN(r))+")");return e.join(", ")},MultiPolygon:function(l){for(var e=[],r=0,s=l.getNumGeometries();r<s;++r)e.push("("+Es(l.getGeometryN(r))+")");return e.join(", ")},GeometryCollection:function(l){for(var e=[],r=0,s=l.getNumGeometries();r<s;++r)e.push(ws(l.getGeometryN(r)));return e.join(", ")}};function ws(l){var e=l.getGeometryType(),r=Hu[e];e=e.toUpperCase();var s=function(o){var f="";if(o.isEmpty())return f;var v=o.getCoordinate();return v.z===void 0||Number.isNaN(v.z)||(f+="Z"),v.m===void 0||Number.isNaN(v.m)||(f+="M"),f}(l);return s.length>0&&(e+=" "+s),l.isEmpty()?e+" "+ps:e+" ("+r(l)+")"}var Zu=function(){function l(e){t(this,l),this.geometryFactory=e||new Zt,this.precisionModel=this.geometryFactory.getPrecisionModel()}return u(l,[{key:"read",value:function(e){var r=new Vu(e);return new $u(r,this.geometryFactory).parse()}},{key:"write",value:function(e){return ws(e)}}]),l}(),si=function(){function l(e){t(this,l),this.parser=new Zu(e)}return u(l,[{key:"write",value:function(e){return this.parser.write(e)}}],[{key:"toLineString",value:function(e,r){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+r.x+" "+r.y+" )"}}]),l}(),Se=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getIndexAlongSegment",value:function(e,r){return this.computeIntLineIndex(),this._intLineIndex[e][r]}},{key:"getTopologySummary",value:function(){var e=new lr;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()}},{key:"computeIntersection",value:function(e,r,s,o){this._inputLines[0][0]=e,this._inputLines[0][1]=r,this._inputLines[1][0]=s,this._inputLines[1][1]=o,this._result=this.computeIntersect(e,r,s,o)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var e=arguments[0],r=this.getEdgeDistance(e,0),s=this.getEdgeDistance(e,1);r>s?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(e){this._precisionModel=e}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var e=arguments[0],r=0;r<this._result;r++)if(!this._intPt[r].equals2D(this._inputLines[e][0])&&!this._intPt[r].equals2D(this._inputLines[e][1]))return!0;return!1}}},{key:"getIntersection",value:function(e){return this._intPt[e]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==l.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(e,r){return l.computeEdgeDistance(this._intPt[r],this._inputLines[e][0],this._inputLines[e][1])}},{key:"isCollinear",value:function(){return this._result===l.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return si.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+si.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(e,r){return this._inputLines[e][r]}},{key:"isIntersection",value:function(e){for(var r=0;r<this._result;r++)if(this._intPt[r].equals2D(e))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(e,r){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][r]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new b,this._intPt[1]=new b,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(e,r,s){var o=Math.abs(s.x-r.x),f=Math.abs(s.y-r.y),v=-1;if(e.equals(r))v=0;else if(e.equals(s))v=o>f?o:f;else{var y=Math.abs(e.x-r.x),_=Math.abs(e.y-r.y);(v=o>f?y:_)!==0||e.equals(r)||(v=Math.max(y,_))}return U.isTrue(!(v===0&&!e.equals(r)),"Bad distance calculation"),v}},{key:"nonRobustComputeEdgeDistance",value:function(e,r,s){var o=e.x-r.x,f=e.y-r.y,v=Math.sqrt(o*o+f*f);return U.isTrue(!(v===0&&!e.equals(r)),"Invalid distance calculation"),v}}]),l}();Se.DONT_INTERSECT=0,Se.DO_INTERSECT=1,Se.COLLINEAR=2,Se.NO_INTERSECTION=0,Se.POINT_INTERSECTION=1,Se.COLLINEAR_INTERSECTION=2;var At=function(l){h(r,l);var e=w(r);function r(){return t(this,r),e.call(this)}return u(r,[{key:"isInSegmentEnvelopes",value:function(s){var o=new we(this._inputLines[0][0],this._inputLines[0][1]),f=new we(this._inputLines[1][0],this._inputLines[1][1]);return o.contains(s)&&f.contains(s)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return k(c(r.prototype),"computeIntersection",this).apply(this,arguments);var s=arguments[0],o=arguments[1],f=arguments[2];if(this._isProper=!1,we.intersects(o,f,s)&&ee.index(o,f,s)===0&&ee.index(f,o,s)===0)return this._isProper=!0,(s.equals(o)||s.equals(f))&&(this._isProper=!1),this._result=Se.POINT_INTERSECTION,null;this._result=Se.NO_INTERSECTION}},{key:"intersection",value:function(s,o,f,v){var y=this.intersectionSafe(s,o,f,v);return this.isInSegmentEnvelopes(y)||(y=new b(r.nearestEndpoint(s,o,f,v))),this._precisionModel!==null&&this._precisionModel.makePrecise(y),y}},{key:"checkDD",value:function(s,o,f,v,y){var _=Jr.intersection(s,o,f,v),E=this.isInSegmentEnvelopes(_);nt.out.println("DD in env = "+E+"  --------------------- "+_),y.distance(_)>1e-4&&nt.out.println("Distance = "+y.distance(_))}},{key:"intersectionSafe",value:function(s,o,f,v){var y=Kr.intersection(s,o,f,v);return y===null&&(y=r.nearestEndpoint(s,o,f,v)),y}},{key:"computeCollinearIntersection",value:function(s,o,f,v){var y=we.intersects(s,o,f),_=we.intersects(s,o,v),E=we.intersects(f,v,s),M=we.intersects(f,v,o);return y&&_?(this._intPt[0]=f,this._intPt[1]=v,Se.COLLINEAR_INTERSECTION):E&&M?(this._intPt[0]=s,this._intPt[1]=o,Se.COLLINEAR_INTERSECTION):y&&E?(this._intPt[0]=f,this._intPt[1]=s,!f.equals(s)||_||M?Se.COLLINEAR_INTERSECTION:Se.POINT_INTERSECTION):y&&M?(this._intPt[0]=f,this._intPt[1]=o,!f.equals(o)||_||E?Se.COLLINEAR_INTERSECTION:Se.POINT_INTERSECTION):_&&E?(this._intPt[0]=v,this._intPt[1]=s,!v.equals(s)||y||M?Se.COLLINEAR_INTERSECTION:Se.POINT_INTERSECTION):_&&M?(this._intPt[0]=v,this._intPt[1]=o,!v.equals(o)||y||E?Se.COLLINEAR_INTERSECTION:Se.POINT_INTERSECTION):Se.NO_INTERSECTION}},{key:"computeIntersect",value:function(s,o,f,v){if(this._isProper=!1,!we.intersects(s,o,f,v))return Se.NO_INTERSECTION;var y=ee.index(s,o,f),_=ee.index(s,o,v);if(y>0&&_>0||y<0&&_<0)return Se.NO_INTERSECTION;var E=ee.index(f,v,s),M=ee.index(f,v,o);return E>0&&M>0||E<0&&M<0?Se.NO_INTERSECTION:y===0&&_===0&&E===0&&M===0?this.computeCollinearIntersection(s,o,f,v):(y===0||_===0||E===0||M===0?(this._isProper=!1,s.equals2D(f)||s.equals2D(v)?this._intPt[0]=s:o.equals2D(f)||o.equals2D(v)?this._intPt[0]=o:y===0?this._intPt[0]=new b(f):_===0?this._intPt[0]=new b(v):E===0?this._intPt[0]=new b(s):M===0&&(this._intPt[0]=new b(o))):(this._isProper=!0,this._intPt[0]=this.intersection(s,o,f,v)),Se.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(s,o,f,v){var y=s,_=ft.pointToSegment(s,f,v),E=ft.pointToSegment(o,f,v);return E<_&&(_=E,y=o),(E=ft.pointToSegment(f,s,o))<_&&(_=E,y=f),(E=ft.pointToSegment(v,s,o))<_&&(_=E,y=v),y}}]),r}(Se),Wu=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"countSegment",value:function(e,r){if(e.x<this._p.x&&r.x<this._p.x)return null;if(this._p.x===r.x&&this._p.y===r.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&r.y===this._p.y){var s=e.x,o=r.x;return s>o&&(s=r.x,o=e.x),this._p.x>=s&&this._p.x<=o&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&r.y<=this._p.y||r.y>this._p.y&&e.y<=this._p.y){var f=ee.index(e,r,this._p);if(f===ee.COLLINEAR)return this._isPointOnSegment=!0,null;r.y<e.y&&(f=-f),f===ee.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==N.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?N.BOUNDARY:this._crossingCount%2==1?N.INTERIOR:N.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var e=arguments[0];this._p=e}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof b&&oe(arguments[1],ge)){for(var e=arguments[0],r=arguments[1],s=new l(e),o=new b,f=new b,v=1;v<r.size();v++)if(r.getCoordinate(v,o),r.getCoordinate(v-1,f),s.countSegment(o,f),s.isOnSegment())return s.getLocation();return s.getLocation()}if(arguments[0]instanceof b&&arguments[1]instanceof Array){for(var y=arguments[0],_=arguments[1],E=new l(y),M=1;M<_.length;M++){var L=_[M],T=_[M-1];if(E.countSegment(L,T),E.isOnSegment())return E.getLocation()}return E.getLocation()}}}]),l}(),ai=function(){function l(){t(this,l)}return u(l,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof b&&oe(arguments[1],ge)){for(var e=arguments[0],r=arguments[1],s=new At,o=new b,f=new b,v=r.size(),y=1;y<v;y++)if(r.getCoordinate(y-1,o),r.getCoordinate(y,f),s.computeIntersection(e,o,f),s.hasIntersection())return!0;return!1}if(arguments[0]instanceof b&&arguments[1]instanceof Array){for(var _=arguments[0],E=arguments[1],M=new At,L=1;L<E.length;L++){var T=E[L-1],B=E[L];if(M.computeIntersection(_,T,B),M.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(e,r){return Wu.locatePointInRing(e,r)}},{key:"isInRing",value:function(e,r){return l.locateInRing(e,r)!==N.EXTERIOR}}]),l}(),rt=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"setAllLocations",value:function(e){for(var r=0;r<this.location.length;r++)this.location[r]=e}},{key:"isNull",value:function(){for(var e=0;e<this.location.length;e++)if(this.location[e]!==N.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(e){for(var r=0;r<this.location.length;r++)this.location[r]===N.NONE&&(this.location[r]=e)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(e){if(e.location.length>this.location.length){var r=new Array(3).fill(null);r[q.ON]=this.location[q.ON],r[q.LEFT]=N.NONE,r[q.RIGHT]=N.NONE,this.location=r}for(var s=0;s<this.location.length;s++)this.location[s]===N.NONE&&s<e.location.length&&(this.location[s]=e.location[s])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var e=this.location[q.LEFT];this.location[q.LEFT]=this.location[q.RIGHT],this.location[q.RIGHT]=e}},{key:"toString",value:function(){var e=new yn;return this.location.length>1&&e.append(N.toLocationSymbol(this.location[q.LEFT])),e.append(N.toLocationSymbol(this.location[q.ON])),this.location.length>1&&e.append(N.toLocationSymbol(this.location[q.RIGHT])),e.toString()}},{key:"setLocations",value:function(e,r,s){this.location[q.ON]=e,this.location[q.LEFT]=r,this.location[q.RIGHT]=s}},{key:"get",value:function(e){return e<this.location.length?this.location[e]:N.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var e=0;e<this.location.length;e++)if(this.location[e]===N.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var e=arguments[0];this.setLocation(q.ON,e)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.location[r]=s}}},{key:"init",value:function(e){this.location=new Array(e).fill(null),this.setAllLocations(N.NONE)}},{key:"isEqualOnSide",value:function(e,r){return this.location[r]===e.location[r]}},{key:"allPositionsEqual",value:function(e){for(var r=0;r<this.location.length;r++)if(this.location[r]!==e)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[q.ON]=r}else if(arguments[0]instanceof l){var s=arguments[0];if(this.init(s.location.length),s!==null)for(var o=0;o<this.location.length;o++)this.location[o]=s.location[o]}}else if(arguments.length===3){var f=arguments[0],v=arguments[1],y=arguments[2];this.init(3),this.location[q.ON]=f,this.location[q.LEFT]=v,this.location[q.RIGHT]=y}}}]),l}(),it=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getGeometryCount",value:function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e}},{key:"setAllLocations",value:function(e,r){this.elt[e].setAllLocations(r)}},{key:"isNull",value:function(e){return this.elt[e].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.elt[r].setAllLocationsIfNull(s)}}},{key:"isLine",value:function(e){return this.elt[e].isLine()}},{key:"merge",value:function(e){for(var r=0;r<2;r++)this.elt[r]===null&&e.elt[r]!==null?this.elt[r]=new rt(e.elt[r]):this.elt[r].merge(e.elt[r])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var e=arguments[0];return this.elt[e].get(q.ON)}if(arguments.length===2){var r=arguments[0],s=arguments[1];return this.elt[r].get(s)}}},{key:"toString",value:function(){var e=new yn;return this.elt[0]!==null&&(e.append("A:"),e.append(this.elt[0].toString())),this.elt[1]!==null&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var e=arguments[0];return this.elt[e].isArea()}}},{key:"isAnyNull",value:function(e){return this.elt[e].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var e=arguments[0],r=arguments[1];this.elt[e].setLocation(q.ON,r)}else if(arguments.length===3){var s=arguments[0],o=arguments[1],f=arguments[2];this.elt[s].setLocation(o,f)}}},{key:"isEqualOnSide",value:function(e,r){return this.elt[0].isEqualOnSide(e.elt[0],r)&&this.elt[1].isEqualOnSide(e.elt[1],r)}},{key:"allPositionsEqual",value:function(e,r){return this.elt[e].allPositionsEqual(r)}},{key:"toLine",value:function(e){this.elt[e].isArea()&&(this.elt[e]=new rt(this.elt[e].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new rt(e),this.elt[1]=new rt(e)}else if(arguments[0]instanceof l){var r=arguments[0];this.elt[0]=new rt(r.elt[0]),this.elt[1]=new rt(r.elt[1])}}else if(arguments.length===2){var s=arguments[0],o=arguments[1];this.elt[0]=new rt(N.NONE),this.elt[1]=new rt(N.NONE),this.elt[s].setLocation(o)}else if(arguments.length===3){var f=arguments[0],v=arguments[1],y=arguments[2];this.elt[0]=new rt(f,v,y),this.elt[1]=new rt(f,v,y)}else if(arguments.length===4){var _=arguments[0],E=arguments[1],M=arguments[2],L=arguments[3];this.elt[0]=new rt(N.NONE,N.NONE,N.NONE),this.elt[1]=new rt(N.NONE,N.NONE,N.NONE),this.elt[_].setLocations(E,M,L)}}},{key:"toLineLabel",value:function(e){for(var r=new l(N.NONE),s=0;s<2;s++)r.setLocation(s,e.getLocation(s));return r}}]),l}(),cr=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var e=new Array(this._pts.size()).fill(null),r=0;r<this._pts.size();r++)e[r]=this._pts.get(r);this._ring=this._geometryFactory.createLinearRing(e),this._isHole=ee.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(e){this._startDe=e;var r=e,s=!0;do{if(r===null)throw new pt("Found null DirectedEdge");if(r.getEdgeRing()===this)throw new pt("Directed Edge visited twice during ring-building at "+r.getCoordinate());this._edges.add(r);var o=r.getLabel();U.isTrue(o.isArea()),this.mergeLabel(o),this.addPoints(r.getEdge(),r.isForward(),s),s=!1,this.setEdgeRing(r,this),r=this.getNext(r)}while(r!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(e){return this._pts.get(e)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var e=this._startDe;do{var r=e.getNode().getEdges().getOutgoingDegree(this);r>this._maxNodeDegree&&(this._maxNodeDegree=r),e=this.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(e,r,s){var o=e.getCoordinates();if(r){var f=1;s&&(f=0);for(var v=f;v<o.length;v++)this._pts.add(o[v])}else{var y=o.length-2;s&&(y=o.length-1);for(var _=y;_>=0;_--)this._pts.add(o[_])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var e=this._startDe;do e.getEdge().setInResult(!0),e=e.getNext();while(e!==this._startDe)}},{key:"containsPoint",value:function(e){var r=this.getLinearRing();if(!r.getEnvelopeInternal().contains(e)||!ai.isInRing(e,r.getCoordinates()))return!1;for(var s=this._holes.iterator();s.hasNext();)if(s.next().containsPoint(e))return!1;return!0}},{key:"addHole",value:function(e){this._holes.add(e)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var e=arguments[0];this.mergeLabel(e,0),this.mergeLabel(e,1)}else if(arguments.length===2){var r=arguments[0],s=arguments[1],o=r.getLocation(s,q.RIGHT);if(o===N.NONE)return null;if(this._label.getLocation(s)===N.NONE)return this._label.setLocation(s,o),null}}},{key:"setShell",value:function(e){this._shell=e,e!==null&&e.addHole(this)}},{key:"toPolygon",value:function(e){for(var r=new Array(this._holes.size()).fill(null),s=0;s<this._holes.size();s++)r[s]=this._holes.get(s).getLinearRing();return e.createPolygon(this.getLinearRing(),r)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new K,this._pts=new K,this._label=new it(N.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new K,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var e=arguments[0],r=arguments[1];this._geometryFactory=r,this.computePoints(e),this.computeRing()}}}}]),l}(),Ju=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"setEdgeRing",value:function(s,o){s.setMinEdgeRing(o)}},{key:"getNext",value:function(s){return s.getNextMin()}}],[{key:"constructor_",value:function(){var s=arguments[0],o=arguments[1];cr.constructor_.call(this,s,o)}}]),r}(cr),Ku=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"buildMinimalRings",value:function(){var s=new K,o=this._startDe;do{if(o.getMinEdgeRing()===null){var f=new Ju(o,this._geometryFactory);s.add(f)}o=o.getNext()}while(o!==this._startDe);return s}},{key:"setEdgeRing",value:function(s,o){s.setEdgeRing(o)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var s=this._startDe;do s.getNode().getEdges().linkMinimalDirectedEdges(this),s=s.getNext();while(s!==this._startDe)}},{key:"getNext",value:function(s){return s.getNext()}}],[{key:"constructor_",value:function(){var s=arguments[0],o=arguments[1];cr.constructor_.call(this,s,o)}}]),r}(cr),ks=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"setVisited",value:function(e){this._isVisited=e}},{key:"setInResult",value:function(e){this._isInResult=e}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(e){this._label=e}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(e){this._isCovered=e,this._isCoveredSet=!0}},{key:"updateIM",value:function(e){U.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._label=e}}}}]),l}(),fr=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"isIncidentEdgeInResult",value:function(){for(var s=this.getEdges().getEdges().iterator();s.hasNext();)if(s.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(s){s.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(s){}},{key:"computeMergedLocation",value:function(s,o){var f=N.NONE;if(f=this._label.getLocation(o),!s.isNull(o)){var v=s.getLocation(o);f!==N.BOUNDARY&&(f=v)}return f}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return k(c(r.prototype),"setLabel",this).apply(this,arguments);var s=arguments[0],o=arguments[1];this._label===null?this._label=new it(s,o):this._label.setLocation(s,o)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof r){var s=arguments[0];this.mergeLabel(s._label)}else if(arguments[0]instanceof it)for(var o=arguments[0],f=0;f<2;f++){var v=this.computeMergedLocation(o,f),y=this._label.getLocation(f);y===N.NONE&&this._label.setLocation(f,v)}}},{key:"add",value:function(s){this._edges.insert(s),s.setNode(this)}},{key:"setLabelBoundary",value:function(s){if(this._label===null)return null;var o=N.NONE;this._label!==null&&(o=this._label.getLocation(s));var f=null;switch(o){case N.BOUNDARY:f=N.INTERIOR;break;case N.INTERIOR:default:f=N.BOUNDARY}this._label.setLocation(s,f)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var s=arguments[0],o=arguments[1];this._coord=s,this._edges=o,this._label=new it(0,N.NONE)}}]),r}(ks),Qu=function(l){h(r,l);var e=w(r);function r(){return t(this,r),e.apply(this,arguments)}return r}(ms);function Is(l){return l==null?0:l.color}function pe(l){return l==null?null:l.parent}function gt(l,e){l!==null&&(l.color=e)}function oi(l){return l==null?null:l.left}function Ns(l){return l==null?null:l.right}var In=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),(s=e.call(this)).root_=null,s.size_=0,s}return u(r,[{key:"get",value:function(s){for(var o=this.root_;o!==null;){var f=s.compareTo(o.key);if(f<0)o=o.left;else{if(!(f>0))return o.value;o=o.right}}return null}},{key:"put",value:function(s,o){if(this.root_===null)return this.root_={key:s,value:o,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var f,v,y=this.root_;do if(f=y,(v=s.compareTo(y.key))<0)y=y.left;else{if(!(v>0)){var _=y.value;return y.value=o,_}y=y.right}while(y!==null);var E={key:s,left:null,right:null,value:o,parent:f,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return v<0?f.left=E:f.right=E,this.fixAfterInsertion(E),this.size_++,null}},{key:"fixAfterInsertion",value:function(s){var o;for(s.color=1;s!=null&&s!==this.root_&&s.parent.color===1;)pe(s)===oi(pe(pe(s)))?Is(o=Ns(pe(pe(s))))===1?(gt(pe(s),0),gt(o,0),gt(pe(pe(s)),1),s=pe(pe(s))):(s===Ns(pe(s))&&(s=pe(s),this.rotateLeft(s)),gt(pe(s),0),gt(pe(pe(s)),1),this.rotateRight(pe(pe(s)))):Is(o=oi(pe(pe(s))))===1?(gt(pe(s),0),gt(o,0),gt(pe(pe(s)),1),s=pe(pe(s))):(s===oi(pe(s))&&(s=pe(s),this.rotateRight(s)),gt(pe(s),0),gt(pe(pe(s)),1),this.rotateLeft(pe(pe(s))));this.root_.color=0}},{key:"values",value:function(){var s=new K,o=this.getFirstEntry();if(o!==null)for(s.add(o.value);(o=r.successor(o))!==null;)s.add(o.value);return s}},{key:"entrySet",value:function(){var s=new Zr,o=this.getFirstEntry();if(o!==null)for(s.add(o);(o=r.successor(o))!==null;)s.add(o);return s}},{key:"rotateLeft",value:function(s){if(s!=null){var o=s.right;s.right=o.left,o.left!=null&&(o.left.parent=s),o.parent=s.parent,s.parent==null?this.root_=o:s.parent.left===s?s.parent.left=o:s.parent.right=o,o.left=s,s.parent=o}}},{key:"rotateRight",value:function(s){if(s!=null){var o=s.left;s.left=o.right,o.right!=null&&(o.right.parent=s),o.parent=s.parent,s.parent==null?this.root_=o:s.parent.right===s?s.parent.right=o:s.parent.left=o,o.right=s,s.parent=o}}},{key:"getFirstEntry",value:function(){var s=this.root_;if(s!=null)for(;s.left!=null;)s=s.left;return s}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(s){for(var o=this.root_;o!==null;){var f=s.compareTo(o.key);if(f<0)o=o.left;else{if(!(f>0))return!0;o=o.right}}return!1}}],[{key:"successor",value:function(s){var o;if(s===null)return null;if(s.right!==null){for(o=s.right;o.left!==null;)o=o.left;return o}o=s.parent;for(var f=s;o!==null&&f===o.right;)f=o,o=o.parent;return o}}]),r}(Qu),Ms=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"find",value:function(e){return this.nodeMap.get(e)}},{key:"addNode",value:function(){if(arguments[0]instanceof b){var e=arguments[0],r=this.nodeMap.get(e);return r===null&&(r=this.nodeFact.createNode(e),this.nodeMap.put(e,r)),r}if(arguments[0]instanceof fr){var s=arguments[0],o=this.nodeMap.get(s.getCoordinate());return o===null?(this.nodeMap.put(s.getCoordinate(),s),s):(o.mergeLabel(s),o)}}},{key:"print",value:function(e){for(var r=this.iterator();r.hasNext();)r.next().print(e)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(e){for(var r=new K,s=this.iterator();s.hasNext();){var o=s.next();o.getLabel().getLocation(e)===N.BOUNDARY&&r.add(o)}return r}},{key:"add",value:function(e){var r=e.getCoordinate();this.addNode(r).add(e)}}],[{key:"constructor_",value:function(){this.nodeMap=new In,this.nodeFact=null;var e=arguments[0];this.nodeFact=e}}]),l}(),$e=function(){function l(){t(this,l)}return u(l,null,[{key:"isNorthern",value:function(e){return e===l.NE||e===l.NW}},{key:"isOpposite",value:function(e,r){return e!==r&&(e-r+4)%4===2}},{key:"commonHalfPlane",value:function(e,r){if(e===r)return e;if((e-r+4)%4===2)return-1;var s=e<r?e:r;return s===0&&(e>r?e:r)===3?3:s}},{key:"isInHalfPlane",value:function(e,r){return r===l.SE?e===l.SE||e===l.SW:e===r||e===r+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],r=arguments[1];if(e===0&&r===0)throw new O("Cannot compute the quadrant for point ( "+e+", "+r+" )");return e>=0?r>=0?l.NE:l.SE:r>=0?l.NW:l.SW}if(arguments[0]instanceof b&&arguments[1]instanceof b){var s=arguments[0],o=arguments[1];if(o.x===s.x&&o.y===s.y)throw new O("Cannot compute the quadrant for two identical points "+s);return o.x>=s.x?o.y>=s.y?l.NE:l.SE:o.y>=s.y?l.NW:l.SW}}}]),l}();$e.NE=0,$e.NW=1,$e.SW=2,$e.SE=3;var Ps=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"compareDirection",value:function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:ee.index(e._p0,e._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(e){this._node=e}},{key:"print",value:function(e){var r=Math.atan2(this._dy,this._dx),s=this.getClass().getName(),o=s.lastIndexOf("."),f=s.substring(o+1);e.print("  "+f+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+r+"   "+this._label)}},{key:"compareTo",value:function(e){var r=e;return this.compareDirection(r)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var e=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),s=r.lastIndexOf(".");return"  "+r.substring(s+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label}},{key:"computeLabel",value:function(e){}},{key:"init",value:function(e,r){this._p0=e,this._p1=r,this._dx=r.x-e.x,this._dy=r.y-e.y,this._quadrant=$e.quadrant(this._dx,this._dy),U.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var e=arguments[0];this._edge=e}else if(arguments.length===3){var r=arguments[0],s=arguments[1],o=arguments[2];l.constructor_.call(this,r,s,o,null)}else if(arguments.length===4){var f=arguments[0],v=arguments[1],y=arguments[2],_=arguments[3];l.constructor_.call(this,f),this.init(v,y),this._label=_}}}]),l}(),ui=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(s){return this._depth[s]}},{key:"setVisited",value:function(s){this._isVisited=s}},{key:"computeDirectedLabel",value:function(){this._label=new it(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(s,o){if(this._depth[s]!==-999&&this._depth[s]!==o)throw new pt("assigned depths do not match",this.getCoordinate());this._depth[s]=o}},{key:"isInteriorAreaEdge",value:function(){for(var s=!0,o=0;o<2;o++)this._label.isArea(o)&&this._label.getLocation(o,q.LEFT)===N.INTERIOR&&this._label.getLocation(o,q.RIGHT)===N.INTERIOR||(s=!1);return s}},{key:"setNextMin",value:function(s){this._nextMin=s}},{key:"print",value:function(s){k(c(r.prototype),"print",this).call(this,s),s.print(" "+this._depth[q.LEFT]+"/"+this._depth[q.RIGHT]),s.print(" ("+this.getDepthDelta()+")"),this._isInResult&&s.print(" inResult")}},{key:"setMinEdgeRing",value:function(s){this._minEdgeRing=s}},{key:"isLineEdge",value:function(){var s=this._label.isLine(0)||this._label.isLine(1),o=!this._label.isArea(0)||this._label.allPositionsEqual(0,N.EXTERIOR),f=!this._label.isArea(1)||this._label.allPositionsEqual(1,N.EXTERIOR);return s&&o&&f}},{key:"setEdgeRing",value:function(s){this._edgeRing=s}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var s=this._edge.getDepthDelta();return this._isForward||(s=-s),s}},{key:"setInResult",value:function(s){this._isInResult=s}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(s){this.print(s),s.print(" "),this._isForward?this._edge.print(s):this._edge.printReverse(s)}},{key:"setSym",value:function(s){this._sym=s}},{key:"setVisitedEdge",value:function(s){this.setVisited(s),this._sym.setVisited(s)}},{key:"setEdgeDepths",value:function(s,o){var f=this.getEdge().getDepthDelta();this._isForward||(f=-f);var v=1;s===q.LEFT&&(v=-1);var y=q.opposite(s),_=o+f*v;this.setDepth(s,o),this.setDepth(y,_)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(s){this._next=s}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var s=arguments[0],o=arguments[1];if(Ps.constructor_.call(this,s),this._isForward=o,o)this.init(s.getCoordinate(0),s.getCoordinate(1));else{var f=s.getNumPoints()-1;this.init(s.getCoordinate(f),s.getCoordinate(f-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(s,o){return s===N.EXTERIOR&&o===N.INTERIOR?1:s===N.INTERIOR&&o===N.EXTERIOR?-1:0}}]),r}(Ps),Ls=function(){function l(){t(this,l)}return u(l,[{key:"createNode",value:function(e){return new fr(e,null)}}]),l}(),Ss=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"printEdges",value:function(e){e.println("Edges:");for(var r=0;r<this._edges.size();r++){e.println("edge "+r+":");var s=this._edges.get(r);s.print(e),s.eiList.print(e)}}},{key:"find",value:function(e){return this._nodes.find(e)}},{key:"addNode",value:function(){if(arguments[0]instanceof fr){var e=arguments[0];return this._nodes.addNode(e)}if(arguments[0]instanceof b){var r=arguments[0];return this._nodes.addNode(r)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(e){nt.out.println(e)}},{key:"isBoundaryNode",value:function(e,r){var s=this._nodes.find(r);if(s===null)return!1;var o=s.getLabel();return o!==null&&o.getLocation(e)===N.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(e,r,s,o){return!!e.equals(s)&&ee.index(e,r,o)===ee.COLLINEAR&&$e.quadrant(e,r)===$e.quadrant(s,o)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(e){nt.out.print(e)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(e,r){for(var s=0;s<this._edges.size();s++){var o=this._edges.get(s),f=o.getCoordinates();if(this.matchInSameDirection(e,r,f[0],f[1])||this.matchInSameDirection(e,r,f[f.length-1],f[f.length-2]))return o}return null}},{key:"insertEdge",value:function(e){this._edges.add(e)}},{key:"findEdgeEnd",value:function(e){for(var r=this.getEdgeEnds().iterator();r.hasNext();){var s=r.next();if(s.getEdge()===e)return s}return null}},{key:"addEdges",value:function(e){for(var r=e.iterator();r.hasNext();){var s=r.next();this._edges.add(s);var o=new ui(s,!0),f=new ui(s,!1);o.setSym(f),f.setSym(o),this.add(o),this.add(f)}}},{key:"add",value:function(e){this._nodes.add(e),this._edgeEndList.add(e)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(e,r){for(var s=0;s<this._edges.size();s++){var o=this._edges.get(s),f=o.getCoordinates();if(e.equals(f[0])&&r.equals(f[1]))return o}return null}}],[{key:"constructor_",value:function(){if(this._edges=new K,this._nodes=null,this._edgeEndList=new K,arguments.length===0)this._nodes=new Ms(new Ls);else if(arguments.length===1){var e=arguments[0];this._nodes=new Ms(e)}}},{key:"linkResultDirectedEdges",value:function(e){for(var r=e.iterator();r.hasNext();)r.next().getEdges().linkResultDirectedEdges()}}]),l}(),ju=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"sortShellsAndHoles",value:function(e,r,s){for(var o=e.iterator();o.hasNext();){var f=o.next();f.isHole()?s.add(f):r.add(f)}}},{key:"computePolygons",value:function(e){for(var r=new K,s=e.iterator();s.hasNext();){var o=s.next().toPolygon(this._geometryFactory);r.add(o)}return r}},{key:"placeFreeHoles",value:function(e,r){for(var s=r.iterator();s.hasNext();){var o=s.next();if(o.getShell()===null){var f=l.findEdgeRingContaining(o,e);if(f===null)throw new pt("unable to assign hole to a shell",o.getCoordinate(0));o.setShell(f)}}}},{key:"buildMinimalEdgeRings",value:function(e,r,s){for(var o=new K,f=e.iterator();f.hasNext();){var v=f.next();if(v.getMaxNodeDegree()>2){v.linkDirectedEdgesForMinimalEdgeRings();var y=v.buildMinimalRings(),_=this.findShell(y);_!==null?(this.placePolygonHoles(_,y),r.add(_)):s.addAll(y)}else o.add(v)}return o}},{key:"buildMaximalEdgeRings",value:function(e){for(var r=new K,s=e.iterator();s.hasNext();){var o=s.next();if(o.isInResult()&&o.getLabel().isArea()&&o.getEdgeRing()===null){var f=new Ku(o,this._geometryFactory);r.add(f),f.setInResult()}}return r}},{key:"placePolygonHoles",value:function(e,r){for(var s=r.iterator();s.hasNext();){var o=s.next();o.isHole()&&o.setShell(e)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(e){for(var r=0,s=null,o=e.iterator();o.hasNext();){var f=o.next();f.isHole()||(s=f,r++)}return U.isTrue(r<=1,"found two shells in MinimalEdgeRing list"),s}},{key:"add",value:function(){if(arguments.length===1){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(arguments.length===2){var r=arguments[0],s=arguments[1];Ss.linkResultDirectedEdges(s);var o=this.buildMaximalEdgeRings(r),f=new K,v=this.buildMinimalEdgeRings(o,this._shellList,f);this.sortShellsAndHoles(v,this._shellList,f),this.placeFreeHoles(this._shellList,f)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new K;var e=arguments[0];this._geometryFactory=e}},{key:"findEdgeRingContaining",value:function(e,r){for(var s=e.getLinearRing(),o=s.getEnvelopeInternal(),f=s.getCoordinateN(0),v=null,y=null,_=r.iterator();_.hasNext();){var E=_.next(),M=E.getLinearRing(),L=M.getEnvelopeInternal();if(!L.equals(o)&&L.contains(o)){f=qe.ptNotInList(s.getCoordinates(),M.getCoordinates());var T=!1;ai.isInRing(f,M.getCoordinates())&&(T=!0),T&&(v===null||y.contains(L))&&(y=(v=E).getLinearRing().getEnvelopeInternal())}}return v}}]),l}(),bs=function(){function l(){t(this,l)}return u(l,[{key:"getBounds",value:function(){}}]),l}(),xt=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[bs,H]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var e=arguments[0],r=arguments[1];this._bounds=e,this._item=r}}]),l}(),gr=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"poll",value:function(){if(this.isEmpty())return null;var e=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),e}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(e){for(var r=null,s=this._items.get(e);2*e<=this._size&&((r=2*e)!==this._size&&this._items.get(r+1).compareTo(this._items.get(r))<0&&r++,this._items.get(r).compareTo(s)<0);e=r)this._items.set(e,this._items.get(r));this._items.set(e,s)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(e){this._items.add(null),this._size+=1;var r=this._size;for(this._items.set(0,e);e.compareTo(this._items.get(Math.trunc(r/2)))<0;r/=2)this._items.set(r,this._items.get(Math.trunc(r/2)));this._items.set(r,e)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new K,this._items.add(null)}}]),l}(),el=function(){function l(){t(this,l)}return u(l,[{key:"insert",value:function(e,r){}},{key:"remove",value:function(e,r){}},{key:"query",value:function(){}}]),l}(),st=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(e){U.isTrue(this._bounds===null),this._childBoundables.add(e)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[bs,H]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new K,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._level=e}}}}]),l}(),Jt={reverseOrder:function(){return{compare:function(l,e){return e.compareTo(l)}}},min:function(l){return Jt.sort(l),l.get(0)},sort:function(l,e){var r=l.toArray();e?Tt.sort(r,e):Tt.sort(r);for(var s=l.iterator(),o=0,f=r.length;o<f;o++)s.next(),s.set(r[o])},singletonList:function(l){var e=new K;return e.add(l),e}},tl=function(){function l(){t(this,l)}return u(l,null,[{key:"maxDistance",value:function(e,r,s,o,f,v,y,_){var E=l.distance(e,r,f,v);return E=Math.max(E,l.distance(e,r,y,_)),E=Math.max(E,l.distance(s,o,f,v)),E=Math.max(E,l.distance(s,o,y,_))}},{key:"distance",value:function(e,r,s,o){var f=s-e,v=o-r;return Math.sqrt(f*f+v*v)}},{key:"maximumDistance",value:function(e,r){var s=Math.min(e.getMinX(),r.getMinX()),o=Math.min(e.getMinY(),r.getMinY()),f=Math.max(e.getMaxX(),r.getMaxX()),v=Math.max(e.getMaxY(),r.getMaxY());return l.distance(s,o,f,v)}},{key:"minMaxDistance",value:function(e,r){var s=e.getMinX(),o=e.getMinY(),f=e.getMaxX(),v=e.getMaxY(),y=r.getMinX(),_=r.getMinY(),E=r.getMaxX(),M=r.getMaxY(),L=l.maxDistance(s,o,s,v,y,_,y,M);return L=Math.min(L,l.maxDistance(s,o,s,v,y,_,E,_)),L=Math.min(L,l.maxDistance(s,o,s,v,E,M,y,M)),L=Math.min(L,l.maxDistance(s,o,s,v,E,M,E,_)),L=Math.min(L,l.maxDistance(s,o,f,o,y,_,y,M)),L=Math.min(L,l.maxDistance(s,o,f,o,y,_,E,_)),L=Math.min(L,l.maxDistance(s,o,f,o,E,M,y,M)),L=Math.min(L,l.maxDistance(s,o,f,o,E,M,E,_)),L=Math.min(L,l.maxDistance(f,v,s,v,y,_,y,M)),L=Math.min(L,l.maxDistance(f,v,s,v,y,_,E,_)),L=Math.min(L,l.maxDistance(f,v,s,v,E,M,y,M)),L=Math.min(L,l.maxDistance(f,v,s,v,E,M,E,_)),L=Math.min(L,l.maxDistance(f,v,f,o,y,_,y,M)),L=Math.min(L,l.maxDistance(f,v,f,o,y,_,E,_)),L=Math.min(L,l.maxDistance(f,v,f,o,E,M,y,M)),L=Math.min(L,l.maxDistance(f,v,f,o,E,M,E,_))}}]),l}(),Kt=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"maximumDistance",value:function(){return tl.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(e,r){var s=l.isComposite(this._boundable1),o=l.isComposite(this._boundable2);if(s&&o)return l.area(this._boundable1)>l.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,e,r),null):(this.expand(this._boundable2,this._boundable1,!0,e,r),null);if(s)return this.expand(this._boundable1,this._boundable2,!1,e,r),null;if(o)return this.expand(this._boundable2,this._boundable1,!0,e,r),null;throw new O("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(l.isComposite(this._boundable1)||l.isComposite(this._boundable2))}},{key:"compareTo",value:function(e){var r=e;return this._distance<r._distance?-1:this._distance>r._distance?1:0}},{key:"expand",value:function(e,r,s,o,f){for(var v=e.getChildBoundables().iterator();v.hasNext();){var y=v.next(),_=null;(_=s?new l(r,y,this._itemDistance):new l(y,r,this._itemDistance)).getDistance()<f&&o.add(_)}}},{key:"getBoundable",value:function(e){return e===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var e=arguments[0],r=arguments[1],s=arguments[2];this._boundable1=e,this._boundable2=r,this._itemDistance=s,this._distance=this.distance()}},{key:"area",value:function(e){return e.getBounds().getArea()}},{key:"isComposite",value:function(e){return e instanceof st}}]),l}(),Cs=function(){function l(){t(this,l)}return u(l,[{key:"visitItem",value:function(e){}}]),l}(),Qt=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"queryInternal",value:function(){if(oe(arguments[2],Cs)&&arguments[0]instanceof Object&&arguments[1]instanceof st)for(var e=arguments[0],r=arguments[1],s=arguments[2],o=r.getChildBoundables(),f=0;f<o.size();f++){var v=o.get(f);this.getIntersectsOp().intersects(v.getBounds(),e)&&(v instanceof st?this.queryInternal(e,v,s):v instanceof xt?s.visitItem(v.getItem()):U.shouldNeverReachHere())}else if(oe(arguments[2],bt)&&arguments[0]instanceof Object&&arguments[1]instanceof st)for(var y=arguments[0],_=arguments[1],E=arguments[2],M=_.getChildBoundables(),L=0;L<M.size();L++){var T=M.get(L);this.getIntersectsOp().intersects(T.getBounds(),y)&&(T instanceof st?this.queryInternal(y,T,E):T instanceof xt?E.add(T.getItem()):U.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(e){return e.get(e.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var e=arguments[0],r=0,s=e.getChildBoundables().iterator();s.hasNext();){var o=s.next();o instanceof st?r+=this.size(o):o instanceof xt&&(r+=1)}return r}}},{key:"removeItem",value:function(e,r){for(var s=null,o=e.getChildBoundables().iterator();o.hasNext();){var f=o.next();f instanceof xt&&f.getItem()===r&&(s=f)}return s!==null&&(e.getChildBoundables().remove(s),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var e=this.itemsTree(this._root);return e===null?new K:e}if(arguments.length===1){for(var r=arguments[0],s=new K,o=r.getChildBoundables().iterator();o.hasNext();){var f=o.next();if(f instanceof st){var v=this.itemsTree(f);v!==null&&s.add(v)}else f instanceof xt?s.add(f.getItem()):U.shouldNeverReachHere()}return s.size()<=0?null:s}}},{key:"insert",value:function(e,r){U.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new xt(e,r))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var e=arguments[0],r=new K;return this.boundablesAtLevel(e,this._root,r),r}if(arguments.length===3){var s=arguments[0],o=arguments[1],f=arguments[2];if(U.isTrue(s>-2),o.getLevel()===s)return f.add(o),null;for(var v=o.getChildBoundables().iterator();v.hasNext();){var y=v.next();y instanceof st?this.boundablesAtLevel(s,y,f):(U.isTrue(y instanceof xt),s===-1&&f.add(y))}return null}}},{key:"query",value:function(){if(arguments.length===1){var e=arguments[0];this.build();var r=new K;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.queryInternal(e,this._root,r),r}if(arguments.length===2){var s=arguments[0],o=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),s)&&this.queryInternal(s,this._root,o)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var e=arguments[0],r=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,r)}if(arguments.length===3){var s=arguments[0],o=arguments[1],f=arguments[2],v=this.removeItem(o,f);if(v)return!0;for(var y=null,_=o.getChildBoundables().iterator();_.hasNext();){var E=_.next();if(this.getIntersectsOp().intersects(E.getBounds(),s)&&E instanceof st&&(v=this.remove(s,E,f))){y=E;break}}return y!==null&&y.getChildBoundables().isEmpty()&&o.getChildBoundables().remove(y),v}}},{key:"createHigherLevels",value:function(e,r){U.isTrue(!e.isEmpty());var s=this.createParentBoundables(e,r+1);return s.size()===1?s.get(0):this.createHigherLevels(s,r+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var e=arguments[0],r=0,s=e.getChildBoundables().iterator();s.hasNext();){var o=s.next();if(o instanceof st){var f=this.depth(o);f>r&&(r=f)}}return r+1}}},{key:"createParentBoundables",value:function(e,r){U.isTrue(!e.isEmpty());var s=new K;s.add(this.createNode(r));var o=new K(e);Jt.sort(o,this.getComparator());for(var f=o.iterator();f.hasNext();){var v=f.next();this.lastNode(s).getChildBoundables().size()===this.getNodeCapacity()&&s.add(this.createNode(r)),this.lastNode(s).addChildBoundable(v)}return s}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[H]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new K,this._nodeCapacity=null,arguments.length===0)l.constructor_.call(this,l.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var e=arguments[0];U.isTrue(e>1,"Node capacity must be greater than 1"),this._nodeCapacity=e}}},{key:"compareDoubles",value:function(e,r){return e>r?1:e<r?-1:0}}]),l}();Qt.IntersectsOp=function(){},Qt.DEFAULT_NODE_CAPACITY=10;var nl=function(){function l(){t(this,l)}return u(l,[{key:"distance",value:function(e,r){}}]),l}(),dt=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"createParentBoundablesFromVerticalSlices",value:function(s,o){U.isTrue(s.length>0);for(var f=new K,v=0;v<s.length;v++)f.addAll(this.createParentBoundablesFromVerticalSlice(s[v],o));return f}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var s=arguments[0],o=arguments[1];return this.nearestNeighbourK(s,z.POSITIVE_INFINITY,o)}if(arguments.length===3){var f=arguments[0],v=arguments[1],y=arguments[2],_=v,E=new gr;E.add(f);for(var M=new gr;!E.isEmpty()&&_>=0;){var L=E.poll(),T=L.getDistance();if(T>=_)break;if(L.isLeaves())if(M.size()<y)M.add(L);else{var B=M.peek();B.getDistance()>T&&(M.poll(),M.add(L));var F=M.peek();_=F.getDistance()}else L.expandToQueue(E,_)}return r.getItems(M)}}},{key:"createNode",value:function(s){return new Ts(s)}},{key:"size",value:function(){return arguments.length===0?k(c(r.prototype),"size",this).call(this):k(c(r.prototype),"size",this).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof we))return k(c(r.prototype),"insert",this).apply(this,arguments);var s=arguments[0],o=arguments[1];if(s.isNull())return null;k(c(r.prototype),"insert",this).call(this,s,o)}},{key:"getIntersectsOp",value:function(){return r.intersectsOp}},{key:"verticalSlices",value:function(s,o){for(var f=Math.trunc(Math.ceil(s.size()/o)),v=new Array(o).fill(null),y=s.iterator(),_=0;_<o;_++){v[_]=new K;for(var E=0;y.hasNext()&&E<f;){var M=y.next();v[_].add(M),E++}}return v}},{key:"query",value:function(){if(arguments.length===1){var s=arguments[0];return k(c(r.prototype),"query",this).call(this,s)}if(arguments.length===2){var o=arguments[0],f=arguments[1];k(c(r.prototype),"query",this).call(this,o,f)}}},{key:"getComparator",value:function(){return r.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(s,o){return k(c(r.prototype),"createParentBoundables",this).call(this,s,o)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof we){var s=arguments[0],o=arguments[1];return k(c(r.prototype),"remove",this).call(this,s,o)}return k(c(r.prototype),"remove",this).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?k(c(r.prototype),"depth",this).call(this):k(c(r.prototype),"depth",this).apply(this,arguments)}},{key:"createParentBoundables",value:function(s,o){U.isTrue(!s.isEmpty());var f=Math.trunc(Math.ceil(s.size()/this.getNodeCapacity())),v=new K(s);Jt.sort(v,r.xComparator);var y=this.verticalSlices(v,Math.trunc(Math.ceil(Math.sqrt(f))));return this.createParentBoundablesFromVerticalSlices(y,o)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(oe(arguments[0],nl)){var s=arguments[0];if(this.isEmpty())return null;var o=new Kt(this.getRoot(),this.getRoot(),s);return this.nearestNeighbour(o)}if(arguments[0]instanceof Kt){var f=arguments[0],v=z.POSITIVE_INFINITY,y=null,_=new gr;for(_.add(f);!_.isEmpty()&&v>0;){var E=_.poll(),M=E.getDistance();if(M>=v)break;E.isLeaves()?(v=M,y=E):E.expandToQueue(_,v)}return y===null?null:[y.getBoundable(0).getItem(),y.getBoundable(1).getItem()]}}else{if(arguments.length===2){var L=arguments[0],T=arguments[1];if(this.isEmpty()||L.isEmpty())return null;var B=new Kt(this.getRoot(),L.getRoot(),T);return this.nearestNeighbour(B)}if(arguments.length===3){var F=arguments[0],$=arguments[1],W=arguments[2],te=new xt(F,$),Ee=new Kt(this.getRoot(),te,W);return this.nearestNeighbour(Ee)[0]}if(arguments.length===4){var be=arguments[0],ze=arguments[1],je=arguments[2],lt=arguments[3],Et=new xt(be,ze),Ft=new Kt(this.getRoot(),Et,je);return this.nearestNeighbourK(Ft,lt)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var s=arguments[0],o=arguments[1],f=z.POSITIVE_INFINITY,v=new gr;for(v.add(s);!v.isEmpty();){var y=v.poll(),_=y.getDistance();if(_>o)return!1;if(y.maximumDistance()<=o)return!0;if(y.isLeaves()){if((f=_)<=o)return!0}else y.expandToQueue(v,f)}return!1}if(arguments.length===3){var E=arguments[0],M=arguments[1],L=arguments[2],T=new Kt(this.getRoot(),E.getRoot(),M);return this.isWithinDistance(T,L)}}},{key:"interfaces_",get:function(){return[el,H]}}],[{key:"constructor_",value:function(){if(arguments.length===0)r.constructor_.call(this,r.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var s=arguments[0];Qt.constructor_.call(this,s)}}},{key:"centreX",value:function(s){return r.avg(s.getMinX(),s.getMaxX())}},{key:"avg",value:function(s,o){return(s+o)/2}},{key:"getItems",value:function(s){for(var o=new Array(s.size()).fill(null),f=0;!s.isEmpty();){var v=s.poll();o[f]=v.getBoundable(0).getItem(),f++}return o}},{key:"centreY",value:function(s){return r.avg(s.getMinY(),s.getMaxY())}}]),r}(Qt),Ts=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"computeBounds",value:function(){for(var s=null,o=this.getChildBoundables().iterator();o.hasNext();){var f=o.next();s===null?s=new we(f.getBounds()):s.expandToInclude(f.getBounds())}return s}}],[{key:"constructor_",value:function(){var s=arguments[0];st.constructor_.call(this,s)}}]),r}(st);dt.STRtreeNode=Ts,dt.xComparator=new(function(){function l(){t(this,l)}return u(l,[{key:"interfaces_",get:function(){return[et]}},{key:"compare",value:function(e,r){return Qt.compareDoubles(dt.centreX(e.getBounds()),dt.centreX(r.getBounds()))}}]),l}()),dt.yComparator=new(function(){function l(){t(this,l)}return u(l,[{key:"interfaces_",get:function(){return[et]}},{key:"compare",value:function(e,r){return Qt.compareDoubles(dt.centreY(e.getBounds()),dt.centreY(r.getBounds()))}}]),l}()),dt.intersectsOp=new(function(){function l(){t(this,l)}return u(l,[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(e,r){return e.intersects(r)}}]),l}()),dt.DEFAULT_NODE_CAPACITY=10;var rl=function(){function l(){t(this,l)}return u(l,null,[{key:"relativeSign",value:function(e,r){return e<r?-1:e>r?1:0}},{key:"compare",value:function(e,r,s){if(r.equals2D(s))return 0;var o=l.relativeSign(r.x,s.x),f=l.relativeSign(r.y,s.y);switch(e){case 0:return l.compareValue(o,f);case 1:return l.compareValue(f,o);case 2:return l.compareValue(f,-o);case 3:return l.compareValue(-o,f);case 4:return l.compareValue(-o,-f);case 5:return l.compareValue(-f,-o);case 6:return l.compareValue(-f,o);case 7:return l.compareValue(o,-f)}return U.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(e,r){return e<0?-1:e>0?1:r<0?-1:r>0?1:0}}]),l}(),il=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(e){var r=e;return this.segmentIndex<r.segmentIndex?-1:this.segmentIndex>r.segmentIndex?1:this.coord.equals2D(r.coord)?0:this._isInterior?r._isInterior?rl.compare(this._segmentOctant,this.coord,r.coord):1:-1}},{key:"isEndPoint",value:function(e){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===e}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var e=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];this._segString=e,this.coord=new b(r),this.segmentIndex=s,this._segmentOctant=o,this._isInterior=!r.equals2D(e.getCoordinate(s))}}]),l}(),sl=function(){function l(){t(this,l)}return u(l,[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}]),l}(),al=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getSplitCoordinates",value:function(){var e=new En;this.addEndpoints();for(var r=this.iterator(),s=r.next();r.hasNext();){var o=r.next();this.addEdgeCoordinates(s,o,e),s=o}return e.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var e=new K;this.findCollapsesFromInsertedNodes(e),this.findCollapsesFromExistingVertices(e);for(var r=e.iterator();r.hasNext();){var s=r.next().intValue();this.add(this._edge.getCoordinate(s),s)}}},{key:"createSplitEdgePts",value:function(e,r){var s=r.segmentIndex-e.segmentIndex+2;if(s===2)return[new b(e.coord),new b(r.coord)];var o=this._edge.getCoordinate(r.segmentIndex),f=r.isInterior()||!r.coord.equals2D(o);f||s--;var v=new Array(s).fill(null),y=0;v[y++]=new b(e.coord);for(var _=e.segmentIndex+1;_<=r.segmentIndex;_++)v[y++]=this._edge.getCoordinate(_);return f&&(v[y]=new b(r.coord)),v}},{key:"print",value:function(e){e.println("Intersections:");for(var r=this.iterator();r.hasNext();)r.next().print(e)}},{key:"findCollapsesFromExistingVertices",value:function(e){for(var r=0;r<this._edge.size()-2;r++){var s=this._edge.getCoordinate(r);this._edge.getCoordinate(r+1);var o=this._edge.getCoordinate(r+2);s.equals2D(o)&&e.add(rr.valueOf(r+1))}}},{key:"addEdgeCoordinates",value:function(e,r,s){var o=this.createSplitEdgePts(e,r);s.add(o,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(e){this.addEndpoints(),this.addCollapsedNodes();for(var r=this.iterator(),s=r.next();r.hasNext();){var o=r.next(),f=this.createSplitEdge(s,o);e.add(f),s=o}}},{key:"findCollapseIndex",value:function(e,r,s){if(!e.coord.equals2D(r.coord))return!1;var o=r.segmentIndex-e.segmentIndex;return r.isInterior()||o--,o===1&&(s[0]=e.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(e){for(var r=new Array(1).fill(null),s=this.iterator(),o=s.next();s.hasNext();){var f=s.next();this.findCollapseIndex(o,f,r)&&e.add(rr.valueOf(r[0])),o=f}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var e=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(e),e)}},{key:"createSplitEdge",value:function(e,r){var s=this.createSplitEdgePts(e,r);return new Dt(s,this._edge.getData())}},{key:"add",value:function(e,r){var s=new il(this._edge,e,r,this._edge.getSegmentOctant(r)),o=this._nodeMap.get(s);return o!==null?(U.isTrue(o.coord.equals2D(e),"Found equal nodes with different coordinates"),o):(this._nodeMap.put(s,s),s)}},{key:"checkSplitEdgesCorrectness",value:function(e){var r=this._edge.getCoordinates(),s=e.get(0).getCoordinate(0);if(!s.equals2D(r[0]))throw new Be("bad split edge start point at "+s);var o=e.get(e.size()-1).getCoordinates(),f=o[o.length-1];if(!f.equals2D(r[r.length-1]))throw new Be("bad split edge end point at "+f)}}],[{key:"constructor_",value:function(){this._nodeMap=new In,this._edge=null;var e=arguments[0];this._edge=e}}]),l}(),ol=function(){function l(){t(this,l)}return u(l,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],r=arguments[1];if(e===0&&r===0)throw new O("Cannot compute the octant for point ( "+e+", "+r+" )");var s=Math.abs(e),o=Math.abs(r);return e>=0?r>=0?s>=o?0:1:s>=o?7:6:r>=0?s>=o?3:2:s>=o?4:5}if(arguments[0]instanceof b&&arguments[1]instanceof b){var f=arguments[0],v=arguments[1],y=v.x-f.x,_=v.y-f.y;if(y===0&&_===0)throw new O("Cannot compute the octant for two identical points "+f);return l.octant(y,_)}}}]),l}(),ul=function(){function l(){t(this,l)}return u(l,[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(e){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(e){}},{key:"getData",value:function(){}}]),l}(),ll=function(){function l(){t(this,l)}return u(l,[{key:"addIntersection",value:function(e,r){}},{key:"interfaces_",get:function(){return[ul]}}]),l}(),Dt=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(e){return this._pts[e]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))}},{key:"setData",value:function(e){this._data=e}},{key:"safeOctant",value:function(e,r){return e.equals2D(r)?0:ol.octant(e,r)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var e=arguments[0],r=arguments[1];this.addIntersectionNode(e,r)}else if(arguments.length===4){var s=arguments[0],o=arguments[1],f=arguments[3],v=new b(s.getIntersection(f));this.addIntersection(v,o)}}},{key:"toString",value:function(){return si.toLineString(new wn(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(e,r){var s=r,o=s+1;if(o<this._pts.length){var f=this._pts[o];e.equals2D(f)&&(s=o)}return this._nodeList.add(e,s)}},{key:"addIntersections",value:function(e,r,s){for(var o=0;o<e.getIntersectionNum();o++)this.addIntersection(e,r,s,o)}},{key:"interfaces_",get:function(){return[ll]}}],[{key:"constructor_",value:function(){this._nodeList=new al(this),this._pts=null,this._data=null;var e=arguments[0],r=arguments[1];this._pts=e,this._data=r}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var e=arguments[0],r=new K;return l.getNodedSubstrings(e,r),r}if(arguments.length===2)for(var s=arguments[0],o=arguments[1],f=s.iterator();f.hasNext();){var v=f.next();v.getNodeList().addSplitEdges(o)}}}]),l}(),Ke=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof l){var e=arguments[0],r=ee.index(this.p0,this.p1,e.p0),s=ee.index(this.p0,this.p1,e.p1);return r>=0&&s>=0||r<=0&&s<=0?Math.max(r,s):0}if(arguments[0]instanceof b){var o=arguments[0];return ee.index(this.p0,this.p1,o)}}},{key:"toGeometry",value:function(e){return e.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(e){if(!(e instanceof l))return!1;var r=e;return this.p0.equals(r.p0)&&this.p1.equals(r.p1)}},{key:"intersection",value:function(e){var r=new At;return r.computeIntersection(this.p0,this.p1,e.p0,e.p1),r.hasIntersection()?r.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof b){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new b(e);var r=this.projectionFactor(e),s=new b;return s.x=this.p0.x+r*(this.p1.x-this.p0.x),s.y=this.p0.y+r*(this.p1.y-this.p0.y),s}if(arguments[0]instanceof l){var o=arguments[0],f=this.projectionFactor(o.p0),v=this.projectionFactor(o.p1);if(f>=1&&v>=1||f<=0&&v<=0)return null;var y=this.project(o.p0);f<0&&(y=this.p0),f>1&&(y=this.p1);var _=this.project(o.p1);return v<0&&(_=this.p0),v>1&&(_=this.p1),new l(y,_)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(e){return e===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(e){return ft.pointToLinePerpendicular(e,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return l.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var r=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,o=r*r+s*s;return o<=0?z.NaN:((e.x-this.p0.x)*r+(e.y-this.p0.y)*s)/o}},{key:"closestPoints",value:function(e){var r=this.intersection(e);if(r!==null)return[r,r];var s=new Array(2).fill(null),o=z.MAX_VALUE,f=null,v=this.closestPoint(e.p0);o=v.distance(e.p0),s[0]=v,s[1]=e.p0;var y=this.closestPoint(e.p1);(f=y.distance(e.p1))<o&&(o=f,s[0]=y,s[1]=e.p1);var _=e.closestPoint(this.p0);(f=_.distance(this.p0))<o&&(o=f,s[0]=this.p0,s[1]=_);var E=e.closestPoint(this.p1);return(f=E.distance(this.p1))<o&&(o=f,s[0]=this.p1,s[1]=E),s}},{key:"closestPoint",value:function(e){var r=this.projectionFactor(e);return r>0&&r<1?this.project(e):this.p0.distance(e)<this.p1.distance(e)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(e){var r=e,s=this.p0.compareTo(r.p0);return s!==0?s:this.p1.compareTo(r.p1)}},{key:"reverse",value:function(){var e=this.p0;this.p0=this.p1,this.p1=e}},{key:"equalsTopo",value:function(e){return this.p0.equals(e.p0)&&this.p1.equals(e.p1)||this.p0.equals(e.p1)&&this.p1.equals(e.p0)}},{key:"lineIntersection",value:function(e){return Kr.intersection(this.p0,this.p1,e.p0,e.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(e,r){var s=this.p0.x+e*(this.p1.x-this.p0.x),o=this.p0.y+e*(this.p1.y-this.p0.y),f=this.p1.x-this.p0.x,v=this.p1.y-this.p0.y,y=Math.sqrt(f*f+v*v),_=0,E=0;if(r!==0){if(y<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");_=r*f/y,E=r*v/y}return new b(s-E,o+_)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.p0.x=r.x,this.p0.y=r.y,this.p1.x=s.x,this.p1.y=s.y}}},{key:"segmentFraction",value:function(e){var r=this.projectionFactor(e);return r<0?r=0:(r>1||z.isNaN(r))&&(r=1),r}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(e){var r=this.p1.getY()-this.p0.getY(),s=this.p0.getX()-this.p1.getX(),o=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),f=r*r+s*s,v=r*r-s*s,y=e.getX(),_=e.getY();return new b((-v*y-2*r*s*_-2*r*o)/f,(v*_-2*r*s*y-2*s*o)/f)}},{key:"distance",value:function(){if(arguments[0]instanceof l){var e=arguments[0];return ft.segmentToSegment(this.p0,this.p1,e.p0,e.p1)}if(arguments[0]instanceof b){var r=arguments[0];return ft.pointToSegment(r,this.p0,this.p1)}}},{key:"pointAlong",value:function(e){var r=new b;return r.x=this.p0.x+e*(this.p1.x-this.p0.x),r.y=this.p0.y+e*(this.p1.y-this.p0.y),r}},{key:"hashCode",value:function(){var e=z.doubleToLongBits(this.p0.x);e^=31*z.doubleToLongBits(this.p0.y);var r=Math.trunc(e)^Math.trunc(e>>32),s=z.doubleToLongBits(this.p1.x);return s^=31*z.doubleToLongBits(this.p1.y),r^(Math.trunc(s)^Math.trunc(s>>32))}},{key:"interfaces_",get:function(){return[X,H]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)l.constructor_.call(this,new b,new b);else if(arguments.length===1){var e=arguments[0];l.constructor_.call(this,e.p0,e.p1)}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this.p0=r,this.p1=s}else if(arguments.length===4){var o=arguments[0],f=arguments[1],v=arguments[2],y=arguments[3];l.constructor_.call(this,new b(o,f),new b(v,y))}}},{key:"midPoint",value:function(e,r){return new b((e.x+r.x)/2,(e.y+r.y)/2)}}]),l}(),hl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var e=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];e.getLineSegment(r,this._overlapSeg1),s.getLineSegment(o,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new Ke,this._overlapSeg2=new Ke}}]),l}(),Os=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getLineSegment",value:function(e,r){r.p0=this._pts[e],r.p1=this._pts[e+1]}},{key:"computeSelect",value:function(e,r,s,o){var f=this._pts[r],v=this._pts[s];if(s-r==1)return o.select(this,r),null;if(!e.intersects(f,v))return null;var y=Math.trunc((r+s)/2);r<y&&this.computeSelect(e,r,y,o),y<s&&this.computeSelect(e,y,s,o)}},{key:"getCoordinates",value:function(){for(var e=new Array(this._end-this._start+1).fill(null),r=0,s=this._start;s<=this._end;s++)e[r++]=this._pts[s];return e}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var e=arguments[0],r=arguments[1];this.computeOverlaps(this._start,this._end,e,e._start,e._end,r)}else if(arguments.length===6){var s=arguments[0],o=arguments[1],f=arguments[2],v=arguments[3],y=arguments[4],_=arguments[5];if(o-s==1&&y-v==1)return _.overlap(this,s,f,v),null;if(!this.overlaps(s,o,f,v,y))return null;var E=Math.trunc((s+o)/2),M=Math.trunc((v+y)/2);s<E&&(v<M&&this.computeOverlaps(s,E,f,v,M,_),M<y&&this.computeOverlaps(s,E,f,M,y,_)),E<o&&(v<M&&this.computeOverlaps(E,o,f,v,M,_),M<y&&this.computeOverlaps(E,o,f,M,y,_))}}},{key:"setId",value:function(e){this._id=e}},{key:"select",value:function(e,r){this.computeSelect(e,this._start,this._end,r)}},{key:"getEnvelope",value:function(){if(this._env===null){var e=this._pts[this._start],r=this._pts[this._end];this._env=new we(e,r)}return this._env}},{key:"overlaps",value:function(e,r,s,o,f){return we.intersects(this._pts[e],this._pts[r],s._pts[o],s._pts[f])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var e=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];this._pts=e,this._start=r,this._end=s,this._context=o}}]),l}(),cl=function(){function l(){t(this,l)}return u(l,null,[{key:"findChainEnd",value:function(e,r){for(var s=r;s<e.length-1&&e[s].equals2D(e[s+1]);)s++;if(s>=e.length-1)return e.length-1;for(var o=$e.quadrant(e[s],e[s+1]),f=r+1;f<e.length&&!(!e[f-1].equals2D(e[f])&&$e.quadrant(e[f-1],e[f])!==o);)f++;return f-1}},{key:"getChains",value:function(){if(arguments.length===1){var e=arguments[0];return l.getChains(e,null)}if(arguments.length===2){var r=arguments[0],s=arguments[1],o=new K,f=0;do{var v=l.findChainEnd(r,f),y=new Os(r,f,v,s);o.add(y),f=v}while(f<r.length-1);return o}}}]),l}(),li=function(){function l(){t(this,l)}return u(l,[{key:"computeNodes",value:function(e){}},{key:"getNodedSubstrings",value:function(){}}]),l}(),Rs=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"setSegmentIntersector",value:function(e){this._segInt=e}},{key:"interfaces_",get:function(){return[li]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setSegmentIntersector(e)}}}}]),l}(),hi=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return Dt.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(s){for(var o=cl.getChains(s.getCoordinates(),s).iterator();o.hasNext();){var f=o.next();f.setId(this._idCounter++),this._index.insert(f.getEnvelope(),f),this._monoChains.add(f)}}},{key:"computeNodes",value:function(s){this._nodedSegStrings=s;for(var o=s.iterator();o.hasNext();)this.add(o.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var s=new As(this._segInt),o=this._monoChains.iterator();o.hasNext();)for(var f=o.next(),v=this._index.query(f.getEnvelope()).iterator();v.hasNext();){var y=v.next();if(y.getId()>f.getId()&&(f.computeOverlaps(y,s),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new K,this._index=new dt,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var s=arguments[0];Rs.constructor_.call(this,s)}}}}]),r}(Rs),As=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"overlap",value:function(){if(arguments.length!==4)return k(c(r.prototype),"overlap",this).apply(this,arguments);var s=arguments[0],o=arguments[1],f=arguments[2],v=arguments[3],y=s.getContext(),_=f.getContext();this._si.processIntersections(y,o,_,v)}}],[{key:"constructor_",value:function(){this._si=null;var s=arguments[0];this._si=s}}]),r}(hl);hi.SegmentOverlapAction=As;var ut=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"isDeletable",value:function(e,r,s,o){var f=this._inputLine[e],v=this._inputLine[r],y=this._inputLine[s];return!!this.isConcave(f,v,y)&&!!this.isShallow(f,v,y,o)&&this.isShallowSampled(f,v,e,s,o)}},{key:"deleteShallowConcavities",value:function(){for(var e=1,r=this.findNextNonDeletedIndex(e),s=this.findNextNonDeletedIndex(r),o=!1;s<this._inputLine.length;){var f=!1;this.isDeletable(e,r,s,this._distanceTol)&&(this._isDeleted[r]=l.DELETE,f=!0,o=!0),e=f?s:r,r=this.findNextNonDeletedIndex(e),s=this.findNextNonDeletedIndex(r)}return o}},{key:"isShallowConcavity",value:function(e,r,s,o){return ee.index(e,r,s)===this._angleOrientation&&ft.pointToSegment(r,e,s)<o}},{key:"isShallowSampled",value:function(e,r,s,o,f){var v=Math.trunc((o-s)/l.NUM_PTS_TO_CHECK);v<=0&&(v=1);for(var y=s;y<o;y+=v)if(!this.isShallow(e,r,this._inputLine[y],f))return!1;return!0}},{key:"isConcave",value:function(e,r,s){var o=ee.index(e,r,s)===this._angleOrientation;return o}},{key:"simplify",value:function(e){this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=ee.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var r=!1;do r=this.deleteShallowConcavities();while(r);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(e){for(var r=e+1;r<this._inputLine.length&&this._isDeleted[r]===l.DELETE;)r++;return r}},{key:"isShallow",value:function(e,r,s,o){return ft.pointToSegment(r,e,s)<o}},{key:"collapseLine",value:function(){for(var e=new En,r=0;r<this._inputLine.length;r++)this._isDeleted[r]!==l.DELETE&&e.add(this._inputLine[r]);return e.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=ee.COUNTERCLOCKWISE;var e=arguments[0];this._inputLine=e}},{key:"simplify",value:function(e,r){return new l(e).simplify(r)}}]),l}();ut.INIT=0,ut.DELETE=1,ut.KEEP=1,ut.NUM_PTS_TO_CHECK=10;var Ds=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getCoordinates",value:function(){return this._ptList.toArray(l.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(e){this._precisionModel=e}},{key:"addPt",value:function(e){var r=new b(e);if(this._precisionModel.makePrecise(r),this.isRedundant(r))return null;this._ptList.add(r)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(e,r){if(r)for(var s=0;s<e.length;s++)this.addPt(e[s]);else for(var o=e.length-1;o>=0;o--)this.addPt(e[o])}},{key:"isRedundant",value:function(e){if(this._ptList.size()<1)return!1;var r=this._ptList.get(this._ptList.size()-1);return e.distance(r)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Zt().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var e=new b(this._ptList.get(0)),r=this._ptList.get(this._ptList.size()-1);if(e.equals(r))return null;this._ptList.add(e)}},{key:"setMinimumVertexDistance",value:function(e){this._minimimVertexDistance=e}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new K}}]),l}();Ds.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var Qe=function(){function l(){t(this,l)}return u(l,null,[{key:"toDegrees",value:function(e){return 180*e/Math.PI}},{key:"normalize",value:function(e){for(;e>Math.PI;)e-=l.PI_TIMES_2;for(;e<=-Math.PI;)e+=l.PI_TIMES_2;return e}},{key:"angle",value:function(){if(arguments.length===1){var e=arguments[0];return Math.atan2(e.y,e.x)}if(arguments.length===2){var r=arguments[0],s=arguments[1],o=s.x-r.x,f=s.y-r.y;return Math.atan2(f,o)}}},{key:"isAcute",value:function(e,r,s){var o=e.x-r.x,f=e.y-r.y;return o*(s.x-r.x)+f*(s.y-r.y)>0}},{key:"isObtuse",value:function(e,r,s){var o=e.x-r.x,f=e.y-r.y;return o*(s.x-r.x)+f*(s.y-r.y)<0}},{key:"interiorAngle",value:function(e,r,s){var o=l.angle(r,e),f=l.angle(r,s);return Math.abs(f-o)}},{key:"normalizePositive",value:function(e){if(e<0){for(;e<0;)e+=l.PI_TIMES_2;e>=l.PI_TIMES_2&&(e=0)}else{for(;e>=l.PI_TIMES_2;)e-=l.PI_TIMES_2;e<0&&(e=0)}return e}},{key:"angleBetween",value:function(e,r,s){var o=l.angle(r,e),f=l.angle(r,s);return l.diff(o,f)}},{key:"diff",value:function(e,r){var s=null;return(s=e<r?r-e:e-r)>Math.PI&&(s=2*Math.PI-s),s}},{key:"toRadians",value:function(e){return e*Math.PI/180}},{key:"getTurn",value:function(e,r){var s=Math.sin(r-e);return s>0?l.COUNTERCLOCKWISE:s<0?l.CLOCKWISE:l.NONE}},{key:"angleBetweenOriented",value:function(e,r,s){var o=l.angle(r,e),f=l.angle(r,s)-o;return f<=-Math.PI?f+l.PI_TIMES_2:f>Math.PI?f-l.PI_TIMES_2:f}}]),l}();Qe.PI_TIMES_2=2*Math.PI,Qe.PI_OVER_2=Math.PI/2,Qe.PI_OVER_4=Math.PI/4,Qe.COUNTERCLOCKWISE=ee.COUNTERCLOCKWISE,Qe.CLOCKWISE=ee.CLOCKWISE,Qe.NONE=ee.COLLINEAR;var Nn=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"addNextSegment",value:function(e,r){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var s=ee.index(this._s0,this._s1,this._s2),o=s===ee.CLOCKWISE&&this._side===q.LEFT||s===ee.COUNTERCLOCKWISE&&this._side===q.RIGHT;s===0?this.addCollinear(r):o?this.addOutsideTurn(s,r):this.addInsideTurn(s,r)}},{key:"addLineEndCap",value:function(e,r){var s=new Ke(e,r),o=new Ke;this.computeOffsetSegment(s,q.LEFT,this._distance,o);var f=new Ke;this.computeOffsetSegment(s,q.RIGHT,this._distance,f);var v=r.x-e.x,y=r.y-e.y,_=Math.atan2(y,v);switch(this._bufParams.getEndCapStyle()){case S.CAP_ROUND:this._segList.addPt(o.p1),this.addDirectedFillet(r,_+Math.PI/2,_-Math.PI/2,ee.CLOCKWISE,this._distance),this._segList.addPt(f.p1);break;case S.CAP_FLAT:this._segList.addPt(o.p1),this._segList.addPt(f.p1);break;case S.CAP_SQUARE:var E=new b;E.x=Math.abs(this._distance)*Math.cos(_),E.y=Math.abs(this._distance)*Math.sin(_);var M=new b(o.p1.x+E.x,o.p1.y+E.y),L=new b(f.p1.x+E.x,f.p1.y+E.y);this._segList.addPt(M),this._segList.addPt(L)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(e,r,s,o){var f=Kr.intersection(r.p0,r.p1,s.p0,s.p1);if(f!==null&&(o<=0?1:f.distance(e)/Math.abs(o))<=this._bufParams.getMitreLimit())return this._segList.addPt(f),null;this.addLimitedMitreJoin(r,s,o,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(e,r){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*l.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===S.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===S.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(r&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(e){this._segList.addPt(new b(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new b(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new b(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new b(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(e,r){this._segList.addPts(e,r)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(e,r,s,o,f){var v=r.x-e.x,y=r.y-e.y,_=Math.atan2(y,v),E=s.x-e.x,M=s.y-e.y,L=Math.atan2(M,E);o===ee.CLOCKWISE?_<=L&&(_+=2*Math.PI):_>=L&&(_-=2*Math.PI),this._segList.addPt(r),this.addDirectedFillet(e,_,L,o,f),this._segList.addPt(s)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(e,r,s){this._s1=e,this._s2=r,this._side=s,this._seg1.setCoordinates(e,r),this.computeOffsetSegment(this._seg1,s,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(e,r,s,o){var f=this._seg0.p1,v=Qe.angle(f,this._seg0.p0),y=Qe.angleBetweenOriented(this._seg0.p0,f,this._seg1.p1)/2,_=Qe.normalize(v+y),E=Qe.normalize(_+Math.PI),M=o*s,L=s-M*Math.abs(Math.sin(y)),T=f.x+M*Math.cos(E),B=f.y+M*Math.sin(E),F=new b(T,B),$=new Ke(f,F),W=$.pointAlongOffset(1,L),te=$.pointAlongOffset(1,-L);this._side===q.LEFT?(this._segList.addPt(W),this._segList.addPt(te)):(this._segList.addPt(te),this._segList.addPt(W))}},{key:"addDirectedFillet",value:function(e,r,s,o,f){var v=o===ee.CLOCKWISE?-1:1,y=Math.abs(r-s),_=Math.trunc(y/this._filletAngleQuantum+.5);if(_<1)return null;for(var E=y/_,M=new b,L=0;L<_;L++){var T=r+v*L*E;M.x=e.x+f*Math.cos(T),M.y=e.y+f*Math.sin(T),this._segList.addPt(M)}}},{key:"computeOffsetSegment",value:function(e,r,s,o){var f=r===q.LEFT?1:-1,v=e.p1.x-e.p0.x,y=e.p1.y-e.p0.y,_=Math.sqrt(v*v+y*y),E=f*s*v/_,M=f*s*y/_;o.p0.x=e.p0.x-M,o.p0.y=e.p0.y+E,o.p1.x=e.p1.x-M,o.p1.y=e.p1.y+E}},{key:"addInsideTurn",value:function(e,r){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*l.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var s=new b((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(s);var o=new b((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(o)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(e){var r=new b(e.x+this._distance,e.y);this._segList.addPt(r),this.addDirectedFillet(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(e,r){this._segList.addPt(e.p1),this._segList.addPt(r.p0)}},{key:"init",value:function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Ds,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*l.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===S.JOIN_BEVEL||this._bufParams.getJoinStyle()===S.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,ee.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Ke,this._seg1=new Ke,this._offset0=new Ke,this._offset1=new Ke,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],r=arguments[1],s=arguments[2];this._precisionModel=e,this._bufParams=r,this._li=new At,this._filletAngleQuantum=Math.PI/2/r.getQuadrantSegments(),r.getQuadrantSegments()>=8&&r.getJoinStyle()===S.JOIN_ROUND&&(this._closingSegLengthFactor=l.MAX_CLOSING_SEG_LEN_FACTOR),this.init(s)}}]),l}();Nn.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Nn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Nn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Nn.MAX_CLOSING_SEG_LEN_FACTOR=80;var fl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getOffsetCurve",value:function(e,r){if(this._distance=r,r===0)return null;var s=r<0,o=Math.abs(r),f=this.getSegGen(o);e.length<=1?this.computePointCurve(e[0],f):this.computeOffsetCurve(e,s,f);var v=f.getCoordinates();return s&&qe.reverse(v),v}},{key:"computeSingleSidedBufferCurve",value:function(e,r,s){var o=this.simplifyTolerance(this._distance);if(r){s.addSegments(e,!0);var f=ut.simplify(e,-o),v=f.length-1;s.initSideSegments(f[v],f[v-1],q.LEFT),s.addFirstSegment();for(var y=v-2;y>=0;y--)s.addNextSegment(f[y],!0)}else{s.addSegments(e,!1);var _=ut.simplify(e,o),E=_.length-1;s.initSideSegments(_[0],_[1],q.LEFT),s.addFirstSegment();for(var M=2;M<=E;M++)s.addNextSegment(_[M],!0)}s.addLastSegment(),s.closeRing()}},{key:"computeRingBufferCurve",value:function(e,r,s){var o=this.simplifyTolerance(this._distance);r===q.RIGHT&&(o=-o);var f=ut.simplify(e,o),v=f.length-1;s.initSideSegments(f[v-1],f[0],r);for(var y=1;y<=v;y++){var _=y!==1;s.addNextSegment(f[y],_)}s.closeRing()}},{key:"computeLineBufferCurve",value:function(e,r){var s=this.simplifyTolerance(this._distance),o=ut.simplify(e,s),f=o.length-1;r.initSideSegments(o[0],o[1],q.LEFT);for(var v=2;v<=f;v++)r.addNextSegment(o[v],!0);r.addLastSegment(),r.addLineEndCap(o[f-1],o[f]);var y=ut.simplify(e,-s),_=y.length-1;r.initSideSegments(y[_],y[_-1],q.LEFT);for(var E=_-2;E>=0;E--)r.addNextSegment(y[E],!0);r.addLastSegment(),r.addLineEndCap(y[1],y[0]),r.closeRing()}},{key:"computePointCurve",value:function(e,r){switch(this._bufParams.getEndCapStyle()){case S.CAP_ROUND:r.createCircle(e);break;case S.CAP_SQUARE:r.createSquare(e)}}},{key:"getLineCurve",value:function(e,r){if(this._distance=r,this.isLineOffsetEmpty(r))return null;var s=Math.abs(r),o=this.getSegGen(s);if(e.length<=1)this.computePointCurve(e[0],o);else if(this._bufParams.isSingleSided()){var f=r<0;this.computeSingleSidedBufferCurve(e,f,o)}else this.computeLineBufferCurve(e,o);return o.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(e){return e*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(e,r,s){if(this._distance=s,e.length<=2)return this.getLineCurve(e,s);if(s===0)return l.copyCoordinates(e);var o=this.getSegGen(s);return this.computeRingBufferCurve(e,r,o),o.getCoordinates()}},{key:"computeOffsetCurve",value:function(e,r,s){var o=this.simplifyTolerance(this._distance);if(r){var f=ut.simplify(e,-o),v=f.length-1;s.initSideSegments(f[v],f[v-1],q.LEFT),s.addFirstSegment();for(var y=v-2;y>=0;y--)s.addNextSegment(f[y],!0)}else{var _=ut.simplify(e,o),E=_.length-1;s.initSideSegments(_[0],_[1],q.LEFT),s.addFirstSegment();for(var M=2;M<=E;M++)s.addNextSegment(_[M],!0)}s.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(e){return e===0||e<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(e){return new Nn(this._precisionModel,this._bufParams,e)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var e=arguments[0],r=arguments[1];this._precisionModel=e,this._bufParams=r}},{key:"copyCoordinates",value:function(e){for(var r=new Array(e.length).fill(null),s=0;s<r.length;s++)r[s]=new b(e[s]);return r}}]),l}(),Fs=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var e=arguments[0],r=new K,s=this._subgraphs.iterator();s.hasNext();){var o=s.next(),f=o.getEnvelope();e.y<f.getMinY()||e.y>f.getMaxY()||this.findStabbedSegments(e,o.getDirectedEdges(),r)}return r}if(arguments.length===3){if(oe(arguments[2],bt)&&arguments[0]instanceof b&&arguments[1]instanceof ui)for(var v=arguments[0],y=arguments[1],_=arguments[2],E=y.getEdge().getCoordinates(),M=0;M<E.length-1;M++){this._seg.p0=E[M],this._seg.p1=E[M+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse();var L=Math.max(this._seg.p0.x,this._seg.p1.x);if(!(L<v.x)&&!(this._seg.isHorizontal()||v.y<this._seg.p0.y||v.y>this._seg.p1.y||ee.index(this._seg.p0,this._seg.p1,v)===ee.RIGHT)){var T=y.getDepth(q.LEFT);this._seg.p0.equals(E[M])||(T=y.getDepth(q.RIGHT));var B=new Bs(this._seg,T);_.add(B)}}else if(oe(arguments[2],bt)&&arguments[0]instanceof b&&oe(arguments[1],bt))for(var F=arguments[0],$=arguments[1],W=arguments[2],te=$.iterator();te.hasNext();){var Ee=te.next();Ee.isForward()&&this.findStabbedSegments(F,Ee,W)}}}},{key:"getDepth",value:function(e){var r=this.findStabbedSegments(e);return r.size()===0?0:Jt.min(r)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new Ke;var e=arguments[0];this._subgraphs=e}}]),l}(),Bs=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"compareTo",value:function(e){var r=e;if(this._upwardSeg.minX()>=r._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=r._upwardSeg.minX())return-1;var s=this._upwardSeg.orientationIndex(r._upwardSeg);return s!==0||(s=-1*r._upwardSeg.orientationIndex(this._upwardSeg))!==0?s:this._upwardSeg.compareTo(r._upwardSeg)}},{key:"compareX",value:function(e,r){var s=e.p0.compareTo(r.p0);return s!==0?s:e.p1.compareTo(r.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var e=arguments[0],r=arguments[1];this._upwardSeg=new Ke(e),this._leftDepth=r}}]),l}();Fs.DepthSegment=Bs;var qs=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,null,[{key:"constructor_",value:function(){A.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}]),r}(A),ci=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getY",value:function(){var e=this.y/this.w;if(z.isNaN(e)||z.isInfinite(e))throw new qs;return e}},{key:"getX",value:function(){var e=this.x/this.w;if(z.isNaN(e)||z.isInfinite(e))throw new qs;return e}},{key:"getCoordinate",value:function(){var e=new b;return e.x=this.getX(),e.y=this.getY(),e}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var r=arguments[0],s=arguments[1];this.x=r,this.y=s,this.w=1}else if(arguments[0]instanceof l&&arguments[1]instanceof l){var o=arguments[0],f=arguments[1];this.x=o.y*f.w-f.y*o.w,this.y=f.x*o.w-o.x*f.w,this.w=o.x*f.y-f.x*o.y}else if(arguments[0]instanceof b&&arguments[1]instanceof b){var v=arguments[0],y=arguments[1];this.x=v.y-y.y,this.y=y.x-v.x,this.w=v.x*y.y-y.x*v.y}}else if(arguments.length===3){var _=arguments[0],E=arguments[1],M=arguments[2];this.x=_,this.y=E,this.w=M}else if(arguments.length===4){var L=arguments[0],T=arguments[1],B=arguments[2],F=arguments[3],$=L.y-T.y,W=T.x-L.x,te=L.x*T.y-T.x*L.y,Ee=B.y-F.y,be=F.x-B.x,ze=B.x*F.y-F.x*B.y;this.x=W*ze-be*te,this.y=Ee*te-$*ze,this.w=$*be-Ee*W}}}]),l}(),gl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"area",value:function(){return l.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return l.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(e){if(e===null)throw new O("Supplied point is null.");return l.interpolateZ(e,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return l.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return l.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return l.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return l.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return l.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return l.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var e=arguments[0],r=arguments[1],s=arguments[2];this.p0=e,this.p1=r,this.p2=s}},{key:"area",value:function(e,r,s){return Math.abs(((s.x-e.x)*(r.y-e.y)-(r.x-e.x)*(s.y-e.y))/2)}},{key:"signedArea",value:function(e,r,s){return((s.x-e.x)*(r.y-e.y)-(r.x-e.x)*(s.y-e.y))/2}},{key:"det",value:function(e,r,s,o){return e*o-r*s}},{key:"interpolateZ",value:function(e,r,s,o){var f=r.x,v=r.y,y=s.x-f,_=o.x-f,E=s.y-v,M=o.y-v,L=y*M-_*E,T=e.x-f,B=e.y-v,F=(M*T-_*B)/L,$=(-E*T+y*B)/L;return r.getZ()+F*(s.getZ()-r.getZ())+$*(o.getZ()-r.getZ())}},{key:"longestSideLength",value:function(e,r,s){var o=e.distance(r),f=r.distance(s),v=s.distance(e),y=o;return f>y&&(y=f),v>y&&(y=v),y}},{key:"circumcentreDD",value:function(e,r,s){var o=Q.valueOf(e.x).subtract(s.x),f=Q.valueOf(e.y).subtract(s.y),v=Q.valueOf(r.x).subtract(s.x),y=Q.valueOf(r.y).subtract(s.y),_=Q.determinant(o,f,v,y).multiply(2),E=o.sqr().add(f.sqr()),M=v.sqr().add(y.sqr()),L=Q.determinant(f,E,y,M),T=Q.determinant(o,E,v,M),B=Q.valueOf(s.x).subtract(L.divide(_)).doubleValue(),F=Q.valueOf(s.y).add(T.divide(_)).doubleValue();return new b(B,F)}},{key:"isAcute",value:function(e,r,s){return!!Qe.isAcute(e,r,s)&&!!Qe.isAcute(r,s,e)&&!!Qe.isAcute(s,e,r)}},{key:"circumcentre",value:function(e,r,s){var o=s.x,f=s.y,v=e.x-o,y=e.y-f,_=r.x-o,E=r.y-f,M=2*l.det(v,y,_,E),L=l.det(y,v*v+y*y,E,_*_+E*E),T=l.det(v,v*v+y*y,_,_*_+E*E);return new b(o-L/M,f+T/M)}},{key:"perpendicularBisector",value:function(e,r){var s=r.x-e.x,o=r.y-e.y,f=new ci(e.x+s/2,e.y+o/2,1),v=new ci(e.x-o+s/2,e.y+s+o/2,1);return new ci(f,v)}},{key:"angleBisector",value:function(e,r,s){var o=r.distance(e),f=o/(o+r.distance(s)),v=s.x-e.x,y=s.y-e.y;return new b(e.x+f*v,e.y+f*y)}},{key:"area3D",value:function(e,r,s){var o=r.x-e.x,f=r.y-e.y,v=r.getZ()-e.getZ(),y=s.x-e.x,_=s.y-e.y,E=s.getZ()-e.getZ(),M=f*E-v*_,L=v*y-o*E,T=o*_-f*y,B=M*M+L*L+T*T,F=Math.sqrt(B)/2;return F}},{key:"centroid",value:function(e,r,s){var o=(e.x+r.x+s.x)/3,f=(e.y+r.y+s.y)/3;return new b(o,f)}},{key:"inCentre",value:function(e,r,s){var o=r.distance(s),f=e.distance(s),v=e.distance(r),y=o+f+v,_=(o*e.x+f*r.x+v*s.x)/y,E=(o*e.y+f*r.y+v*s.y)/y;return new b(_,E)}}]),l}(),dl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"addRingSide",value:function(e,r,s,o,f){if(r===0&&e.length<xn.MINIMUM_VALID_SIZE)return null;var v=o,y=f;e.length>=xn.MINIMUM_VALID_SIZE&&ee.isCCW(e)&&(v=f,y=o,s=q.opposite(s));var _=this._curveBuilder.getRingCurve(e,s,r);this.addCurve(_,v,y)}},{key:"addRingBothSides",value:function(e,r){this.addRingSide(e,r,q.LEFT,N.EXTERIOR,N.INTERIOR),this.addRingSide(e,r,q.RIGHT,N.INTERIOR,N.EXTERIOR)}},{key:"addPoint",value:function(e){if(this._distance<=0)return null;var r=e.getCoordinates(),s=this._curveBuilder.getLineCurve(r,this._distance);this.addCurve(s,N.EXTERIOR,N.INTERIOR)}},{key:"addPolygon",value:function(e){var r=this._distance,s=q.LEFT;this._distance<0&&(r=-this._distance,s=q.RIGHT);var o=e.getExteriorRing(),f=qe.removeRepeatedPoints(o.getCoordinates());if(this._distance<0&&this.isErodedCompletely(o,this._distance)||this._distance<=0&&f.length<3)return null;this.addRingSide(f,r,s,N.EXTERIOR,N.INTERIOR);for(var v=0;v<e.getNumInteriorRing();v++){var y=e.getInteriorRingN(v),_=qe.removeRepeatedPoints(y.getCoordinates());this._distance>0&&this.isErodedCompletely(y,-this._distance)||this.addRingSide(_,r,q.opposite(s),N.INTERIOR,N.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(e,r){var s=new gl(e[0],e[1],e[2]),o=s.inCentre();return ft.pointToSegment(o,s.p0,s.p1)<Math.abs(r)}},{key:"addLineString",value:function(e){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var r=qe.removeRepeatedPoints(e.getCoordinates());if(qe.isRing(r)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(r,this._distance);else{var s=this._curveBuilder.getLineCurve(r,this._distance);this.addCurve(s,N.EXTERIOR,N.INTERIOR)}}},{key:"addCurve",value:function(e,r,s){if(e===null||e.length<2)return null;var o=new Dt(e,new it(0,N.BOUNDARY,r,s));this._curveList.add(o)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(e){if(e.isEmpty())return null;if(e instanceof or)this.addPolygon(e);else if(e instanceof _n)this.addLineString(e);else if(e instanceof Qr)this.addPoint(e);else if(e instanceof jr)this.addCollection(e);else if(e instanceof ri)this.addCollection(e);else if(e instanceof ni)this.addCollection(e);else{if(!(e instanceof Je))throw new ct(e.getGeometryType());this.addCollection(e)}}},{key:"isErodedCompletely",value:function(e,r){var s=e.getCoordinates();if(s.length<4)return r<0;if(s.length===4)return this.isTriangleErodedCompletely(s,r);var o=e.getEnvelopeInternal(),f=Math.min(o.getHeight(),o.getWidth());return r<0&&2*Math.abs(r)>f}},{key:"addCollection",value:function(e){for(var r=0;r<e.getNumGeometries();r++){var s=e.getGeometryN(r);this.add(s)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new K;var e=arguments[0],r=arguments[1],s=arguments[2];this._inputGeom=e,this._distance=r,this._curveBuilder=s}}]),l}(),vl=function(){function l(){t(this,l)}return u(l,[{key:"locate",value:function(e){}}]),l}(),ml=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,l.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new $t;var e=this._parent.getGeometryN(this._index++);return e instanceof Je?(this._subcollectionIterator=new l(e),this._subcollectionIterator.next()):e}},{key:"remove",value:function(){throw new ct(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[sl]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()}},{key:"isAtomic",value:function(e){return!(e instanceof Je)}}]),l}(),yl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"locate",value:function(e){return l.locate(e,this._geom)}},{key:"interfaces_",get:function(){return[vl]}}],[{key:"constructor_",value:function(){this._geom=null;var e=arguments[0];this._geom=e}},{key:"locatePointInPolygon",value:function(e,r){if(r.isEmpty())return N.EXTERIOR;var s=r.getExteriorRing(),o=l.locatePointInRing(e,s);if(o!==N.INTERIOR)return o;for(var f=0;f<r.getNumInteriorRing();f++){var v=r.getInteriorRingN(f),y=l.locatePointInRing(e,v);if(y===N.BOUNDARY)return N.BOUNDARY;if(y===N.INTERIOR)return N.EXTERIOR}return N.INTERIOR}},{key:"locatePointInRing",value:function(e,r){return r.getEnvelopeInternal().intersects(e)?ai.locateInRing(e,r.getCoordinates()):N.EXTERIOR}},{key:"containsPointInPolygon",value:function(e,r){return N.EXTERIOR!==l.locatePointInPolygon(e,r)}},{key:"locateInGeometry",value:function(e,r){if(r instanceof or)return l.locatePointInPolygon(e,r);if(r instanceof Je)for(var s=new ml(r);s.hasNext();){var o=s.next();if(o!==r){var f=l.locateInGeometry(e,o);if(f!==N.EXTERIOR)return f}}return N.EXTERIOR}},{key:"isContained",value:function(e,r){return N.EXTERIOR!==l.locate(e,r)}},{key:"locate",value:function(e,r){return r.isEmpty()?N.EXTERIOR:r.getEnvelopeInternal().intersects(e)?l.locateInGeometry(e,r):N.EXTERIOR}}]),l}(),pl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getNextCW",value:function(e){this.getEdges();var r=this._edgeList.indexOf(e),s=r-1;return r===0&&(s=this._edgeList.size()-1),this._edgeList.get(s)}},{key:"propagateSideLabels",value:function(e){for(var r=N.NONE,s=this.iterator();s.hasNext();){var o=s.next().getLabel();o.isArea(e)&&o.getLocation(e,q.LEFT)!==N.NONE&&(r=o.getLocation(e,q.LEFT))}if(r===N.NONE)return null;for(var f=r,v=this.iterator();v.hasNext();){var y=v.next(),_=y.getLabel();if(_.getLocation(e,q.ON)===N.NONE&&_.setLocation(e,q.ON,f),_.isArea(e)){var E=_.getLocation(e,q.LEFT),M=_.getLocation(e,q.RIGHT);if(M!==N.NONE){if(M!==f)throw new pt("side location conflict",y.getCoordinate());E===N.NONE&&U.shouldNeverReachHere("found single null side (at "+y.getCoordinate()+")"),f=E}else U.isTrue(_.getLocation(e,q.LEFT)===N.NONE,"found single null side"),_.setLocation(e,q.RIGHT,f),_.setLocation(e,q.LEFT,f)}}}},{key:"getCoordinate",value:function(){var e=this.iterator();return e.hasNext()?e.next().getCoordinate():null}},{key:"print",value:function(e){nt.out.println("EdgeEndStar:   "+this.getCoordinate());for(var r=this.iterator();r.hasNext();)r.next().print(e)}},{key:"isAreaLabelsConsistent",value:function(e){return this.computeEdgeEndLabels(e.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(e){var r=this.getEdges();if(r.size()<=0)return!0;var s=r.size()-1,o=r.get(s).getLabel().getLocation(e,q.LEFT);U.isTrue(o!==N.NONE,"Found unlabelled area edge");for(var f=o,v=this.iterator();v.hasNext();){var y=v.next().getLabel();U.isTrue(y.isArea(e),"Found non-area edge");var _=y.getLocation(e,q.LEFT),E=y.getLocation(e,q.RIGHT);if(_===E||E!==f)return!1;f=_}return!0}},{key:"findIndex",value:function(e){this.iterator();for(var r=0;r<this._edgeList.size();r++)if(this._edgeList.get(r)===e)return r;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new K(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(e,r,s){return this._ptInAreaLocation[e]===N.NONE&&(this._ptInAreaLocation[e]=yl.locate(r,s[e].getGeometry())),this._ptInAreaLocation[e]}},{key:"toString",value:function(){var e=new yn;e.append("EdgeEndStar:   "+this.getCoordinate()),e.append(`
`);for(var r=this.iterator();r.hasNext();){var s=r.next();e.append(s),e.append(`
`)}return e.toString()}},{key:"computeEdgeEndLabels",value:function(e){for(var r=this.iterator();r.hasNext();)r.next().computeLabel(e)}},{key:"computeLabelling",value:function(e){this.computeEdgeEndLabels(e[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var r=[!1,!1],s=this.iterator();s.hasNext();)for(var o=s.next().getLabel(),f=0;f<2;f++)o.isLine(f)&&o.getLocation(f)===N.BOUNDARY&&(r[f]=!0);for(var v=this.iterator();v.hasNext();)for(var y=v.next(),_=y.getLabel(),E=0;E<2;E++)if(_.isAnyNull(E)){var M=N.NONE;if(r[E])M=N.EXTERIOR;else{var L=y.getCoordinate();M=this.getLocation(E,L,e)}_.setAllLocationsIfNull(E,M)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(e,r){this._edgeMap.put(e,r),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new In,this._edgeList=null,this._ptInAreaLocation=[N.NONE,N.NONE]}}]),l}(),_l=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var s=null,o=null,f=this._SCANNING_FOR_INCOMING,v=0;v<this._resultAreaEdgeList.size();v++){var y=this._resultAreaEdgeList.get(v),_=y.getSym();if(y.getLabel().isArea())switch(s===null&&y.isInResult()&&(s=y),f){case this._SCANNING_FOR_INCOMING:if(!_.isInResult())continue;o=_,f=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!y.isInResult())continue;o.setNext(y),f=this._SCANNING_FOR_INCOMING}}if(f===this._LINKING_TO_OUTGOING){if(s===null)throw new pt("no outgoing dirEdge found",this.getCoordinate());U.isTrue(s.isInResult(),"unable to link last incoming dirEdge"),o.setNext(s)}}},{key:"insert",value:function(s){var o=s;this.insertEdgeEnd(o,o)}},{key:"getRightmostEdge",value:function(){var s=this.getEdges(),o=s.size();if(o<1)return null;var f=s.get(0);if(o===1)return f;var v=s.get(o-1),y=f.getQuadrant(),_=v.getQuadrant();return $e.isNorthern(y)&&$e.isNorthern(_)?f:$e.isNorthern(y)||$e.isNorthern(_)?f.getDy()!==0?f:v.getDy()!==0?v:(U.shouldNeverReachHere("found two horizontal edges incident on node"),null):v}},{key:"print",value:function(s){nt.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var o=this.iterator();o.hasNext();){var f=o.next();s.print("out "),f.print(s),s.println(),s.print("in "),f.getSym().print(s),s.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new K;for(var s=this.iterator();s.hasNext();){var o=s.next();(o.isInResult()||o.getSym().isInResult())&&this._resultAreaEdgeList.add(o)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(s){for(var o=this.iterator();o.hasNext();){var f=o.next().getLabel();f.setAllLocationsIfNull(0,s.getLocation(0)),f.setAllLocationsIfNull(1,s.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var s=null,o=null,f=this._edgeList.size()-1;f>=0;f--){var v=this._edgeList.get(f),y=v.getSym();o===null&&(o=y),s!==null&&y.setNext(s),s=v}o.setNext(s)}},{key:"computeDepths",value:function(){if(arguments.length===1){var s=arguments[0],o=this.findIndex(s),f=s.getDepth(q.LEFT),v=s.getDepth(q.RIGHT),y=this.computeDepths(o+1,this._edgeList.size(),f),_=this.computeDepths(0,o,y);if(_!==v)throw new pt("depth mismatch at "+s.getCoordinate())}else if(arguments.length===3){for(var E=arguments[0],M=arguments[1],L=arguments[2],T=L,B=E;B<M;B++){var F=this._edgeList.get(B);F.setEdgeDepths(q.RIGHT,T),T=F.getDepth(q.LEFT)}return T}}},{key:"mergeSymLabels",value:function(){for(var s=this.iterator();s.hasNext();){var o=s.next();o.getLabel().merge(o.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(s){for(var o=null,f=null,v=this._SCANNING_FOR_INCOMING,y=this._resultAreaEdgeList.size()-1;y>=0;y--){var _=this._resultAreaEdgeList.get(y),E=_.getSym();switch(o===null&&_.getEdgeRing()===s&&(o=_),v){case this._SCANNING_FOR_INCOMING:if(E.getEdgeRing()!==s)continue;f=E,v=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(_.getEdgeRing()!==s)continue;f.setNextMin(_),v=this._SCANNING_FOR_INCOMING}}v===this._LINKING_TO_OUTGOING&&(U.isTrue(o!==null,"found null for first outgoing dirEdge"),U.isTrue(o.getEdgeRing()===s,"unable to link last incoming dirEdge"),f.setNextMin(o))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var s=0,o=this.iterator();o.hasNext();){var f=o.next();f.isInResult()&&s++}return s}if(arguments.length===1){for(var v=arguments[0],y=0,_=this.iterator();_.hasNext();){var E=_.next();E.getEdgeRing()===v&&y++}return y}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var s=N.NONE,o=this.iterator();o.hasNext();){var f=o.next(),v=f.getSym();if(!f.isLineEdge()){if(f.isInResult()){s=N.INTERIOR;break}if(v.isInResult()){s=N.EXTERIOR;break}}}if(s===N.NONE)return null;for(var y=s,_=this.iterator();_.hasNext();){var E=_.next(),M=E.getSym();E.isLineEdge()?E.getEdge().setCovered(y===N.INTERIOR):(E.isInResult()&&(y=N.EXTERIOR),M.isInResult()&&(y=N.INTERIOR))}}},{key:"computeLabelling",value:function(s){k(c(r.prototype),"computeLabelling",this).call(this,s),this._label=new it(N.NONE);for(var o=this.iterator();o.hasNext();)for(var f=o.next().getEdge().getLabel(),v=0;v<2;v++){var y=f.getLocation(v);y!==N.INTERIOR&&y!==N.BOUNDARY||this._label.setLocation(v,N.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}]),r}(pl),xl=function(l){h(r,l);var e=w(r);function r(){return t(this,r),e.call(this)}return u(r,[{key:"createNode",value:function(s){return new fr(s,new _l)}}]),r}(Ls),Ys=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"compareTo",value:function(e){var r=e;return l.compareOriented(this._pts,this._orientation,r._pts,r._orientation)}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=l.orientation(e)}},{key:"orientation",value:function(e){return qe.increasingDirection(e)===1}},{key:"compareOriented",value:function(e,r,s,o){for(var f=r?1:-1,v=o?1:-1,y=r?e.length:-1,_=o?s.length:-1,E=r?0:e.length-1,M=o?0:s.length-1;;){var L=e[E].compareTo(s[M]);if(L!==0)return L;var T=(E+=f)===y,B=(M+=v)===_;if(T&&!B)return-1;if(!T&&B)return 1;if(T&&B)return 0}}}]),l}(),El=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"print",value:function(e){e.print("MULTILINESTRING ( ");for(var r=0;r<this._edges.size();r++){var s=this._edges.get(r);r>0&&e.print(","),e.print("(");for(var o=s.getCoordinates(),f=0;f<o.length;f++)f>0&&e.print(","),e.print(o[f].x+" "+o[f].y);e.println(")")}e.print(")  ")}},{key:"addAll",value:function(e){for(var r=e.iterator();r.hasNext();)this.add(r.next())}},{key:"findEdgeIndex",value:function(e){for(var r=0;r<this._edges.size();r++)if(this._edges.get(r).equals(e))return r;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(e){return this._edges.get(e)}},{key:"findEqualEdge",value:function(e){var r=new Ys(e.getCoordinates());return this._ocaMap.get(r)}},{key:"add",value:function(e){this._edges.add(e);var r=new Ys(e.getCoordinates());this._ocaMap.put(r,e)}}],[{key:"constructor_",value:function(){this._edges=new K,this._ocaMap=new In}}]),l}(),Xs=function(){function l(){t(this,l)}return u(l,[{key:"processIntersections",value:function(e,r,s,o){}},{key:"isDone",value:function(){}}]),l}(),wl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"isTrivialIntersection",value:function(e,r,s,o){if(e===s&&this._li.getIntersectionNum()===1){if(l.isAdjacentSegments(r,o))return!0;if(e.isClosed()){var f=e.size()-1;if(r===0&&o===f||o===0&&r===f)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(e,r,s,o){if(e===s&&r===o)return null;this.numTests++;var f=e.getCoordinates()[r],v=e.getCoordinates()[r+1],y=s.getCoordinates()[o],_=s.getCoordinates()[o+1];this._li.computeIntersection(f,v,y,_),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,r,s,o)||(this._hasIntersection=!0,e.addIntersections(this._li,r,0),s.addIntersections(this._li,o,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[Xs]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var e=arguments[0];this._li=e}},{key:"isAdjacentSegments",value:function(e,r){return Math.abs(e-r)===1}}]),l}(),kl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex),e.println(" dist = "+this.dist)}},{key:"compareTo",value:function(e){var r=e;return this.compare(r.segmentIndex,r.dist)}},{key:"isEndPoint",value:function(e){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===e}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(e,r){return this.segmentIndex<e?-1:this.segmentIndex>e?1:this.dist<r?-1:this.dist>r?1:0}},{key:"interfaces_",get:function(){return[X]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var e=arguments[0],r=arguments[1],s=arguments[2];this.coord=new b(e),this.segmentIndex=r,this.dist=s}}]),l}(),Il=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"print",value:function(e){e.println("Intersections:");for(var r=this.iterator();r.hasNext();)r.next().print(e)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(e){this.addEndpoints();for(var r=this.iterator(),s=r.next();r.hasNext();){var o=r.next(),f=this.createSplitEdge(s,o);e.add(f),s=o}}},{key:"addEndpoints",value:function(){var e=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[e],e,0)}},{key:"createSplitEdge",value:function(e,r){var s=r.segmentIndex-e.segmentIndex+2,o=this.edge.pts[r.segmentIndex],f=r.dist>0||!r.coord.equals2D(o);f||s--;var v=new Array(s).fill(null),y=0;v[y++]=new b(e.coord);for(var _=e.segmentIndex+1;_<=r.segmentIndex;_++)v[y++]=this.edge.pts[_];return f&&(v[y]=r.coord),new zs(v,new it(this.edge._label))}},{key:"add",value:function(e,r,s){var o=new kl(e,r,s),f=this._nodeMap.get(o);return f!==null?f:(this._nodeMap.put(o,o),o)}},{key:"isIntersection",value:function(e){for(var r=this.iterator();r.hasNext();)if(r.next().coord.equals(e))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new In,this.edge=null;var e=arguments[0];this.edge=e}}]),l}(),Nl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(l.isTrue(this._matrix[N.INTERIOR][N.INTERIOR])||l.isTrue(this._matrix[N.INTERIOR][N.BOUNDARY])||l.isTrue(this._matrix[N.BOUNDARY][N.INTERIOR])||l.isTrue(this._matrix[N.BOUNDARY][N.BOUNDARY]))&&this._matrix[N.EXTERIOR][N.INTERIOR]===Y.FALSE&&this._matrix[N.EXTERIOR][N.BOUNDARY]===Y.FALSE}},{key:"isCoveredBy",value:function(){return(l.isTrue(this._matrix[N.INTERIOR][N.INTERIOR])||l.isTrue(this._matrix[N.INTERIOR][N.BOUNDARY])||l.isTrue(this._matrix[N.BOUNDARY][N.INTERIOR])||l.isTrue(this._matrix[N.BOUNDARY][N.BOUNDARY]))&&this._matrix[N.INTERIOR][N.EXTERIOR]===Y.FALSE&&this._matrix[N.BOUNDARY][N.EXTERIOR]===Y.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var e=arguments[0],r=0;r<e.length;r++){var s=Math.trunc(r/3),o=r%3;this._matrix[s][o]=Y.toDimensionValue(e.charAt(r))}else if(arguments.length===3){var f=arguments[0],v=arguments[1],y=arguments[2];this._matrix[f][v]=y}}},{key:"isContains",value:function(){return l.isTrue(this._matrix[N.INTERIOR][N.INTERIOR])&&this._matrix[N.EXTERIOR][N.INTERIOR]===Y.FALSE&&this._matrix[N.EXTERIOR][N.BOUNDARY]===Y.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var e=arguments[0],r=0;r<e.length;r++){var s=Math.trunc(r/3),o=r%3;this.setAtLeast(s,o,Y.toDimensionValue(e.charAt(r)))}else if(arguments.length===3){var f=arguments[0],v=arguments[1],y=arguments[2];this._matrix[f][v]<y&&(this._matrix[f][v]=y)}}},{key:"setAtLeastIfValid",value:function(e,r,s){e>=0&&r>=0&&this.setAtLeast(e,r,s)}},{key:"isWithin",value:function(){return l.isTrue(this._matrix[N.INTERIOR][N.INTERIOR])&&this._matrix[N.INTERIOR][N.EXTERIOR]===Y.FALSE&&this._matrix[N.BOUNDARY][N.EXTERIOR]===Y.FALSE}},{key:"isTouches",value:function(e,r){return e>r?this.isTouches(r,e):(e===Y.A&&r===Y.A||e===Y.L&&r===Y.L||e===Y.L&&r===Y.A||e===Y.P&&r===Y.A||e===Y.P&&r===Y.L)&&this._matrix[N.INTERIOR][N.INTERIOR]===Y.FALSE&&(l.isTrue(this._matrix[N.INTERIOR][N.BOUNDARY])||l.isTrue(this._matrix[N.BOUNDARY][N.INTERIOR])||l.isTrue(this._matrix[N.BOUNDARY][N.BOUNDARY]))}},{key:"isOverlaps",value:function(e,r){return e===Y.P&&r===Y.P||e===Y.A&&r===Y.A?l.isTrue(this._matrix[N.INTERIOR][N.INTERIOR])&&l.isTrue(this._matrix[N.INTERIOR][N.EXTERIOR])&&l.isTrue(this._matrix[N.EXTERIOR][N.INTERIOR]):e===Y.L&&r===Y.L&&this._matrix[N.INTERIOR][N.INTERIOR]===1&&l.isTrue(this._matrix[N.INTERIOR][N.EXTERIOR])&&l.isTrue(this._matrix[N.EXTERIOR][N.INTERIOR])}},{key:"isEquals",value:function(e,r){return e===r&&l.isTrue(this._matrix[N.INTERIOR][N.INTERIOR])&&this._matrix[N.INTERIOR][N.EXTERIOR]===Y.FALSE&&this._matrix[N.BOUNDARY][N.EXTERIOR]===Y.FALSE&&this._matrix[N.EXTERIOR][N.INTERIOR]===Y.FALSE&&this._matrix[N.EXTERIOR][N.BOUNDARY]===Y.FALSE}},{key:"toString",value:function(){for(var e=new lr("123456789"),r=0;r<3;r++)for(var s=0;s<3;s++)e.setCharAt(3*r+s,Y.toDimensionSymbol(this._matrix[r][s]));return e.toString()}},{key:"setAll",value:function(e){for(var r=0;r<3;r++)for(var s=0;s<3;s++)this._matrix[r][s]=e}},{key:"get",value:function(e,r){return this._matrix[e][r]}},{key:"transpose",value:function(){var e=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=e,e=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=e,e=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=e,this}},{key:"matches",value:function(e){if(e.length!==9)throw new O("Should be length 9: "+e);for(var r=0;r<3;r++)for(var s=0;s<3;s++)if(!l.matches(this._matrix[r][s],e.charAt(3*r+s)))return!1;return!0}},{key:"add",value:function(e){for(var r=0;r<3;r++)for(var s=0;s<3;s++)this.setAtLeast(r,s,e.get(r,s))}},{key:"isDisjoint",value:function(){return this._matrix[N.INTERIOR][N.INTERIOR]===Y.FALSE&&this._matrix[N.INTERIOR][N.BOUNDARY]===Y.FALSE&&this._matrix[N.BOUNDARY][N.INTERIOR]===Y.FALSE&&this._matrix[N.BOUNDARY][N.BOUNDARY]===Y.FALSE}},{key:"isCrosses",value:function(e,r){return e===Y.P&&r===Y.L||e===Y.P&&r===Y.A||e===Y.L&&r===Y.A?l.isTrue(this._matrix[N.INTERIOR][N.INTERIOR])&&l.isTrue(this._matrix[N.INTERIOR][N.EXTERIOR]):e===Y.L&&r===Y.P||e===Y.A&&r===Y.P||e===Y.A&&r===Y.L?l.isTrue(this._matrix[N.INTERIOR][N.INTERIOR])&&l.isTrue(this._matrix[N.EXTERIOR][N.INTERIOR]):e===Y.L&&r===Y.L&&this._matrix[N.INTERIOR][N.INTERIOR]===0}},{key:"interfaces_",get:function(){return[Z]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(Y.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var e=arguments[0];l.constructor_.call(this),this.set(e)}else if(arguments[0]instanceof l){var r=arguments[0];l.constructor_.call(this),this._matrix[N.INTERIOR][N.INTERIOR]=r._matrix[N.INTERIOR][N.INTERIOR],this._matrix[N.INTERIOR][N.BOUNDARY]=r._matrix[N.INTERIOR][N.BOUNDARY],this._matrix[N.INTERIOR][N.EXTERIOR]=r._matrix[N.INTERIOR][N.EXTERIOR],this._matrix[N.BOUNDARY][N.INTERIOR]=r._matrix[N.BOUNDARY][N.INTERIOR],this._matrix[N.BOUNDARY][N.BOUNDARY]=r._matrix[N.BOUNDARY][N.BOUNDARY],this._matrix[N.BOUNDARY][N.EXTERIOR]=r._matrix[N.BOUNDARY][N.EXTERIOR],this._matrix[N.EXTERIOR][N.INTERIOR]=r._matrix[N.EXTERIOR][N.INTERIOR],this._matrix[N.EXTERIOR][N.BOUNDARY]=r._matrix[N.EXTERIOR][N.BOUNDARY],this._matrix[N.EXTERIOR][N.EXTERIOR]=r._matrix[N.EXTERIOR][N.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var e=arguments[0],r=arguments[1];return r===Y.SYM_DONTCARE||r===Y.SYM_TRUE&&(e>=0||e===Y.TRUE)||r===Y.SYM_FALSE&&e===Y.FALSE||r===Y.SYM_P&&e===Y.P||r===Y.SYM_L&&e===Y.L||r===Y.SYM_A&&e===Y.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var s=arguments[0],o=arguments[1],f=new l(s);return f.matches(o)}}},{key:"isTrue",value:function(e){return e>=0||e===Y.TRUE}}]),l}(),Ml=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(e){return e===null||e.length===0?null:(this.ensureCapacity(this._size+e.length),nt.arraycopy(e,0,this._data,this._size,e.length),void(this._size+=e.length))}},{key:"ensureCapacity",value:function(e){if(e<=this._data.length)return null;var r=Math.max(e,2*this._data.length);this._data=Tt.copyOf(this._data,r)}},{key:"toArray",value:function(){var e=new Array(this._size).fill(null);return nt.arraycopy(this._data,0,e,0,this._size),e}},{key:"add",value:function(e){this.ensureCapacity(this._size+1),this._data[this._size]=e,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)l.constructor_.call(this,10);else if(arguments.length===1){var e=arguments[0];this._data=new Array(e).fill(null)}}}]),l}(),Pl=function(){function l(){t(this,l)}return u(l,[{key:"getChainStartIndices",value:function(e){var r=0,s=new Ml(Math.trunc(e.length/2));s.add(r);do{var o=this.findChainEnd(e,r);s.add(o),r=o}while(r<e.length-1);return s.toArray()}},{key:"findChainEnd",value:function(e,r){for(var s=$e.quadrant(e[r],e[r+1]),o=r+1;o<e.length&&$e.quadrant(e[o-1],e[o])===s;)o++;return o-1}},{key:"OLDgetChainStartIndices",value:function(e){var r=0,s=new K;s.add(r);do{var o=this.findChainEnd(e,r);s.add(o),r=o}while(r<e.length-1);return l.toIntArray(s)}}],[{key:"toIntArray",value:function(e){for(var r=new Array(e.size()).fill(null),s=0;s<r.length;s++)r[s]=e.get(s).intValue();return r}}]),l}(),Ll=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(e){var r=this.pts[this.startIndex[e]].x,s=this.pts[this.startIndex[e+1]].x;return r>s?r:s}},{key:"getMinX",value:function(e){var r=this.pts[this.startIndex[e]].x,s=this.pts[this.startIndex[e+1]].x;return r<s?r:s}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var e=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];this.computeIntersectsForChain(this.startIndex[e],this.startIndex[e+1],r,r.startIndex[s],r.startIndex[s+1],o)}else if(arguments.length===6){var f=arguments[0],v=arguments[1],y=arguments[2],_=arguments[3],E=arguments[4],M=arguments[5];if(v-f==1&&E-_==1)return M.addIntersections(this.e,f,y.e,_),null;if(!this.overlaps(f,v,y,_,E))return null;var L=Math.trunc((f+v)/2),T=Math.trunc((_+E)/2);f<L&&(_<T&&this.computeIntersectsForChain(f,L,y,_,T,M),T<E&&this.computeIntersectsForChain(f,L,y,T,E,M)),L<v&&(_<T&&this.computeIntersectsForChain(L,v,y,_,T,M),T<E&&this.computeIntersectsForChain(L,v,y,T,E,M))}}},{key:"overlaps",value:function(e,r,s,o,f){return we.intersects(this.pts[e],this.pts[r],s.pts[o],s.pts[f])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(e,r){for(var s=0;s<this.startIndex.length-1;s++)for(var o=0;o<e.startIndex.length-1;o++)this.computeIntersectsForChain(s,e,o,r)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var e=arguments[0];this.e=e,this.pts=e.getCoordinates();var r=new Pl;this.startIndex=r.getChainStartIndices(this.pts)}}]),l}(),Gs=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"getDepth",value:function(e,r){return this._depth[e][r]}},{key:"setDepth",value:function(e,r,s){this._depth[e][r]=s}},{key:"isNull",value:function(){if(arguments.length===0){for(var e=0;e<2;e++)for(var r=0;r<3;r++)if(this._depth[e][r]!==l.NULL_VALUE)return!1;return!0}if(arguments.length===1){var s=arguments[0];return this._depth[s][1]===l.NULL_VALUE}if(arguments.length===2){var o=arguments[0],f=arguments[1];return this._depth[o][f]===l.NULL_VALUE}}},{key:"normalize",value:function(){for(var e=0;e<2;e++)if(!this.isNull(e)){var r=this._depth[e][1];this._depth[e][2]<r&&(r=this._depth[e][2]),r<0&&(r=0);for(var s=1;s<3;s++){var o=0;this._depth[e][s]>r&&(o=1),this._depth[e][s]=o}}}},{key:"getDelta",value:function(e){return this._depth[e][q.RIGHT]-this._depth[e][q.LEFT]}},{key:"getLocation",value:function(e,r){return this._depth[e][r]<=0?N.EXTERIOR:N.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var e=arguments[0],r=0;r<2;r++)for(var s=1;s<3;s++){var o=e.getLocation(r,s);o!==N.EXTERIOR&&o!==N.INTERIOR||(this.isNull(r,s)?this._depth[r][s]=l.depthAtLocation(o):this._depth[r][s]+=l.depthAtLocation(o))}else if(arguments.length===3){var f=arguments[0],v=arguments[1],y=arguments[2];y===N.INTERIOR&&this._depth[f][v]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var e=0;e<2;e++)for(var r=0;r<3;r++)this._depth[e][r]=l.NULL_VALUE}},{key:"depthAtLocation",value:function(e){return e===N.EXTERIOR?0:e===N.INTERIOR?1:l.NULL_VALUE}}]),l}();Gs.NULL_VALUE=-1;var zs=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var s=new Array(2).fill(null);return s[0]=this.pts[0],s[1]=this.pts[1],new r(s,it.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(s){this._isIsolated=s}},{key:"setName",value:function(s){this._name=s}},{key:"equals",value:function(s){if(!(s instanceof r))return!1;var o=s;if(this.pts.length!==o.pts.length)return!1;for(var f=!0,v=!0,y=this.pts.length,_=0;_<this.pts.length;_++)if(this.pts[_].equals2D(o.pts[_])||(f=!1),this.pts[_].equals2D(o.pts[--y])||(v=!1),!f&&!v)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var s=arguments[0];return this.pts[s]}}},{key:"print",value:function(s){s.print("edge "+this._name+": "),s.print("LINESTRING (");for(var o=0;o<this.pts.length;o++)o>0&&s.print(","),s.print(this.pts[o].x+" "+this.pts[o].y);s.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(s){r.updateIM(this._label,s)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(s){s.print("edge "+this._name+": ");for(var o=this.pts.length-1;o>=0;o--)s.print(this.pts[o]+" ");s.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new Ll(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new we;for(var s=0;s<this.pts.length;s++)this._env.expandToInclude(this.pts[s])}return this._env}},{key:"addIntersection",value:function(s,o,f,v){var y=new b(s.getIntersection(v)),_=o,E=s.getEdgeDistance(f,v),M=_+1;if(M<this.pts.length){var L=this.pts[M];y.equals2D(L)&&(_=M,E=0)}this.eiList.add(y,_,E)}},{key:"toString",value:function(){var s=new lr;s.append("edge "+this._name+": "),s.append("LINESTRING (");for(var o=0;o<this.pts.length;o++)o>0&&s.append(","),s.append(this.pts[o].x+" "+this.pts[o].y);return s.append(")  "+this._label+" "+this._depthDelta),s.toString()}},{key:"isPointwiseEqual",value:function(s){if(this.pts.length!==s.pts.length)return!1;for(var o=0;o<this.pts.length;o++)if(!this.pts[o].equals2D(s.pts[o]))return!1;return!0}},{key:"setDepthDelta",value:function(s){this._depthDelta=s}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(s,o,f){for(var v=0;v<s.getIntersectionNum();v++)this.addIntersection(s,o,f,v)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new Il(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Gs,this._depthDelta=0,arguments.length===1){var s=arguments[0];r.constructor_.call(this,s,null)}else if(arguments.length===2){var o=arguments[0],f=arguments[1];this.pts=o,this._label=f}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Nl&&arguments[0]instanceof it))return k(c(r),"updateIM",this).apply(this,arguments);var s=arguments[0],o=arguments[1];o.setAtLeastIfValid(s.getLocation(0,q.ON),s.getLocation(1,q.ON),1),s.isArea()&&(o.setAtLeastIfValid(s.getLocation(0,q.LEFT),s.getLocation(1,q.LEFT),2),o.setAtLeastIfValid(s.getLocation(0,q.RIGHT),s.getLocation(1,q.RIGHT),2))}}]),r}(ks),Us=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"setWorkingPrecisionModel",value:function(e){this._workingPrecisionModel=e}},{key:"insertUniqueEdge",value:function(e){var r=this._edgeList.findEqualEdge(e);if(r!==null){var s=r.getLabel(),o=e.getLabel();r.isPointwiseEqual(e)||(o=new it(e.getLabel())).flip(),s.merge(o);var f=l.depthDelta(o),v=r.getDepthDelta()+f;r.setDepthDelta(v)}else this._edgeList.add(e),e.setDepthDelta(l.depthDelta(e.getLabel()))}},{key:"buildSubgraphs",value:function(e,r){for(var s=new K,o=e.iterator();o.hasNext();){var f=o.next(),v=f.getRightmostCoordinate(),y=new Fs(s).getDepth(v);f.computeDepth(y),f.findResultEdges(),s.add(f),r.add(f.getDirectedEdges(),f.getNodes())}}},{key:"createSubgraphs",value:function(e){for(var r=new K,s=e.getNodes().iterator();s.hasNext();){var o=s.next();if(!o.isVisited()){var f=new Ou;f.create(o),r.add(f)}}return Jt.sort(r,Jt.reverseOrder()),r}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(e){if(this._workingNoder!==null)return this._workingNoder;var r=new hi,s=new At;return s.setPrecisionModel(e),r.setSegmentIntersector(new wl(s)),r}},{key:"buffer",value:function(e,r){var s=this._workingPrecisionModel;s===null&&(s=e.getPrecisionModel()),this._geomFact=e.getFactory();var o=new fl(s,this._bufParams),f=new dl(e,r,o).getCurves();if(f.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(f,s),this._graph=new Ss(new xl),this._graph.addEdges(this._edgeList.getEdges());var v=this.createSubgraphs(this._graph),y=new ju(this._geomFact);this.buildSubgraphs(v,y);var _=y.getPolygons();return _.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(_)}},{key:"computeNodedEdges",value:function(e,r){var s=this.getNoder(r);s.computeNodes(e);for(var o=s.getNodedSubstrings().iterator();o.hasNext();){var f=o.next(),v=f.getCoordinates();if(v.length!==2||!v[0].equals2D(v[1])){var y=f.getData(),_=new zs(f.getCoordinates(),new it(y));this.insertUniqueEdge(_)}}}},{key:"setNoder",value:function(e){this._workingNoder=e}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new El;var e=arguments[0];this._bufParams=e}},{key:"depthDelta",value:function(e){var r=e.getLocation(0,q.LEFT),s=e.getLocation(0,q.RIGHT);return r===N.INTERIOR&&s===N.EXTERIOR?1:r===N.EXTERIOR&&s===N.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(e){for(var r=new Zt,s=new K;e.hasNext();){var o=e.next(),f=r.createLineString(o.getCoordinates());s.add(f)}return r.buildGeometry(s)}}]),l}(),Sl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"rescale",value:function(){if(oe(arguments[0],tt))for(var e=arguments[0],r=e.iterator();r.hasNext();){var s=r.next();this.rescale(s.getCoordinates())}else if(arguments[0]instanceof Array){for(var o=arguments[0],f=0;f<o.length;f++)o[f].x=o[f].x/this._scaleFactor+this._offsetX,o[f].y=o[f].y/this._scaleFactor+this._offsetY;o.length===2&&o[0].equals2D(o[1])&&nt.out.println(o)}}},{key:"scale",value:function(){if(oe(arguments[0],tt)){for(var e=arguments[0],r=new K(e.size()),s=e.iterator();s.hasNext();){var o=s.next();r.add(new Dt(this.scale(o.getCoordinates()),o.getData()))}return r}if(arguments[0]instanceof Array){for(var f=arguments[0],v=new Array(f.length).fill(null),y=0;y<f.length;y++)v[y]=new b(Math.round((f[y].x-this._offsetX)*this._scaleFactor),Math.round((f[y].y-this._offsetY)*this._scaleFactor),f[y].getZ());var _=qe.removeRepeatedPoints(v);return _}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e}},{key:"computeNodes",value:function(e){var r=e;this._isScaled&&(r=this.scale(e)),this._noder.computeNodes(r)}},{key:"interfaces_",get:function(){return[li]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var e=arguments[0],r=arguments[1];l.constructor_.call(this,e,r,0,0)}else if(arguments.length===4){var s=arguments[0],o=arguments[1];this._noder=s,this._scaleFactor=o,this._isScaled=!this.isIntegerPrecision()}}}]),l}(),Vs=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var r=e.next(),s=r.getCoordinates();this.checkEndPtVertexIntersections(s[0],this._segStrings),this.checkEndPtVertexIntersections(s[s.length-1],this._segStrings)}else if(arguments.length===2){for(var o=arguments[0],f=arguments[1],v=f.iterator();v.hasNext();)for(var y=v.next(),_=y.getCoordinates(),E=1;E<_.length-1;E++)if(_[E].equals(o))throw new Be("found endpt/interior pt intersection at index "+E+" :pt "+o)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();)for(var r=e.next(),s=this._segStrings.iterator();s.hasNext();){var o=s.next();this.checkInteriorIntersections(r,o)}else if(arguments.length===2)for(var f=arguments[0],v=arguments[1],y=f.getCoordinates(),_=v.getCoordinates(),E=0;E<y.length-1;E++)for(var M=0;M<_.length-1;M++)this.checkInteriorIntersections(f,E,v,M);else if(arguments.length===4){var L=arguments[0],T=arguments[1],B=arguments[2],F=arguments[3];if(L===B&&T===F)return null;var $=L.getCoordinates()[T],W=L.getCoordinates()[T+1],te=B.getCoordinates()[F],Ee=B.getCoordinates()[F+1];if(this._li.computeIntersection($,W,te,Ee),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,$,W)||this.hasInteriorIntersection(this._li,te,Ee)))throw new Be("found non-noded intersection at "+$+"-"+W+" and "+te+"-"+Ee)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var r=e.next();this.checkCollapses(r)}else if(arguments.length===1)for(var s=arguments[0],o=s.getCoordinates(),f=0;f<o.length-2;f++)this.checkCollapse(o[f],o[f+1],o[f+2])}},{key:"hasInteriorIntersection",value:function(e,r,s){for(var o=0;o<e.getIntersectionNum();o++){var f=e.getIntersection(o);if(!f.equals(r)&&!f.equals(s))return!0}return!1}},{key:"checkCollapse",value:function(e,r,s){if(e.equals(s))throw new Be("found non-noded collapse at "+l.fact.createLineString([e,r,s]))}}],[{key:"constructor_",value:function(){this._li=new At,this._segStrings=null;var e=arguments[0];this._segStrings=e}}]),l}();Vs.fact=new Zt;var fi=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"intersectsScaled",value:function(e,r){var s=Math.min(e.x,r.x),o=Math.max(e.x,r.x),f=Math.min(e.y,r.y),v=Math.max(e.y,r.y),y=this._maxx<s||this._minx>o||this._maxy<f||this._miny>v;if(y)return!1;var _=this.intersectsToleranceSquare(e,r);return U.isTrue(!(y&&_),"Found bad envelope test"),_}},{key:"initCorners",value:function(e){var r=.5;this._minx=e.x-r,this._maxx=e.x+r,this._miny=e.y-r,this._maxy=e.y+r,this._corner[0]=new b(this._maxx,this._maxy),this._corner[1]=new b(this._minx,this._maxy),this._corner[2]=new b(this._minx,this._miny),this._corner[3]=new b(this._maxx,this._miny)}},{key:"intersects",value:function(e,r){return this._scaleFactor===1?this.intersectsScaled(e,r):(this.copyScaled(e,this._p0Scaled),this.copyScaled(r,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(e){return Math.round(e*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(e,r){r.x=this.scale(e.x),r.y=this.scale(e.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var e=l.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new we(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(e,r){return this._li.computeIntersection(e,r,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,r,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,r,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,r,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(e,r){var s=!1,o=!1;return this._li.computeIntersection(e,r,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(e,r,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(s=!0),this._li.computeIntersection(e,r,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(o=!0),this._li.computeIntersection(e,r,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!s||!o)||!!e.equals(this._pt)||!!r.equals(this._pt))))}},{key:"addSnappedNode",value:function(e,r){var s=e.getCoordinate(r),o=e.getCoordinate(r+1);return!!this.intersects(s,o)&&(e.addIntersection(this.getCoordinate(),r),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],r=arguments[1],s=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=r,this._li=s,r<=0)throw new O("Scale factor must be non-zero");r!==1&&(this._pt=new b(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new b,this._p1Scaled=new b),this.initCorners(this._pt)}}]),l}();fi.SAFE_ENV_EXPANSION_FACTOR=.75;var bl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var e=arguments[0],r=arguments[1];e.getLineSegment(r,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new Ke}}]),l}(),$s=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"snap",value:function(){if(arguments.length===1){var e=arguments[0];return this.snap(e,null,-1)}if(arguments.length===3){var r=arguments[0],s=arguments[1],o=arguments[2],f=r.getSafeEnvelope(),v=new Hs(r,s,o);return this._index.query(f,new(function(){function y(){t(this,y)}return u(y,[{key:"interfaces_",get:function(){return[Cs]}},{key:"visitItem",value:function(_){_.select(f,v)}}]),y}())),v.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var e=arguments[0];this._index=e}}]),l}(),Hs=function(l){h(r,l);var e=w(r);function r(){var s;return t(this,r),s=e.call(this),r.constructor_.apply(x(s),arguments),s}return u(r,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof Os))return k(c(r.prototype),"select",this).apply(this,arguments);var s=arguments[0],o=arguments[1],f=s.getContext();if(this._parentEdge===f&&(o===this._hotPixelVertexIndex||o+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(f,o)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var s=arguments[0],o=arguments[1],f=arguments[2];this._hotPixel=s,this._parentEdge=o,this._hotPixelVertexIndex=f}}]),r}(bl);$s.HotPixelSnapAction=Hs;var Cl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"processIntersections",value:function(e,r,s,o){if(e===s&&r===o)return null;var f=e.getCoordinates()[r],v=e.getCoordinates()[r+1],y=s.getCoordinates()[o],_=s.getCoordinates()[o+1];if(this._li.computeIntersection(f,v,y,_),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var E=0;E<this._li.getIntersectionNum();E++)this._interiorIntersections.add(this._li.getIntersection(E));e.addIntersections(this._li,r,0),s.addIntersections(this._li,o,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[Xs]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var e=arguments[0];this._li=e,this._interiorIntersections=new K}}]),l}(),Tl=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"checkCorrectness",value:function(e){var r=Dt.getNodedSubstrings(e),s=new Vs(r);try{s.checkValid()}catch(o){if(!(o instanceof A))throw o;o.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return Dt.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(e,r){var s=this.findInteriorIntersections(e,r);this.computeIntersectionSnaps(s),this.computeVertexSnaps(e)}},{key:"findInteriorIntersections",value:function(e,r){var s=new Cl(r);return this._noder.setSegmentIntersector(s),this._noder.computeNodes(e),s.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(oe(arguments[0],tt))for(var e=arguments[0],r=e.iterator();r.hasNext();){var s=r.next();this.computeVertexSnaps(s)}else if(arguments[0]instanceof Dt)for(var o=arguments[0],f=o.getCoordinates(),v=0;v<f.length;v++){var y=new fi(f[v],this._scaleFactor,this._li),_=this._pointSnapper.snap(y,o,v);_&&o.addIntersection(f[v],v)}}},{key:"computeNodes",value:function(e){this._nodedSegStrings=e,this._noder=new hi,this._pointSnapper=new $s(this._noder.getIndex()),this.snapRound(e,this._li)}},{key:"computeIntersectionSnaps",value:function(e){for(var r=e.iterator();r.hasNext();){var s=r.next(),o=new fi(s,this._scaleFactor,this._li);this._pointSnapper.snap(o)}}},{key:"interfaces_",get:function(){return[li]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=arguments[0];this._pm=e,this._li=new At,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()}}]),l}(),jt=function(){function l(){t(this,l),l.constructor_.apply(this,arguments)}return u(l,[{key:"bufferFixedPrecision",value:function(e){var r=new Sl(new Tl(new ot(1)),e.getScale()),s=new Us(this._bufParams);s.setWorkingPrecisionModel(e),s.setNoder(r),this._resultGeometry=s.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var e=l.MAX_PRECISION_DIGITS;e>=0;e--){try{this.bufferReducedPrecision(e)}catch(f){if(!(f instanceof pt))throw f;this._saveException=f}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var r=arguments[0],s=l.precisionScaleFactor(this._argGeom,this._distance,r),o=new ot(s);this.bufferFixedPrecision(o)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===ot.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(e){this._bufParams.setQuadrantSegments(e)}},{key:"bufferOriginalPrecision",value:function(){try{var e=new Us(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(r){if(!(r instanceof Be))throw r;this._saveException=r}}},{key:"getResultGeometry",value:function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(e){this._bufParams.setEndCapStyle(e)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new S,this._resultGeometry=null,this._saveException=null,arguments.length===1){var e=arguments[0];this._argGeom=e}else if(arguments.length===2){var r=arguments[0],s=arguments[1];this._argGeom=r,this._bufParams=s}}},{key:"bufferOp",value:function(){if(arguments.length===2){var e=arguments[0],r=arguments[1],s=new l(e),o=s.getResultGeometry(r);return o}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof V&&typeof arguments[1]=="number"){var f=arguments[0],v=arguments[1],y=arguments[2],_=new l(f);_.setQuadrantSegments(y);var E=_.getResultGeometry(v);return E}if(arguments[2]instanceof S&&arguments[0]instanceof V&&typeof arguments[1]=="number"){var M=arguments[0],L=arguments[1],T=arguments[2],B=new l(M,T),F=B.getResultGeometry(L);return F}}else if(arguments.length===4){var $=arguments[0],W=arguments[1],te=arguments[2],Ee=arguments[3],be=new l($);be.setQuadrantSegments(te),be.setEndCapStyle(Ee);var ze=be.getResultGeometry(W);return ze}}},{key:"precisionScaleFactor",value:function(e,r,s){var o=e.getEnvelopeInternal(),f=pn.max(Math.abs(o.getMaxX()),Math.abs(o.getMaxY()),Math.abs(o.getMinX()),Math.abs(o.getMinY()))+2*(r>0?r:0),v=s-Math.trunc(Math.log(f)/Math.log(10)+1);return Math.pow(10,v)}}]),l}();jt.CAP_ROUND=S.CAP_ROUND,jt.CAP_BUTT=S.CAP_FLAT,jt.CAP_FLAT=S.CAP_FLAT,jt.CAP_SQUARE=S.CAP_SQUARE,jt.MAX_PRECISION_DIGITS=12;var Ol=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Zs=function(){function l(e){t(this,l),this.geometryFactory=e||new Zt}return u(l,[{key:"read",value:function(e){var r,s=(r=typeof e=="string"?JSON.parse(e):e).type;if(!at[s])throw new Error("Unknown GeoJSON type: "+r.type);return Ol.indexOf(s)!==-1?at[s].call(this,r.coordinates):s==="GeometryCollection"?at[s].call(this,r.geometries):at[s].call(this,r)}},{key:"write",value:function(e){var r=e.getGeometryType();if(!vt[r])throw new Error("Geometry is not supported");return vt[r].call(this,e)}}]),l}(),at={Feature:function(l){var e={};for(var r in l)e[r]=l[r];if(l.geometry){var s=l.geometry.type;if(!at[s])throw new Error("Unknown GeoJSON type: "+l.type);e.geometry=this.read(l.geometry)}return l.bbox&&(e.bbox=at.bbox.call(this,l.bbox)),e},FeatureCollection:function(l){var e={};if(l.features){e.features=[];for(var r=0;r<l.features.length;++r)e.features.push(this.read(l.features[r]))}return l.bbox&&(e.bbox=this.parse.bbox.call(this,l.bbox)),e},coordinates:function(l){for(var e=[],r=0;r<l.length;++r){var s=l[r];e.push(m(b,C(s)))}return e},bbox:function(l){return this.geometryFactory.createLinearRing([new b(l[0],l[1]),new b(l[2],l[1]),new b(l[2],l[3]),new b(l[0],l[3]),new b(l[0],l[1])])},Point:function(l){var e=m(b,C(l));return this.geometryFactory.createPoint(e)},MultiPoint:function(l){for(var e=[],r=0;r<l.length;++r)e.push(at.Point.call(this,l[r]));return this.geometryFactory.createMultiPoint(e)},LineString:function(l){var e=at.coordinates.call(this,l);return this.geometryFactory.createLineString(e)},MultiLineString:function(l){for(var e=[],r=0;r<l.length;++r)e.push(at.LineString.call(this,l[r]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(l){for(var e=at.coordinates.call(this,l[0]),r=this.geometryFactory.createLinearRing(e),s=[],o=1;o<l.length;++o){var f=l[o],v=at.coordinates.call(this,f),y=this.geometryFactory.createLinearRing(v);s.push(y)}return this.geometryFactory.createPolygon(r,s)},MultiPolygon:function(l){for(var e=[],r=0;r<l.length;++r){var s=l[r];e.push(at.Polygon.call(this,s))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(l){for(var e=[],r=0;r<l.length;++r){var s=l[r];e.push(this.read(s))}return this.geometryFactory.createGeometryCollection(e)}},vt={coordinate:function(l){var e=[l.x,l.y];return l.z&&e.push(l.z),l.m&&e.push(l.m),e},Point:function(l){return{type:"Point",coordinates:vt.coordinate.call(this,l.getCoordinate())}},MultiPoint:function(l){for(var e=[],r=0;r<l._geometries.length;++r){var s=l._geometries[r],o=vt.Point.call(this,s);e.push(o.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(l){for(var e=[],r=l.getCoordinates(),s=0;s<r.length;++s){var o=r[s];e.push(vt.coordinate.call(this,o))}return{type:"LineString",coordinates:e}},MultiLineString:function(l){for(var e=[],r=0;r<l._geometries.length;++r){var s=l._geometries[r],o=vt.LineString.call(this,s);e.push(o.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(l){var e=[],r=vt.LineString.call(this,l._shell);e.push(r.coordinates);for(var s=0;s<l._holes.length;++s){var o=l._holes[s],f=vt.LineString.call(this,o);e.push(f.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(l){for(var e=[],r=0;r<l._geometries.length;++r){var s=l._geometries[r],o=vt.Polygon.call(this,s);e.push(o.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(l){for(var e=[],r=0;r<l._geometries.length;++r){var s=l._geometries[r],o=s.getGeometryType();e.push(vt[o].call(this,s))}return{type:"GeometryCollection",geometries:e}}};return{BufferOp:jt,GeoJSONReader:function(){function l(e){t(this,l),this.parser=new Zs(e||new Zt)}return u(l,[{key:"read",value:function(e){return this.parser.read(e)}}]),l}(),GeoJSONWriter:function(){function l(){t(this,l),this.parser=new Zs(this.geometryFactory)}return u(l,[{key:"write",value:function(e){return this.parser.write(e)}}]),l}()}})})(bo);var rc=bo.exports;const ic=so(rc);var{BufferOp:sc,GeoJSONReader:ac,GeoJSONWriter:oc}=ic;function uc(i,n,t){t=t||{};var a=t.units||"kilometers",u=t.steps||8;if(!i)throw new Error("geojson is required");if(typeof t!="object")throw new Error("options must be an object");if(typeof u!="number")throw new Error("steps must be an number");if(n===void 0)throw new Error("radius is required");if(u<=0)throw new Error("steps must be greater than 0");var h=[];switch(i.type){case"GeometryCollection":return Ge(i,function(c){var g=Nr(c,n,a,u);g&&h.push(g)}),G(h);case"FeatureCollection":return ce(i,function(c){var g=Nr(c,n,a,u);g&&ce(g,function(d){d&&h.push(d)})}),G(h)}return Nr(i,n,a,u)}function Nr(i,n,t,a){var u=i.properties||{},h=i.type==="Feature"?i.geometry:i;if(h.type==="GeometryCollection"){var c=[];return Ge(i,function(C){var D=Nr(C,n,t,a);D&&c.push(D)}),G(c)}var g=lc(h),d={type:h.type,coordinates:To(h.coordinates,g)},m=new ac,p=m.read(d),x=er(vn(n,t),"meters"),I=sc.bufferOp(p,x,a),w=new oc;if(I=w.write(I),!Co(I.coordinates)){var k={type:I.type,coordinates:Oo(I.coordinates,g)};return Oe(k,u)}}function Co(i){return Array.isArray(i[0])?Co(i[0]):isNaN(i[0])}function To(i,n){return typeof i[0]!="object"?n(i):i.map(function(t){return To(t,n)})}function Oo(i,n){return typeof i[0]!="object"?n.invert(i):i.map(function(t){return Oo(t,n)})}function lc(i){var n=Dr(i).geometry.coordinates,t=[-n[0],-n[1]];return Dl().rotate(t).scale(Ae)}function Ji(i,n={}){let t=0,a=0,u=0;return Ge(i,function(h,c,g){let d=n.weight?g==null?void 0:g[n.weight]:void 0;if(d=d??1,!De(d))throw new Error("weight value must be a number for feature index "+c);d=Number(d),d>0&&Me(h,function(m){t+=m[0]*d,a+=m[1]*d,u+=d})}),re([t/u,a/u],n.properties,n)}function Nt(i,n={}){let t=0,a=0,u=0;return Me(i,function(h){t+=h[0],a+=h[1],u++},!0),re([t/u,a/u],n.properties)}function hc(i,n={}){if(n=n||{},!de(n))throw new Error("options is invalid");var t=n.counter||10;if(!De(t))throw new Error("counter must be a number");var a=n.weight,u=Ji(i,{weight:n.weight}),h=G([]);ce(i,function(g){var d;h.features.push(Nt(g,{properties:{weight:(d=g.properties)==null?void 0:d[a]}}))});const c={tolerance:n.tolerance,medianCandidates:[]};return Ro(u.geometry.coordinates,[0,0],h,c,t)}function Ro(i,n,t,a,u){var h=a.tolerance||.001,c=0,g=0,d=0,m=0;if(ce(t,function(I){var w,k=(w=I.properties)==null?void 0:w.weight,C=k??1;if(C=Number(C),!De(C))throw new Error("weight value must be a number");if(C>0){m+=1;var D=C*me(I,i);D===0&&(D=1);var R=C/D;c+=I.geometry.coordinates[0]*R,g+=I.geometry.coordinates[1]*R,d+=R}}),m<1)throw new Error("no features to measure");var p=c/d,x=g/d;return m===1||u===0||Math.abs(p-n[0])<h&&Math.abs(x-n[1])<h?re([p,x],{medianCandidates:a.medianCandidates}):(a.medianCandidates.push([p,x]),Ro([p,x],i,t,a,u-1))}function Ao(i,n={}){n.concavity=n.concavity||1/0;const t=[];if(Me(i,u=>{t.push([u[0],u[1]])}),!t.length)return null;const a=Fl(t,n.concavity);return a.length>3?j([a]):null}function Do(i,n={}){switch(We(i)){case"Point":return re(ye(i),n.properties);case"Polygon":var t=[];Me(i,function(A){t.push(A)});var a=Nt(i,{properties:n.properties}),u=a.geometry.coordinates,h=0,c=0,g=0,d,m,p,x,I,w,k,C,D=t.map(function(A){return[A[0]-u[0],A[1]-u[1]]});for(d=0;d<t.length-1;d++)m=D[d],x=m[0],w=m[1],p=D[d+1],I=p[0],k=p[1],C=x*k-I*w,g+=C,h+=(x+I)*C,c+=(w+k)*C;if(g===0)return a;var R=g*.5,P=1/(6*R);return re([u[0]+P*h,u[1]+P*c],n.properties);default:var S=Ao(i);return S?Do(S,{properties:n.properties}):Nt(i,{properties:n.properties})}}function Ki(i,n,t={}){const a=t.steps||64,u=t.properties?t.properties:!Array.isArray(i)&&i.type==="Feature"&&i.properties?i.properties:{},h=[];for(let c=0;c<a;c++)h.push(It(i,n,c*-360/a,t).geometry.coordinates);return h.push(h[0]),j([h],u)}function Xe(i){if(!i)throw new Error("geojson is required");switch(i.type){case"Feature":return Fo(i);case"FeatureCollection":return cc(i);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Qi(i);default:throw new Error("unknown GeoJSON type")}}function Fo(i){const n={type:"Feature"};return Object.keys(i).forEach(t=>{switch(t){case"type":case"properties":case"geometry":return;default:n[t]=i[t]}}),n.properties=Fr(i.properties),i.geometry==null?n.geometry=null:n.geometry=Qi(i.geometry),n}function Fr(i){const n={};return i&&Object.keys(i).forEach(t=>{const a=i[t];typeof a=="object"?a===null?n[t]=null:Array.isArray(a)?n[t]=a.map(u=>u):n[t]=Fr(a):n[t]=a}),n}function cc(i){const n={type:"FeatureCollection"};return Object.keys(i).forEach(t=>{switch(t){case"type":case"features":return;default:n[t]=i[t]}}),n.features=i.features.map(t=>Fo(t)),n}function Qi(i){const n={type:i.type};return i.bbox&&(n.bbox=i.bbox),i.type==="GeometryCollection"?(n.geometries=i.geometries.map(t=>Qi(t)),n):(n.coordinates=Bo(i.coordinates),n)}function Bo(i){const n=i;return typeof n[0]!="object"?n.slice():n.map(t=>Bo(t))}function qo(i,n){if(!i)throw new Error("geojson is required");if(i.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(n==null)throw new Error("filter is required");var t=[];return ce(i,function(a){Br(a.properties,n)&&t.push(a)}),G(t)}function ji(i,n,t){if(!i)throw new Error("geojson is required");if(i.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(n==null)throw new Error("property is required");for(var a=es(i,n),u=Object.keys(a),h=0;h<u.length;h++){for(var c=u[h],g=a[c],d=[],m=0;m<g.length;m++)d.push(i.features[g[m]]);t(G(d),c,h)}}function Yo(i,n,t,a){var u=a;return ji(i,n,function(h,c,g){g===0&&a===void 0?u=h:u=t(u,h,c,g)}),u}function es(i,n){var t={};return ce(i,function(a,u){var h=a.properties||{};if(Object.prototype.hasOwnProperty.call(h,String(n))){var c=h[n];Object.prototype.hasOwnProperty.call(t,c)?t[c].push(u):t[c]=[u]}}),t}function Br(i,n){if(i===void 0)return!1;var t=typeof n;if(t==="number"||t==="string")return Object.prototype.hasOwnProperty.call(i,n);if(Array.isArray(n)){for(var a=0;a<n.length;a++)if(!Br(i,n[a]))return!1;return!0}else return ts(i,n)}function ts(i,n){for(var t=Object.keys(n),a=0;a<t.length;a++){var u=t[a];if(i[u]!==n[u])return!1}return!0}function Xo(i,n){if(!n)return{};if(!n.length)return{};for(var t={},a=0;a<n.length;a++){var u=n[a];Object.prototype.hasOwnProperty.call(i,u)&&(t[u]=i[u])}return t}const fc=Object.freeze(Object.defineProperty({__proto__:null,applyFilter:Br,clusterEach:ji,clusterReduce:Yo,createBins:es,filterProperties:Xo,getCluster:qo,propertiesContainsFilter:ts},Symbol.toStringTag,{value:"Module"}));function gc(i,n,t,a,u){Go(i,n,t||0,a||i.length-1,u||dc)}function Go(i,n,t,a,u){for(;a>t;){if(a-t>600){var h=a-t+1,c=n-t+1,g=Math.log(h),d=.5*Math.exp(2*g/3),m=.5*Math.sqrt(g*d*(h-d)/h)*(c-h/2<0?-1:1),p=Math.max(t,Math.floor(n-c*d/h+m)),x=Math.min(a,Math.floor(n+(h-c)*d/h+m));Go(i,n,p,x,u)}var I=i[n],w=t,k=a;for(Sn(i,t,n),u(i[a],I)>0&&Sn(i,t,a);w<k;){for(Sn(i,w,k),w++,k--;u(i[w],I)<0;)w++;for(;u(i[k],I)>0;)k--}u(i[t],I)===0?Sn(i,t,k):(k++,Sn(i,k,a)),k<=n&&(t=k+1),n<=k&&(a=k-1)}}function Sn(i,n,t){var a=i[n];i[n]=i[t],i[t]=a}function dc(i,n){return i<n?-1:i>n?1:0}let vc=class{constructor(n=9){this._maxEntries=Math.max(4,n),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(n){let t=this.data;const a=[];if(!yr(n,t))return a;const u=this.toBBox,h=[];for(;t;){for(let c=0;c<t.children.length;c++){const g=t.children[c],d=t.leaf?u(g):g;yr(n,d)&&(t.leaf?a.push(g):Ei(n,d)?this._all(g,a):h.push(g))}t=h.pop()}return a}collides(n){let t=this.data;if(!yr(n,t))return!1;const a=[];for(;t;){for(let u=0;u<t.children.length;u++){const h=t.children[u],c=t.leaf?this.toBBox(h):h;if(yr(n,c)){if(t.leaf||Ei(n,c))return!0;a.push(h)}}t=a.pop()}return!1}load(n){if(!(n&&n.length))return this;if(n.length<this._minEntries){for(let a=0;a<n.length;a++)this.insert(n[a]);return this}let t=this._build(n.slice(),0,n.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const a=this.data;this.data=t,t=a}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(n){return n&&this._insert(n,this.data.height-1),this}clear(){return this.data=on([]),this}remove(n,t){if(!n)return this;let a=this.data;const u=this.toBBox(n),h=[],c=[];let g,d,m;for(;a||h.length;){if(a||(a=h.pop(),d=h[h.length-1],g=c.pop(),m=!0),a.leaf){const p=mc(n,a.children,t);if(p!==-1)return a.children.splice(p,1),h.push(a),this._condense(h),this}!m&&!a.leaf&&Ei(a,u)?(h.push(a),c.push(g),g=0,d=a,a=a.children[0]):d?(g++,a=d.children[g],m=!1):a=null}return this}toBBox(n){return n}compareMinX(n,t){return n.minX-t.minX}compareMinY(n,t){return n.minY-t.minY}toJSON(){return this.data}fromJSON(n){return this.data=n,this}_all(n,t){const a=[];for(;n;)n.leaf?t.push(...n.children):a.push(...n.children),n=a.pop();return t}_build(n,t,a,u){const h=a-t+1;let c=this._maxEntries,g;if(h<=c)return g=on(n.slice(t,a+1)),nn(g,this.toBBox),g;u||(u=Math.ceil(Math.log(h)/Math.log(c)),c=Math.ceil(h/Math.pow(c,u-1))),g=on([]),g.leaf=!1,g.height=u;const d=Math.ceil(h/c),m=d*Math.ceil(Math.sqrt(c));va(n,t,a,m,this.compareMinX);for(let p=t;p<=a;p+=m){const x=Math.min(p+m-1,a);va(n,p,x,d,this.compareMinY);for(let I=p;I<=x;I+=d){const w=Math.min(I+d-1,x);g.children.push(this._build(n,I,w,u-1))}}return nn(g,this.toBBox),g}_chooseSubtree(n,t,a,u){for(;u.push(t),!(t.leaf||u.length-1===a);){let h=1/0,c=1/0,g;for(let d=0;d<t.children.length;d++){const m=t.children[d],p=xi(m),x=_c(n,m)-p;x<c?(c=x,h=p<h?p:h,g=m):x===c&&p<h&&(h=p,g=m)}t=g||t.children[0]}return t}_insert(n,t,a){const u=a?n:this.toBBox(n),h=[],c=this._chooseSubtree(u,this.data,t,h);for(c.children.push(n),Dn(c,u);t>=0&&h[t].children.length>this._maxEntries;)this._split(h,t),t--;this._adjustParentBBoxes(u,h,t)}_split(n,t){const a=n[t],u=a.children.length,h=this._minEntries;this._chooseSplitAxis(a,h,u);const c=this._chooseSplitIndex(a,h,u),g=on(a.children.splice(c,a.children.length-c));g.height=a.height,g.leaf=a.leaf,nn(a,this.toBBox),nn(g,this.toBBox),t?n[t-1].children.push(g):this._splitRoot(a,g)}_splitRoot(n,t){this.data=on([n,t]),this.data.height=n.height+1,this.data.leaf=!1,nn(this.data,this.toBBox)}_chooseSplitIndex(n,t,a){let u,h=1/0,c=1/0;for(let g=t;g<=a-t;g++){const d=An(n,0,g,this.toBBox),m=An(n,g,a,this.toBBox),p=xc(d,m),x=xi(d)+xi(m);p<h?(h=p,u=g,c=x<c?x:c):p===h&&x<c&&(c=x,u=g)}return u||a-t}_chooseSplitAxis(n,t,a){const u=n.leaf?this.compareMinX:yc,h=n.leaf?this.compareMinY:pc,c=this._allDistMargin(n,t,a,u),g=this._allDistMargin(n,t,a,h);c<g&&n.children.sort(u)}_allDistMargin(n,t,a,u){n.children.sort(u);const h=this.toBBox,c=An(n,0,t,h),g=An(n,a-t,a,h);let d=mr(c)+mr(g);for(let m=t;m<a-t;m++){const p=n.children[m];Dn(c,n.leaf?h(p):p),d+=mr(c)}for(let m=a-t-1;m>=t;m--){const p=n.children[m];Dn(g,n.leaf?h(p):p),d+=mr(g)}return d}_adjustParentBBoxes(n,t,a){for(let u=a;u>=0;u--)Dn(t[u],n)}_condense(n){for(let t=n.length-1,a;t>=0;t--)n[t].children.length===0?t>0?(a=n[t-1].children,a.splice(a.indexOf(n[t]),1)):this.clear():nn(n[t],this.toBBox)}};function mc(i,n,t){if(!t)return n.indexOf(i);for(let a=0;a<n.length;a++)if(t(i,n[a]))return a;return-1}function nn(i,n){An(i,0,i.children.length,n,i)}function An(i,n,t,a,u){u||(u=on(null)),u.minX=1/0,u.minY=1/0,u.maxX=-1/0,u.maxY=-1/0;for(let h=n;h<t;h++){const c=i.children[h];Dn(u,i.leaf?a(c):c)}return u}function Dn(i,n){return i.minX=Math.min(i.minX,n.minX),i.minY=Math.min(i.minY,n.minY),i.maxX=Math.max(i.maxX,n.maxX),i.maxY=Math.max(i.maxY,n.maxY),i}function yc(i,n){return i.minX-n.minX}function pc(i,n){return i.minY-n.minY}function xi(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function mr(i){return i.maxX-i.minX+(i.maxY-i.minY)}function _c(i,n){return(Math.max(n.maxX,i.maxX)-Math.min(n.minX,i.minX))*(Math.max(n.maxY,i.maxY)-Math.min(n.minY,i.minY))}function xc(i,n){const t=Math.max(i.minX,n.minX),a=Math.max(i.minY,n.minY),u=Math.min(i.maxX,n.maxX),h=Math.min(i.maxY,n.maxY);return Math.max(0,u-t)*Math.max(0,h-a)}function Ei(i,n){return i.minX<=n.minX&&i.minY<=n.minY&&n.maxX<=i.maxX&&n.maxY<=i.maxY}function yr(i,n){return n.minX<=i.maxX&&n.minY<=i.maxY&&n.maxX>=i.minX&&n.maxY>=i.minY}function on(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function va(i,n,t,a,u){const h=[n,t];for(;h.length;){if(t=h.pop(),n=h.pop(),t-n<=a)continue;const c=n+Math.ceil((t-n)/a/2)*a;gc(i,c,n,t,u),h.push(n,c,c,t)}}var Ec=vc;function wc(i,n,t={}){t.mutate!==!0&&(i=Xe(i));const a=t.minPoints||3,u=Rr(n,t.units);var h=new Ec(i.features.length),c=i.features.map(w=>!1),g=i.features.map(w=>!1),d=i.features.map(w=>!1),m=i.features.map(w=>-1);h.load(i.features.map((w,k)=>{var[C,D]=w.geometry.coordinates;return{minX:C,minY:D,maxX:C,maxY:D,index:k}}));const p=w=>{const k=i.features[w],[C,D]=k.geometry.coordinates,R=Math.max(D-u,-90),P=Math.min(D+u,90),S=function(){return R<0&&P>0?u:Math.abs(R)<Math.abs(P)?u/Math.cos(Te(P)):u/Math.cos(Te(R))}(),A=Math.max(C-S,-360),O=Math.min(C+S,360),fe={minX:A,minY:R,maxX:O,maxY:P};return h.search(fe).filter(X=>{const Z=X.index,H=i.features[Z];return me(k,H,{units:"kilometers"})<=n})},x=(w,k)=>{for(var C=0;C<k.length;C++){var D=k[C];const R=D.index;if(!c[R]){c[R]=!0;const P=p(R);P.length>=a&&k.push(...P)}g[R]||(g[R]=!0,m[R]=w)}};var I=0;return i.features.forEach((w,k)=>{if(c[k])return;const C=p(k);if(C.length>=a){const D=I;I++,c[k]=!0,x(D,C)}else d[k]=!0}),i.features.forEach((w,k)=>{var C=i.features[k];C.properties||(C.properties={}),m[k]>=0?(C.properties.dbscan=d[k]?"edge":"core",C.properties.cluster=m[k]):C.properties.dbscan="noise"}),i}function kc(i,n={}){var t=i.features.length;n.numberOfClusters=n.numberOfClusters||Math.round(Math.sqrt(t/2)),n.numberOfClusters>t&&(n.numberOfClusters=t),n.mutate!==!0&&(i=Xe(i));var a=Un(i),u=a.slice(0,n.numberOfClusters),h=Bl(a,n.numberOfClusters,u),c={};return h.centroids.forEach(function(g,d){c[d]=g}),ce(i,function(g,d){var m=h.idxs[d];g.properties.cluster=m,g.properties.centroid=c[m]}),i}function Ic(i,n,t,a,u){zo(i,n,t||0,a||i.length-1,u||Nc)}function zo(i,n,t,a,u){for(;a>t;){if(a-t>600){var h=a-t+1,c=n-t+1,g=Math.log(h),d=.5*Math.exp(2*g/3),m=.5*Math.sqrt(g*d*(h-d)/h)*(c-h/2<0?-1:1),p=Math.max(t,Math.floor(n-c*d/h+m)),x=Math.min(a,Math.floor(n+(h-c)*d/h+m));zo(i,n,p,x,u)}var I=i[n],w=t,k=a;for(bn(i,t,n),u(i[a],I)>0&&bn(i,t,a);w<k;){for(bn(i,w,k),w++,k--;u(i[w],I)<0;)w++;for(;u(i[k],I)>0;)k--}u(i[t],I)===0?bn(i,t,k):(k++,bn(i,k,a)),k<=n&&(t=k+1),n<=k&&(a=k-1)}}function bn(i,n,t){var a=i[n];i[n]=i[t],i[t]=a}function Nc(i,n){return i<n?-1:i>n?1:0}let Mc=class{constructor(n=9){this._maxEntries=Math.max(4,n),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(n){let t=this.data;const a=[];if(!_r(n,t))return a;const u=this.toBBox,h=[];for(;t;){for(let c=0;c<t.children.length;c++){const g=t.children[c],d=t.leaf?u(g):g;_r(n,d)&&(t.leaf?a.push(g):ki(n,d)?this._all(g,a):h.push(g))}t=h.pop()}return a}collides(n){let t=this.data;if(!_r(n,t))return!1;const a=[];for(;t;){for(let u=0;u<t.children.length;u++){const h=t.children[u],c=t.leaf?this.toBBox(h):h;if(_r(n,c)){if(t.leaf||ki(n,c))return!0;a.push(h)}}t=a.pop()}return!1}load(n){if(!(n&&n.length))return this;if(n.length<this._minEntries){for(let a=0;a<n.length;a++)this.insert(n[a]);return this}let t=this._build(n.slice(),0,n.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const a=this.data;this.data=t,t=a}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(n){return n&&this._insert(n,this.data.height-1),this}clear(){return this.data=un([]),this}remove(n,t){if(!n)return this;let a=this.data;const u=this.toBBox(n),h=[],c=[];let g,d,m;for(;a||h.length;){if(a||(a=h.pop(),d=h[h.length-1],g=c.pop(),m=!0),a.leaf){const p=Pc(n,a.children,t);if(p!==-1)return a.children.splice(p,1),h.push(a),this._condense(h),this}!m&&!a.leaf&&ki(a,u)?(h.push(a),c.push(g),g=0,d=a,a=a.children[0]):d?(g++,a=d.children[g],m=!1):a=null}return this}toBBox(n){return n}compareMinX(n,t){return n.minX-t.minX}compareMinY(n,t){return n.minY-t.minY}toJSON(){return this.data}fromJSON(n){return this.data=n,this}_all(n,t){const a=[];for(;n;)n.leaf?t.push(...n.children):a.push(...n.children),n=a.pop();return t}_build(n,t,a,u){const h=a-t+1;let c=this._maxEntries,g;if(h<=c)return g=un(n.slice(t,a+1)),rn(g,this.toBBox),g;u||(u=Math.ceil(Math.log(h)/Math.log(c)),c=Math.ceil(h/Math.pow(c,u-1))),g=un([]),g.leaf=!1,g.height=u;const d=Math.ceil(h/c),m=d*Math.ceil(Math.sqrt(c));ma(n,t,a,m,this.compareMinX);for(let p=t;p<=a;p+=m){const x=Math.min(p+m-1,a);ma(n,p,x,d,this.compareMinY);for(let I=p;I<=x;I+=d){const w=Math.min(I+d-1,x);g.children.push(this._build(n,I,w,u-1))}}return rn(g,this.toBBox),g}_chooseSubtree(n,t,a,u){for(;u.push(t),!(t.leaf||u.length-1===a);){let h=1/0,c=1/0,g;for(let d=0;d<t.children.length;d++){const m=t.children[d],p=wi(m),x=bc(n,m)-p;x<c?(c=x,h=p<h?p:h,g=m):x===c&&p<h&&(h=p,g=m)}t=g||t.children[0]}return t}_insert(n,t,a){const u=a?n:this.toBBox(n),h=[],c=this._chooseSubtree(u,this.data,t,h);for(c.children.push(n),Bn(c,u);t>=0&&h[t].children.length>this._maxEntries;)this._split(h,t),t--;this._adjustParentBBoxes(u,h,t)}_split(n,t){const a=n[t],u=a.children.length,h=this._minEntries;this._chooseSplitAxis(a,h,u);const c=this._chooseSplitIndex(a,h,u),g=un(a.children.splice(c,a.children.length-c));g.height=a.height,g.leaf=a.leaf,rn(a,this.toBBox),rn(g,this.toBBox),t?n[t-1].children.push(g):this._splitRoot(a,g)}_splitRoot(n,t){this.data=un([n,t]),this.data.height=n.height+1,this.data.leaf=!1,rn(this.data,this.toBBox)}_chooseSplitIndex(n,t,a){let u,h=1/0,c=1/0;for(let g=t;g<=a-t;g++){const d=Fn(n,0,g,this.toBBox),m=Fn(n,g,a,this.toBBox),p=Cc(d,m),x=wi(d)+wi(m);p<h?(h=p,u=g,c=x<c?x:c):p===h&&x<c&&(c=x,u=g)}return u||a-t}_chooseSplitAxis(n,t,a){const u=n.leaf?this.compareMinX:Lc,h=n.leaf?this.compareMinY:Sc,c=this._allDistMargin(n,t,a,u),g=this._allDistMargin(n,t,a,h);c<g&&n.children.sort(u)}_allDistMargin(n,t,a,u){n.children.sort(u);const h=this.toBBox,c=Fn(n,0,t,h),g=Fn(n,a-t,a,h);let d=pr(c)+pr(g);for(let m=t;m<a-t;m++){const p=n.children[m];Bn(c,n.leaf?h(p):p),d+=pr(c)}for(let m=a-t-1;m>=t;m--){const p=n.children[m];Bn(g,n.leaf?h(p):p),d+=pr(g)}return d}_adjustParentBBoxes(n,t,a){for(let u=a;u>=0;u--)Bn(t[u],n)}_condense(n){for(let t=n.length-1,a;t>=0;t--)n[t].children.length===0?t>0?(a=n[t-1].children,a.splice(a.indexOf(n[t]),1)):this.clear():rn(n[t],this.toBBox)}};function Pc(i,n,t){if(!t)return n.indexOf(i);for(let a=0;a<n.length;a++)if(t(i,n[a]))return a;return-1}function rn(i,n){Fn(i,0,i.children.length,n,i)}function Fn(i,n,t,a,u){u||(u=un(null)),u.minX=1/0,u.minY=1/0,u.maxX=-1/0,u.maxY=-1/0;for(let h=n;h<t;h++){const c=i.children[h];Bn(u,i.leaf?a(c):c)}return u}function Bn(i,n){return i.minX=Math.min(i.minX,n.minX),i.minY=Math.min(i.minY,n.minY),i.maxX=Math.max(i.maxX,n.maxX),i.maxY=Math.max(i.maxY,n.maxY),i}function Lc(i,n){return i.minX-n.minX}function Sc(i,n){return i.minY-n.minY}function wi(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function pr(i){return i.maxX-i.minX+(i.maxY-i.minY)}function bc(i,n){return(Math.max(n.maxX,i.maxX)-Math.min(n.minX,i.minX))*(Math.max(n.maxY,i.maxY)-Math.min(n.minY,i.minY))}function Cc(i,n){const t=Math.max(i.minX,n.minX),a=Math.max(i.minY,n.minY),u=Math.min(i.maxX,n.maxX),h=Math.min(i.maxY,n.maxY);return Math.max(0,u-t)*Math.max(0,h-a)}function ki(i,n){return i.minX<=n.minX&&i.minY<=n.minY&&n.maxX<=i.maxX&&n.maxY<=i.maxY}function _r(i,n){return n.minX<=i.maxX&&n.minY<=i.maxY&&n.maxX>=i.minX&&n.maxY>=i.minY}function un(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ma(i,n,t,a,u){const h=[n,t];for(;h.length;){if(t=h.pop(),n=h.pop(),t-n<=a)continue;const c=n+Math.ceil((t-n)/a/2)*a;Ic(i,c,n,t,u),h.push(n,c,c,t)}}var Tc=Mc;function Oc(i,n,t,a){var u=new Tc(6),h=n.features.map(function(c){var g;return{minX:c.geometry.coordinates[0],minY:c.geometry.coordinates[1],maxX:c.geometry.coordinates[0],maxY:c.geometry.coordinates[1],property:(g=c.properties)==null?void 0:g[t]}});return u.load(h),i.features.forEach(function(c){c.properties||(c.properties={});var g=_e(c),d=u.search({minX:g[0],minY:g[1],maxX:g[2],maxY:g[3]}),m=[];d.forEach(function(p){ne([p.minX,p.minY],c)&&m.push(p.property)}),c.properties[a]=m}),i}function Rc(i){var n={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return ce(i,t=>{var a;switch((a=t.geometry)==null?void 0:a.type){case"Point":n.MultiPoint.coordinates.push(t.geometry.coordinates),n.MultiPoint.properties.push(t.properties);break;case"MultiPoint":n.MultiPoint.coordinates.push(...t.geometry.coordinates),n.MultiPoint.properties.push(t.properties);break;case"LineString":n.MultiLineString.coordinates.push(t.geometry.coordinates),n.MultiLineString.properties.push(t.properties);break;case"MultiLineString":n.MultiLineString.coordinates.push(...t.geometry.coordinates),n.MultiLineString.properties.push(t.properties);break;case"Polygon":n.MultiPolygon.coordinates.push(t.geometry.coordinates),n.MultiPolygon.properties.push(t.properties);break;case"MultiPolygon":n.MultiPolygon.coordinates.push(...t.geometry.coordinates),n.MultiPolygon.properties.push(t.properties);break}}),G(Object.keys(n).filter(function(t){return n[t].coordinates.length}).sort().map(function(t){var a={type:t,coordinates:n[t].coordinates},u={collectedProperties:n[t].properties};return Oe(a,u)}))}function Uo(i,n){let t=!1;return G(Fc(i.features.map(a=>{const u={x:a.geometry.coordinates[0],y:a.geometry.coordinates[1]};return n?u.z=a.properties[n]:a.geometry.coordinates.length===3&&(t=!0,u.z=a.geometry.coordinates[2]),u})).map(a=>{const u=[a.a.x,a.a.y],h=[a.b.x,a.b.y],c=[a.c.x,a.c.y];let g={};return t?(u.push(a.a.z),h.push(a.b.z),c.push(a.c.z)):g={a:a.a.z,b:a.b.z,c:a.c.z},j([[u,h,c,u]],g)}))}var ya=class{constructor(i,n,t){this.a=i,this.b=n,this.c=t;const a=n.x-i.x,u=n.y-i.y,h=t.x-i.x,c=t.y-i.y,g=a*(i.x+n.x)+u*(i.y+n.y),d=h*(i.x+t.x)+c*(i.y+t.y),m=2*(a*(t.y-n.y)-u*(t.x-n.x));let p,x;this.x=(c*g-u*d)/m,this.y=(a*d-h*g)/m,p=this.x-i.x,x=this.y-i.y,this.r=p*p+x*x}};function Ac(i,n){return n.x-i.x}function Dc(i){let n=i.length,t,a,u,h,c;e:for(;n;)for(a=i[--n],t=i[--n],u=n;u;)if(c=i[--u],h=i[--u],t===h&&a===c||t===c&&a===h){i.splice(n,2),i.splice(u,2),n-=2;continue e}}function Fc(i){if(i.length<3)return[];i.sort(Ac);let n=i.length-1;const t=i[n].x,a=i[0].x;let u=i[n].y,h=u;const c=1e-12;let g,d,m,p,x,I;for(;n--;)i[n].y<u&&(u=i[n].y),i[n].y>h&&(h=i[n].y);let w=a-t,k=h-u;const C=w>k?w:k,D=(a+t)*.5,R=(h+u)*.5,P=[new ya({__sentinel:!0,x:D-20*C,y:R-C},{__sentinel:!0,x:D,y:R+20*C},{__sentinel:!0,x:D+20*C,y:R-C})],S=[],A=[];let O;for(n=i.length;n--;){for(A.length=0,O=P.length;O--;){if(w=i[n].x-P[O].x,w>0&&w*w>P[O].r){S.push(P[O]),P.splice(O,1);continue}k=i[n].y-P[O].y,!(w*w+k*k>P[O].r)&&(A.push(P[O].a,P[O].b,P[O].b,P[O].c,P[O].c,P[O].a),P.splice(O,1))}for(Dc(A),O=A.length;O;)d=A[--O],g=A[--O],m=i[n],p=d.x-g.x,x=d.y-g.y,I=2*(p*(m.y-d.y)-x*(m.x-d.x)),Math.abs(I)>c&&P.push(new ya(g,d,m))}for(Array.prototype.push.apply(S,P),n=S.length;n--;)(S[n].a.__sentinel||S[n].b.__sentinel||S[n].c.__sentinel)&&S.splice(n,1);return S}function Bc(i,n={}){if(n=n||{},!de(n))throw new Error("options is invalid");const t=n.mutate;if(We(i)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!i.features.length)throw new Error("geojson is empty");(t===!1||t===void 0)&&(i=Xe(i));const a=[],u=Hi(i,(h,c)=>{const g=qc(h,c);return g||(a.push(h),c)});return u&&a.push(u),a.length?a.length===1?a[0]:St(a.map(h=>h.coordinates)):null}function xr(i){return i[0].toString()+","+i[1].toString()}function qc(i,n){const t=i.geometry.coordinates,a=n.geometry.coordinates,u=xr(t[0]),h=xr(t[t.length-1]),c=xr(a[0]),g=xr(a[a.length-1]);let d;if(u===g)d=a.concat(t.slice(1));else if(c===h)d=t.concat(a.slice(1));else if(u===c)d=t.slice(1).reverse().concat(a);else if(h===g)d=t.concat(a.reverse().slice(1));else return null;return he(d)}function Yc(i,n={}){if(We(i)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!i.features.length)throw new Error("geojson is empty");(n.mutate===!1||n.mutate===void 0)&&(i=Xe(i));const t=[];Ye(i,h=>{t.push(h.geometry)});const a=Yl({geoms:Bi(t).geometry});return ql(a,a.objects.geoms.geometries)}function Xc(i,n={}){if(n=n||{},!de(n))throw new Error("options is invalid");const t=n.mutate;if(We(i)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!i.features.length)throw new Error("geojson is empty");(t===!1||t===void 0)&&(i=Xe(i));const a=Gc(i);if(!a)throw new Error("geojson must be homogenous");const u=i;switch(a){case"LineString":return Bc(u,n);case"Polygon":return Yc(u,n);default:throw new Error(a+" is not supported")}}function Gc(i){const n={};Ye(i,a=>{n[a.geometry.type]=!0});const t=Object.keys(n);return t.length===1?t[0]:null}function zc(i,n={}){const t=n.maxEdge||1/0,a=Uc(i),u=Uo(a);if(u.features=u.features.filter(c=>{const g=c.geometry.coordinates[0][0],d=c.geometry.coordinates[0][1],m=c.geometry.coordinates[0][2],p=me(g,d,n),x=me(d,m,n),I=me(g,m,n);return p<=t&&x<=t&&I<=t}),u.features.length<1)return null;const h=Xc(u);return h.coordinates.length===1&&(h.coordinates=h.coordinates[0],h.type="Polygon"),Oe(h)}function Uc(i){const n=[],t={};return ce(i,a=>{if(!a.geometry)return;const u=a.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(t,u)||(n.push(a),t[u]=!0)}),G(n)}function Vc(i){const n=[];if(Ge(i,u=>{n.push(u.coordinates)}),n.length<2)throw new Error("Must have at least two features");const t=i.features[0].properties||{},a=yt.difference(n[0],...n.slice(1));return a.length===0?null:a.length===1?j(a[0],t):Ze(a,t)}function bi(i){if(!i)throw new Error("geojson is required");var n=[];return Ye(i,function(t){n.push(t)}),G(n)}function $c(i,n={}){if(n=n||{},!de(n))throw new Error("options is invalid");const{propertyName:t}=n;Mt(i,"Polygon","dissolve");const a=[];if(t){const u={};ce(i,function(c){c.properties&&(Object.prototype.hasOwnProperty.call(u,c.properties[t])||(u[c.properties[t]]=[]),u[c.properties[t]].push(c))});const h=Object.keys(u);for(let c=0;c<h.length;c++){const g=Ze(yt.union.apply(null,u[h[c]].map(function(d){return d.geometry.coordinates})));g&&g.properties&&(g.properties[t]=h[c],a.push(g))}}else return bi(Ze(yt.union.apply(null,i.features.map(function(u){return u.geometry.coordinates}))));return bi(G(a))}function Hc(i,n,t=2){const a=ye(i),u=ye(n),h=a[0]-u[0],c=a[1]-u[1];return t===1?Math.abs(h)+Math.abs(c):Math.pow(Math.pow(h,t)+Math.pow(c,t),1/t)}function Vo(i,n){var t,a;n=n||{};const u=n.threshold||1e4,h=n.p||2,c=(t=n.binary)!=null?t:!1,g=n.alpha||-1,d=(a=n.standardization)!=null?a:!1,m=[];ce(i,x=>{m.push(Nt(x))});const p=[];for(let x=0;x<m.length;x++)p[x]=[];for(let x=0;x<m.length;x++)for(let I=x;I<m.length;I++){x===I&&(p[x][I]=0);const w=Hc(m[x],m[I],h);p[x][I]=w,p[I][x]=w}for(let x=0;x<m.length;x++)for(let I=0;I<m.length;I++){const w=p[x][I];w!==0&&(c?w<=u?p[x][I]=1:p[x][I]=0:w<=u?p[x][I]=Math.pow(w,g):p[x][I]=0)}if(d)for(let x=0;x<m.length;x++){const I=p[x].reduce((w,k)=>w+k,0);for(let w=0;w<m.length;w++)p[x][w]=p[x][w]/I}return p}function dn(i,n,t,a={}){const u=n<0;let h=Xt(Math.abs(n),a.units,"meters");u&&(h=-Math.abs(h));const c=ye(i),g=Zc(c,h,t);return g[0]+=g[0]-c[0]>180?-360:c[0]-g[0]>180?360:0,re(g,a.properties)}function Zc(i,n,t,a){a=a===void 0?Ae:Number(a);const u=n/a,h=i[0]*Math.PI/180,c=Te(i[1]),g=Te(t),d=u*Math.cos(g);let m=c+d;Math.abs(m)>Math.PI/2&&(m=m>0?Math.PI-m:-Math.PI-m);const p=Math.log(Math.tan(m/2+Math.PI/4)/Math.tan(c/2+Math.PI/4)),x=Math.abs(p)>1e-11?d/p:Math.cos(c),I=u*Math.sin(g)/x;return[((h+I)*180/Math.PI+540)%360-180,m*180/Math.PI]}function qr(i,n,t={}){const a=ye(i),u=ye(n);u[0]+=u[0]-a[0]>180?-360:a[0]-u[0]>180?360:0;const h=Wc(a,u);return Xt(h,"meters",t.units)}function Wc(i,n,t){t=t===void 0?Ae:Number(t);const a=t,u=i[1]*Math.PI/180,h=n[1]*Math.PI/180,c=h-u;let g=Math.abs(n[0]-i[0])*Math.PI/180;g>Math.PI&&(g-=2*Math.PI);const d=Math.log(Math.tan(h/2+Math.PI/4)/Math.tan(u/2+Math.PI/4)),m=Math.abs(d)>1e-11?c/d:Math.cos(u);return Math.sqrt(c*c+m*m*g*g)*a}function $o(i,n,t){if(t=t||{},!de(t))throw new Error("options is invalid");const a=t.pivot,u=t.mutate;if(!i)throw new Error("geojson is required");if(n==null||isNaN(n))throw new Error("angle is required");if(n===0)return i;const h=a??Nt(i);return(u===!1||u===void 0)&&(i=Xe(i)),Me(i,function(c){const d=Gt(h,c)+n,m=qr(h,c),p=J(dn(h,m,d));c[0]=p[0],c[1]=p[1]}),i}function Ho(i,n,t,a){a=a||{};const u=a.steps||64,h=a.units||"kilometers",c=a.angle||0,g=a.pivot||i,d=a.properties||{};if(!i)throw new Error("center is required");if(!n)throw new Error("xSemiAxis is required");if(!t)throw new Error("ySemiAxis is required");if(!de(a))throw new Error("options must be an object");if(!De(u))throw new Error("steps must be a number");if(!De(c))throw new Error("angle must be a number");const m=ye(i);if(h!=="degrees"){const x=dn(i,n,90,{units:h}),I=dn(i,t,0,{units:h});n=ye(x)[0]-m[0],t=ye(I)[1]-m[1]}const p=[];for(let x=0;x<u;x+=1){const I=x*-360/u;let w=n*t/Math.sqrt(Math.pow(t,2)+Math.pow(n,2)*Math.pow(pa(I),2)),k=n*t/Math.sqrt(Math.pow(n,2)+Math.pow(t,2)/Math.pow(pa(I),2));if(I<-90&&I>=-270&&(w=-w),I<-180&&I>=-360&&(k=-k),h==="degrees"){const C=Te(c),D=w*Math.cos(C)+k*Math.sin(C),R=k*Math.cos(C)-w*Math.sin(C);w=D,k=R}p.push([w+m[0],k+m[1]])}return p.push(p[0]),h==="degrees"?j([p],d):$o(j([p],d),c,{pivot:g})}function pa(i){const n=i*Math.PI/180;return Math.tan(n)}function Zo(i){return nr(_e(i))}function Yr(i){const n=[];return i.type==="FeatureCollection"?ce(i,function(t){Me(t,function(a){n.push(re(a,t.properties))})}):i.type==="Feature"?Me(i,function(t){n.push(re(t,i.properties))}):Me(i,function(t){n.push(re(t))}),G(n)}function Jc(i,n){var t;if(n=n||{},!de(n))throw new Error("options is invalid");const a=(t=n.mutate)!=null?t:!1;if(!i)throw new Error("geojson is required");return(a===!1||a===void 0)&&(i=Xe(i)),Me(i,function(u){var h=u[0],c=u[1];u[0]=c,u[1]=h}),i}var _a=Math.PI/180,xa=180/Math.PI,Hn=function(i,n){this.lon=i,this.lat=n,this.x=_a*i,this.y=_a*n};Hn.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};Hn.prototype.antipode=function(){var i=-1*this.lat,n=this.lon<0?180+this.lon:(180-this.lon)*-1;return new Hn(n,i)};var Wo=function(){this.coords=[],this.length=0};Wo.prototype.move_to=function(i){this.length++,this.coords.push(i)};var ns=function(i){this.properties=i||{},this.geometries=[]};ns.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var i=[],n=0;n<this.geometries.length;n++)i.push(this.geometries[n].coords);return{geometry:{type:"MultiLineString",coordinates:i},type:"Feature",properties:this.properties}};ns.prototype.wkt=function(){for(var i="",n="LINESTRING(",t=function(h){n+=h[0]+" "+h[1]+","},a=0;a<this.geometries.length;a++){if(this.geometries[a].coords.length===0)return"LINESTRING(empty)";var u=this.geometries[a].coords;u.forEach(t),i+=n.substring(0,n.length-1)+")"}return i};var rs=function(i,n,t){if(!i||i.x===void 0||i.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!n||n.x===void 0||n.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Hn(i.x,i.y),this.end=new Hn(n.x,n.y),this.properties=t||{};var a=this.start.x-this.end.x,u=this.start.y-this.end.y,h=Math.pow(Math.sin(u/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(a/2),2);if(this.g=2*Math.asin(Math.sqrt(h)),this.g===Math.PI)throw new Error("it appears "+i.view()+" and "+n.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+i+" and "+n)};rs.prototype.interpolate=function(i){var n=Math.sin((1-i)*this.g)/Math.sin(this.g),t=Math.sin(i*this.g)/Math.sin(this.g),a=n*Math.cos(this.start.y)*Math.cos(this.start.x)+t*Math.cos(this.end.y)*Math.cos(this.end.x),u=n*Math.cos(this.start.y)*Math.sin(this.start.x)+t*Math.cos(this.end.y)*Math.sin(this.end.x),h=n*Math.sin(this.start.y)+t*Math.sin(this.end.y),c=xa*Math.atan2(h,Math.sqrt(Math.pow(a,2)+Math.pow(u,2))),g=xa*Math.atan2(u,a);return[g,c]};rs.prototype.Arc=function(i,n){var t=[];if(!i||i<=2)t.push([this.start.lon,this.start.lat]),t.push([this.end.lon,this.end.lat]);else for(var a=1/(i-1),u=0;u<i;++u){var h=a*u,c=this.interpolate(h);t.push(c)}for(var g=!1,d=0,m=n&&n.offset?n.offset:10,p=180-m,x=-180+m,I=360-m,w=1;w<t.length;++w){var k=t[w-1][0],C=t[w][0],D=Math.abs(C-k);D>I&&(C>p&&k<x||k>p&&C<x)?g=!0:D>d&&(d=D)}var R=[];if(g&&d<m){var P=[];R.push(P);for(var S=0;S<t.length;++S){var A=parseFloat(t[S][0]);if(S>0&&Math.abs(A-t[S-1][0])>I){var O=parseFloat(t[S-1][0]),fe=parseFloat(t[S-1][1]),X=parseFloat(t[S][0]),Z=parseFloat(t[S][1]);if(O>-180&&O<x&&X===180&&S+1<t.length&&t[S-1][0]>-180&&t[S-1][0]<x){P.push([-180,t[S][1]]),S++,P.push([t[S][0],t[S][1]]);continue}else if(O>p&&O<180&&X===-180&&S+1<t.length&&t[S-1][0]>p&&t[S-1][0]<180){P.push([180,t[S][1]]),S++,P.push([t[S][0],t[S][1]]);continue}if(O<x&&X>p){var H=O;O=X,X=H;var ae=fe;fe=Z,Z=ae}if(O>p&&X<x&&(X+=360),O<=180&&X>=180&&O<X){var ie=(180-O)/(X-O),ve=ie*Z+(1-ie)*fe;P.push([t[S-1][0]>p?180:-180,ve]),P=[],P.push([t[S-1][0]>p?-180:180,ve]),R.push(P)}else P=[],R.push(P);P.push([A,t[S][1]])}else P.push([t[S][0],t[S][1]])}}else{var Ie=[];R.push(Ie);for(var Pe=0;Pe<t.length;++Pe)Ie.push([t[Pe][0],t[Pe][1]])}for(var Ne=new ns(this.properties),ue=0;ue<R.length;++ue){var Fe=new Wo;Ne.geometries.push(Fe);for(var Le=R[ue],le=0;le<Le.length;++le)Fe.move_to(Le[le])}return Ne};function Kc(i,n,t){if(t=t||{},typeof t!="object")throw new Error("options is invalid");var a=t.properties,u=t.npoints,h=t.offset;i=ye(i),n=ye(n),a=a||{},u=u||100,h=h||10;var c=new rs({x:i[0],y:i[1]},{x:n[0],y:n[1]},a),g=c.Arc(u,{offset:h});return g.json()}/*!
 * Copyright (c) 2019, Dane Springmeyer
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in
 *       the documentation and/or other materials provided with the
 *       distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */function Zn(i,n={}){const t=[];if(Ge(i,u=>{t.push(u.coordinates)}),t.length<2)throw new Error("Must specify at least 2 geometries");const a=yt.intersection(t[0],...t.slice(1));return a.length===0?null:a.length===1?j(a[0],n.properties):Ze(a,n.properties)}function Jo(i,n,t={}){const a=JSON.stringify(t.properties||{}),[u,h,c,g]=i,d=(h+g)/2,m=(u+c)/2,x=n*2/me([u,d],[c,d],t)*(c-u),w=n*2/me([m,h],[m,g],t)*(g-h),k=x/2,C=k*2,D=Math.sqrt(3)/2*w,R=c-u,P=g-h,S=3/4*C,A=D,O=(R-C)/(C-k/2),fe=Math.floor(O),X=(fe*S-k/2-R)/2-k/2+S/2,Z=Math.floor((P-D)/D);let H=(P-Z*D)/2;const ae=Z*D-P>D/2;ae&&(H-=D/4);const ie=[],ve=[];for(let Pe=0;Pe<6;Pe++){const Ne=2*Math.PI/6*Pe;ie.push(Math.cos(Ne)),ve.push(Math.sin(Ne))}const Ie=[];for(let Pe=0;Pe<=fe;Pe++)for(let Ne=0;Ne<=Z;Ne++){const ue=Pe%2===1;if(Ne===0&&ue||Ne===0&&ae)continue;const Fe=Pe*S+u-X;let Le=Ne*A+h+H;if(ue&&(Le-=D/2),t.triangles===!0)jc([Fe,Le],x/2,w/2,JSON.parse(a),ie,ve).forEach(function(le){t.mask?Zn(G([t.mask,le]))&&Ie.push(le):Ie.push(le)});else{const le=Qc([Fe,Le],x/2,w/2,JSON.parse(a),ie,ve);t.mask?Zn(G([t.mask,le]))&&Ie.push(le):Ie.push(le)}}return G(Ie)}function Qc(i,n,t,a,u,h){const c=[];for(let g=0;g<6;g++){const d=i[0]+n*u[g],m=i[1]+t*h[g];c.push([d,m])}return c.push(c[0].slice()),j([c],a)}function jc(i,n,t,a,u,h){const c=[];for(let g=0;g<6;g++){const d=[];d.push(i),d.push([i[0]+n*u[g],i[1]+t*h[g]]),d.push([i[0]+n*u[(g+1)%6],i[1]+t*h[(g+1)%6]]),d.push(i),c.push(j([d],a))}return c}function Ko(i,n,t={}){t.mask&&!t.units&&(t.units="kilometers");for(var a=[],u=i[0],h=i[1],c=i[2],g=i[3],d=n/me([u,h],[c,h],t),m=d*(c-u),p=n/me([u,h],[u,g],t),x=p*(g-h),I=c-u,w=g-h,k=Math.floor(I/m),C=Math.floor(w/x),D=(I-k*m)/2,R=(w-C*x)/2,P=u+D;P<=c;){for(var S=h+R;S<=g;){var A=re([P,S],t.properties);t.mask?Po(A,t.mask)&&a.push(A):a.push(A),S+=x}P+=m}return G(a)}function Qo(i,n,t,a={}){const u=[],h=i[0],c=i[1],g=i[2],d=i[3],m=g-h,p=Xt(n,a.units,"degrees"),x=d-c,I=Xt(t,a.units,"degrees"),w=Math.floor(Math.abs(m)/p),k=Math.floor(Math.abs(x)/I),C=(m-w*p)/2,D=(x-k*I)/2;let R=h+C;for(let P=0;P<w;P++){let S=c+D;for(let A=0;A<k;A++){const O=j([[[R,S],[R,S+I],[R+p,S+I],[R+p,S],[R,S]]],a.properties);a.mask?Io(a.mask,O)&&u.push(O):u.push(O),S+=I}R+=p}return G(u)}function is(i,n,t={}){return Qo(i,n,n,t)}function jo(i,n,t={}){for(var a=[],u=n/me([i[0],i[1]],[i[2],i[1]],t),h=u*(i[2]-i[0]),c=n/me([i[0],i[1]],[i[0],i[3]],t),g=c*(i[3]-i[1]),d=0,m=i[0];m<=i[2];){for(var p=0,x=i[1];x<=i[3];){var I=null,w=null;d%2===0&&p%2===0?(I=j([[[m,x],[m,x+g],[m+h,x],[m,x]]],t.properties),w=j([[[m,x+g],[m+h,x+g],[m+h,x],[m,x+g]]],t.properties)):d%2===0&&p%2===1?(I=j([[[m,x],[m+h,x+g],[m+h,x],[m,x]]],t.properties),w=j([[[m,x],[m,x+g],[m+h,x+g],[m,x]]],t.properties)):p%2===0&&d%2===1?(I=j([[[m,x],[m,x+g],[m+h,x+g],[m,x]]],t.properties),w=j([[[m,x],[m+h,x+g],[m+h,x],[m,x]]],t.properties)):p%2===1&&d%2===1&&(I=j([[[m,x],[m,x+g],[m+h,x],[m,x]]],t.properties),w=j([[[m,x+g],[m+h,x+g],[m+h,x],[m,x+g]]],t.properties)),t.mask?(Zn(G([t.mask,I]))&&a.push(I),Zn(G([t.mask,w]))&&a.push(w)):(a.push(I),a.push(w)),x+=g,p++}d++,m+=h}return G(a)}function ef(i,n,t){if(t=t||{},typeof t!="object")throw new Error("options is invalid");var a=t.gridType,u=t.property,h=t.weight;if(!i)throw new Error("points is required");if(Mt(i,"Point","input must contain Points"),!n)throw new Error("cellSize is required");if(h!==void 0&&typeof h!="number")throw new Error("weight must be a number");u=u||"elevation",a=a||"square",h=h||1;var c=_e(i),g;switch(a){case"point":case"points":g=Ko(c,n,t);break;case"square":case"squares":g=is(c,n,t);break;case"hex":case"hexes":g=Jo(c,n,t);break;case"triangle":case"triangles":g=jo(c,n,t);break;default:throw new Error("invalid gridType")}var d=[];return ce(g,function(m){var p=0,x=0;ce(i,function(w){var k=a==="point"?m:Nt(m),C=me(k,w,t),D;if(u!==void 0&&(D=w.properties[u]),D===void 0&&(D=w.geometry.coordinates[2]),D===void 0)throw new Error("zValue is missing");C===0&&(p=D);var R=1/Math.pow(C,h);x+=R,p+=R*D});var I=Xe(m);I.properties[u]=p/x,d.push(I)}),G(d)}var tf=Object.defineProperty,Ea=Object.getOwnPropertySymbols,nf=Object.prototype.hasOwnProperty,rf=Object.prototype.propertyIsEnumerable,wa=(i,n,t)=>n in i?tf(i,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[n]=t,ka=(i,n)=>{for(var t in n||(n={}))nf.call(n,t)&&wa(i,t,n[t]);if(Ea)for(var t of Ea(n))rf.call(n,t)&&wa(i,t,n[t]);return i};function sf(i,n){if(n=n||{},!de(n))throw new Error("options is invalid");var t=n.zProperty||"elevation",a=n.flip,u=n.flags;Mt(i,"Point","input must contain Points");for(var h=af(i,a),c=[],g=0;g<h.length;g++){for(var d=h[g],m=[],p=0;p<d.length;p++){var x=d[p];x.properties[t]?m.push(x.properties[t]):m.push(0),u===!0&&(x.properties.matrixPosition=[g,p])}c.push(m)}return c}function af(i,n){var t={};ce(i,function(h){var c=J(h)[1];t[c]||(t[c]=[]),t[c].push(h)});var a=Object.keys(t).map(function(h){var c=t[h],g=c.sort(function(d,m){return J(d)[0]-J(m)[0]});return g}),u=a.sort(function(h,c){return n?J(h[0])[1]-J(c[0])[1]:J(c[0])[1]-J(h[0])[1]});return u}function of(i,n,t){if(t=t||{},!de(t))throw new Error("options is invalid");const a=t.zProperty||"elevation",u=t.commonProperties||{},h=t.breaksProperties||[];if(Mt(i,"Point","Input must contain Points"),!n)throw new Error("breaks is required");if(!Array.isArray(n))throw new Error("breaks is not an Array");if(!de(u))throw new Error("commonProperties is not an Object");if(!Array.isArray(h))throw new Error("breaksProperties is not an Array");const c=sf(i,{zProperty:a,flip:!0});let g=uf(c,n,a);g=lf(g,c,i);const d=g.map((m,p)=>{if(h[p]&&!de(h[p]))throw new Error("Each mappedProperty is required to be an Object");const x=ka(ka({},u),h[p]);return x[a]=m[a],Ze(m.groupedRings,x)});return G(d)}function uf(i,n,t){const a=[];for(let u=1;u<n.length;u++){const h=+n[u-1],c=+n[u],g=Xl(i,h,c-h),d=hf(g),m=cf(d);a.push({groupedRings:m,[t]:h+"-"+c})}return a}function lf(i,n,t){const a=_e(t),u=a[2]-a[0],h=a[3]-a[1],c=a[0],g=a[1],d=n[0].length-1,m=n.length-1,p=u/d,x=h/m;return i.map(function(I){return I.groupedRings=I.groupedRings.map(function(w){return w.map(function(k){return k.map(C=>[C[0]*p+c,C[1]*x+g])})}),I})}function hf(i){const n=i.map(function(t){return{ring:t,area:tr(j([t]))}});return n.sort(function(t,a){return a.area-t.area}),n.map(function(t){return t.ring})}function cf(i){const n=i.map(a=>({lrCoordinates:a,grouped:!1})),t=[];for(;!gf(n);)for(let a=0;a<n.length;a++)if(!n[a].grouped){const u=[];u.push(n[a].lrCoordinates),n[a].grouped=!0;const h=j([n[a].lrCoordinates]);for(let c=a+1;c<n.length;c++)if(!n[c].grouped){const g=j([n[c].lrCoordinates]);ff(g,h)&&(u.push(n[c].lrCoordinates),n[c].grouped=!0)}t.push(u)}return t}function ff(i,n){const t=Yr(i);for(let a=0;a<t.features.length;a++)if(!ne(t.features[a],n))return!1;return!0}function gf(i){for(let n=0;n<i.length;n++)if(i[n].grouped===!1)return!1;return!0}var df=Object.defineProperty,Ia=Object.getOwnPropertySymbols,vf=Object.prototype.hasOwnProperty,mf=Object.prototype.propertyIsEnumerable,Na=(i,n,t)=>n in i?df(i,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[n]=t,Ma=(i,n)=>{for(var t in n||(n={}))vf.call(n,t)&&Na(i,t,n[t]);if(Ia)for(var t of Ia(n))mf.call(n,t)&&Na(i,t,n[t]);return i};function yf(i,n){if(n=n||{},!de(n))throw new Error("options is invalid");var t=n.zProperty||"elevation",a=n.flip,u=n.flags;Mt(i,"Point","input must contain Points");for(var h=pf(i,a),c=[],g=0;g<h.length;g++){for(var d=h[g],m=[],p=0;p<d.length;p++){var x=d[p];x.properties[t]?m.push(x.properties[t]):m.push(0),u===!0&&(x.properties.matrixPosition=[g,p])}c.push(m)}return c}function pf(i,n){var t={};ce(i,function(h){var c=J(h)[1];t[c]||(t[c]=[]),t[c].push(h)});var a=Object.keys(t).map(function(h){var c=t[h],g=c.sort(function(d,m){return J(d)[0]-J(m)[0]});return g}),u=a.sort(function(h,c){return n?J(h[0])[1]-J(c[0])[1]:J(c[0])[1]-J(h[0])[1]});return u}function _f(i,n,t){if(t=t||{},!de(t))throw new Error("options is invalid");const a=t.zProperty||"elevation",u=t.commonProperties||{},h=t.breaksProperties||[];if(Mt(i,"Point","Input must contain Points"),!n)throw new Error("breaks is required");if(!Array.isArray(n))throw new Error("breaks must be an Array");if(!de(u))throw new Error("commonProperties must be an Object");if(!Array.isArray(h))throw new Error("breaksProperties must be an Array");const c=yf(i,{zProperty:a,flip:!0}),g=xf(c,n,a,u,h),d=Ef(g,c,i);return G(d)}function xf(i,n,t,a,u){const h=[];for(let c=0;c<n.length;c++){const g=+n[c],d=Ma(Ma({},a),u[c]);d[t]=g;const m=St(Gl(i,g,{linearRing:!1,noFrame:!0}),d);h.push(m)}return h}function Ef(i,n,t){const a=_e(t),u=a[2]-a[0],h=a[3]-a[1],c=a[0],g=a[1],d=n[0].length-1,m=n.length-1,p=u/d,x=h/m,I=w=>{w[0]=w[0]*p+c,w[1]=w[1]*x+g};return i.forEach(w=>{Me(w,I)}),i}function wf(i){let n,t;const a={type:"FeatureCollection",features:[]};if(i.type==="Feature"?t=i.geometry:t=i,t.type==="LineString")n=[t.coordinates];else if(t.type==="MultiLineString")n=t.coordinates;else if(t.type==="MultiPolygon")n=[].concat(...t.coordinates);else if(t.type==="Polygon")n=t.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return n.forEach(u=>{n.forEach(h=>{for(let c=0;c<u.length-1;c++)for(let g=c;g<h.length-1;g++){if(u===h&&(Math.abs(c-g)===1||c===0&&g===u.length-2&&u[c][0]===u[u.length-1][0]&&u[c][1]===u[u.length-1][1]))continue;const d=kf(u[c][0],u[c][1],u[c+1][0],u[c+1][1],h[g][0],h[g][1],h[g+1][0],h[g+1][1]);d&&a.features.push(re([d[0],d[1]]))}})}),a}function kf(i,n,t,a,u,h,c,g){let d,m,p,x,I;const w={x:null,y:null,onLine1:!1,onLine2:!1};return d=(g-h)*(t-i)-(c-u)*(a-n),d===0?w.x!==null&&w.y!==null?w:!1:(m=n-h,p=i-u,x=(c-u)*m-(g-h)*p,I=(t-i)*m-(a-n)*p,m=x/d,p=I/d,w.x=i+m*(t-i),w.y=n+m*(a-n),m>=0&&m<=1&&(w.onLine1=!0),p>=0&&p<=1&&(w.onLine2=!0),w.onLine1&&w.onLine2?[w.x,w.y]:!1)}function eu(i,n={}){return Vi(i,(t,a)=>{const u=a.geometry.coordinates;return t+me(u[0],u[1],n)},0)}function tu(i,n,t,a,u={}){const h=u.steps||64,c=Pa(t),g=Pa(a),d=!Array.isArray(i)&&i.type==="Feature"?i.properties:{};if(c===g)return he(Ki(i,n,u).geometry.coordinates[0],d);const m=c,p=c<g?g:g+360;let x=m;const I=[];let w=0;const k=(p-m)/h;for(;x<=p;)I.push(It(i,n,x,u).geometry.coordinates),w++,x=m+w*k;return he(I,d)}function Pa(i){let n=i%360;return n<0&&(n+=360),n}function nu(i,n,t,a){if(a=a||{},!de(a))throw new Error("options is invalid");var u,h=[];if(i.type==="Feature")u=i.geometry.coordinates;else if(i.type==="LineString")u=i.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var c=u.length,g=0,d,m,p,x=0;x<u.length&&!(n>=g&&x===u.length-1);x++){if(g>n&&h.length===0){if(d=n-g,!d)return h.push(u[x]),he(h);m=kt(u[x],u[x-1])-180,p=It(u[x],d,m,a),h.push(p.geometry.coordinates)}if(g>=t)return d=t-g,d?(m=kt(u[x],u[x-1])-180,p=It(u[x],d,m,a),h.push(p.geometry.coordinates),he(h)):(h.push(u[x]),he(h));if(g>=n&&h.push(u[x]),x===u.length-1)return he(h);g+=me(u[x],u[x+1],a)}if(g<n&&u.length===c)throw new Error("Start position is beyond line");var I=u[u.length-1];return he([I,I])}function If(i,n,t){if(t=t||{},!de(t))throw new Error("options is invalid");var a=t.units,u=t.reverse;if(!i)throw new Error("geojson is required");if(n<=0)throw new Error("segmentLength must be greater than 0");var h=[];return Ye(i,function(c){u&&(c.geometry.coordinates=c.geometry.coordinates.reverse()),Nf(c,n,a,function(g){h.push(g)})}),G(h)}function Nf(i,n,t,a){var u=eu(i,{units:t});if(u<=n)return a(i);var h=u/n;Number.isInteger(h)||(h=Math.floor(h)+1);for(var c=0;c<h;c++){var g=nu(i,n*c,n*(c+1),{units:t});a(g,c)}}function Cr(i){var n=i[0],t=i[1];return[t[0]-n[0],t[1]-n[1]]}function Ci(i,n){return i[0]*n[1]-n[0]*i[1]}function Mf(i,n){return[i[0]+n[0],i[1]+n[1]]}function Pf(i,n){return[i[0]-n[0],i[1]-n[1]]}function Lf(i,n){return[i*n[0],i*n[1]]}function Sf(i,n){var t=i[0],a=Cr(i),u=n[0],h=Cr(n),c=Ci(a,h),g=Pf(u,t),d=Ci(g,h),m=d/c,p=Mf(t,Lf(m,a));return p}function bf(i,n){var t=Cr(i),a=Cr(n);return Ci(t,a)===0}function Cf(i,n){return bf(i,n)?!1:Sf(i,n)}function Tf(i,n,t){if(t=t||{},!de(t))throw new Error("options is invalid");var a=t.units;if(!i)throw new Error("geojson is required");if(n==null||isNaN(n))throw new Error("distance is required");var u=We(i),h=i.properties;switch(u){case"LineString":return La(i,n,a);case"MultiLineString":var c=[];return Ye(i,function(g){c.push(La(g,n,a).geometry.coordinates)}),St(c,h);default:throw new Error("geometry "+u+" is not supported")}}function La(i,n,t){var a=[],u=Rr(n,t),h=J(i),c=[];return h.forEach(function(g,d){if(d!==h.length-1){var m=Of(g,h[d+1],u);if(a.push(m),d>0){var p=a[d-1],x=Cf(m,p);x!==!1&&(p[1]=x,m[0]=x),c.push(p[0]),d===h.length-2&&(c.push(m[0]),c.push(m[1]))}h.length===2&&(c.push(m[0]),c.push(m[1]))}}),he(c,i.properties)}function Of(i,n,t){var a=Math.sqrt((i[0]-n[0])*(i[0]-n[0])+(i[1]-n[1])*(i[1]-n[1])),u=i[0]+t*(n[1]-i[1])/a,h=n[0]+t*(n[1]-i[1])/a,c=i[1]+t*(i[0]-n[0])/a,g=n[1]+t*(i[0]-n[0])/a;return[[u,c],[h,g]]}function Rf(i,n,t){var a=J(t);if(We(t)!=="LineString")throw new Error("line must be a LineString");var u=Lt(t,i),h=Lt(t,n),c;u.properties.index<=h.properties.index?c=[u,h]:c=[h,u];for(var g=[c[0].geometry.coordinates],d=c[0].properties.index+1;d<c[1].properties.index+1;d++)g.push(a[d]);return g.push(c[1].geometry.coordinates),he(g,t.properties)}function ru(i){var n=i[0],t=i[1],a=i[2],u=i[3],h=me(i.slice(0,2),[a,t]),c=me(i.slice(0,2),[n,u]);if(h>=c){var g=(t+u)/2;return[n,g-(a-n)/2,a,g+(a-n)/2]}else{var d=(n+a)/2;return[d-(u-t)/2,t,d+(u-t)/2,u]}}function iu(i,n){if(n=n??{},!de(n))throw new Error("options is invalid");var t=n.precision,a=n.coordinates,u=n.mutate;if(t=t==null||isNaN(t)?6:t,a=a==null||isNaN(a)?3:a,!i)throw new Error("<geojson> is required");if(typeof t!="number")throw new Error("<precision> must be a number");if(typeof a!="number")throw new Error("<coordinates> must be a number");(u===!1||u===void 0)&&(i=JSON.parse(JSON.stringify(i)));var h=Math.pow(10,t);return Me(i,function(c){Af(c,h,a)}),i}function Af(i,n,t){i.length>t&&i.splice(t,i.length);for(var a=0;a<i.length;a++)i[a]=Math.round(i[a]*n)/n;return i}function Df(i,n){if(!i)throw new Error("line is required");if(!n)throw new Error("splitter is required");var t=We(i),a=We(n);if(t!=="LineString")throw new Error("line must be LineString");if(a==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(a==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var u=iu(n,{precision:7});switch(a){case"Point":return Ti(i,u);case"MultiPoint":return Sa(i,u);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Sa(i,ht(i,u,{ignoreSelfIntersections:!0}))}}function Sa(i,n){var t=[],a=Ar();return Ye(n,function(u){if(t.forEach(function(g,d){g.id=d}),!t.length)t=Ti(i,u).features,t.forEach(function(g){g.bbox||(g.bbox=ru(_e(g)))}),a.load(G(t));else{var h=a.search(u);if(h.features.length){var c=su(u,h);t=t.filter(function(g){return g.id!==c.id}),a.remove(c),ce(Ti(c,u),function(g){t.push(g),a.insert(g)})}}}),G(t)}function Ti(i,n){var t=[],a=J(i)[0],u=J(i)[i.geometry.coordinates.length-1];if(Ii(a,ye(n))||Ii(u,ye(n)))return G([i]);var h=Ar(),c=$n(i);h.load(c);var g=h.search(n);if(!g.features.length)return G([i]);var d=su(n,g),m=[a],p=zi(c,function(x,I,w){var k=J(I)[1],C=ye(n);return w===d.id?(x.push(C),t.push(he(x)),Ii(C,k)?[C]:[C,k]):(x.push(k),x)},m);return p.length>1&&t.push(he(p)),G(t)}function su(i,n){if(!n.features.length)throw new Error("lines must contain features");if(n.features.length===1)return n.features[0];var t,a=1/0;return ce(n,function(u){var h=Lt(u,i),c=h.properties.dist;c<a&&(t=u,a=c)}),t}function Ii(i,n){return i[0]===n[0]&&i[1]===n[1]}function Ff(i,n={}){var t,a,u,h=n.properties,c=(t=n.autoComplete)!=null?t:!0,g=(a=n.orderCoords)!=null?a:!0,d=(u=n.mutate)!=null?u:!1;switch(d||(i=Xe(i)),i.type){case"FeatureCollection":var m=[];return i.features.forEach(function(p){m.push(J(ba(p,{},c,g)))}),Ze(m,h);default:return ba(i,h,c,g)}}function ba(i,n,t,a){n=n||(i.type==="Feature"?i.properties:{});var u=ke(i),h=u.coordinates,c=u.type;if(!h.length)throw new Error("line must contain coordinates");switch(c){case"LineString":return t&&(h=Ca(h)),j([h],n);case"MultiLineString":var g=[],d=0;return h.forEach(function(m){if(t&&(m=Ca(m)),a){var p=Bf(_e(he(m)));p>d?(g.unshift(m),d=p):g.push(m)}else g.push(m)}),j(g,n);default:throw new Error("geometry type "+c+" is not supported")}}function Ca(i){var n=i[0],t=n[0],a=n[1],u=i[i.length-1],h=u[0],c=u[1];return(t!==h||a!==c)&&i.push(n),i}function Bf(i){var n=i[0],t=i[1],a=i[2],u=i[3];return Math.abs(n-a)*Math.abs(t-u)}function qf(i,n,t){var a;const u=(a=t==null?void 0:t.mutate)!=null?a:!1;let h=n;n&&u===!1&&(h=Xe(n));const c=Xf(h);let g=null;return i.type==="FeatureCollection"?g=Yf(i):i.type==="Feature"?g=Oi(yt.union(i.geometry.coordinates)):g=Oi(yt.union(i.coordinates)),g.geometry.coordinates.forEach(function(d){c.geometry.coordinates.push(d[0])}),c}function Yf(i){const n=i.features.length===2?yt.union(i.features[0].geometry.coordinates,i.features[1].geometry.coordinates):yt.union.apply(yt,i.features.map(function(t){return t.geometry.coordinates}));return Oi(n)}function Oi(i){return Ze(i)}function Xf(i){let t=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]];return i&&(i.type==="Feature"?t=i.geometry.coordinates:t=i.coordinates),j(t)}function Gf(i,n){const t=me(i,n),a=kt(i,n);return It(i,t/2,a)}function zf(i,n){var t,a;const u=n.inputField,h=n.threshold||1e5,c=n.p||2,g=(t=n.binary)!=null?t:!1,d=n.alpha||-1,m=(a=n.standardization)!=null?a:!0,p=Vo(i,{alpha:d,binary:g,p:c,standardization:m,threshold:h}),x=[];ce(i,ae=>{const ie=ae.properties||{};x.push(ie[u])});const I=au(x),w=Uf(x);let k=0,C=0,D=0,R=0;const P=p.length;for(let ae=0;ae<P;ae++){let ie=0;for(let ve=0;ve<P;ve++)k+=p[ae][ve]*(x[ae]-I)*(x[ve]-I),C+=p[ae][ve],D+=Math.pow(p[ae][ve]+p[ve][ae],2),ie+=p[ae][ve]+p[ve][ae];R+=Math.pow(ie,2)}D=.5*D;const S=k/C/w,A=-1/(P-1),O=P*P*D-P*R+3*(C*C),fe=(P-1)*(P+1)*(C*C),X=O/fe-A*A,Z=Math.sqrt(X),H=(S-A)/Z;return{expectedMoranIndex:A,moranIndex:S,stdNorm:Z,zNorm:H}}function au(i){let n=0;for(const t of i)n+=t;return n/i.length}function Uf(i){const n=au(i);let t=0;for(const a of i)t+=Math.pow(a-n,2);return t/i.length}var Vf=Object.defineProperty,$f=Object.defineProperties,Hf=Object.getOwnPropertyDescriptors,Ta=Object.getOwnPropertySymbols,Zf=Object.prototype.hasOwnProperty,Wf=Object.prototype.propertyIsEnumerable,Oa=(i,n,t)=>n in i?Vf(i,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[n]=t,Ra=(i,n)=>{for(var t in n||(n={}))Zf.call(n,t)&&Oa(i,t,n[t]);if(Ta)for(var t of Ta(n))Wf.call(n,t)&&Oa(i,t,n[t]);return i},Aa=(i,n)=>$f(i,Hf(n));function Xr(i,n,t={}){if(!i)throw new Error("targetPoint is required");if(!n)throw new Error("points is required");let a=1/0,u=0;ce(n,(c,g)=>{const d=me(i,c,t);d<a&&(u=g,a=d)});const h=Xe(n.features[u]);return Aa(Ra({},h),{properties:Aa(Ra({},h.properties),{featureIndex:u,distanceToPoint:a})})}function Jf(i,n){n=n||{};const t=n.studyArea||nr(_e(i)),a=n.properties||{},u=n.units||"kilometers",h=[];ce(i,x=>{h.push(Nt(x))});const c=h.length,g=h.map((x,I)=>{const w=G(h.filter((k,C)=>C!==I));return me(x,Xr(x,w).geometry.coordinates,{units:u})}).reduce((x,I)=>x+I,0)/c,d=c/qi(tr(t),"meters",u),m=1/(2*Math.sqrt(d)),p=.26136/Math.sqrt(c*d);return a.nearestNeighborAnalysis={units:u,arealUnits:u+"²",observedMeanDistance:g,expectedMeanDistance:m,nearestNeighborIndex:g/m,numberOfPoints:c,zScore:(g-m)/p},t.properties=a,t}function ou(i,n,t={}){if(t.method||(t.method="geodesic"),t.units||(t.units="kilometers"),!i)throw new Error("pt is required");if(Array.isArray(i)?i=re(i):i.type==="Point"?i=Oe(i):zn(i,"Point","point"),!n)throw new Error("line is required");Array.isArray(n)?n=he(n):n.type==="LineString"?n=Oe(n):zn(n,"LineString","line");let a=1/0;const u=i.geometry.coordinates;return wt(n,h=>{const c=h.geometry.coordinates[0],g=h.geometry.coordinates[1],d=Kf(u,c,g,t);d<a&&(a=d)}),Xt(a,"degrees",t.units)}function Kf(i,n,t,a){const u=[t[0]-n[0],t[1]-n[1]],h=[i[0]-n[0],i[1]-n[1]],c=Da(h,u);if(c<=0)return Ni(i,n,{method:a.method,units:"degrees"});const g=Da(u,u);if(g<=c)return Ni(i,t,{method:a.method,units:"degrees"});const d=c/g,m=[n[0]+d*u[0],n[1]+d*u[1]];return Ni(i,m,{method:a.method,units:"degrees"})}function Da(i,n){return i[0]*n[0]+i[1]*n[1]}function Ni(i,n,t){return t.method==="planar"?qr(i,n,t):me(i,n,t)}var Qf=Object.defineProperty,Fa=Object.getOwnPropertySymbols,jf=Object.prototype.hasOwnProperty,eg=Object.prototype.propertyIsEnumerable,Ba=(i,n,t)=>n in i?Qf(i,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[n]=t,Mi=(i,n)=>{for(var t in n||(n={}))jf.call(n,t)&&Ba(i,t,n[t]);if(Fa)for(var t of Fa(n))eg.call(n,t)&&Ba(i,t,n[t]);return i};function tg(i,n,t={}){const a=t.units,u=t.properties||{},h=ng(i);if(!h.features.length)throw new Error("points must contain features");if(!n)throw new Error("line is required");if(We(n)!=="LineString")throw new Error("line must be a LineString");let c=1/0,g=null;return ce(h,d=>{const m=ou(d,n,{units:a});m<c&&(c=m,g=d)}),g&&(g.properties=Mi(Mi(Mi({},{dist:c}),g.properties),u)),g}function ng(i){const n=[];switch(i.geometry?i.geometry.type:i.type){case"GeometryCollection":return Ge(i,a=>{a.type==="Point"&&n.push({type:"Feature",properties:{},geometry:a})}),{type:"FeatureCollection",features:n};case"FeatureCollection":return i.features=i.features.filter(a=>a.geometry.type==="Point"),i;default:throw new Error("points must be a Point Collection")}}function rg(i,n){const t=ye(i),h=ke(n).coordinates[0];if(h.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");const c=n.type==="Feature"&&n.properties||{},g=c.a,d=c.b,m=c.c,p=t[0],x=t[1],I=h[0][0],w=h[0][1],k=g!==void 0?g:h[0][2],C=h[1][0],D=h[1][1],R=d!==void 0?d:h[1][2],P=h[2][0],S=h[2][1],A=m!==void 0?m:h[2][2];return(A*(p-I)*(x-D)+k*(p-C)*(x-S)+R*(p-P)*(x-w)-R*(p-I)*(x-S)-A*(p-C)*(x-w)-k*(p-P)*(x-D))/((p-I)*(x-D)+(p-C)*(x-S)+(p-P)*(x-w)-(p-I)*(x-S)-(p-C)*(x-w)-(p-P)*(x-D))}function ig(i){const n=sg(i),t=Dr(n);let a=!1,u=0;for(;!a&&u<n.features.length;){const h=n.features[u].geometry;let c,g,d,m,p,x,I=!1;if(h.type==="Point")t.geometry.coordinates[0]===h.coordinates[0]&&t.geometry.coordinates[1]===h.coordinates[1]&&(a=!0);else if(h.type==="MultiPoint"){let w=!1,k=0;for(;!w&&k<h.coordinates.length;)t.geometry.coordinates[0]===h.coordinates[k][0]&&t.geometry.coordinates[1]===h.coordinates[k][1]&&(a=!0,w=!0),k++}else if(h.type==="LineString"){let w=0;for(;!I&&w<h.coordinates.length-1;)c=t.geometry.coordinates[0],g=t.geometry.coordinates[1],d=h.coordinates[w][0],m=h.coordinates[w][1],p=h.coordinates[w+1][0],x=h.coordinates[w+1][1],qa(c,g,d,m,p,x)&&(I=!0,a=!0),w++}else if(h.type==="MultiLineString"){let w=0;for(;w<h.coordinates.length;){I=!1;let k=0;const C=h.coordinates[w];for(;!I&&k<C.length-1;)c=t.geometry.coordinates[0],g=t.geometry.coordinates[1],d=C[k][0],m=C[k][1],p=C[k+1][0],x=C[k+1][1],qa(c,g,d,m,p,x)&&(I=!0,a=!0),k++;w++}}else(h.type==="Polygon"||h.type==="MultiPolygon")&&ne(t,h)&&(a=!0);u++}if(a)return t;{const h=G([]);for(let c=0;c<n.features.length;c++)h.features=h.features.concat(Yr(n.features[c]).features);return re(Xr(t,h).geometry.coordinates)}}function sg(i){return i.type!=="FeatureCollection"?i.type!=="Feature"?G([Oe(i)]):G([i]):i}function qa(i,n,t,a,u,h){const c=Math.sqrt((u-t)*(u-t)+(h-a)*(h-a)),g=Math.sqrt((i-t)*(i-t)+(n-a)*(n-a)),d=Math.sqrt((u-i)*(u-i)+(h-n)*(h-n));return c===g+d}function uu(i,n){const t=[];return ce(i,function(a){let u=!1;if(a.geometry.type==="Point")Ge(n,function(c){ne(a,c)&&(u=!0)}),u&&t.push(a);else if(a.geometry.type==="MultiPoint"){var h=[];Ge(n,function(c){Me(a,function(g){ne(g,c)&&(u=!0,h.push(g))})}),u&&t.push(jn(h,a.properties))}else throw new Error("Input geometry must be a Point or MultiPoint")}),G(t)}function ag(i){return(i>0)-(i<0)||+i}function ss(i,n,t){const a=n[0]-i[0],u=n[1]-i[1],h=t[0]-n[0],c=t[1]-n[1];return ag(a*c-h*u)}function og(i,n){const t=i.geometry.coordinates[0].map(c=>c[0]),a=i.geometry.coordinates[0].map(c=>c[1]),u=n.geometry.coordinates[0].map(c=>c[0]),h=n.geometry.coordinates[0].map(c=>c[1]);return Math.max.apply(null,t)===Math.max.apply(null,u)&&Math.max.apply(null,a)===Math.max.apply(null,h)&&Math.min.apply(null,t)===Math.min.apply(null,u)&&Math.min.apply(null,a)===Math.min.apply(null,h)}function Ya(i,n){return n.geometry.coordinates[0].every(t=>ne(re(t),i))}function ug(i,n){return i[0]===n[0]&&i[1]===n[1]}var Xa=class lu{static buildId(n){return n.join(",")}constructor(n){this.id=lu.buildId(n),this.coordinates=n,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}removeInnerEdge(n){this.innerEdges=this.innerEdges.filter(t=>t.from.id!==n.from.id)}removeOuterEdge(n){this.outerEdges=this.outerEdges.filter(t=>t.to.id!==n.to.id)}addOuterEdge(n){this.outerEdges.push(n),this.outerEdgesSorted=!1}sortOuterEdges(){this.outerEdgesSorted||(this.outerEdges.sort((n,t)=>{const a=n.to,u=t.to;if(a.coordinates[0]-this.coordinates[0]>=0&&u.coordinates[0]-this.coordinates[0]<0)return 1;if(a.coordinates[0]-this.coordinates[0]<0&&u.coordinates[0]-this.coordinates[0]>=0)return-1;if(a.coordinates[0]-this.coordinates[0]===0&&u.coordinates[0]-this.coordinates[0]===0)return a.coordinates[1]-this.coordinates[1]>=0||u.coordinates[1]-this.coordinates[1]>=0?a.coordinates[1]-u.coordinates[1]:u.coordinates[1]-a.coordinates[1];const h=ss(this.coordinates,a.coordinates,u.coordinates);if(h<0)return 1;if(h>0)return-1;const c=Math.pow(a.coordinates[0]-this.coordinates[0],2)+Math.pow(a.coordinates[1]-this.coordinates[1],2),g=Math.pow(u.coordinates[0]-this.coordinates[0],2)+Math.pow(u.coordinates[1]-this.coordinates[1],2);return c-g}),this.outerEdgesSorted=!0)}getOuterEdges(){return this.sortOuterEdges(),this.outerEdges}getOuterEdge(n){return this.sortOuterEdges(),this.outerEdges[n]}addInnerEdge(n){this.innerEdges.push(n)}},lg=class hu{getSymetric(){return this.symetric||(this.symetric=new hu(this.to,this.from),this.symetric.symetric=this),this.symetric}constructor(n,t){this.from=n,this.to=t,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}deleteEdge(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)}isEqual(n){return this.from.id===n.from.id&&this.to.id===n.to.id}toString(){return`Edge { ${this.from.id} -> ${this.to.id} }`}toLineString(){return he([this.from.coordinates,this.to.coordinates])}compareTo(n){return ss(n.from.coordinates,n.to.coordinates,this.to.coordinates)}},cu=class{constructor(){this.edges=[],this.polygon=void 0,this.envelope=void 0}push(i){this.edges.push(i),this.polygon=this.envelope=void 0}get(i){return this.edges[i]}get length(){return this.edges.length}forEach(i){this.edges.forEach(i)}map(i){return this.edges.map(i)}some(i){return this.edges.some(i)}isValid(){return!0}isHole(){const i=this.edges.reduce((u,h,c)=>(h.from.coordinates[1]>this.edges[u].from.coordinates[1]&&(u=c),u),0),n=(i===0?this.length:i)-1,t=(i+1)%this.length,a=ss(this.edges[n].from.coordinates,this.edges[i].from.coordinates,this.edges[t].from.coordinates);return a===0?this.edges[n].from.coordinates[0]>this.edges[t].from.coordinates[0]:a>0}toMultiPoint(){return jn(this.edges.map(i=>i.from.coordinates))}toPolygon(){if(this.polygon)return this.polygon;const i=this.edges.map(n=>n.from.coordinates);return i.push(this.edges[0].from.coordinates),this.polygon=j([i])}getEnvelope(){return this.envelope?this.envelope:this.envelope=Zo(this.toPolygon())}static findEdgeRingContaining(i,n){const t=i.getEnvelope();let a,u;return n.forEach(h=>{const c=h.getEnvelope();if(u&&(a=u.getEnvelope()),!og(c,t)&&Ya(c,t)){const g=i.map(m=>m.from.coordinates);let d;for(const m of g)h.some(p=>ug(m,p.from.coordinates))||(d=m);d&&h.inside(re(d))&&(!u||Ya(a,c))&&(u=h)}}),u}inside(i){return ne(i,this.toPolygon())}};function hg(i){if(!i)throw new Error("No geojson passed");if(i.type!=="FeatureCollection"&&i.type!=="GeometryCollection"&&i.type!=="MultiLineString"&&i.type!=="LineString"&&i.type!=="Feature")throw new Error(`Invalid input type '${i.type}'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature`)}var cg=class fu{static fromGeoJson(n){hg(n);const t=new fu;return Ye(n,a=>{zn(a,"LineString","Graph::fromGeoJson"),Xi(a,(u,h)=>{if(u){const c=t.getNode(u),g=t.getNode(h);t.addEdge(c,g)}return h})}),t}getNode(n){const t=Xa.buildId(n);let a=this.nodes[t];return a||(a=this.nodes[t]=new Xa(n)),a}addEdge(n,t){const a=new lg(n,t),u=a.getSymetric();this.edges.push(a),this.edges.push(u)}constructor(){this.edges=[],this.nodes={}}deleteDangles(){Object.keys(this.nodes).map(n=>this.nodes[n]).forEach(n=>this._removeIfDangle(n))}_removeIfDangle(n){if(n.innerEdges.length<=1){const t=n.getOuterEdges().map(a=>a.to);this.removeNode(n),t.forEach(a=>this._removeIfDangle(a))}}deleteCutEdges(){this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(n=>{n.label===n.symetric.label&&(this.removeEdge(n.symetric),this.removeEdge(n))})}_computeNextCWEdges(n){typeof n>"u"?Object.keys(this.nodes).forEach(t=>this._computeNextCWEdges(this.nodes[t])):n.getOuterEdges().forEach((t,a)=>{n.getOuterEdge((a===0?n.getOuterEdges().length:a)-1).symetric.next=t})}_computeNextCCWEdges(n,t){const a=n.getOuterEdges();let u,h;for(let c=a.length-1;c>=0;--c){let g=a[c],d=g.symetric,m,p;g.label===t&&(m=g),d.label===t&&(p=d),!(!m||!p)&&(p&&(h=p),m&&(h&&(h.next=m,h=void 0),u||(u=m)))}h&&(h.next=u)}_findLabeledEdgeRings(){const n=[];let t=0;return this.edges.forEach(a=>{if(a.label>=0)return;n.push(a);let u=a;do u.label=t,u=u.next;while(!a.isEqual(u));t++}),n}getEdgeRings(){this._computeNextCWEdges(),this.edges.forEach(t=>{t.label=void 0}),this._findLabeledEdgeRings().forEach(t=>{this._findIntersectionNodes(t).forEach(a=>{this._computeNextCCWEdges(a,t.label)})});const n=[];return this.edges.forEach(t=>{t.ring||n.push(this._findEdgeRing(t))}),n}_findIntersectionNodes(n){const t=[];let a=n;do{let u=0;a.from.getOuterEdges().forEach(h=>{h.label===n.label&&++u}),u>1&&t.push(a.from),a=a.next}while(!n.isEqual(a));return t}_findEdgeRing(n){let t=n;const a=new cu;do a.push(t),t.ring=a,t=t.next;while(!n.isEqual(t));return a}removeNode(n){n.getOuterEdges().forEach(t=>this.removeEdge(t)),n.innerEdges.forEach(t=>this.removeEdge(t)),delete this.nodes[n.id]}removeEdge(n){this.edges=this.edges.filter(t=>!t.isEqual(n)),n.deleteEdge()}};function fg(i){const n=cg.fromGeoJson(i);n.deleteDangles(),n.deleteCutEdges();const t=[],a=[];return n.getEdgeRings().filter(u=>u.isValid()).forEach(u=>{u.isHole()?t.push(u):a.push(u)}),t.forEach(u=>{cu.findEdgeRingContaining(u,a)&&a.push(u)}),G(a.map(u=>u.toPolygon()))}function gg(i,n){n=n||{},n.iterations=n.iterations||1;const{iterations:t}=n,a=[];if(!i)throw new Error("inputPolys is required");return Ge(i,function(u,h,c){if(u.type==="Polygon"){let g=[[]];for(let d=0;d<t;d++){let m=[],p=u;d>0&&(p=j(g).geometry),dg(p,m),g=m.slice(0)}a.push(j(g,c))}else if(u.type==="MultiPolygon"){let g=[[[]]];for(let d=0;d<t;d++){let m=[],p=u;d>0&&(p=Ze(g).geometry),vg(p,m),g=m.slice(0)}a.push(Ze(g,c))}else throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}),G(a)}function dg(i,n){var t,a;Me(i,function(u,h,c,g,d){if(a!==d)n.push([]);else{var m=t[0],p=t[1],x=u[0],I=u[1];n[d].push([.75*m+.25*x,.75*p+.25*I]),n[d].push([.25*m+.75*x,.25*p+.75*I])}t=u,a=d},!1),n.forEach(function(u){u.push(u[0])})}function vg(i,n){let t,a,u;Me(i,function(h,c,g,d,m){if(a!==d)n.push([[]]);else if(u!==m)n[d].push([]);else{var p=t[0],x=t[1],I=h[0],w=h[1];n[d][m].push([.75*p+.25*I,.75*x+.25*w]),n[d][m].push([.25*p+.75*I,.25*x+.75*w])}t=h,a=d,u=m},!1),n.forEach(function(h){h.forEach(function(c){c.push(c[0])})})}function mg(i,n){const t=J(i),a=J(n);let u=[],h=[],c;const g=_e(n);let d=0,m=null;switch(t[0]>g[0]&&t[0]<g[2]&&t[1]>g[1]&&t[1]<g[3]&&(m=Xr(i,Yr(n)),d=m.properties.featureIndex),We(n)){case"Polygon":u=a[0][d],h=a[0][0],m!==null&&m.geometry.coordinates[1]<t[1]&&(h=a[0][d]),c=Wn(a[0][0],a[0][a[0].length-1],t),[u,h]=Ga(a[0],t,c,u,h);break;case"MultiPolygon":for(var x=0,I=0,w=0,k=0;k<a[0].length;k++){x=k;for(var C=!1,D=0;D<a[0][k].length;D++){if(I=D,w===d){C=!0;break}w++}if(C)break}u=a[0][x][I],h=a[0][x][I],c=Wn(a[0][0][0],a[0][0][a[0][0].length-1],t),a.forEach(function(R){[u,h]=Ga(R[0],t,c,u,h)});break}return G([re(u),re(h)])}function Ga(i,n,t,a,u){for(let h=0;h<i.length;h++){const c=i[h];let g=i[h+1];h===i.length-1&&(g=i[0]);const d=Wn(c,g,n);t<=0&&d>0?pg(n,c,a)||(a=c):t>0&&d<=0&&(yg(n,c,u)||(u=c)),t=d}return[a,u]}function yg(i,n,t){return Wn(i,n,t)>0}function pg(i,n,t){return Wn(i,n,t)<0}function Wn(i,n,t){return(n[0]-i[0])*(t[1]-i[1])-(t[0]-i[0])*(n[1]-i[1])}function gu(i,n={}){return vu(i,"mercator",n)}function du(i,n={}){return vu(i,"wgs84",n)}function vu(i,n,t={}){t=t||{};var a=t.mutate;if(!i)throw new Error("geojson is required");return Array.isArray(i)&&De(i[0])?i=n==="mercator"?za(i):Ua(i):(a!==!0&&(i=Xe(i)),Me(i,function(u){var h=n==="mercator"?za(u):Ua(u);u[0]=h[0],u[1]=h[1]})),i}function za(i){var n=Math.PI/180,t=6378137,a=20037508342789244e-9,u=Math.abs(i[0])<=180?i[0]:i[0]-_g(i[0])*360,h=[t*u*n,t*Math.log(Math.tan(Math.PI*.25+.5*i[1]*n))];return h[0]>a&&(h[0]=a),h[0]<-a&&(h[0]=-a),h[1]>a&&(h[1]=a),h[1]<-a&&(h[1]=-a),h}function Ua(i){var n=180/Math.PI,t=6378137;return[i[0]*n/t,(Math.PI*.5-2*Math.atan(Math.exp(-i[1]/t)))*n]}function _g(i){return i<0?-1:i>0?1:0}const xg=Object.freeze(Object.defineProperty({__proto__:null,toMercator:gu,toWgs84:du},Symbol.toStringTag,{value:"Module"}));function Eg(i,n){n=n||{};const t=n.studyBbox||_e(i),a=n.confidenceLevel||20,u=i.features,h=u.length,c=tr(nr(t)),g=Math.sqrt(c/h*2),m=is(t,g,{units:"meters"}).features,p={};for(let X=0;X<m.length;X++)p[X]={box:_e(m[X]),cnt:0};let x=0;for(const X of u)for(const Z of Object.keys(p)){const H=p[Z].box;if(kg(ye(X),H)){p[Z].cnt+=1,x+=1;break}}let I=0;for(const X of Object.keys(p)){const Z=p[X].cnt;Z>I&&(I=Z)}const w=[],k=Object.keys(p).length,C=x/k;let D=0;for(let X=0;X<I+1;X++)D+=Math.exp(-C)*Math.pow(C,X)/Ig(X),w.push(D);const R=[];let P=0;for(let X=0;X<I+1;X++){for(const H of Object.keys(p))p[H].cnt===X&&(P+=1);const Z=P/k;R.push(Z)}let S=0;for(let X=0;X<I+1;X++){const Z=Math.abs(w[X]-R[X]);Z>S&&(S=Z)}const O=wg[a]/Math.sqrt(k),fe={criticalValue:O,isRandom:!0,maxAbsoluteDifference:S,observedDistribution:R};return S>O&&(fe.isRandom=!1),fe}var wg={20:1.07275,15:1.13795,10:1.22385,5:1.3581,2:1.51743,1:1.62762};function kg(i,n){return n[0]<=i[0]&&n[1]<=i[1]&&n[2]>=i[0]&&n[3]>=i[1]}function Ig(i){const n=[];function t(a){return a===0||a===1?1:n[a]>0?n[a]:n[a]=t(a-1)*a}return t(i)}function mu(i){return zr(i),Gr(i)}function Gr(i){return Array.isArray(i)?Va(i):i&&i.bbox?Va(i.bbox):[Mg(),Pg()]}function zr(i){i!=null&&(Array.isArray(i)?Sr(i):i.bbox!=null&&Sr(i.bbox))}function yu(i,n={}){zr(n.bbox),i==null&&(i=1);const t=[];for(let a=0;a<i;a++)t.push(re(Gr(n.bbox)));return G(t)}function pu(i,n={}){zr(n.bbox),i==null&&(i=1),(n.bbox===void 0||n.bbox===null)&&(n.bbox=[-180,-90,180,90]),(!De(n.num_vertices)||n.num_vertices===void 0)&&(n.num_vertices=10),(!De(n.max_radial_length)||n.max_radial_length===void 0)&&(n.max_radial_length=10);const t=Math.abs(n.bbox[0]-n.bbox[2]),a=Math.abs(n.bbox[1]-n.bbox[3]),u=Math.min(t/2,a/2);if(n.max_radial_length>u)throw new Error("max_radial_length is greater than the radius of the bbox");const h=[n.bbox[0]+n.max_radial_length,n.bbox[1]+n.max_radial_length,n.bbox[2]-n.max_radial_length,n.bbox[3]-n.max_radial_length],c=[];for(let g=0;g<i;g++){let d=[];const m=[...Array(n.num_vertices+1)].map(Math.random);m.forEach((p,x,I)=>{I[x]=x>0?p+I[x-1]:p}),m.forEach(p=>{p=p*2*Math.PI/m[m.length-1];const x=Math.random();d.push([x*(n.max_radial_length||10)*Math.sin(p),x*(n.max_radial_length||10)*Math.cos(p)])}),d[d.length-1]=d[0],d=d.map(Ng(Gr(h))),c.push(j([d]))}return G(c)}function _u(i,n={}){if(n=n||{},!de(n))throw new Error("options is invalid");const t=n.bbox;zr(t);let a=n.num_vertices,u=n.max_length,h=n.max_rotation;i==null&&(i=1),(!De(a)||a===void 0||a<2)&&(a=10),(!De(u)||u===void 0)&&(u=1e-4),(!De(h)||h===void 0)&&(h=Math.PI/8);const c=[];for(let g=0;g<i;g++){const m=[Gr(t)];for(let p=0;p<a-1;p++){const I=(p===0?Math.random()*2*Math.PI:Math.tan((m[p][1]-m[p-1][1])/(m[p][0]-m[p-1][0])))+(Math.random()-.5)*h*2,w=Math.random()*u;m.push([m[p][0]+w*Math.cos(I),m[p][1]+w*Math.sin(I)])}c.push(he(m))}return G(c)}function Ng(i){return n=>[n[0]+i[0],n[1]+i[1]]}function xu(){return Math.random()-.5}function Mg(){return xu()*360}function Pg(){return xu()*180}function Va(i){return[Math.random()*(i[2]-i[0])+i[0],Math.random()*(i[3]-i[1])+i[1]]}const Lg=Object.freeze(Object.defineProperty({__proto__:null,randomLineString:_u,randomPoint:yu,randomPolygon:pu,randomPosition:mu},Symbol.toStringTag,{value:"Module"}));function Sg(i,n={}){var t,a;if(n=n||{},!de(n))throw new Error("options is invalid");const u=(t=n.mutate)!=null?t:!1,h=(a=n.reverse)!=null?a:!1;if(!i)throw new Error("<geojson> is required");if(typeof h!="boolean")throw new Error("<reverse> must be a boolean");if(typeof u!="boolean")throw new Error("<mutate> must be a boolean");!u&&i.type!=="Point"&&i.type!=="MultiPoint"&&(i=Xe(i));const c=[];switch(i.type){case"GeometryCollection":return Ge(i,function(g){Mr(g,h)}),i;case"FeatureCollection":return ce(i,function(g){const d=Mr(g,h);ce(d,function(m){c.push(m)})}),G(c)}return Mr(i,h)}function Mr(i,n){switch(i.type==="Feature"?i.geometry.type:i.type){case"GeometryCollection":return Ge(i,function(a){Mr(a,n)}),i;case"LineString":return $a(J(i),n),i;case"Polygon":return Ha(J(i),n),i;case"MultiLineString":return J(i).forEach(function(a){$a(a,n)}),i;case"MultiPolygon":return J(i).forEach(function(a){Ha(a,n)}),i;case"Point":case"MultiPoint":return i}}function $a(i,n){br(i)===n&&i.reverse()}function Ha(i,n){br(i[0])!==n&&i[0].reverse();for(let t=1;t<i.length;t++)br(i[t])===n&&i[t].reverse()}function bg(i,n){if(!i)throw new Error("fc is required");if(n==null)throw new Error("num is required");if(typeof n!="number")throw new Error("num must be a number");var t=G(Cg(i.features,n));return t}function Cg(i,n){for(var t=i.slice(0),a=i.length,u=a-n,h,c;a-- >u;)c=Math.floor((a+1)*Math.random()),h=t[c],t[c]=t[a],t[a]=h;return t.slice(u)}function Tg(i,n,t,a,u={}){if(u=u||{},!de(u))throw new Error("options is invalid");const h=u.properties;if(!i)throw new Error("center is required");if(t==null)throw new Error("bearing1 is required");if(a==null)throw new Error("bearing2 is required");if(!n)throw new Error("radius is required");if(typeof u!="object")throw new Error("options must be an object");if(Za(t)===Za(a))return Ki(i,n,u);const c=J(i),g=tu(i,n,t,a,u),d=[[c]];return Me(g,function(m){d[0].push(m)}),d[0].push(c),j(d,h)}function Za(i){let n=i%360;return n<0&&(n+=360),n}function Eu(i,n,t){if(t=t||{},!de(t))throw new Error("options is invalid");const a=t.origin||"centroid",u=t.mutate||!1;if(!i)throw new Error("geojson required");if(typeof n!="number"||n<=0)throw new Error("invalid factor");const h=Array.isArray(a)||typeof a=="object";return u!==!0&&(i=Xe(i)),i.type==="FeatureCollection"&&!h?(ce(i,function(c,g){i.features[g]=Wa(c,n,a)}),i):Wa(i,n,a)}function Wa(i,n,t){const a=We(i)==="Point",u=Og(i,t);return n===1||a||(Me(i,function(h){const c=qr(u,h),g=Gt(u,h),d=c*n,m=J(dn(u,d,g));h[0]=m[0],h[1]=m[1],h.length===3&&(h[2]*=n)}),delete i.bbox),i}function Og(i,n){if(n==null&&(n="centroid"),Array.isArray(n)||typeof n=="object")return ye(n);const t=i.bbox?i.bbox:_e(i,{recompute:!0}),a=t[0],u=t[1],h=t[2],c=t[3];switch(n){case"sw":case"southwest":case"westsouth":case"bottomleft":return re([a,u]);case"se":case"southeast":case"eastsouth":case"bottomright":return re([h,u]);case"nw":case"northwest":case"westnorth":case"topleft":return re([a,c]);case"ne":case"northeast":case"eastnorth":case"topright":return re([h,c]);case"center":return Dr(i);case void 0:case null:case"centroid":return Nt(i);default:throw new Error("invalid origin")}}function Ja(i){for(var n=i,t=[];n.parent;)t.unshift(n),n=n.parent;return t}function Rg(){return new wu(function(i){return i.f})}var Ur={search:function(i,n,t,a){var u;i.cleanDirty(),a=a||{};var h=a.heuristic||Ur.heuristics.manhattan,c=(u=a.closest)!=null?u:!1,g=Rg(),d=n;for(n.h=h(n,t),g.push(n);g.size()>0;){var m=g.pop();if(m===t)return Ja(m);m.closed=!0;for(var p=i.neighbors(m),x=0,I=p.length;x<I;++x){var w=p[x];if(!(w.closed||w.isWall())){var k=m.g+w.getCost(m),C=w.visited;(!C||k<w.g)&&(w.visited=!0,w.parent=m,w.h=w.h||h(w,t),w.g=k,w.f=w.g+w.h,i.markDirty(w),c&&(w.h<d.h||w.h===d.h&&w.g<d.g)&&(d=w),C?g.rescoreElement(w):g.push(w))}}}return c?Ja(d):[]},heuristics:{manhattan:function(i,n){var t=Math.abs(n.x-i.x),a=Math.abs(n.y-i.y);return t+a},diagonal:function(i,n){var t=1,a=Math.sqrt(2),u=Math.abs(n.x-i.x),h=Math.abs(n.y-i.y);return t*(u+h)+(a-2*t)*Math.min(u,h)}},cleanNode:function(i){i.f=0,i.g=0,i.h=0,i.visited=!1,i.closed=!1,i.parent=null}};function mn(i,n){n=n||{},this.nodes=[],this.diagonal=!!n.diagonal,this.grid=[];for(var t=0;t<i.length;t++){this.grid[t]=[];for(var a=0,u=i[t];a<u.length;a++){var h=new Vr(t,a,u[a]);this.grid[t][a]=h,this.nodes.push(h)}}this.init()}mn.prototype.init=function(){this.dirtyNodes=[];for(var i=0;i<this.nodes.length;i++)Ur.cleanNode(this.nodes[i])};mn.prototype.cleanDirty=function(){for(var i=0;i<this.dirtyNodes.length;i++)Ur.cleanNode(this.dirtyNodes[i]);this.dirtyNodes=[]};mn.prototype.markDirty=function(i){this.dirtyNodes.push(i)};mn.prototype.neighbors=function(i){var n=[],t=i.x,a=i.y,u=this.grid;return u[t-1]&&u[t-1][a]&&n.push(u[t-1][a]),u[t+1]&&u[t+1][a]&&n.push(u[t+1][a]),u[t]&&u[t][a-1]&&n.push(u[t][a-1]),u[t]&&u[t][a+1]&&n.push(u[t][a+1]),this.diagonal&&(u[t-1]&&u[t-1][a-1]&&n.push(u[t-1][a-1]),u[t+1]&&u[t+1][a-1]&&n.push(u[t+1][a-1]),u[t-1]&&u[t-1][a+1]&&n.push(u[t-1][a+1]),u[t+1]&&u[t+1][a+1]&&n.push(u[t+1][a+1])),n};mn.prototype.toString=function(){for(var i=[],n=this.grid,t,a,u,h,c=0,g=n.length;c<g;c++){for(t=[],a=n[c],u=0,h=a.length;u<h;u++)t.push(a[u].weight);i.push(t.join(" "))}return i.join(`
`)};function Vr(i,n,t){this.x=i,this.y=n,this.weight=t}Vr.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};Vr.prototype.getCost=function(i){return i&&i.x!==this.x&&i.y!==this.y?this.weight*1.41421:this.weight};Vr.prototype.isWall=function(){return this.weight===0};function wu(i){this.content=[],this.scoreFunction=i}wu.prototype={push:function(i){this.content.push(i),this.sinkDown(this.content.length-1)},pop:function(){var i=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),i},remove:function(i){var n=this.content.indexOf(i),t=this.content.pop();n!==this.content.length-1&&(this.content[n]=t,this.scoreFunction(t)<this.scoreFunction(i)?this.sinkDown(n):this.bubbleUp(n))},size:function(){return this.content.length},rescoreElement:function(i){this.sinkDown(this.content.indexOf(i))},sinkDown:function(i){for(var n=this.content[i];i>0;){var t=(i+1>>1)-1,a=this.content[t];if(this.scoreFunction(n)<this.scoreFunction(a))this.content[t]=n,this.content[i]=a,i=t;else break}},bubbleUp:function(i){for(var n=this.content.length,t=this.content[i],a=this.scoreFunction(t);;){var u=i+1<<1,h=u-1,c=null,g;if(h<n){var d=this.content[h];g=this.scoreFunction(d),g<a&&(c=h)}if(u<n){var m=this.content[u],p=this.scoreFunction(m);p<(c===null?a:g)&&(c=u)}if(c!==null)this.content[i]=this.content[c],this.content[c]=t,i=c;else break}}};function Ag(i,n,t={}){if(t=t||{},!de(t))throw new Error("options is invalid");let a=t.obstacles||G([]),u=t.resolution||100;if(!i)throw new Error("start is required");if(!n)throw new Error("end is required");if(u&&(!De(u)||u<=0))throw new Error("options.resolution must be a number, greater than 0");const h=ye(i),c=ye(n);if(i=re(h),n=re(c),a.type==="FeatureCollection"){if(a.features.length===0)return he([h,c])}else if(a.type==="Polygon")a=G([Oe(ke(a))]);else throw new Error("invalid obstacles");const g=a;g.features.push(i),g.features.push(n);const d=_e(Eu(nr(_e(g)),1.15)),[m,p,x,I]=d,k=me([m,p],[x,p],t)/u;g.features.pop(),g.features.pop();const D=k/me([m,p],[x,p],t)*(x-m),P=k/me([m,p],[m,I],t)*(I-p),S=x-m,A=I-p,O=Math.floor(S/D),fe=Math.floor(A/P),X=(S-O*D)/2,Z=(A-fe*P)/2,H=[],ae=[];let ie,ve,Ie=1/0,Pe=1/0,Ne=I-Z,ue=0;for(;Ne>=p;){const Be=[],xe=[];let U=m+X,Re=0;for(;U<=x;){const He=re([U,Ne]),Ve=Dg(He,a);Be.push(Ve?0:1),xe.push(U+"|"+Ne);const b=me(He,i);!Ve&&b<Ie&&(Ie=b,ie={x:Re,y:ue});const Vt=me(He,n);!Ve&&Vt<Pe&&(Pe=Vt,ve={x:Re,y:ue}),U+=D,Re++}ae.push(Be),H.push(xe),Ne-=P,ue++}const Fe=new mn(ae,{diagonal:!0}),Le=Fe.grid[ie.y][ie.x],le=Fe.grid[ve.y][ve.x],z=Ur.search(Fe,Le,le),et=[h];return z.forEach(function(Be){const xe=H[Be.x][Be.y].split("|");et.push([+xe[0],+xe[1]])}),et.push(c),zt(he(et))}function Dg(i,n){for(let t=0;t<n.features.length;t++)if(ne(i,n.features[t]))return!0;return!1}function Fg(i,n){var t=i[0]-n[0],a=i[1]-n[1];return t*t+a*a}function Bg(i,n,t){var a=n[0],u=n[1],h=t[0]-a,c=t[1]-u;if(h!==0||c!==0){var g=((i[0]-a)*h+(i[1]-u)*c)/(h*h+c*c);g>1?(a=t[0],u=t[1]):g>0&&(a+=h*g,u+=c*g)}return h=i[0]-a,c=i[1]-u,h*h+c*c}function qg(i,n){for(var t=i[0],a=[t],u,h=1,c=i.length;h<c;h++)u=i[h],Fg(u,t)>n&&(a.push(u),t=u);return t!==u&&a.push(u),a}function Ri(i,n,t,a,u){for(var h=a,c,g=n+1;g<t;g++){var d=Bg(i[g],i[n],i[t]);d>h&&(c=g,h=d)}h>a&&(c-n>1&&Ri(i,n,c,a,u),u.push(i[c]),t-c>1&&Ri(i,c,t,a,u))}function Yg(i,n){var t=i.length-1,a=[i[0]];return Ri(i,0,t,n,a),a.push(i[t]),a}function Tr(i,n,t){if(i.length<=2)return i;var a=n!==void 0?n*n:1;return i=t?i:qg(i,a),i=Yg(i,a),i}function Xg(i,n={}){var t,a,u;if(n=n??{},!de(n))throw new Error("options is invalid");const h=(t=n.tolerance)!=null?t:1,c=(a=n.highQuality)!=null?a:!1,g=(u=n.mutate)!=null?u:!1;if(!i)throw new Error("geojson is required");if(h&&h<0)throw new Error("invalid tolerance");return g!==!0&&(i=Xe(i)),Ge(i,function(d){Gg(d,h,c)}),i}function Gg(i,n,t){const a=i.type;if(a==="Point"||a==="MultiPoint")return i;if(zt(i,{mutate:!0}),a!=="GeometryCollection")switch(a){case"LineString":i.coordinates=Tr(i.coordinates,n,t);break;case"MultiLineString":i.coordinates=i.coordinates.map(u=>Tr(u,n,t));break;case"Polygon":i.coordinates=Ka(i.coordinates,n,t);break;case"MultiPolygon":i.coordinates=i.coordinates.map(u=>Ka(u,n,t))}return i}function Ka(i,n,t){return i.map(function(a){if(a.length<4)throw new Error("invalid polygon");let u=n,h=Tr(a,u,t);for(;!zg(h);)u-=u*.01,h=Tr(a,u,t);return(h[h.length-1][0]!==h[0][0]||h[h.length-1][1]!==h[0][1])&&h.push(h[0]),h})}function zg(i){return i.length<3?!1:!(i.length===3&&i[2][0]===i[0][0]&&i[2][1]===i[0][1])}function Ug(i,n){var t;if(n=n||{},!de(n))throw new Error("options is invalid");const a=n.steps||64,u=n.weight,h=n.properties||{};if(!De(a))throw new Error("steps must be a number");if(!de(h))throw new Error("properties must be a number");const c=Un(i).length,g=Ji(i,{weight:u});let d=0,m=0,p=0;ce(i,function(Z){var H;const ae=u&&((H=Z.properties)==null?void 0:H[u])||1,ie=Qa(J(Z),J(g));d+=Math.pow(ie.x,2)*ae,m+=Math.pow(ie.y,2)*ae,p+=ie.x*ie.y*ae});const x=d-m,I=Math.sqrt(Math.pow(x,2)+4*Math.pow(p,2)),w=2*p,k=Math.atan((x+I)/w),C=k*180/Math.PI;let D=0,R=0,P=0;ce(i,function(Z){var H;const ae=u&&((H=Z.properties)==null?void 0:H[u])||1,ie=Qa(J(Z),J(g));D+=Math.pow(ie.x*Math.cos(k)-ie.y*Math.sin(k),2)*ae,R+=Math.pow(ie.x*Math.sin(k)+ie.y*Math.cos(k),2)*ae,P+=ae});const S=Math.sqrt(2*D/P),A=Math.sqrt(2*R/P),O=Ho(g,S,A,{units:"degrees",angle:C,steps:a,properties:h}),fe=uu(i,G([O])),X={meanCenterCoordinates:J(g),semiMajorAxis:S,semiMinorAxis:A,numberOfFeatures:c,angle:C,percentageWithinEllipse:100*Un(fe).length/c};return O.properties=(t=O.properties)!=null?t:{},O.properties.standardDeviationalEllipse=X,O}function Qa(i,n){return{x:i[0]-n[0],y:i[1]-n[1]}}function Vg(i,n,t,a){return i=Xe(i),n=Xe(n),ce(i,function(u){u.properties||(u.properties={}),ce(n,function(h){u.properties&&h.properties&&u.properties[a]===void 0&&ne(u,h)&&(u.properties[a]=h.properties[t])})}),i}var as={exports:{}};as.exports=$r;as.exports.default=$r;function $r(i,n,t){t=t||2;var a=n&&n.length,u=a?n[0]*t:i.length,h=ku(i,0,u,t,!0),c=[];if(!h||h.next===h.prev)return c;var g,d,m,p,x,I,w;if(a&&(h=Jg(i,n,h,t)),i.length>80*t){g=m=i[0],d=p=i[1];for(var k=t;k<u;k+=t)x=i[k],I=i[k+1],x<g&&(g=x),I<d&&(d=I),x>m&&(m=x),I>p&&(p=I);w=Math.max(m-g,p-d),w=w!==0?32767/w:0}return Jn(h,c,t,g,d,w,0),c}function ku(i,n,t,a,u){var h,c;if(u===Fi(i,n,t,a)>0)for(h=n;h<t;h+=a)c=ja(h,i[h],i[h+1],c);else for(h=t-a;h>=n;h-=a)c=ja(h,i[h],i[h+1],c);return c&&Hr(c,c.next)&&(Qn(c),c=c.next),c}function Ut(i,n){if(!i)return i;n||(n=i);var t=i,a;do if(a=!1,!t.steiner&&(Hr(t,t.next)||Ce(t.prev,t,t.next)===0)){if(Qn(t),t=n=t.prev,t===t.next)break;a=!0}else t=t.next;while(a||t!==n);return n}function Jn(i,n,t,a,u,h,c){if(i){!c&&h&&td(i,a,u,h);for(var g=i,d,m;i.prev!==i.next;){if(d=i.prev,m=i.next,h?Hg(i,a,u,h):$g(i)){n.push(d.i/t|0),n.push(i.i/t|0),n.push(m.i/t|0),Qn(i),i=m.next,g=m.next;continue}if(i=m,i===g){c?c===1?(i=Zg(Ut(i),n,t),Jn(i,n,t,a,u,h,2)):c===2&&Wg(i,n,t,a,u,h):Jn(Ut(i),n,t,a,u,h,1);break}}}}function $g(i){var n=i.prev,t=i,a=i.next;if(Ce(n,t,a)>=0)return!1;for(var u=n.x,h=t.x,c=a.x,g=n.y,d=t.y,m=a.y,p=u<h?u<c?u:c:h<c?h:c,x=g<d?g<m?g:m:d<m?d:m,I=u>h?u>c?u:c:h>c?h:c,w=g>d?g>m?g:m:d>m?d:m,k=a.next;k!==n;){if(k.x>=p&&k.x<=I&&k.y>=x&&k.y<=w&&cn(u,g,h,d,c,m,k.x,k.y)&&Ce(k.prev,k,k.next)>=0)return!1;k=k.next}return!0}function Hg(i,n,t,a){var u=i.prev,h=i,c=i.next;if(Ce(u,h,c)>=0)return!1;for(var g=u.x,d=h.x,m=c.x,p=u.y,x=h.y,I=c.y,w=g<d?g<m?g:m:d<m?d:m,k=p<x?p<I?p:I:x<I?x:I,C=g>d?g>m?g:m:d>m?d:m,D=p>x?p>I?p:I:x>I?x:I,R=Ai(w,k,n,t,a),P=Ai(C,D,n,t,a),S=i.prevZ,A=i.nextZ;S&&S.z>=R&&A&&A.z<=P;){if(S.x>=w&&S.x<=C&&S.y>=k&&S.y<=D&&S!==u&&S!==c&&cn(g,p,d,x,m,I,S.x,S.y)&&Ce(S.prev,S,S.next)>=0||(S=S.prevZ,A.x>=w&&A.x<=C&&A.y>=k&&A.y<=D&&A!==u&&A!==c&&cn(g,p,d,x,m,I,A.x,A.y)&&Ce(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;S&&S.z>=R;){if(S.x>=w&&S.x<=C&&S.y>=k&&S.y<=D&&S!==u&&S!==c&&cn(g,p,d,x,m,I,S.x,S.y)&&Ce(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;A&&A.z<=P;){if(A.x>=w&&A.x<=C&&A.y>=k&&A.y<=D&&A!==u&&A!==c&&cn(g,p,d,x,m,I,A.x,A.y)&&Ce(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function Zg(i,n,t){var a=i;do{var u=a.prev,h=a.next.next;!Hr(u,h)&&Iu(u,a,a.next,h)&&Kn(u,h)&&Kn(h,u)&&(n.push(u.i/t|0),n.push(a.i/t|0),n.push(h.i/t|0),Qn(a),Qn(a.next),a=i=h),a=a.next}while(a!==i);return Ut(a)}function Wg(i,n,t,a,u,h){var c=i;do{for(var g=c.next.next;g!==c.prev;){if(c.i!==g.i&&id(c,g)){var d=Nu(c,g);c=Ut(c,c.next),d=Ut(d,d.next),Jn(c,n,t,a,u,h,0),Jn(d,n,t,a,u,h,0);return}g=g.next}c=c.next}while(c!==i)}function Jg(i,n,t,a){var u=[],h,c,g,d,m;for(h=0,c=n.length;h<c;h++)g=n[h]*a,d=h<c-1?n[h+1]*a:i.length,m=ku(i,g,d,a,!1),m===m.next&&(m.steiner=!0),u.push(rd(m));for(u.sort(Kg),h=0;h<u.length;h++)t=Qg(u[h],t);return t}function Kg(i,n){return i.x-n.x}function Qg(i,n){var t=jg(i,n);if(!t)return n;var a=Nu(t,i);return Ut(a,a.next),Ut(t,t.next)}function jg(i,n){var t=n,a=i.x,u=i.y,h=-1/0,c;do{if(u<=t.y&&u>=t.next.y&&t.next.y!==t.y){var g=t.x+(u-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(g<=a&&g>h&&(h=g,c=t.x<t.next.x?t:t.next,g===a))return c}t=t.next}while(t!==n);if(!c)return null;var d=c,m=c.x,p=c.y,x=1/0,I;t=c;do a>=t.x&&t.x>=m&&a!==t.x&&cn(u<p?a:h,u,m,p,u<p?h:a,u,t.x,t.y)&&(I=Math.abs(u-t.y)/(a-t.x),Kn(t,i)&&(I<x||I===x&&(t.x>c.x||t.x===c.x&&ed(c,t)))&&(c=t,x=I)),t=t.next;while(t!==d);return c}function ed(i,n){return Ce(i.prev,i,n.prev)<0&&Ce(n.next,i,i.next)<0}function td(i,n,t,a){var u=i;do u.z===0&&(u.z=Ai(u.x,u.y,n,t,a)),u.prevZ=u.prev,u.nextZ=u.next,u=u.next;while(u!==i);u.prevZ.nextZ=null,u.prevZ=null,nd(u)}function nd(i){var n,t,a,u,h,c,g,d,m=1;do{for(t=i,i=null,h=null,c=0;t;){for(c++,a=t,g=0,n=0;n<m&&(g++,a=a.nextZ,!!a);n++);for(d=m;g>0||d>0&&a;)g!==0&&(d===0||!a||t.z<=a.z)?(u=t,t=t.nextZ,g--):(u=a,a=a.nextZ,d--),h?h.nextZ=u:i=u,u.prevZ=h,h=u;t=a}h.nextZ=null,m*=2}while(c>1);return i}function Ai(i,n,t,a,u){return i=(i-t)*u|0,n=(n-a)*u|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,i|n<<1}function rd(i){var n=i,t=i;do(n.x<t.x||n.x===t.x&&n.y<t.y)&&(t=n),n=n.next;while(n!==i);return t}function cn(i,n,t,a,u,h,c,g){return(u-c)*(n-g)>=(i-c)*(h-g)&&(i-c)*(a-g)>=(t-c)*(n-g)&&(t-c)*(h-g)>=(u-c)*(a-g)}function id(i,n){return i.next.i!==n.i&&i.prev.i!==n.i&&!sd(i,n)&&(Kn(i,n)&&Kn(n,i)&&ad(i,n)&&(Ce(i.prev,i,n.prev)||Ce(i,n.prev,n))||Hr(i,n)&&Ce(i.prev,i,i.next)>0&&Ce(n.prev,n,n.next)>0)}function Ce(i,n,t){return(n.y-i.y)*(t.x-n.x)-(n.x-i.x)*(t.y-n.y)}function Hr(i,n){return i.x===n.x&&i.y===n.y}function Iu(i,n,t,a){var u=wr(Ce(i,n,t)),h=wr(Ce(i,n,a)),c=wr(Ce(t,a,i)),g=wr(Ce(t,a,n));return!!(u!==h&&c!==g||u===0&&Er(i,t,n)||h===0&&Er(i,a,n)||c===0&&Er(t,i,a)||g===0&&Er(t,n,a))}function Er(i,n,t){return n.x<=Math.max(i.x,t.x)&&n.x>=Math.min(i.x,t.x)&&n.y<=Math.max(i.y,t.y)&&n.y>=Math.min(i.y,t.y)}function wr(i){return i>0?1:i<0?-1:0}function sd(i,n){var t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==n.i&&t.next.i!==n.i&&Iu(t,t.next,i,n))return!0;t=t.next}while(t!==i);return!1}function Kn(i,n){return Ce(i.prev,i,i.next)<0?Ce(i,n,i.next)>=0&&Ce(i,i.prev,n)>=0:Ce(i,n,i.prev)<0||Ce(i,i.next,n)<0}function ad(i,n){var t=i,a=!1,u=(i.x+n.x)/2,h=(i.y+n.y)/2;do t.y>h!=t.next.y>h&&t.next.y!==t.y&&u<(t.next.x-t.x)*(h-t.y)/(t.next.y-t.y)+t.x&&(a=!a),t=t.next;while(t!==i);return a}function Nu(i,n){var t=new Di(i.i,i.x,i.y),a=new Di(n.i,n.x,n.y),u=i.next,h=n.prev;return i.next=n,n.prev=i,t.next=u,u.prev=t,a.next=t,t.prev=a,h.next=a,a.prev=h,a}function ja(i,n,t,a){var u=new Di(i,n,t);return a?(u.next=a.next,u.prev=a,a.next.prev=u,a.next=u):(u.prev=u,u.next=u),u}function Qn(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Di(i,n,t){this.i=i,this.x=n,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}$r.deviation=function(i,n,t,a){var u=n&&n.length,h=u?n[0]*t:i.length,c=Math.abs(Fi(i,0,h,t));if(u)for(var g=0,d=n.length;g<d;g++){var m=n[g]*t,p=g<d-1?n[g+1]*t:i.length;c-=Math.abs(Fi(i,m,p,t))}var x=0;for(g=0;g<a.length;g+=3){var I=a[g]*t,w=a[g+1]*t,k=a[g+2]*t;x+=Math.abs((i[I]-i[k])*(i[w+1]-i[I+1])-(i[I]-i[w])*(i[k+1]-i[I+1]))}return c===0&&x===0?0:Math.abs((x-c)/c)};function Fi(i,n,t,a){for(var u=0,h=n,c=t-a;h<t;h+=a)u+=(i[c]-i[h])*(i[h+1]+i[c+1]),c=h;return u}$r.flatten=function(i){for(var n=i[0][0].length,t={vertices:[],holes:[],dimensions:n},a=0,u=0;u<i.length;u++){for(var h=0;h<i[u].length;h++)for(var c=0;c<n;c++)t.vertices.push(i[u][h][c]);u>0&&(a+=i[u-1].length,t.holes.push(a))}return t};var od=as.exports;const ud=so(od);function ld(i){if(!i.geometry||i.geometry.type!=="Polygon"&&i.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");const n={type:"FeatureCollection",features:[]};return i.geometry.type==="Polygon"?n.features=eo(i.geometry.coordinates):i.geometry.coordinates.forEach(function(t){n.features=n.features.concat(eo(t))}),n}function eo(i){const n=hd(i),t=2,a=ud(n.vertices,n.holes,t),u=[],h=[];a.forEach(function(g,d){const m=a[d];h.push([n.vertices[m*t],n.vertices[m*t+1]])});for(var c=0;c<h.length;c+=3){const g=h.slice(c,c+3);g.push(h[c]),u.push(j([g]))}return u}function hd(i){const n=i[0][0].length,t={vertices:[],holes:[],dimensions:n};let a=0;for(let u=0;u<i.length;u++){for(let h=0;h<i[u].length;h++)for(let c=0;c<n;c++)t.vertices.push(i[u][h][c]);u>0&&(a+=i[u-1].length,t.holes.push(a))}return t}function cd(i,n,t,a){if(a=a||{},!de(a))throw new Error("options is invalid");var u=a.units,h=a.zTranslation,c=a.mutate;if(!i)throw new Error("geojson is required");if(n==null||isNaN(n))throw new Error("distance is required");if(h&&typeof h!="number"&&isNaN(h))throw new Error("zTranslation is not a number");if(h=h!==void 0?h:0,n===0&&h===0)return i;if(t==null||isNaN(t))throw new Error("direction is required");return n<0&&(n=-n,t=t+180),(c===!1||c===void 0)&&(i=Xe(i)),Me(i,function(g){var d=J(dn(g,n,t,{units:u}));g[0]=d[0],g[1]=d[1],h&&g.length===3&&(g[2]+=h)}),i}function fd(i,n={}){const t=[];if(Ge(i,u=>{t.push(u.coordinates)}),t.length<2)throw new Error("Must have at least 2 geometries");const a=yt.union(t[0],...t.slice(1));return a.length===0?null:a.length===1?j(a[0],n.properties):Ze(a,n.properties)}function gd(i,n,t,a,u){Mu(i,n,t||0,a||i.length-1,u||dd)}function Mu(i,n,t,a,u){for(;a>t;){if(a-t>600){var h=a-t+1,c=n-t+1,g=Math.log(h),d=.5*Math.exp(2*g/3),m=.5*Math.sqrt(g*d*(h-d)/h)*(c-h/2<0?-1:1),p=Math.max(t,Math.floor(n-c*d/h+m)),x=Math.min(a,Math.floor(n+(h-c)*d/h+m));Mu(i,n,p,x,u)}var I=i[n],w=t,k=a;for(Cn(i,t,n),u(i[a],I)>0&&Cn(i,t,a);w<k;){for(Cn(i,w,k),w++,k--;u(i[w],I)<0;)w++;for(;u(i[k],I)>0;)k--}u(i[t],I)===0?Cn(i,t,k):(k++,Cn(i,k,a)),k<=n&&(t=k+1),n<=k&&(a=k-1)}}function Cn(i,n,t){var a=i[n];i[n]=i[t],i[t]=a}function dd(i,n){return i<n?-1:i>n?1:0}class Pu{constructor(n=9){this._maxEntries=Math.max(4,n),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(n){let t=this.data;const a=[];if(!Ir(n,t))return a;const u=this.toBBox,h=[];for(;t;){for(let c=0;c<t.children.length;c++){const g=t.children[c],d=t.leaf?u(g):g;Ir(n,d)&&(t.leaf?a.push(g):Li(n,d)?this._all(g,a):h.push(g))}t=h.pop()}return a}collides(n){let t=this.data;if(!Ir(n,t))return!1;const a=[];for(;t;){for(let u=0;u<t.children.length;u++){const h=t.children[u],c=t.leaf?this.toBBox(h):h;if(Ir(n,c)){if(t.leaf||Li(n,c))return!0;a.push(h)}}t=a.pop()}return!1}load(n){if(!(n&&n.length))return this;if(n.length<this._minEntries){for(let a=0;a<n.length;a++)this.insert(n[a]);return this}let t=this._build(n.slice(),0,n.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const a=this.data;this.data=t,t=a}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(n){return n&&this._insert(n,this.data.height-1),this}clear(){return this.data=ln([]),this}remove(n,t){if(!n)return this;let a=this.data;const u=this.toBBox(n),h=[],c=[];let g,d,m;for(;a||h.length;){if(a||(a=h.pop(),d=h[h.length-1],g=c.pop(),m=!0),a.leaf){const p=vd(n,a.children,t);if(p!==-1)return a.children.splice(p,1),h.push(a),this._condense(h),this}!m&&!a.leaf&&Li(a,u)?(h.push(a),c.push(g),g=0,d=a,a=a.children[0]):d?(g++,a=d.children[g],m=!1):a=null}return this}toBBox(n){return n}compareMinX(n,t){return n.minX-t.minX}compareMinY(n,t){return n.minY-t.minY}toJSON(){return this.data}fromJSON(n){return this.data=n,this}_all(n,t){const a=[];for(;n;)n.leaf?t.push(...n.children):a.push(...n.children),n=a.pop();return t}_build(n,t,a,u){const h=a-t+1;let c=this._maxEntries,g;if(h<=c)return g=ln(n.slice(t,a+1)),sn(g,this.toBBox),g;u||(u=Math.ceil(Math.log(h)/Math.log(c)),c=Math.ceil(h/Math.pow(c,u-1))),g=ln([]),g.leaf=!1,g.height=u;const d=Math.ceil(h/c),m=d*Math.ceil(Math.sqrt(c));to(n,t,a,m,this.compareMinX);for(let p=t;p<=a;p+=m){const x=Math.min(p+m-1,a);to(n,p,x,d,this.compareMinY);for(let I=p;I<=x;I+=d){const w=Math.min(I+d-1,x);g.children.push(this._build(n,I,w,u-1))}}return sn(g,this.toBBox),g}_chooseSubtree(n,t,a,u){for(;u.push(t),!(t.leaf||u.length-1===a);){let h=1/0,c=1/0,g;for(let d=0;d<t.children.length;d++){const m=t.children[d],p=Pi(m),x=pd(n,m)-p;x<c?(c=x,h=p<h?p:h,g=m):x===c&&p<h&&(h=p,g=m)}t=g||t.children[0]}return t}_insert(n,t,a){const u=a?n:this.toBBox(n),h=[],c=this._chooseSubtree(u,this.data,t,h);for(c.children.push(n),Yn(c,u);t>=0&&h[t].children.length>this._maxEntries;)this._split(h,t),t--;this._adjustParentBBoxes(u,h,t)}_split(n,t){const a=n[t],u=a.children.length,h=this._minEntries;this._chooseSplitAxis(a,h,u);const c=this._chooseSplitIndex(a,h,u),g=ln(a.children.splice(c,a.children.length-c));g.height=a.height,g.leaf=a.leaf,sn(a,this.toBBox),sn(g,this.toBBox),t?n[t-1].children.push(g):this._splitRoot(a,g)}_splitRoot(n,t){this.data=ln([n,t]),this.data.height=n.height+1,this.data.leaf=!1,sn(this.data,this.toBBox)}_chooseSplitIndex(n,t,a){let u,h=1/0,c=1/0;for(let g=t;g<=a-t;g++){const d=qn(n,0,g,this.toBBox),m=qn(n,g,a,this.toBBox),p=_d(d,m),x=Pi(d)+Pi(m);p<h?(h=p,u=g,c=x<c?x:c):p===h&&x<c&&(c=x,u=g)}return u||a-t}_chooseSplitAxis(n,t,a){const u=n.leaf?this.compareMinX:md,h=n.leaf?this.compareMinY:yd,c=this._allDistMargin(n,t,a,u),g=this._allDistMargin(n,t,a,h);c<g&&n.children.sort(u)}_allDistMargin(n,t,a,u){n.children.sort(u);const h=this.toBBox,c=qn(n,0,t,h),g=qn(n,a-t,a,h);let d=kr(c)+kr(g);for(let m=t;m<a-t;m++){const p=n.children[m];Yn(c,n.leaf?h(p):p),d+=kr(c)}for(let m=a-t-1;m>=t;m--){const p=n.children[m];Yn(g,n.leaf?h(p):p),d+=kr(g)}return d}_adjustParentBBoxes(n,t,a){for(let u=a;u>=0;u--)Yn(t[u],n)}_condense(n){for(let t=n.length-1,a;t>=0;t--)n[t].children.length===0?t>0?(a=n[t-1].children,a.splice(a.indexOf(n[t]),1)):this.clear():sn(n[t],this.toBBox)}}function vd(i,n,t){if(!t)return n.indexOf(i);for(let a=0;a<n.length;a++)if(t(i,n[a]))return a;return-1}function sn(i,n){qn(i,0,i.children.length,n,i)}function qn(i,n,t,a,u){u||(u=ln(null)),u.minX=1/0,u.minY=1/0,u.maxX=-1/0,u.maxY=-1/0;for(let h=n;h<t;h++){const c=i.children[h];Yn(u,i.leaf?a(c):c)}return u}function Yn(i,n){return i.minX=Math.min(i.minX,n.minX),i.minY=Math.min(i.minY,n.minY),i.maxX=Math.max(i.maxX,n.maxX),i.maxY=Math.max(i.maxY,n.maxY),i}function md(i,n){return i.minX-n.minX}function yd(i,n){return i.minY-n.minY}function Pi(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function kr(i){return i.maxX-i.minX+(i.maxY-i.minY)}function pd(i,n){return(Math.max(n.maxX,i.maxX)-Math.min(n.minX,i.minX))*(Math.max(n.maxY,i.maxY)-Math.min(n.minY,i.minY))}function _d(i,n){const t=Math.max(i.minX,n.minX),a=Math.max(i.minY,n.minY),u=Math.min(i.maxX,n.maxX),h=Math.min(i.maxY,n.maxY);return Math.max(0,u-t)*Math.max(0,h-a)}function Li(i,n){return i.minX<=n.minX&&i.minY<=n.minY&&n.maxX<=i.maxX&&n.maxY<=i.maxY}function Ir(i,n){return n.minX<=i.maxX&&n.minY<=i.maxY&&n.maxX>=i.minX&&n.maxY>=i.minY}function ln(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function to(i,n,t,a,u){const h=[n,t];for(;h.length;){if(t=h.pop(),n=h.pop(),t-n<=a)continue;const c=n+Math.ceil((t-n)/a/2)*a;gd(i,c,n,t,u),h.push(n,c,c,t)}}function xd(i,n,t){if(i.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");t===void 0&&(t=1);var a=i.geometry.coordinates,u=[],h={};if(t){for(var c=[],g=0;g<a.length;g++)for(var d=0;d<a[g].length-1;d++)c.push(D(g,d));var m=new Pu;m.load(c)}for(var p=0;p<a.length;p++)for(var x=0;x<a[p].length-1;x++)if(t){var I=m.search(D(p,x));I.forEach(function(R){var P=R.ring,S=R.edge;C(p,x,P,S)})}else for(var w=0;w<a.length;w++)for(var k=0;k<a[w].length-1;k++)C(p,x,w,k);return n||(u={type:"Feature",geometry:{type:"MultiPoint",coordinates:u}}),u;function C(R,P,S,A){var O=a[R][P],fe=a[R][P+1],X=a[S][A],Z=a[S][A+1],H=Ed(O,fe,X,Z);if(H!==null){var ae,ie;if(fe[0]!==O[0]?ae=(H[0]-O[0])/(fe[0]-O[0]):ae=(H[1]-O[1])/(fe[1]-O[1]),Z[0]!==X[0]?ie=(H[0]-X[0])/(Z[0]-X[0]):ie=(H[1]-X[1])/(Z[1]-X[1]),!(ae>=1||ae<=0||ie>=1||ie<=0)){var ve=H,Ie=!h[ve];Ie&&(h[ve]=!0),n?u.push(n(H,R,P,O,fe,ae,S,A,X,Z,ie,Ie)):u.push(H)}}}function D(R,P){var S=a[R][P],A=a[R][P+1],O,fe,X,Z;return S[0]<A[0]?(O=S[0],fe=A[0]):(O=A[0],fe=S[0]),S[1]<A[1]?(X=S[1],Z=A[1]):(X=A[1],Z=S[1]),{minX:O,minY:X,maxX:fe,maxY:Z,ring:R,edge:P}}}function Ed(i,n,t,a){if(Xn(i,t)||Xn(i,a)||Xn(n,t)||Xn(a,t))return null;var u=i[0],h=i[1],c=n[0],g=n[1],d=t[0],m=t[1],p=a[0],x=a[1],I=(u-c)*(m-x)-(h-g)*(d-p);if(I===0)return null;var w=((u*g-h*c)*(d-p)-(u-c)*(d*x-m*p))/I,k=((u*g-h*c)*(m-x)-(h-g)*(d*x-m*p))/I;return[w,k]}function Xn(i,n){if(!i||!n||i.length!==n.length)return!1;for(var t=0,a=i.length;t<a;t++)if(i[t]instanceof Array&&n[t]instanceof Array){if(!Xn(i[t],n[t]))return!1}else if(i[t]!==n[t])return!1;return!0}function wd(i){if(i.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(i.geometry===void 0||i.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(i.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var n=i.geometry.coordinates.length,t=[],P=0;P<n;P++){var a=i.geometry.coordinates[P];Gn(a[0],a[a.length-1])||a.push(a[0]);for(var u=0;u<a.length-1;u++)t.push(a[u])}if(!Id(t))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var h=t.length,c=xd(i,function(U,Re,He,Ve,b,Vt,we,V,N,tt,$t,ct){return[U,Re,He,Ve,b,Vt,we,V,N,tt,$t,ct]}),g=c.length;if(g==0){for(var X=[],P=0;P<n;P++)X.push(j([i.geometry.coordinates[P]],{parent:-1,winding:kd(i.geometry.coordinates[P])}));var le=G(X);return z(),et(),le}for(var d=[],m=[],P=0;P<n;P++){d.push([]);for(var u=0;u<i.geometry.coordinates[P].length-1;u++)d[P].push([new no(i.geometry.coordinates[P][fn(u+1,i.geometry.coordinates[P].length-1)],1,[P,u],[P,fn(u+1,i.geometry.coordinates[P].length-1)],void 0)]),m.push(new ro(i.geometry.coordinates[P][u],[P,fn(u-1,i.geometry.coordinates[P].length-1)],[P,u],void 0,void 0,!1,!0))}for(var P=0;P<g;P++)d[c[P][1]][c[P][2]].push(new no(c[P][0],c[P][5],[c[P][1],c[P][2]],[c[P][6],c[P][7]],void 0)),c[P][11]&&m.push(new ro(c[P][0],[c[P][1],c[P][2]],[c[P][6],c[P][7]],void 0,void 0,!0,!0));for(var p=m.length,P=0;P<d.length;P++)for(var u=0;u<d[P].length;u++)d[P][u].sort(function(Re,He){return Re.param<He.param?-1:1});for(var x=[],P=0;P<p;P++)x.push({minX:m[P].coord[0],minY:m[P].coord[1],maxX:m[P].coord[0],maxY:m[P].coord[1],index:P});var I=new Pu;I.load(x);for(var P=0;P<d.length;P++)for(var u=0;u<d[P].length;u++)for(var w=0;w<d[P][u].length;w++){var k;w==d[P][u].length-1?k=d[P][fn(u+1,i.geometry.coordinates[P].length-1)][0].coord:k=d[P][u][w+1].coord;var C=I.search({minX:k[0],minY:k[1],maxX:k[0],maxY:k[1]})[0];d[P][u][w].nxtIsectAlongEdgeIn=C.index}for(var P=0;P<d.length;P++)for(var u=0;u<d[P].length;u++)for(var w=0;w<d[P][u].length;w++){var k=d[P][u][w].coord,C=I.search({minX:k[0],minY:k[1],maxX:k[0],maxY:k[1]})[0],D=C.index;D<h?m[D].nxtIsectAlongRingAndEdge2=d[P][u][w].nxtIsectAlongEdgeIn:Gn(m[D].ringAndEdge1,d[P][u][w].ringAndEdgeIn)?m[D].nxtIsectAlongRingAndEdge1=d[P][u][w].nxtIsectAlongEdgeIn:m[D].nxtIsectAlongRingAndEdge2=d[P][u][w].nxtIsectAlongEdgeIn}for(var R=[],P=0,u=0;u<n;u++){for(var S=P,w=0;w<i.geometry.coordinates[u].length-1;w++)m[P].coord[0]<m[S].coord[0]&&(S=P),P++;for(var A=m[S].nxtIsectAlongRingAndEdge2,w=0;w<m.length;w++)if(m[w].nxtIsectAlongRingAndEdge1==S||m[w].nxtIsectAlongRingAndEdge2==S){var O=w;break}var fe=Pr([m[O].coord,m[S].coord,m[A].coord],!0)?1:-1;R.push({isect:S,parent:-1,winding:fe})}R.sort(function(xe,U){return m[xe.isect].coord>m[U.isect].coord?-1:1});for(var X=[];R.length>0;){var Z=R.pop(),H=Z.isect,ae=Z.parent,ie=Z.winding,ve=X.length,Ie=[m[H].coord],Pe=H;if(m[H].ringAndEdge1Walkable)var Ne=m[H].ringAndEdge1,ue=m[H].nxtIsectAlongRingAndEdge1;else var Ne=m[H].ringAndEdge2,ue=m[H].nxtIsectAlongRingAndEdge2;for(;!Gn(m[H].coord,m[ue].coord);){Ie.push(m[ue].coord);for(var Fe=void 0,P=0;P<R.length;P++)if(R[P].isect==ue){Fe=P;break}if(Fe!=null&&R.splice(Fe,1),Gn(Ne,m[ue].ringAndEdge1)){if(Ne=m[ue].ringAndEdge2,m[ue].ringAndEdge2Walkable=!1,m[ue].ringAndEdge1Walkable){var Le={isect:ue};Pr([m[Pe].coord,m[ue].coord,m[m[ue].nxtIsectAlongRingAndEdge2].coord],ie==1)?(Le.parent=ae,Le.winding=-ie):(Le.parent=ve,Le.winding=ie),R.push(Le)}Pe=ue,ue=m[ue].nxtIsectAlongRingAndEdge2}else{if(Ne=m[ue].ringAndEdge1,m[ue].ringAndEdge1Walkable=!1,m[ue].ringAndEdge2Walkable){var Le={isect:ue};Pr([m[Pe].coord,m[ue].coord,m[m[ue].nxtIsectAlongRingAndEdge1].coord],ie==1)?(Le.parent=ae,Le.winding=-ie):(Le.parent=ve,Le.winding=ie),R.push(Le)}Pe=ue,ue=m[ue].nxtIsectAlongRingAndEdge1}}Ie.push(m[ue].coord),X.push(j([Ie],{index:ve,parent:ae,winding:ie,netWinding:void 0}))}var le=G(X);z(),et();function z(){for(var xe=[],U=0;U<le.features.length;U++)le.features[U].properties.parent==-1&&xe.push(U);if(xe.length>1)for(var U=0;U<xe.length;U++){for(var Re=-1,He=1/0,Ve=0;Ve<le.features.length;Ve++)xe[U]!=Ve&&ne(le.features[xe[U]].geometry.coordinates[0][0],le.features[Ve],{ignoreBoundary:!0})&&tr(le.features[Ve])<He&&(Re=Ve);le.features[xe[U]].properties.parent=Re}}function et(){for(var xe=0;xe<le.features.length;xe++)if(le.features[xe].properties.parent==-1){var U=le.features[xe].properties.winding;le.features[xe].properties.netWinding=U,Be(xe,U)}}function Be(xe,U){for(var Re=0;Re<le.features.length;Re++)if(le.features[Re].properties.parent==xe){var He=U+le.features[Re].properties.winding;le.features[Re].properties.netWinding=He,Be(Re,He)}}return le}var no=function(i,n,t,a,u){this.coord=i,this.param=n,this.ringAndEdgeIn=t,this.ringAndEdgeOut=a,this.nxtIsectAlongEdgeIn=u},ro=function(i,n,t,a,u,h,c){this.coord=i,this.ringAndEdge1=n,this.ringAndEdge2=t,this.nxtIsectAlongRingAndEdge1=a,this.nxtIsectAlongRingAndEdge2=u,this.ringAndEdge1Walkable=h,this.ringAndEdge2Walkable=c};function Pr(i,n){if(typeof n>"u"&&(n=!0),i.length!=3)throw new Error("This function requires an array of three points [x,y]");var t=(i[1][0]-i[0][0])*(i[2][1]-i[0][1])-(i[1][1]-i[0][1])*(i[2][0]-i[0][0]);return t>=0==n}function kd(i){for(var n=0,t=0;t<i.length-1;t++)i[t][0]<i[n][0]&&(n=t);if(Pr([i[fn(n-1,i.length-1)],i[n],i[fn(n+1,i.length-1)]],!0))var a=1;else var a=-1;return a}function Gn(i,n){if(!i||!n||i.length!=n.length)return!1;for(var t=0,a=i.length;t<a;t++)if(i[t]instanceof Array&&n[t]instanceof Array){if(!Gn(i[t],n[t]))return!1}else if(i[t]!=n[t])return!1;return!0}function fn(i,n){return(i%n+n)%n}function Id(i){for(var n={},t=1,a=0,u=i.length;a<u;++a){if(Object.prototype.hasOwnProperty.call(n,i[a])){t=0;break}n[i[a]]=1}return t}function Nd(i){var n=[];return Ye(i,function(t){t.geometry.type==="Polygon"&&ce(wd(t),function(a){n.push(j(a.geometry.coordinates,t.properties))})}),G(n)}function Md(i){return i=i.slice(),i.push(i[0]),j([i])}function Pd(i,n){if(n=n||{},!de(n))throw new Error("options is invalid");const t=n.bbox||[-180,-85,180,85];if(!i)throw new Error("points is required");if(!Array.isArray(t))throw new Error("bbox is invalid");return Mt(i,"Point","points"),G(zl().x(a=>a.geometry.coordinates[0]).y(a=>a.geometry.coordinates[1]).extent([[t[0],t[1]],[t[2],t[3]]]).polygons(i.features).map(function(a,u){return Object.assign(Md(a),{properties:Fr(i.features[u].properties)})}))}const Vd=Object.freeze(Object.defineProperty({__proto__:null,along:Zl,angle:Wl,applyFilter:Br,area:tr,areaFactors:Lr,azimuthToBearing:co,bbox:_e,bboxClip:th,bboxPolygon:nr,bearing:kt,bearingToAzimuth:gn,bezierSpline:sh,booleanClockwise:br,booleanConcave:ah,booleanContains:lh,booleanCrosses:wo,booleanDisjoint:Wi,booleanEqual:Ph,booleanIntersects:Io,booleanOverlap:zh,booleanParallel:Uh,booleanPointInPolygon:ne,booleanPointOnLine:se,booleanTouches:$h,booleanValid:Hh,booleanWithin:Po,buffer:uc,center:Dr,centerMean:Ji,centerMedian:hc,centerOfMass:Do,centroid:Nt,circle:Ki,cleanCoords:zt,clone:Xe,cloneProperties:Fr,clusterEach:ji,clusterReduce:Yo,clusters:fc,clustersDbscan:wc,clustersKmeans:kc,collect:Oc,collectionOf:Mt,combine:Rc,concave:zc,containsNumber:Yi,convertArea:qi,convertLength:Xt,convex:Ao,coordAll:Un,coordEach:Me,coordReduce:Xi,createBins:es,degreesToRadians:Te,destination:It,difference:Vc,dissolve:$c,distance:me,distanceWeight:Vo,earthRadius:Ae,ellipse:Ho,envelope:Zo,explode:Yr,factors:Or,feature:Oe,featureCollection:G,featureEach:ce,featureOf:zn,featureReduce:zi,filterProperties:Xo,findPoint:po,findSegment:yo,flatten:bi,flattenEach:Ye,flattenReduce:mo,flip:Jc,geojsonRbush:Ar,geojsonType:go,geomEach:Ge,geomReduce:Ui,geometry:ao,geometryCollection:Bi,getCluster:qo,getCoord:ye,getCoords:J,getGeom:ke,getType:We,greatCircle:Kc,helpers:Vl,hexGrid:Jo,interpolate:ef,intersect:Zn,invariant:$l,isNumber:De,isObject:de,isobands:of,isolines:_f,kinks:wf,length:eu,lengthToDegrees:Rr,lengthToRadians:vn,lineArc:tu,lineChunk:If,lineEach:$i,lineIntersect:ht,lineOffset:Tf,lineOverlap:Mo,lineReduce:Hi,lineSegment:$n,lineSlice:Rf,lineSliceAlong:nu,lineSplit:Df,lineString:he,lineStrings:lo,lineToPolygon:Ff,mask:qf,meta:Jl,midpoint:Gf,moranIndex:zf,multiLineString:St,multiPoint:jn,multiPolygon:Ze,nearestNeighborAnalysis:Jf,nearestPoint:Xr,nearestPointOnLine:Lt,nearestPointToLine:tg,planepoint:rg,point:re,pointGrid:Ko,pointOnFeature:ig,pointToLineDistance:ou,points:oo,pointsWithinPolygon:uu,polygon:j,polygonSmooth:gg,polygonTangents:mg,polygonToLine:Vn,polygonize:fg,polygons:uo,projection:xg,propEach:Gi,propReduce:vo,propertiesContainsFilter:ts,quadratAnalysis:Eg,radiansToDegrees:Yt,radiansToLength:er,random:Lg,randomLineString:_u,randomPoint:yu,randomPolygon:pu,randomPosition:mu,rectangleGrid:Qo,rewind:Sg,rhumbBearing:Gt,rhumbDestination:dn,rhumbDistance:qr,round:ho,sample:bg,sector:Tg,segmentEach:wt,segmentReduce:Vi,shortestPath:Ag,simplify:Xg,square:ru,squareGrid:is,standardDeviationalEllipse:Ug,tag:Vg,tesselate:ld,tin:Uo,toMercator:gu,toWgs84:du,transformRotate:$o,transformScale:Eu,transformTranslate:cd,triangleGrid:jo,truncate:iu,union:fd,unkinkPolygon:Nd,validateBBox:Sr,validateId:fo,voronoi:Pd},Symbol.toStringTag,{value:"Module"}));export{Xd as a,Ul as c,so as g,Vd as t};
