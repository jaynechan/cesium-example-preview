import{p as Xu}from"./point-in-polygon-hao.CVtqB2KT.js";import{s as Uu}from"./sweepline-intersections.D78iGcFZ.js";import{g as pa}from"./geojson-equality-ts.385IDfwq.js";import{R as We}from"./rbush.Cgn01eBg.js";import{e as xn}from"./fast-deep-equal.DN_w7cbV.js";import{g as Vu}from"./d3-geo.B8ycIn1u.js";import"./d3-array.0UpHvbR7.js";import{c as Hu}from"./concaveman.Bk-LBz7L.js";import{s as Zu}from"./skmeans.CFR2OUal.js";import{m as Wu}from"./topojson-client.C_Q_XF1Z.js";import{t as $u}from"./topojson-server.BJ5ICLc2.js";import{i as mt}from"./polygon-clipping.C7RG_Bzj.js";import{i as Ju,a as Ku}from"./marchingsquares.DR8wX6S2.js";import{v as Qu}from"./d3-voronoi.DD4zjRyK.js";var ju=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _a(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Eg(r){if(r.__esModule)return r;var s=r.default;if(typeof s=="function"){var i=function o(){return this instanceof o?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};i.prototype=s.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(r).forEach(function(o){var l=Object.getOwnPropertyDescriptor(r,o);Object.defineProperty(i,o,l.get?l:{enumerable:!0,get:function(){return r[o]}})}),i}var Ae=63710088e-1,sr={centimeters:Ae*100,centimetres:Ae*100,degrees:360/(2*Math.PI),feet:Ae*3.28084,inches:Ae*39.37,kilometers:Ae/1e3,kilometres:Ae/1e3,meters:Ae,metres:Ae,miles:Ae/1609.344,millimeters:Ae*1e3,millimetres:Ae*1e3,nauticalmiles:Ae/1852,radians:1,yards:Ae*1.0936},er={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Oe(r,s,i={}){const o={type:"Feature"};return(i.id===0||i.id)&&(o.id=i.id),i.bbox&&(o.bbox=i.bbox),o.properties=s||{},o.geometry=r,o}function xa(r,s,i={}){switch(r){case"Point":return re(s).geometry;case"LineString":return ce(s).geometry;case"Polygon":return j(s).geometry;case"MultiPoint":return On(s).geometry;case"MultiLineString":return bt(s).geometry;case"MultiPolygon":return $e(s).geometry;default:throw new Error(r+" is invalid")}}function re(r,s,i={}){if(!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!De(r[0])||!De(r[1]))throw new Error("coordinates must contain numbers");return Oe({type:"Point",coordinates:r},s,i)}function Ea(r,s,i={}){return Y(r.map(o=>re(o,s)),i)}function j(r,s,i={}){for(const l of r){if(l.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(l[l.length-1].length!==l[0].length)throw new Error("First and last Position are not equivalent.");for(let h=0;h<l[l.length-1].length;h++)if(l[l.length-1][h]!==l[0][h])throw new Error("First and last Position are not equivalent.")}return Oe({type:"Polygon",coordinates:r},s,i)}function ka(r,s,i={}){return Y(r.map(o=>j(o,s)),i)}function ce(r,s,i={}){if(r.length<2)throw new Error("coordinates must be an array of two or more positions");return Oe({type:"LineString",coordinates:r},s,i)}function wa(r,s,i={}){return Y(r.map(o=>ce(o,s)),i)}function Y(r,s={}){const i={type:"FeatureCollection"};return s.id&&(i.id=s.id),s.bbox&&(i.bbox=s.bbox),i.features=r,i}function bt(r,s,i={}){return Oe({type:"MultiLineString",coordinates:r},s,i)}function On(r,s,i={}){return Oe({type:"MultiPoint",coordinates:r},s,i)}function $e(r,s,i={}){return Oe({type:"MultiPolygon",coordinates:r},s,i)}function ni(r,s,i={}){return Oe({type:"GeometryCollection",geometries:r},s,i)}function Ia(r,s=0){if(s&&!(s>=0))throw new Error("precision must be a positive number");const i=Math.pow(10,s||0);return Math.round(r*i)/i}function Rn(r,s="kilometers"){const i=sr[s];if(!i)throw new Error(s+" units is invalid");return r*i}function on(r,s="kilometers"){const i=sr[s];if(!i)throw new Error(s+" units is invalid");return r/i}function ar(r,s){return zt(on(r,s))}function sn(r){let s=r%360;return s<0&&(s+=360),s}function Na(r){return r=r%360,r>0?r>180?r-360:r:r<-180?r+360:r}function zt(r){return r%(2*Math.PI)*180/Math.PI}function Te(r){return r%360*Math.PI/180}function Bt(r,s="kilometers",i="kilometers"){if(!(r>=0))throw new Error("length must be a positive number");return Rn(on(r,s),i)}function ri(r,s="meters",i="kilometers"){if(!(r>=0))throw new Error("area must be a positive number");const o=er[s];if(!o)throw new Error("invalid original units");const l=er[i];if(!l)throw new Error("invalid final units");return r/o*l}function De(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function de(r){return r!==null&&typeof r=="object"&&!Array.isArray(r)}function tr(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(s=>{if(!De(s))throw new Error("bbox must only contain numbers")})}function Pa(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}const el=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:er,azimuthToBearing:Na,bearingToAzimuth:sn,convertArea:ri,convertLength:Bt,degreesToRadians:Te,earthRadius:Ae,factors:sr,feature:Oe,featureCollection:Y,geometry:xa,geometryCollection:ni,isNumber:De,isObject:de,lengthToDegrees:ar,lengthToRadians:on,lineString:ce,lineStrings:wa,multiLineString:bt,multiPoint:On,multiPolygon:$e,point:re,points:Ea,polygon:j,polygons:ka,radiansToDegrees:zt,radiansToLength:Rn,round:Ia,validateBBox:tr,validateId:Pa},Symbol.toStringTag,{value:"Module"}));function me(r){if(!r)throw new Error("coord is required");if(!Array.isArray(r)){if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return[...r.geometry.coordinates];if(r.type==="Point")return[...r.coordinates]}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return[...r];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function J(r){if(Array.isArray(r))return r;if(r.type==="Feature"){if(r.geometry!==null)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ii(r){if(r.length>1&&De(r[0])&&De(r[1]))return!0;if(Array.isArray(r[0])&&r[0].length)return ii(r[0]);throw new Error("coordinates must only contain numbers")}function Ma(r,s,i){if(!s||!i)throw new Error("type and name required");if(!r||r.type!==s)throw new Error("Invalid input to "+i+": must be a "+s+", given "+r.type)}function wn(r,s,i){if(!r)throw new Error("No feature passed");if(!i)throw new Error(".featureOf() requires a name");if(!r||r.type!=="Feature"||!r.geometry)throw new Error("Invalid input to "+i+", Feature with geometry required");if(!r.geometry||r.geometry.type!==s)throw new Error("Invalid input to "+i+": must be a "+s+", given "+r.geometry.type)}function Pt(r,s,i){if(!r)throw new Error("No featureCollection passed");if(!i)throw new Error(".collectionOf() requires a name");if(!r||r.type!=="FeatureCollection")throw new Error("Invalid input to "+i+", FeatureCollection required");for(const o of r.features){if(!o||o.type!=="Feature"||!o.geometry)throw new Error("Invalid input to "+i+", Feature with geometry required");if(!o.geometry||o.geometry.type!==s)throw new Error("Invalid input to "+i+": must be a "+s+", given "+o.geometry.type)}}function we(r){return r.type==="Feature"?r.geometry:r}function Je(r,s){return r.type==="FeatureCollection"?"FeatureCollection":r.type==="GeometryCollection"?"GeometryCollection":r.type==="Feature"&&r.geometry!==null?r.geometry.type:r.type}const tl=Object.freeze(Object.defineProperty({__proto__:null,collectionOf:Pt,containsNumber:ii,featureOf:wn,geojsonType:Ma,getCoord:me,getCoords:J,getGeom:we,getType:Je},Symbol.toStringTag,{value:"Module"}));function wt(r,s,i={}){if(i.final===!0)return nl(r,s);const o=me(r),l=me(s),h=Te(o[0]),f=Te(l[0]),g=Te(o[1]),v=Te(l[1]),m=Math.sin(f-h)*Math.cos(v),_=Math.cos(g)*Math.sin(v)-Math.sin(g)*Math.cos(v)*Math.cos(f-h);return zt(Math.atan2(m,_))}function nl(r,s){let i=wt(s,r);return i=(i+180)%360,i}function It(r,s,i,o={}){const l=me(r),h=Te(l[0]),f=Te(l[1]),g=Te(i),v=on(s,o.units),m=Math.asin(Math.sin(f)*Math.cos(v)+Math.cos(f)*Math.sin(v)*Math.cos(g)),_=h+Math.atan2(Math.sin(g)*Math.sin(v)*Math.cos(f),Math.cos(v)-Math.sin(f)*Math.sin(m)),x=zt(_),P=zt(m);return re([x,P],o.properties)}function ye(r,s,i={}){var o=me(r),l=me(s),h=Te(l[1]-o[1]),f=Te(l[0]-o[0]),g=Te(o[1]),v=Te(l[1]),m=Math.pow(Math.sin(h/2),2)+Math.pow(Math.sin(f/2),2)*Math.cos(g)*Math.cos(v);return Rn(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),i.units)}function rl(r,s,i={}){const l=we(r).coordinates;let h=0;for(let f=0;f<l.length&&!(s>=h&&f===l.length-1);f++)if(h>=s){const g=s-h;if(g){const v=wt(l[f],l[f-1])-180;return It(l[f],g,v,i)}else return re(l[f])}else h+=ye(l[f],l[f+1],i);return re(l[l.length-1])}function Yt(r,s,i={}){let o;return i.final?o=vs(me(s),me(r)):o=vs(me(r),me(s)),o>180?-(360-o):o}function vs(r,s){const i=Te(r[1]),o=Te(s[1]);let l=Te(s[0]-r[0]);l>Math.PI&&(l-=2*Math.PI),l<-Math.PI&&(l+=2*Math.PI);const h=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),f=Math.atan2(l,h);return(zt(f)+360)%360}function il(r,s,i,o={}){if(!de(o))throw new Error("options is invalid");if(!r)throw new Error("startPoint is required");if(!s)throw new Error("midPoint is required");if(!i)throw new Error("endPoint is required");const l=r,h=s,f=i,g=sn(o.mercator!==!0?wt(l,h):Yt(l,h)),v=sn(o.mercator!==!0?wt(f,h):Yt(f,h)),m=Math.abs(g-v);return o.explementary===!0?360-m:m}function Pe(r,s,i){if(r!==null)for(var o,l,h,f,g,v,m,_=0,x=0,P,k=r.type,N=k==="FeatureCollection",C=k==="Feature",D=N?r.features.length:1,R=0;R<D;R++){m=N?r.features[R].geometry:C?r.geometry:r,P=m?m.type==="GeometryCollection":!1,g=P?m.geometries.length:1;for(var M=0;M<g;M++){var b=0,A=0;if(f=P?m.geometries[M]:m,f!==null){v=f.coordinates;var O=f.type;switch(_=i&&(O==="Polygon"||O==="MultiPolygon")?1:0,O){case null:break;case"Point":if(s(v,x,R,b,A)===!1)return!1;x++,b++;break;case"LineString":case"MultiPoint":for(o=0;o<v.length;o++){if(s(v[o],x,R,b,A)===!1)return!1;x++,O==="MultiPoint"&&b++}O==="LineString"&&b++;break;case"Polygon":case"MultiLineString":for(o=0;o<v.length;o++){for(l=0;l<v[o].length-_;l++){if(s(v[o][l],x,R,b,A)===!1)return!1;x++}O==="MultiLineString"&&b++,O==="Polygon"&&A++}O==="Polygon"&&b++;break;case"MultiPolygon":for(o=0;o<v.length;o++){for(A=0,l=0;l<v[o].length;l++){for(h=0;h<v[o][l].length-_;h++){if(s(v[o][l][h],x,R,b,A)===!1)return!1;x++}A++}b++}break;case"GeometryCollection":for(o=0;o<f.geometries.length;o++)if(Pe(f.geometries[o],s,i)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function si(r,s,i,o){var l=i;return Pe(r,function(h,f,g,v,m){f===0&&i===void 0?l=h:l=s(l,h,f,g,v,m)},o),l}function ai(r,s){var i;switch(r.type){case"FeatureCollection":for(i=0;i<r.features.length&&s(r.features[i].properties,i)!==!1;i++);break;case"Feature":s(r.properties,0);break}}function La(r,s,i){var o=i;return ai(r,function(l,h){h===0&&i===void 0?o=l:o=s(o,l,h)}),o}function he(r,s){if(r.type==="Feature")s(r,0);else if(r.type==="FeatureCollection")for(var i=0;i<r.features.length&&s(r.features[i],i)!==!1;i++);}function oi(r,s,i){var o=i;return he(r,function(l,h){h===0&&i===void 0?o=l:o=s(o,l,h)}),o}function In(r){var s=[];return Pe(r,function(i){s.push(i)}),s}function Ye(r,s){var i,o,l,h,f,g,v,m,_,x,P=0,k=r.type==="FeatureCollection",N=r.type==="Feature",C=k?r.features.length:1;for(i=0;i<C;i++){for(g=k?r.features[i].geometry:N?r.geometry:r,m=k?r.features[i].properties:N?r.properties:{},_=k?r.features[i].bbox:N?r.bbox:void 0,x=k?r.features[i].id:N?r.id:void 0,v=g?g.type==="GeometryCollection":!1,f=v?g.geometries.length:1,l=0;l<f;l++){if(h=v?g.geometries[l]:g,h===null){if(s(null,P,m,_,x)===!1)return!1;continue}switch(h.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(s(h,P,m,_,x)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<h.geometries.length;o++)if(s(h.geometries[o],P,m,_,x)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}P++}}function ui(r,s,i){var o=i;return Ye(r,function(l,h,f,g,v){h===0&&i===void 0?o=l:o=s(o,l,h,f,g,v)}),o}function ze(r,s){Ye(r,function(i,o,l,h,f){var g=i===null?null:i.type;switch(g){case null:case"Point":case"LineString":case"Polygon":return s(Oe(i,l,{bbox:h,id:f}),o,0)===!1?!1:void 0}var v;switch(g){case"MultiPoint":v="Point";break;case"MultiLineString":v="LineString";break;case"MultiPolygon":v="Polygon";break}for(var m=0;m<i.coordinates.length;m++){var _=i.coordinates[m],x={type:v,coordinates:_};if(s(Oe(x,l),o,m)===!1)return!1}})}function ba(r,s,i){var o=i;return ze(r,function(l,h,f){h===0&&f===0&&i===void 0?o=l:o=s(o,l,h,f)}),o}function kt(r,s){ze(r,function(i,o,l){var h=0;if(i.geometry){var f=i.geometry.type;if(!(f==="Point"||f==="MultiPoint")){var g,v=0,m=0,_=0;if(Pe(i,function(x,P,k,N,C){if(g===void 0||o>v||N>m||C>_){g=x,v=o,m=N,_=C,h=0;return}var D=ce([g,x],i.properties);if(s(D,o,l,C,h)===!1)return!1;h++,g=x})===!1)return!1}}})}function li(r,s,i){var o=i,l=!1;return kt(r,function(h,f,g,v,m){l===!1&&i===void 0?o=h:o=s(o,h,f,g,v,m),l=!0}),o}function ci(r,s){if(!r)throw new Error("geojson is required");ze(r,function(i,o,l){if(i.geometry!==null){var h=i.geometry.type,f=i.geometry.coordinates;switch(h){case"LineString":if(s(i,o,l,0,0)===!1)return!1;break;case"Polygon":for(var g=0;g<f.length;g++)if(s(ce(f[g],i.properties),o,l,g)===!1)return!1;break}}})}function hi(r,s,i){var o=i;return ci(r,function(l,h,f,g){h===0&&i===void 0?o=l:o=s(o,l,h,f,g)}),o}function Sa(r,s){if(s=s||{},!de(s))throw new Error("options is invalid");var i=s.featureIndex||0,o=s.multiFeatureIndex||0,l=s.geometryIndex||0,h=s.segmentIndex||0,f=s.properties,g;switch(r.type){case"FeatureCollection":i<0&&(i=r.features.length+i),f=f||r.features[i].properties,g=r.features[i].geometry;break;case"Feature":f=f||r.properties,g=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":g=r;break;default:throw new Error("geojson is invalid")}if(g===null)return null;var v=g.coordinates;switch(g.type){case"Point":case"MultiPoint":return null;case"LineString":return h<0&&(h=v.length+h-1),ce([v[h],v[h+1]],f,s);case"Polygon":return l<0&&(l=v.length+l),h<0&&(h=v[l].length+h-1),ce([v[l][h],v[l][h+1]],f,s);case"MultiLineString":return o<0&&(o=v.length+o),h<0&&(h=v[o].length+h-1),ce([v[o][h],v[o][h+1]],f,s);case"MultiPolygon":return o<0&&(o=v.length+o),l<0&&(l=v[o].length+l),h<0&&(h=v[o][l].length-h-1),ce([v[o][l][h],v[o][l][h+1]],f,s)}throw new Error("geojson is invalid")}function Ca(r,s){if(s=s||{},!de(s))throw new Error("options is invalid");var i=s.featureIndex||0,o=s.multiFeatureIndex||0,l=s.geometryIndex||0,h=s.coordIndex||0,f=s.properties,g;switch(r.type){case"FeatureCollection":i<0&&(i=r.features.length+i),f=f||r.features[i].properties,g=r.features[i].geometry;break;case"Feature":f=f||r.properties,g=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":g=r;break;default:throw new Error("geojson is invalid")}if(g===null)return null;var v=g.coordinates;switch(g.type){case"Point":return re(v,f,s);case"MultiPoint":return o<0&&(o=v.length+o),re(v[o],f,s);case"LineString":return h<0&&(h=v.length+h),re(v[h],f,s);case"Polygon":return l<0&&(l=v.length+l),h<0&&(h=v[l].length+h),re(v[l][h],f,s);case"MultiLineString":return o<0&&(o=v.length+o),h<0&&(h=v[o].length+h),re(v[o][h],f,s);case"MultiPolygon":return o<0&&(o=v.length+o),l<0&&(l=v[o].length+l),h<0&&(h=v[o][l].length-h),re(v[o][l][h],f,s)}throw new Error("geojson is invalid")}const sl=Object.freeze(Object.defineProperty({__proto__:null,coordAll:In,coordEach:Pe,coordReduce:si,featureEach:he,featureReduce:oi,findPoint:Ca,findSegment:Sa,flattenEach:ze,flattenReduce:ba,geomEach:Ye,geomReduce:ui,lineEach:ci,lineReduce:hi,propEach:ai,propReduce:La,segmentEach:kt,segmentReduce:li},Symbol.toStringTag,{value:"Module"}));function An(r){return ui(r,(s,i)=>s+al(i),0)}function al(r){let s=0,i;switch(r.type){case"Polygon":return ys(r.coordinates);case"MultiPolygon":for(i=0;i<r.coordinates.length;i++)s+=ys(r.coordinates[i]);return s;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function ys(r){let s=0;if(r&&r.length>0){s+=Math.abs(ms(r[0]));for(let i=1;i<r.length;i++)s-=Math.abs(ms(r[i]))}return s}var ol=Ae*Ae/2,Br=Math.PI/180;function ms(r){const s=r.length-1;if(s<=2)return 0;let i=0,o=0;for(;o<s;){const l=r[o],h=r[o+1===s?0:o+1],f=r[o+2>=s?(o+2)%s:o+2],g=l[0]*Br,v=h[1]*Br,m=f[0]*Br;i+=(m-g)*Math.sin(v),o++}return i*ol}function _e(r,s={}){if(r.bbox!=null&&s.recompute!==!0)return r.bbox;const i=[1/0,1/0,-1/0,-1/0];return Pe(r,o=>{i[0]>o[0]&&(i[0]=o[0]),i[1]>o[1]&&(i[1]=o[1]),i[2]<o[0]&&(i[2]=o[0]),i[3]<o[1]&&(i[3]=o[1])}),i}function ul(r,s,i){var o=r.length,l=tn(r[0],s),h=[],f,g,v;let m,_;for(i||(i=[]),f=1;f<o;f++){for(m=r[f-1],_=r[f],g=v=tn(_,s);;)if(l|g){if(l&g)break;l?(m=Zr(m,_,l,s),l=tn(m,s)):(_=Zr(m,_,g,s),g=tn(_,s))}else{h.push(m),g!==v?(h.push(_),f<o-1&&(i.push(h),h=[])):f===o-1&&h.push(_);break}l=v}return h.length&&i.push(h),i}function ll(r,s){var i,o,l,h,f,g,v;for(o=1;o<=8;o*=2){for(i=[],l=r[r.length-1],h=!(tn(l,s)&o),f=0;f<r.length;f++)g=r[f],v=!(tn(g,s)&o),v!==h&&i.push(Zr(l,g,o,s)),v&&i.push(g),l=g,h=v;if(r=i,!r.length)break}return i}function Zr(r,s,i,o){return i&8?[r[0]+(s[0]-r[0])*(o[3]-r[1])/(s[1]-r[1]),o[3]]:i&4?[r[0]+(s[0]-r[0])*(o[1]-r[1])/(s[1]-r[1]),o[1]]:i&2?[o[2],r[1]+(s[1]-r[1])*(o[2]-r[0])/(s[0]-r[0])]:i&1?[o[0],r[1]+(s[1]-r[1])*(o[0]-r[0])/(s[0]-r[0])]:null}function tn(r,s){var i=0;return r[0]<s[0]?i|=1:r[0]>s[2]&&(i|=2),r[1]<s[1]?i|=4:r[1]>s[3]&&(i|=8),i}function cl(r,s){const i=we(r),o=i.type,l=r.type==="Feature"?r.properties:{};let h=i.coordinates;switch(o){case"LineString":case"MultiLineString":{const f=[];return o==="LineString"&&(h=[h]),h.forEach(g=>{ul(g,s,f)}),f.length===1?ce(f[0],l):bt(f,l)}case"Polygon":return j(ps(h,s),l);case"MultiPolygon":return $e(h.map(f=>ps(f,s)),l);default:throw new Error("geometry "+o+" not supported")}}function ps(r,s){const i=[];for(const o of r){const l=ll(o,s);l.length>0&&((l[0][0]!==l[l.length-1][0]||l[0][1]!==l[l.length-1][1])&&l.push(l[0]),l.length>=4&&i.push(l))}return i}function Dn(r,s={}){const i=Number(r[0]),o=Number(r[1]),l=Number(r[2]),h=Number(r[3]);if(r.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const f=[i,o];return j([[f,[l,o],[l,h],[i,h],f]],s.properties,{bbox:r,id:s.id})}var hl=class{constructor(r){this.points=r.points||[],this.duration=r.duration||1e4,this.sharpness=r.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=r.stepLength||60,this.length=this.points.length,this.delay=0;for(let s=0;s<this.length;s++)this.points[s].z=this.points[s].z||0;for(let s=0;s<this.length-1;s++){const i=this.points[s],o=this.points[s+1];this.centers.push({x:(i.x+o.x)/2,y:(i.y+o.y)/2,z:(i.z+o.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(let s=0;s<this.centers.length-1;s++){const i=this.points[s+1].x-(this.centers[s].x+this.centers[s+1].x)/2,o=this.points[s+1].y-(this.centers[s].y+this.centers[s+1].y)/2,l=this.points[s+1].z-(this.centers[s].y+this.centers[s+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[s+1].x+this.sharpness*(this.centers[s].x+i),y:(1-this.sharpness)*this.points[s+1].y+this.sharpness*(this.centers[s].y+o),z:(1-this.sharpness)*this.points[s+1].z+this.sharpness*(this.centers[s].z+l)},{x:(1-this.sharpness)*this.points[s+1].x+this.sharpness*(this.centers[s+1].x+i),y:(1-this.sharpness)*this.points[s+1].y+this.sharpness*(this.centers[s+1].y+o),z:(1-this.sharpness)*this.points[s+1].z+this.sharpness*(this.centers[s+1].z+l)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}cacheSteps(r){const s=[];let i=this.pos(0);s.push(0);for(let o=0;o<this.duration;o+=10){const l=this.pos(o);Math.sqrt((l.x-i.x)*(l.x-i.x)+(l.y-i.y)*(l.y-i.y)+(l.z-i.z)*(l.z-i.z))>r&&(s.push(o),i=l)}return s}vector(r){const s=this.pos(r+10),i=this.pos(r-10);return{angle:180*Math.atan2(s.y-i.y,s.x-i.x)/3.14,speed:Math.sqrt((i.x-s.x)*(i.x-s.x)+(i.y-s.y)*(i.y-s.y)+(i.z-s.z)*(i.z-s.z))}}pos(r){let s=r-this.delay;s<0&&(s=0),s>this.duration&&(s=this.duration-1);const i=s/this.duration;if(i>=1)return this.points[this.length-1];const o=Math.floor((this.points.length-1)*i),l=(this.length-1)*i-o;return fl(l,this.points[o],this.controls[o][1],this.controls[o+1][0],this.points[o+1])}};function fl(r,s,i,o,l){const h=gl(r);return{x:l.x*h[0]+o.x*h[1]+i.x*h[2]+s.x*h[3],y:l.y*h[0]+o.y*h[1]+i.y*h[2]+s.y*h[3],z:l.z*h[0]+o.z*h[1]+i.z*h[2]+s.z*h[3]}}function gl(r){const s=r*r;return[s*r,3*s*(1-r),3*r*(1-r)*(1-r),(1-r)*(1-r)*(1-r)]}function dl(r,s={}){const i=s.resolution||1e4,o=s.sharpness||.85,l=[],h=we(r).coordinates.map(m=>({x:m[0],y:m[1]})),f=new hl({duration:i,points:h,sharpness:o}),g=m=>{var _=f.pos(m);Math.floor(m/100)%2===0&&l.push([_.x,_.y])};for(var v=0;v<f.duration;v+=10)g(v);return g(f.duration),ce(l,s.properties)}function nr(r){const s=J(r);let i=0,o=1,l,h;for(;o<s.length;)l=h||s[0],h=s[o],i+=(h[0]-l[0])*(h[1]+l[1]),o++;return i>0}function vl(r){const s=we(r).coordinates;if(s[0].length<=4)return!1;let i=!1;const o=s[0].length-1;for(let l=0;l<o;l++){const h=s[0][(l+2)%o][0]-s[0][(l+1)%o][0],f=s[0][(l+2)%o][1]-s[0][(l+1)%o][1],g=s[0][l][0]-s[0][(l+1)%o][0],v=s[0][l][1]-s[0][(l+1)%o][1],m=h*v-f*g;if(l===0)i=m>0;else if(i!==m>0)return!0}return!1}function ne(r,s,i={}){if(!r)throw new Error("point is required");if(!s)throw new Error("polygon is required");const o=me(r),l=we(s),h=l.type,f=s.bbox;let g=l.coordinates;if(f&&yl(o,f)===!1)return!1;h==="Polygon"&&(g=[g]);let v=!1;for(var m=0;m<g.length;++m){const _=Xu(o,g[m]);if(_===0)return!i.ignoreBoundary;_&&(v=!0)}return v}function yl(r,s){return s[0]<=r[0]&&s[1]<=r[1]&&s[2]>=r[0]&&s[3]>=r[1]}function se(r,s,i={}){const o=me(r),l=J(s);for(let h=0;h<l.length-1;h++){let f=!1;if(i.ignoreEndVertices&&(h===0&&(f="start"),h===l.length-2&&(f="end"),h===0&&h+1===l.length-1&&(f="both")),ml(l[h],l[h+1],o,f,typeof i.epsilon>"u"?null:i.epsilon))return!0}return!1}function ml(r,s,i,o,l){const h=i[0],f=i[1],g=r[0],v=r[1],m=s[0],_=s[1],x=i[0]-g,P=i[1]-v,k=m-g,N=_-v,C=x*N-P*k;if(l!==null){if(Math.abs(C)>l)return!1}else if(C!==0)return!1;if(o){if(o==="start")return Math.abs(k)>=Math.abs(N)?k>0?g<h&&h<=m:m<=h&&h<g:N>0?v<f&&f<=_:_<=f&&f<v;if(o==="end")return Math.abs(k)>=Math.abs(N)?k>0?g<=h&&h<m:m<h&&h<=g:N>0?v<=f&&f<_:_<f&&f<=v;if(o==="both")return Math.abs(k)>=Math.abs(N)?k>0?g<h&&h<m:m<h&&h<g:N>0?v<f&&f<_:_<f&&f<v}else return Math.abs(k)>=Math.abs(N)?k>0?g<=h&&h<=m:m<=h&&h<=g:N>0?v<=f&&f<=_:_<=f&&f<=v;return!1}function pl(r,s){const i=we(r),o=we(s),l=i.type,h=o.type,f=i.coordinates,g=o.coordinates;switch(l){case"Point":switch(h){case"Point":return fi(f,g);default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiPoint":switch(h){case"Point":return xl(i,o);case"MultiPoint":return El(i,o);default:throw new Error("feature2 "+h+" geometry not supported")}case"LineString":switch(h){case"Point":return se(o,i,{ignoreEndVertices:!0});case"LineString":return Il(i,o);case"MultiPoint":return kl(i,o);default:throw new Error("feature2 "+h+" geometry not supported")}case"Polygon":switch(h){case"Point":return ne(o,i,{ignoreBoundary:!0});case"LineString":return Nl(i,o);case"Polygon":return Ta(i,o);case"MultiPoint":return wl(i,o);default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiPolygon":switch(h){case"Polygon":return _l(i,o);default:throw new Error("feature2 "+h+" geometry not supported")}default:throw new Error("feature1 "+l+" geometry not supported")}}function _l(r,s){return r.coordinates.some(i=>Ta({type:"Polygon",coordinates:i},s))}function xl(r,s){let i,o=!1;for(i=0;i<r.coordinates.length;i++)if(fi(r.coordinates[i],s.coordinates)){o=!0;break}return o}function El(r,s){for(const i of s.coordinates){let o=!1;for(const l of r.coordinates)if(fi(i,l)){o=!0;break}if(!o)return!1}return!0}function kl(r,s){let i=!1;for(const o of s.coordinates)if(se(o,r,{ignoreEndVertices:!0})&&(i=!0),!se(o,r))return!1;return!!i}function wl(r,s){for(const i of s.coordinates)if(!ne(i,r,{ignoreBoundary:!0}))return!1;return!0}function Il(r,s){let i=!1;for(const o of s.coordinates)if(se({type:"Point",coordinates:o},r,{ignoreEndVertices:!0})&&(i=!0),!se({type:"Point",coordinates:o},r,{ignoreEndVertices:!1}))return!1;return i}function Nl(r,s){let i=!1,o=0;const l=_e(r),h=_e(s);if(!Oa(l,h))return!1;for(o;o<s.coordinates.length-1;o++){const f=Pl(s.coordinates[o],s.coordinates[o+1]);if(ne({type:"Point",coordinates:f},r,{ignoreBoundary:!0})){i=!0;break}}return i}function Ta(r,s){if(r.type==="Feature"&&r.geometry===null||s.type==="Feature"&&s.geometry===null)return!1;const i=_e(r),o=_e(s);if(!Oa(i,o))return!1;const l=we(s).coordinates;for(const h of l)for(const f of h)if(!ne(f,r))return!1;return!0}function Oa(r,s){return!(r[0]>s[0]||r[2]<s[2]||r[1]>s[1]||r[3]<s[3])}function fi(r,s){return r[0]===s[0]&&r[1]===s[1]}function Pl(r,s){return[(r[0]+s[0])/2,(r[1]+s[1])/2]}var Ml=Uu;function ht(r,s,i={}){const{removeDuplicates:o=!0,ignoreSelfIntersections:l=!1}=i;let h=[];r.type==="FeatureCollection"?h=h.concat(r.features):r.type==="Feature"?h.push(r):(r.type==="LineString"||r.type==="Polygon"||r.type==="MultiLineString"||r.type==="MultiPolygon")&&h.push(Oe(r)),s.type==="FeatureCollection"?h=h.concat(s.features):s.type==="Feature"?h.push(s):(s.type==="LineString"||s.type==="Polygon"||s.type==="MultiLineString"||s.type==="MultiPolygon")&&h.push(Oe(s));const f=Ml(Y(h),l);let g=[];if(o){const v={};f.forEach(m=>{const _=m.join(",");v[_]||(v[_]=!0,g.push(m))})}else g=f;return Y(g.map(v=>re(v)))}function Nn(r,s={}){const i=we(r);switch(!s.properties&&r.type==="Feature"&&(s.properties=r.properties),i.type){case"Polygon":return Ll(i,s);case"MultiPolygon":return bl(i,s);default:throw new Error("invalid poly")}}function Ll(r,s={}){const o=we(r).coordinates,l=s.properties?s.properties:r.type==="Feature"?r.properties:{};return Ra(o,l)}function bl(r,s={}){const o=we(r).coordinates,l=s.properties?s.properties:r.type==="Feature"?r.properties:{},h=[];return o.forEach(f=>{h.push(Ra(f,l))}),Y(h)}function Ra(r,s){return r.length>1?bt(r,s):ce(r[0],s)}function Aa(r,s){var i=we(r),o=we(s),l=i.type,h=o.type;switch(l){case"MultiPoint":switch(h){case"LineString":return _s(i,o);case"Polygon":return Es(i,o);default:throw new Error("feature2 "+h+" geometry not supported")}case"LineString":switch(h){case"MultiPoint":return _s(o,i);case"LineString":return Sl(i,o);case"Polygon":return xs(i,o);default:throw new Error("feature2 "+h+" geometry not supported")}case"Polygon":switch(h){case"MultiPoint":return Es(o,i);case"LineString":return xs(o,i);default:throw new Error("feature2 "+h+" geometry not supported")}default:throw new Error("feature1 "+l+" geometry not supported")}}function _s(r,s){for(var i=!1,o=!1,l=r.coordinates.length,h=0;h<l&&!i&&!o;){for(var f=0;f<s.coordinates.length-1;f++){var g=!0;(f===0||f===s.coordinates.length-2)&&(g=!1),Da(s.coordinates[f],s.coordinates[f+1],r.coordinates[h],g)?i=!0:o=!0}h++}return i&&o}function Sl(r,s){var i=ht(r,s);if(i.features.length>0)for(var o=0;o<r.coordinates.length-1;o++)for(var l=0;l<s.coordinates.length-1;l++){var h=!0;if((l===0||l===s.coordinates.length-2)&&(h=!1),Da(r.coordinates[o],r.coordinates[o+1],s.coordinates[l],h))return!0}return!1}function xs(r,s){const i=Nn(s);return ht(r,i).features.length>0}function Es(r,s){var i=!1,o=!1,l=r.coordinates.length;for(let h=0;h<l&&(!i||!o);h++)ne(re(r.coordinates[h]),s)?i=!0:o=!0;return o&&i}function Da(r,s,i,o){var l=i[0]-r[0],h=i[1]-r[1],f=s[0]-r[0],g=s[1]-r[1],v=l*g-h*f;return v!==0?!1:o?Math.abs(f)>=Math.abs(g)?f>0?r[0]<=i[0]&&i[0]<=s[0]:s[0]<=i[0]&&i[0]<=r[0]:g>0?r[1]<=i[1]&&i[1]<=s[1]:s[1]<=i[1]&&i[1]<=r[1]:Math.abs(f)>=Math.abs(g)?f>0?r[0]<i[0]&&i[0]<s[0]:s[0]<i[0]&&i[0]<r[0]:g>0?r[1]<i[1]&&i[1]<s[1]:s[1]<i[1]&&i[1]<r[1]}function gi(r,s,i={}){var o;const l=(o=i.ignoreSelfIntersections)!=null?o:!1;let h=!0;return ze(r,f=>{ze(s,g=>{if(h===!1)return!1;h=Cl(f.geometry,g.geometry,l)})}),h}function Cl(r,s,i){switch(r.type){case"Point":switch(s.type){case"Point":return!Al(r.coordinates,s.coordinates);case"LineString":return!ks(s,r);case"Polygon":return!ne(r,s)}break;case"LineString":switch(s.type){case"Point":return!ks(r,s);case"LineString":return!Tl(r,s,i);case"Polygon":return!ws(s,r,i)}break;case"Polygon":switch(s.type){case"Point":return!ne(s,r);case"LineString":return!ws(r,s,i);case"Polygon":return!Ol(s,r,i)}}return!1}function ks(r,s){for(let i=0;i<r.coordinates.length-1;i++)if(Rl(r.coordinates[i],r.coordinates[i+1],s.coordinates))return!0;return!1}function Tl(r,s,i){return ht(r,s,{ignoreSelfIntersections:i}).features.length>0}function ws(r,s,i){for(const l of s.coordinates)if(ne(l,r))return!0;return ht(s,Nn(r),{ignoreSelfIntersections:i}).features.length>0}function Ol(r,s,i){for(const l of r.coordinates[0])if(ne(l,s))return!0;for(const l of s.coordinates[0])if(ne(l,r))return!0;return ht(Nn(r),Nn(s),{ignoreSelfIntersections:i}).features.length>0}function Rl(r,s,i){const o=i[0]-r[0],l=i[1]-r[1],h=s[0]-r[0],f=s[1]-r[1];return o*f-l*h!==0?!1:Math.abs(h)>=Math.abs(f)?h>0?r[0]<=i[0]&&i[0]<=s[0]:s[0]<=i[0]&&i[0]<=r[0]:f>0?r[1]<=i[1]&&i[1]<=s[1]:s[1]<=i[1]&&i[1]<=r[1]}function Al(r,s){return r[0]===s[0]&&r[1]===s[1]}function Xt(r,s={}){var i=typeof s=="object"?s.mutate:s;if(!r)throw new Error("geojson is required");var o=Je(r),l=[];switch(o){case"LineString":l=Yr(r,o);break;case"MultiLineString":case"Polygon":J(r).forEach(function(f){l.push(Yr(f,o))});break;case"MultiPolygon":J(r).forEach(function(f){var g=[];f.forEach(function(v){g.push(Yr(v,o))}),l.push(g)});break;case"Point":return r;case"MultiPoint":var h={};J(r).forEach(function(f){var g=f.join("-");Object.prototype.hasOwnProperty.call(h,g)||(l.push(f),h[g]=!0)});break;default:throw new Error(o+" geometry not supported")}return r.coordinates?i===!0?(r.coordinates=l,r):{type:o,coordinates:l}:i===!0?(r.geometry.coordinates=l,r):Oe({type:o,coordinates:l},r.properties,{bbox:r.bbox,id:r.id})}function Yr(r,s){var i=J(r);if(i.length===2&&!Is(i[0],i[1]))return i;var o=[],l=i.length-1,h=o.length;o.push(i[0]);for(var f=1;f<l;f++){var g=o[o.length-1];i[f][0]===g[0]&&i[f][1]===g[1]||(o.push(i[f]),h=o.length,h>2&&Ns(o[h-3],o[h-1],o[h-2])&&o.splice(o.length-2,1))}if(o.push(i[i.length-1]),h=o.length,(s==="Polygon"||s==="MultiPolygon")&&Is(i[0],i[i.length-1])&&h<4)throw new Error("invalid polygon");return s==="LineString"&&h<3||Ns(o[h-3],o[h-1],o[h-2])&&o.splice(o.length-2,1),o}function Is(r,s){return r[0]===s[0]&&r[1]===s[1]}function Ns(r,s,i){var o=i[0],l=i[1],h=r[0],f=r[1],g=s[0],v=s[1],m=o-h,_=l-f,x=g-h,P=v-f,k=m*P-_*x;return k!==0?!1:Math.abs(x)>=Math.abs(P)?x>0?h<=o&&o<=g:g<=o&&o<=h:P>0?f<=l&&l<=v:v<=l&&l<=f}function Dl(r,s,i={}){let o=i.precision;if(o=o==null||isNaN(o)?6:o,typeof o!="number"||!(o>=0))throw new Error("precision must be a positive number");const l=we(r).type,h=we(s).type;return l!==h?!1:pa(Xt(r),Xt(s),{precision:o})}function Fa(r,s,i={}){var o;const l=(o=i.ignoreSelfIntersections)!=null?o:!1;let h=!1;return ze(r,f=>{ze(s,g=>{if(h===!0)return!0;h=!gi(f.geometry,g.geometry,{ignoreSelfIntersections:l})})}),h}function or(r){var s=new We(r);return s.insert=function(i){if(i.type!=="Feature")throw new Error("invalid feature");return i.bbox=i.bbox?i.bbox:_e(i),We.prototype.insert.call(this,i)},s.load=function(i){var o=[];return Array.isArray(i)?i.forEach(function(l){if(l.type!=="Feature")throw new Error("invalid features");l.bbox=l.bbox?l.bbox:_e(l),o.push(l)}):he(i,function(l){if(l.type!=="Feature")throw new Error("invalid features");l.bbox=l.bbox?l.bbox:_e(l),o.push(l)}),We.prototype.load.call(this,o)},s.remove=function(i,o){if(i.type!=="Feature")throw new Error("invalid feature");return i.bbox=i.bbox?i.bbox:_e(i),We.prototype.remove.call(this,i,o)},s.clear=function(){return We.prototype.clear.call(this)},s.search=function(i){var o=We.prototype.search.call(this,this.toBBox(i));return Y(o)},s.collides=function(i){return We.prototype.collides.call(this,this.toBBox(i))},s.all=function(){var i=We.prototype.all.call(this);return Y(i)},s.toJSON=function(){return We.prototype.toJSON.call(this)},s.fromJSON=function(i){return We.prototype.fromJSON.call(this,i)},s.toBBox=function(i){var o;if(i.bbox)o=i.bbox;else if(Array.isArray(i)&&i.length===4)o=i;else if(Array.isArray(i)&&i.length===6)o=[i[0],i[1],i[3],i[4]];else if(i.type==="Feature")o=_e(i);else if(i.type==="FeatureCollection")o=_e(i);else throw new Error("invalid geojson");return{minX:o[0],minY:o[1],maxX:o[2],maxY:o[3]}},s}function Pn(r){if(!r)throw new Error("geojson is required");const s=[];return ze(r,i=>{Fl(i,s)}),Y(s)}function Fl(r,s){let i=[];const o=r.geometry;if(o!==null){switch(o.type){case"Polygon":i=J(o);break;case"LineString":i=[J(o)]}i.forEach(l=>{ql(l,r.properties).forEach(f=>{f.id=s.length,s.push(f)})})}}function ql(r,s){const i=[];return r.reduce((o,l)=>{const h=ce([o,l],s);return h.bbox=Gl(o,l),i.push(h),l}),i}function Gl(r,s){const i=r[0],o=r[1],l=s[0],h=s[1],f=i<l?i:l,g=o<h?o:h,v=i>l?i:l,m=o>h?o:h;return[f,g,v,m]}var zl=Object.defineProperty,Bl=Object.defineProperties,Yl=Object.getOwnPropertyDescriptors,Ps=Object.getOwnPropertySymbols,Xl=Object.prototype.hasOwnProperty,Ul=Object.prototype.propertyIsEnumerable,Ms=(r,s,i)=>s in r?zl(r,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[s]=i,qt=(r,s)=>{for(var i in s||(s={}))Xl.call(s,i)&&Ms(r,i,s[i]);if(Ps)for(var i of Ps(s))Ul.call(s,i)&&Ms(r,i,s[i]);return r},Gt=(r,s)=>Bl(r,Yl(s));function Lt(r,s,i={}){if(!r||!s)throw new Error("lines and pt are required arguments");let o=re([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),l=0;return ze(r,function(h,f,g){const v=J(h);for(let m=0;m<v.length-1;m++){const _=re(v[m]);_.properties.dist=ye(s,_,i);const x=re(v[m+1]);x.properties.dist=ye(s,x,i);const P=ye(_,x,i),k=Math.max(_.properties.dist,x.properties.dist),N=wt(_,x),C=It(s,k,N+90,i),D=It(s,k,N-90,i),R=ht(ce([C.geometry.coordinates,D.geometry.coordinates]),ce([_.geometry.coordinates,x.geometry.coordinates]));let M;R.features.length>0&&R.features[0]&&(M=Gt(qt({},R.features[0]),{properties:{dist:ye(s,R.features[0],i),multiFeatureIndex:g,location:l+ye(_,R.features[0],i)}})),_.properties.dist<o.properties.dist&&(o=Gt(qt({},_),{properties:Gt(qt({},_.properties),{index:m,multiFeatureIndex:g,location:l})})),x.properties.dist<o.properties.dist&&(o=Gt(qt({},x),{properties:Gt(qt({},x.properties),{index:m+1,multiFeatureIndex:g,location:l+P})})),M&&M.properties.dist<o.properties.dist&&(o=Gt(qt({},M),{properties:Gt(qt({},M.properties),{index:m})})),l+=P}}),o}function qa(r,s,i={}){if(i=i||{},!de(i))throw new Error("options is invalid");var o=i.tolerance||0,l=[],h=or();const f=Pn(r);h.load(f);var g;let v=[];return kt(s,function(m){var _=!1;m&&(he(h.search(m),function(x){if(_===!1){var P=J(m).sort(),k=J(x).sort();if(xn(P,k))_=!0,g?g=Xr(g,m)||g:g=m;else if(o===0?se(P[0],x)&&se(P[1],x):Lt(x,P[0]).properties.dist<=o&&Lt(x,P[1]).properties.dist<=o)_=!0,g?g=Xr(g,m)||g:g=m;else if(o===0?se(k[0],m)&&se(k[1],m):Lt(m,k[0]).properties.dist<=o&&Lt(m,k[1]).properties.dist<=o)if(g){const N=Xr(g,x);N?g=N:v.push(x)}else g=x}}),_===!1&&g&&(l.push(g),v.length&&(l=l.concat(v),v=[]),g=void 0))}),g&&l.push(g),Y(l)}function Xr(r,s){var i=J(s),o=J(r),l=o[0],h=o[o.length-1],f=r.geometry.coordinates;if(xn(i[0],l))f.unshift(i[1]);else if(xn(i[0],h))f.push(i[1]);else if(xn(i[1],l))f.unshift(i[0]);else if(xn(i[1],h))f.push(i[0]);else return;return r}function Vl(r,s){const i=we(r),o=we(s),l=i.type,h=o.type;if(l==="MultiPoint"&&h!=="MultiPoint"||(l==="LineString"||l==="MultiLineString")&&h!=="LineString"&&h!=="MultiLineString"||(l==="Polygon"||l==="MultiPolygon")&&h!=="Polygon"&&h!=="MultiPolygon")throw new Error("features must be of the same type");if(l==="Point")throw new Error("Point geometry not supported");if(pa(r,s,{precision:6}))return!1;let f=0;switch(l){case"MultiPoint":for(var g=0;g<i.coordinates.length;g++)for(var v=0;v<o.coordinates.length;v++){var m=i.coordinates[g],_=o.coordinates[v];if(m[0]===_[0]&&m[1]===_[1])return!0}return!1;case"LineString":case"MultiLineString":kt(r,x=>{kt(s,P=>{qa(x,P).features.length&&f++})});break;case"Polygon":case"MultiPolygon":kt(r,x=>{kt(s,P=>{ht(x,P).features.length&&f++})});break}return f>0}function Hl(r,s){if(!r)throw new Error("line1 is required");if(!s)throw new Error("line2 is required");var i=Ls(r,"line1");if(i!=="LineString")throw new Error("line1 must be a LineString");var o=Ls(s,"line2");if(o!=="LineString")throw new Error("line2 must be a LineString");for(var l=Pn(Xt(r)).features,h=Pn(Xt(s)).features,f=0;f<l.length;f++){var g=l[f].geometry.coordinates;if(!h[f])break;var v=h[f].geometry.coordinates;if(!Zl(g,v))return!1}return!0}function Zl(r,s){var i=sn(Yt(r[0],r[1])),o=sn(Yt(s[0],s[1]));return i===o||(o-i)%180===0}function Ls(r,s){if(r.geometry&&r.geometry.type)return r.geometry.type;if(r.type)return r.type;throw new Error("Invalid GeoJSON object for "+s)}function Wl(r,s){var i=we(r),o=we(s),l=i.type,h=o.type;switch(l){case"Point":switch(h){case"LineString":return Ue(i,o);case"MultiLineString":for(var f=!1,g=0;g<o.coordinates.length;g++)Ue(i,{type:"LineString",coordinates:o.coordinates[g]})&&(f=!0);return f;case"Polygon":for(var v=0;v<o.coordinates.length;v++)if(se(i,{type:"LineString",coordinates:o.coordinates[v]}))return!0;return!1;case"MultiPolygon":for(var v=0;v<o.coordinates.length;v++)for(var g=0;g<o.coordinates[v].length;g++)if(se(i,{type:"LineString",coordinates:o.coordinates[v][g]}))return!0;return!1;default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiPoint":switch(h){case"LineString":for(var f=!1,v=0;v<i.coordinates.length;v++)if(f||Ue({type:"Point",coordinates:i.coordinates[v]},o)&&(f=!0),se({type:"Point",coordinates:i.coordinates[v]},o,{ignoreEndVertices:!0}))return!1;return f;case"MultiLineString":for(var f=!1,v=0;v<i.coordinates.length;v++)for(var g=0;g<o.coordinates.length;g++)if(f||Ue({type:"Point",coordinates:i.coordinates[v]},{type:"LineString",coordinates:o.coordinates[g]})&&(f=!0),se({type:"Point",coordinates:i.coordinates[v]},{type:"LineString",coordinates:o.coordinates[g]},{ignoreEndVertices:!0}))return!1;return f;case"Polygon":for(var f=!1,v=0;v<i.coordinates.length;v++)if(f||se({type:"Point",coordinates:i.coordinates[v]},{type:"LineString",coordinates:o.coordinates[0]})&&(f=!0),ne({type:"Point",coordinates:i.coordinates[v]},o,{ignoreBoundary:!0}))return!1;return f;case"MultiPolygon":for(var f=!1,v=0;v<i.coordinates.length;v++)for(var g=0;g<o.coordinates.length;g++)if(f||se({type:"Point",coordinates:i.coordinates[v]},{type:"LineString",coordinates:o.coordinates[g][0]})&&(f=!0),ne({type:"Point",coordinates:i.coordinates[v]},{type:"Polygon",coordinates:o.coordinates[g]},{ignoreBoundary:!0}))return!1;return f;default:throw new Error("feature2 "+h+" geometry not supported")}case"LineString":switch(h){case"Point":return Ue(o,i);case"MultiPoint":for(var f=!1,v=0;v<o.coordinates.length;v++)if(f||Ue({type:"Point",coordinates:o.coordinates[v]},i)&&(f=!0),se({type:"Point",coordinates:o.coordinates[v]},i,{ignoreEndVertices:!0}))return!1;return f;case"LineString":var m=!1;if(Ue({type:"Point",coordinates:i.coordinates[0]},o)&&(m=!0),Ue({type:"Point",coordinates:i.coordinates[i.coordinates.length-1]},o)&&(m=!0),m===!1)return!1;for(var v=0;v<i.coordinates.length;v++)if(se({type:"Point",coordinates:i.coordinates[v]},o,{ignoreEndVertices:!0}))return!1;return m;case"MultiLineString":for(var m=!1,v=0;v<o.coordinates.length;v++){Ue({type:"Point",coordinates:i.coordinates[0]},{type:"LineString",coordinates:o.coordinates[v]})&&(m=!0),Ue({type:"Point",coordinates:i.coordinates[i.coordinates.length-1]},{type:"LineString",coordinates:o.coordinates[v]})&&(m=!0);for(var g=0;g<i.coordinates[v].length;g++)if(se({type:"Point",coordinates:i.coordinates[g]},{type:"LineString",coordinates:o.coordinates[v]},{ignoreEndVertices:!0}))return!1}return m;case"Polygon":for(var f=!1,v=0;v<i.coordinates.length;v++)if(f||se({type:"Point",coordinates:i.coordinates[v]},{type:"LineString",coordinates:o.coordinates[0]})&&(f=!0),ne({type:"Point",coordinates:i.coordinates[v]},o,{ignoreBoundary:!0}))return!1;return f;case"MultiPolygon":for(var f=!1,v=0;v<i.coordinates.length;v++){for(var g=0;g<o.coordinates.length;g++)f||se({type:"Point",coordinates:i.coordinates[v]},{type:"LineString",coordinates:o.coordinates[g][0]})&&(f=!0);if(ne({type:"Point",coordinates:i.coordinates[v]},o,{ignoreBoundary:!0}))return!1}return f;default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiLineString":switch(h){case"Point":for(var v=0;v<i.coordinates.length;v++)if(Ue(o,{type:"LineString",coordinates:i.coordinates[v]}))return!0;return!1;case"MultiPoint":for(var f=!1,v=0;v<i.coordinates.length;v++)for(var g=0;g<o.coordinates.length;g++)if(f||Ue({type:"Point",coordinates:o.coordinates[g]},{type:"LineString",coordinates:i.coordinates[g]})&&(f=!0),se({type:"Point",coordinates:o.coordinates[g]},{type:"LineString",coordinates:i.coordinates[g]},{ignoreEndVertices:!0}))return!1;return f;case"LineString":for(var m=!1,v=0;v<i.coordinates.length;v++){Ue({type:"Point",coordinates:i.coordinates[v][0]},o)&&(m=!0),Ue({type:"Point",coordinates:i.coordinates[v][i.coordinates[v].length-1]},o)&&(m=!0);for(var g=0;g<o.coordinates.length;g++)if(se({type:"Point",coordinates:o.coordinates[g]},{type:"LineString",coordinates:i.coordinates[v]},{ignoreEndVertices:!0}))return!1}return m;case"MultiLineString":for(var m=!1,v=0;v<i.coordinates.length;v++)for(var g=0;g<o.coordinates.length;g++){Ue({type:"Point",coordinates:i.coordinates[v][0]},{type:"LineString",coordinates:o.coordinates[g]})&&(m=!0),Ue({type:"Point",coordinates:i.coordinates[v][i.coordinates[v].length-1]},{type:"LineString",coordinates:o.coordinates[g]})&&(m=!0);for(var _=0;_<i.coordinates[v].length;_++)if(se({type:"Point",coordinates:i.coordinates[v][_]},{type:"LineString",coordinates:o.coordinates[g]},{ignoreEndVertices:!0}))return!1}return m;case"Polygon":for(var f=!1,v=0;v<i.coordinates.length;v++)for(var g=0;g<i.coordinates.length;g++)if(f||se({type:"Point",coordinates:i.coordinates[v][g]},{type:"LineString",coordinates:o.coordinates[0]})&&(f=!0),ne({type:"Point",coordinates:i.coordinates[v][g]},o,{ignoreBoundary:!0}))return!1;return f;case"MultiPolygon":for(var f=!1,v=0;v<o.coordinates[0].length;v++)for(var g=0;g<i.coordinates.length;g++)for(var _=0;_<i.coordinates[g].length;_++)if(f||se({type:"Point",coordinates:i.coordinates[g][_]},{type:"LineString",coordinates:o.coordinates[0][v]})&&(f=!0),ne({type:"Point",coordinates:i.coordinates[g][_]},{type:"Polygon",coordinates:[o.coordinates[0][v]]},{ignoreBoundary:!0}))return!1;return f;default:throw new Error("feature2 "+h+" geometry not supported")}case"Polygon":switch(h){case"Point":for(var v=0;v<i.coordinates.length;v++)if(se(o,{type:"LineString",coordinates:i.coordinates[v]}))return!0;return!1;case"MultiPoint":for(var f=!1,v=0;v<o.coordinates.length;v++)if(f||se({type:"Point",coordinates:o.coordinates[v]},{type:"LineString",coordinates:i.coordinates[0]})&&(f=!0),ne({type:"Point",coordinates:o.coordinates[v]},i,{ignoreBoundary:!0}))return!1;return f;case"LineString":for(var f=!1,v=0;v<o.coordinates.length;v++)if(f||se({type:"Point",coordinates:o.coordinates[v]},{type:"LineString",coordinates:i.coordinates[0]})&&(f=!0),ne({type:"Point",coordinates:o.coordinates[v]},i,{ignoreBoundary:!0}))return!1;return f;case"MultiLineString":for(var f=!1,v=0;v<o.coordinates.length;v++)for(var g=0;g<o.coordinates[v].length;g++)if(f||se({type:"Point",coordinates:o.coordinates[v][g]},{type:"LineString",coordinates:i.coordinates[0]})&&(f=!0),ne({type:"Point",coordinates:o.coordinates[v][g]},i,{ignoreBoundary:!0}))return!1;return f;case"Polygon":for(var f=!1,v=0;v<i.coordinates[0].length;v++)if(f||se({type:"Point",coordinates:i.coordinates[0][v]},{type:"LineString",coordinates:o.coordinates[0]})&&(f=!0),ne({type:"Point",coordinates:i.coordinates[0][v]},o,{ignoreBoundary:!0}))return!1;return f;case"MultiPolygon":for(var f=!1,v=0;v<o.coordinates[0].length;v++)for(var g=0;g<i.coordinates[0].length;g++)if(f||se({type:"Point",coordinates:i.coordinates[0][g]},{type:"LineString",coordinates:o.coordinates[0][v]})&&(f=!0),ne({type:"Point",coordinates:i.coordinates[0][g]},{type:"Polygon",coordinates:o.coordinates[0][v]},{ignoreBoundary:!0}))return!1;return f;default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiPolygon":switch(h){case"Point":for(var v=0;v<i.coordinates[0].length;v++)if(se(o,{type:"LineString",coordinates:i.coordinates[0][v]}))return!0;return!1;case"MultiPoint":for(var f=!1,v=0;v<i.coordinates[0].length;v++)for(var g=0;g<o.coordinates.length;g++)if(f||se({type:"Point",coordinates:o.coordinates[g]},{type:"LineString",coordinates:i.coordinates[0][v]})&&(f=!0),ne({type:"Point",coordinates:o.coordinates[g]},{type:"Polygon",coordinates:i.coordinates[0][v]},{ignoreBoundary:!0}))return!1;return f;case"LineString":for(var f=!1,v=0;v<i.coordinates[0].length;v++)for(var g=0;g<o.coordinates.length;g++)if(f||se({type:"Point",coordinates:o.coordinates[g]},{type:"LineString",coordinates:i.coordinates[0][v]})&&(f=!0),ne({type:"Point",coordinates:o.coordinates[g]},{type:"Polygon",coordinates:i.coordinates[0][v]},{ignoreBoundary:!0}))return!1;return f;case"MultiLineString":for(var f=!1,v=0;v<i.coordinates.length;v++)for(var g=0;g<o.coordinates.length;g++)for(var _=0;_<o.coordinates[g].length;_++)if(f||se({type:"Point",coordinates:o.coordinates[g][_]},{type:"LineString",coordinates:i.coordinates[v][0]})&&(f=!0),ne({type:"Point",coordinates:o.coordinates[g][_]},{type:"Polygon",coordinates:[i.coordinates[v][0]]},{ignoreBoundary:!0}))return!1;return f;case"Polygon":for(var f=!1,v=0;v<i.coordinates[0].length;v++)for(var g=0;g<i.coordinates[0][v].length;g++)if(f||se({type:"Point",coordinates:i.coordinates[0][v][g]},{type:"LineString",coordinates:o.coordinates[0]})&&(f=!0),ne({type:"Point",coordinates:i.coordinates[0][v][g]},o,{ignoreBoundary:!0}))return!1;return f;case"MultiPolygon":for(var f=!1,v=0;v<i.coordinates[0].length;v++)for(var g=0;g<o.coordinates[0].length;g++)for(var _=0;_<i.coordinates[0].length;_++)if(f||se({type:"Point",coordinates:i.coordinates[0][v][_]},{type:"LineString",coordinates:o.coordinates[0][g]})&&(f=!0),ne({type:"Point",coordinates:i.coordinates[0][v][_]},{type:"Polygon",coordinates:o.coordinates[0][g]},{ignoreBoundary:!0}))return!1;return f;default:throw new Error("feature2 "+h+" geometry not supported")}default:throw new Error("feature1 "+l+" geometry not supported")}}function Ue(r,s){return!!(bs(s.coordinates[0],r.coordinates)||bs(s.coordinates[s.coordinates.length-1],r.coordinates))}function bs(r,s){return r[0]===s[0]&&r[1]===s[1]}function $l(r){if(!r.type)return!1;const s=we(r),i=s.type,o=s.coordinates;switch(i){case"Point":return o.length>1;case"MultiPoint":for(var l=0;l<o.length;l++)if(o[l].length<2)return!1;return!0;case"LineString":if(o.length<2)return!1;for(var l=0;l<o.length;l++)if(o[l].length<2)return!1;return!0;case"MultiLineString":if(o.length<2)return!1;for(var l=0;l<o.length;l++)if(o[l].length<2)return!1;return!0;case"Polygon":for(var l=0;l<s.coordinates.length;l++)if(o[l].length<4||!Ss(o[l])||Cs(o[l])||l>0&&ht(j([o[0]]),j([o[l]])).features.length>1)return!1;return!0;case"MultiPolygon":for(var l=0;l<s.coordinates.length;l++)for(var h=s.coordinates[l],f=0;f<h.length;f++)if(h[f].length<4||!Ss(h[f])||Cs(h[f])||f===0&&!Jl(h,s.coordinates,l)||f>0&&ht(j([h[0]]),j([h[f]])).features.length>1)return!1;return!0;default:return!1}}function Ss(r){return r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]}function Cs(r){for(var s=0;s<r.length-1;s++)for(var i=r[s],o=s+1;o<r.length-2;o++){var l=[r[o],r[o+1]];if(se(i,ce(l)))return!0}return!1}function Jl(r,s,i){for(var o=j(r),l=i+1;l<s.length;l++)if(!gi(o,j(s[l]))&&Aa(o,ce(s[l][0])))return!1;return!0}function Ga(r,s){var i=we(r),o=we(s),l=i.type,h=o.type;switch(l){case"Point":switch(h){case"MultiPoint":return Kl(i,o);case"LineString":return se(i,o,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return ne(i,o,{ignoreBoundary:!0});default:throw new Error("feature2 "+h+" geometry not supported")}case"MultiPoint":switch(h){case"MultiPoint":return Ql(i,o);case"LineString":return jl(i,o);case"Polygon":case"MultiPolygon":return ec(i,o);default:throw new Error("feature2 "+h+" geometry not supported")}case"LineString":switch(h){case"LineString":return tc(i,o);case"Polygon":case"MultiPolygon":return nc(i,o);default:throw new Error("feature2 "+h+" geometry not supported")}case"Polygon":switch(h){case"Polygon":case"MultiPolygon":return rc(i,o);default:throw new Error("feature2 "+h+" geometry not supported")}default:throw new Error("feature1 "+l+" geometry not supported")}}function Kl(r,s){var i,o=!1;for(i=0;i<s.coordinates.length;i++)if(Ba(s.coordinates[i],r.coordinates)){o=!0;break}return o}function Ql(r,s){for(var i=0;i<r.coordinates.length;i++){for(var o=!1,l=0;l<s.coordinates.length;l++)Ba(r.coordinates[i],s.coordinates[l])&&(o=!0);if(!o)return!1}return!0}function jl(r,s){for(var i=!1,o=0;o<r.coordinates.length;o++){if(!se(r.coordinates[o],s))return!1;i||(i=se(r.coordinates[o],s,{ignoreEndVertices:!0}))}return i}function ec(r,s){for(var i=!0,o=!1,l=0;l<r.coordinates.length;l++){if(o=ne(r.coordinates[l],s),!o){i=!1;break}o=ne(r.coordinates[l],s,{ignoreBoundary:!0})}return i&&o}function tc(r,s){for(var i=0;i<r.coordinates.length;i++)if(!se(r.coordinates[i],s))return!1;return!0}function nc(r,s){var i=_e(s),o=_e(r);if(!za(i,o))return!1;for(var l=!1,h=0;h<r.coordinates.length;h++){if(!ne(r.coordinates[h],s))return!1;if(l||(l=ne(r.coordinates[h],s,{ignoreBoundary:!0})),!l&&h<r.coordinates.length-1){var f=ic(r.coordinates[h],r.coordinates[h+1]);l=ne(f,s,{ignoreBoundary:!0})}}return l}function rc(r,s){var i=_e(r),o=_e(s);if(!za(o,i))return!1;for(var l=0;l<r.coordinates[0].length;l++)if(!ne(r.coordinates[0][l],s))return!1;return!0}function za(r,s){return!(r[0]>s[0]||r[2]<s[2]||r[1]>s[1]||r[3]<s[3])}function Ba(r,s){return r[0]===s[0]&&r[1]===s[1]}function ic(r,s){return[(r[0]+s[0])/2,(r[1]+s[1])/2]}function ur(r,s={}){const i=_e(r),o=(i[0]+i[2])/2,l=(i[1]+i[3])/2;return re([o,l],s.properties,s)}var Ya={exports:{}};(function(r,s){(function(i,o){r.exports=o()})(ju,function(){function i(u,e){if(!(u instanceof e))throw new TypeError("Cannot call a class as a function")}function o(u,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(u,n.key,n)}}function l(u,e,t){return e&&o(u.prototype,e),t&&o(u,t),u}function h(u,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(e&&e.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),e&&g(u,e)}function f(u){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(u)}function g(u,e){return g=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},g(u,e)}function v(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m(u,e,t){return m=v()?Reflect.construct:function(n,a,c){var d=[null];d.push.apply(d,a);var y=new(Function.bind.apply(n,d));return c&&g(y,c.prototype),y},m.apply(null,arguments)}function _(u){var e=typeof Map=="function"?new Map:void 0;return _=function(t){if(t===null||(n=t,Function.toString.call(n).indexOf("[native code]")===-1))return t;var n;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,a)}function a(){return m(t,arguments,f(this).constructor)}return a.prototype=Object.create(t.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),g(a,t)},_(u)}function x(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}function P(u,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x(u)}function k(u){var e=v();return function(){var t,n=f(u);if(e){var a=f(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return P(this,t)}}function N(u,e,t){return N=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(n,a,c){var d=function(p,E){for(;!Object.prototype.hasOwnProperty.call(p,E)&&(p=f(p))!==null;);return p}(n,a);if(d){var y=Object.getOwnPropertyDescriptor(d,a);return y.get?y.get.call(c):y.value}},N(u,e,t||u)}function C(u){return function(e){if(Array.isArray(e))return R(e)}(u)||function(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}(u)||D(u)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function D(u,e){if(u){if(typeof u=="string")return R(u,e);var t=Object.prototype.toString.call(u).slice(8,-1);return t==="Object"&&u.constructor&&(t=u.constructor.name),t==="Map"||t==="Set"?Array.from(u):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?R(u,e):void 0}}function R(u,e){(e==null||e>u.length)&&(e=u.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=u[t];return n}function M(u,e){var t=typeof Symbol<"u"&&u[Symbol.iterator]||u["@@iterator"];if(!t){if(Array.isArray(u)||(t=D(u))||e){t&&(u=t);var n=0,a=function(){};return{s:a,n:function(){return n>=u.length?{done:!0}:{done:!1,value:u[n++]}},e:function(p){throw p},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c,d=!0,y=!1;return{s:function(){t=t.call(u)},n:function(){var p=t.next();return d=p.done,p},e:function(p){y=!0,c=p},f:function(){try{d||t.return==null||t.return()}finally{if(y)throw c}}}}var b=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(e){this._quadrantSegments=e,this._quadrantSegments===0&&(this._joinStyle=u.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=u.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==u.JOIN_ROUND&&(this._quadrantSegments=u.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(e){this._joinStyle=e}},{key:"setSimplifyFactor",value:function(e){this._simplifyFactor=e<0?0:e}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(e){this._endCapStyle=e}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(e){this._mitreLimit=e}},{key:"setSingleSided",value:function(e){this._isSingleSided=e}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=u.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=u.CAP_ROUND,this._joinStyle=u.JOIN_ROUND,this._mitreLimit=u.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=u.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setQuadrantSegments(e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.setQuadrantSegments(t),this.setEndCapStyle(n)}else if(arguments.length===4){var a=arguments[0],c=arguments[1],d=arguments[2],y=arguments[3];this.setQuadrantSegments(a),this.setEndCapStyle(c),this.setJoinStyle(d),this.setMitreLimit(y)}}}},{key:"bufferDistanceError",value:function(e){var t=Math.PI/2/e;return 1-Math.cos(t/2)}}]),u}();b.CAP_ROUND=1,b.CAP_FLAT=2,b.CAP_SQUARE=3,b.JOIN_ROUND=1,b.JOIN_MITRE=2,b.JOIN_BEVEL=3,b.DEFAULT_QUADRANT_SEGMENTS=8,b.DEFAULT_MITRE_LIMIT=5,b.DEFAULT_SIMPLIFY_FACTOR=.01;var A=function(u){h(t,u);var e=k(t);function t(n){var a;return i(this,t),(a=e.call(this,n)).name=Object.keys({Exception:t})[0],a}return l(t,[{key:"toString",value:function(){return this.message}}]),t}(_(Error)),O=function(u){h(t,u);var e=k(t);function t(n){var a;return i(this,t),(a=e.call(this,n)).name=Object.keys({IllegalArgumentException:t})[0],a}return t}(A),fe=function(){function u(){i(this,u)}return l(u,[{key:"filter",value:function(e){}}]),u}();function B(){}function W(){}function Z(){}var ae,ie,ve,Ie,Me,Ne,ue,Fe,Le=function(){function u(){i(this,u)}return l(u,null,[{key:"equalsWithTolerance",value:function(e,t,n){return Math.abs(e-t)<=n}}]),u}(),le=function(){function u(e,t){i(this,u),this.low=t||0,this.high=e||0}return l(u,null,[{key:"toBinaryString",value:function(e){var t,n="";for(t=2147483648;t>0;t>>>=1)n+=(e.high&t)===t?"1":"0";for(t=2147483648;t>0;t>>>=1)n+=(e.low&t)===t?"1":"0";return n}}]),u}();function X(){}function tt(){}X.NaN=NaN,X.isNaN=function(u){return Number.isNaN(u)},X.isInfinite=function(u){return!Number.isFinite(u)},X.MAX_VALUE=Number.MAX_VALUE,X.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,X.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(Ne=2146435072,ue=new Float64Array(1),Fe=new Int32Array(ue.buffer),X.doubleToLongBits=function(u){ue[0]=u;var e=0|Fe[0],t=0|Fe[1];return(t&Ne)===Ne&&1048575&t&&e!==0&&(e=0,t=2146959360),new le(t,e)},X.longBitsToDouble=function(u){return Fe[0]=u.low,Fe[1]=u.high,ue[0]}):(ae=1023,ie=Math.log2,ve=Math.floor,Ie=Math.pow,Me=function(){for(var u=53;u>0;u--){var e=Ie(2,u)-1;if(ve(ie(e))+1===u)return e}return 0}(),X.doubleToLongBits=function(u){var e,t,n,a,c,d,y,p,E;if(u<0||1/u===Number.NEGATIVE_INFINITY?(d=1<<31,u=-u):d=0,u===0)return new le(p=d,E=0);if(u===1/0)return new le(p=2146435072|d,E=0);if(u!=u)return new le(p=2146959360,E=0);if(a=0,E=0,(e=ve(u))>1)if(e<=Me)(a=ve(ie(e)))<=20?(E=0,p=e<<20-a&1048575):(E=e%(t=Ie(2,n=a-20))<<32-n,p=e/t&1048575);else for(n=e,E=0;(n=ve(t=n/2))!==0;)a++,E>>>=1,E|=(1&p)<<31,p>>>=1,t!==n&&(p|=524288);if(y=a+ae,c=e===0,e=u-e,a<52&&e!==0)for(n=0;;){if((t=2*e)>=1?(e=t-1,c?(y--,c=!1):(n<<=1,n|=1,a++)):(e=t,c?--y==0&&(a++,c=!1):(n<<=1,a++)),a===20)p|=n,n=0;else if(a===52){E|=n;break}if(t===1){a<20?p|=n<<20-a:a<52&&(E|=n<<52-a);break}}return p|=y<<20,new le(p|=d,E)},X.longBitsToDouble=function(u){var e,t,n,a,c=u.high,d=u.low,y=c&1<<31?-1:1;for(n=((2146435072&c)>>20)-ae,a=0,t=1<<19,e=1;e<=20;e++)c&t&&(a+=Ie(2,-e)),t>>>=1;for(t=1<<31,e=21;e<=52;e++)d&t&&(a+=Ie(2,-e)),t>>>=1;if(n===-1023){if(a===0)return 0*y;n=-1022}else{if(n===1024)return a===0?y/0:NaN;a+=1}return y*a*Ie(2,n)});var qe=function(u){h(t,u);var e=k(t);function t(n){var a;return i(this,t),(a=e.call(this,n)).name=Object.keys({RuntimeException:t})[0],a}return t}(A),xe=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,null,[{key:"constructor_",value:function(){if(arguments.length===0)qe.constructor_.call(this);else if(arguments.length===1){var n=arguments[0];qe.constructor_.call(this,n)}}}]),t}(qe),U=function(){function u(){i(this,u)}return l(u,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)u.shouldNeverReachHere(null);else if(arguments.length===1){var e=arguments[0];throw new xe("Should never reach here"+(e!==null?": "+e:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var e=arguments[0];u.isTrue(e,null)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];if(!t)throw n===null?new xe:new xe(n)}}},{key:"equals",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];u.equals(e,t,null)}else if(arguments.length===3){var n=arguments[0],a=arguments[1],c=arguments[2];if(!a.equals(n))throw new xe("Expected "+n+" but encountered "+a+(c!==null?": "+c:""))}}}]),u}(),Re=new ArrayBuffer(8),Ze=new Float64Array(Re),Ve=new Int32Array(Re),S=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getM",value:function(){return X.NaN}},{key:"setOrdinate",value:function(e,t){switch(e){case u.X:this.x=t;break;case u.Y:this.y=t;break;case u.Z:this.setZ(t);break;default:throw new O("Invalid ordinate index: "+e)}}},{key:"equals2D",value:function(){if(arguments.length===1){var e=arguments[0];return this.x===e.x&&this.y===e.y}if(arguments.length===2){var t=arguments[0],n=arguments[1];return!!Le.equalsWithTolerance(this.x,t.x,n)&&!!Le.equalsWithTolerance(this.y,t.y,n)}}},{key:"setM",value:function(e){throw new O("Invalid ordinate index: "+u.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(e){switch(e){case u.X:return this.x;case u.Y:return this.y;case u.Z:return this.getZ()}throw new O("Invalid ordinate index: "+e)}},{key:"equals3D",value:function(e){return this.x===e.x&&this.y===e.y&&(this.getZ()===e.getZ()||X.isNaN(this.getZ())&&X.isNaN(e.getZ()))}},{key:"equals",value:function(e){return e instanceof u&&this.equals2D(e)}},{key:"equalInZ",value:function(e,t){return Le.equalsWithTolerance(this.getZ(),e.getZ(),t)}},{key:"setX",value:function(e){this.x=e}},{key:"compareTo",value:function(e){var t=e;return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(e){this.z=e}},{key:"clone",value:function(){try{return null}catch(e){if(e instanceof CloneNotSupportedException)return U.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw e}}},{key:"copy",value:function(){return new u(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(e){var t=this.x-e.x,n=this.y-e.y,a=this.getZ()-e.getZ();return Math.sqrt(t*t+n*n+a*a)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(e){this.y=e}},{key:"distance",value:function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}},{key:"hashCode",value:function(){var e=17;return e=37*(e=37*e+u.hashCode(this.x))+u.hashCode(this.y)}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.getZ()}},{key:"interfaces_",get:function(){return[B,W,Z]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)u.constructor_.call(this,0,0);else if(arguments.length===1){var e=arguments[0];u.constructor_.call(this,e.x,e.y,e.getZ())}else if(arguments.length===2){var t=arguments[0],n=arguments[1];u.constructor_.call(this,t,n,u.NULL_ORDINATE)}else if(arguments.length===3){var a=arguments[0],c=arguments[1],d=arguments[2];this.x=a,this.y=c,this.z=d}}},{key:"hashCode",value:function(e){return Ze[0]=e,Ve[0]^Ve[1]}}]),u}(),Vt=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"compare",value:function(e,t){var n=u.compare(e.x,t.x);if(n!==0)return n;var a=u.compare(e.y,t.y);return a!==0?a:this._dimensionsToTest<=2?0:u.compare(e.getZ(),t.getZ())}},{key:"interfaces_",get:function(){return[tt]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)u.constructor_.call(this,2);else if(arguments.length===1){var e=arguments[0];if(e!==2&&e!==3)throw new O("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}}},{key:"compare",value:function(e,t){return e<t?-1:e>t?1:X.isNaN(e)?X.isNaN(t)?0:-1:X.isNaN(t)?1:0}}]),u}();S.DimensionalComparator=Vt,S.NULL_ORDINATE=X.NaN,S.X=0,S.Y=1,S.Z=2,S.M=3;var ke=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(e){if(!(e instanceof u))return!1;var t=e;return this.isNull()?t.isNull():this._maxx===t.getMaxX()&&this._maxy===t.getMaxY()&&this._minx===t.getMinX()&&this._miny===t.getMinY()}},{key:"intersection",value:function(e){if(this.isNull()||e.isNull()||!this.intersects(e))return new u;var t=this._minx>e._minx?this._minx:e._minx,n=this._miny>e._miny?this._miny:e._miny;return new u(t,this._maxx<e._maxx?this._maxx:e._maxx,n,this._maxy<e._maxy?this._maxy:e._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof S){var e=arguments[0];return this.covers(e.x,e.y)}if(arguments[0]instanceof u){var t=arguments[0];return!this.isNull()&&!t.isNull()&&t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(arguments.length===2){var n=arguments[0],a=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&a>=this._miny&&a<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof u){var e=arguments[0];return!this.isNull()&&!e.isNull()&&!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}if(arguments[0]instanceof S){var t=arguments[0];return this.intersects(t.x,t.y)}}else if(arguments.length===2){if(arguments[0]instanceof S&&arguments[1]instanceof S){var n=arguments[0],a=arguments[1];if(this.isNull())return!1;var c=n.x<a.x?n.x:a.x;if(c>this._maxx)return!1;var d=n.x>a.x?n.x:a.x;if(d<this._minx)return!1;var y=n.y<a.y?n.y:a.y;if(y>this._maxy)return!1;var p=n.y>a.y?n.y:a.y;return!(p<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var E=arguments[0],I=arguments[1];return!this.isNull()&&!(E>this._maxx||E<this._minx||I>this._maxy||I<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return Math.sqrt(e*e+t*t)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof S){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof u){var t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(arguments.length===2){var n=arguments[0],a=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=a,this._maxy=a):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),a<this._miny&&(this._miny=a),a>this._maxy&&(this._maxy=a))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e<t?e:t}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(e){var t=e;return this.isNull()?t.isNull()?0:-1:t.isNull()?1:this._minx<t._minx?-1:this._minx>t._minx?1:this._miny<t._miny?-1:this._miny>t._miny?1:this._maxx<t._maxx?-1:this._maxx>t._maxx?1:this._maxy<t._maxy?-1:this._maxy>t._maxy?1:0}},{key:"translate",value:function(e,t){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+t,this.getMaxY()+t)}},{key:"copy",value:function(){return new u(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(e){return!(!this.isNull()&&!e.isNull())||e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e>t?e:t}},{key:"expandBy",value:function(){if(arguments.length===1){var e=arguments[0];this.expandBy(e,e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof u){var e=arguments[0];return this.covers(e)}if(arguments[0]instanceof S){var t=arguments[0];return this.covers(t)}}else if(arguments.length===2){var n=arguments[0],a=arguments[1];return this.covers(n,a)}}},{key:"centre",value:function(){return this.isNull()?null:new S((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof S){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof u){var t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(arguments.length===2){var n=arguments[0],a=arguments[1];this.init(n.x,a.x,n.y,a.y)}else if(arguments.length===4){var c=arguments[0],d=arguments[1],y=arguments[2],p=arguments[3];c<d?(this._minx=c,this._maxx=d):(this._minx=d,this._maxx=c),y<p?(this._miny=y,this._maxy=p):(this._miny=p,this._maxy=y)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(e){if(this.intersects(e))return 0;var t=0;this._maxx<e._minx?t=e._minx-this._maxx:this._minx>e._maxx&&(t=this._minx-e._maxx);var n=0;return this._maxy<e._miny?n=e._miny-this._maxy:this._miny>e._maxy&&(n=this._miny-e._maxy),t===0?n:n===0?t:Math.sqrt(t*t+n*n)}},{key:"hashCode",value:function(){var e=17;return e=37*(e=37*(e=37*(e=37*e+S.hashCode(this._minx))+S.hashCode(this._maxx))+S.hashCode(this._miny))+S.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[B,Z]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof S){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof u){var t=arguments[0];this.init(t)}}else if(arguments.length===2){var n=arguments[0],a=arguments[1];this.init(n.x,a.x,n.y,a.y)}else if(arguments.length===4){var c=arguments[0],d=arguments[1],y=arguments[2],p=arguments[3];this.init(c,d,y,p)}}},{key:"intersects",value:function(){if(arguments.length===3){var e=arguments[0],t=arguments[1],n=arguments[2];return n.x>=(e.x<t.x?e.x:t.x)&&n.x<=(e.x>t.x?e.x:t.x)&&n.y>=(e.y<t.y?e.y:t.y)&&n.y<=(e.y>t.y?e.y:t.y)}if(arguments.length===4){var a=arguments[0],c=arguments[1],d=arguments[2],y=arguments[3],p=Math.min(d.x,y.x),E=Math.max(d.x,y.x),I=Math.min(a.x,c.x),L=Math.max(a.x,c.x);return!(I>E)&&!(L<p)&&(p=Math.min(d.y,y.y),E=Math.max(d.y,y.y),I=Math.min(a.y,c.y),L=Math.max(a.y,c.y),!(I>E)&&!(L<p))}}}]),u}(),V=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===u.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(e){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(e){return this===e||this.equalsExact(e,0)}},{key:"geometryChanged",value:function(){this.apply(u.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(e){return e!==null&&this.norm().equalsExact(e.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var e;if(arguments.length===1){var t=arguments[0];return e=t,this.getTypeCode()!==e.getTypeCode()?this.getTypeCode()-e.getTypeCode():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(arguments.length===2){var n=arguments[0],a=arguments[1];return e=n,this.getTypeCode()!==e.getTypeCode()?this.getTypeCode()-e.getTypeCode():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(n,a)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(e){if(e.getTypeCode()===u.TYPECODE_GEOMETRYCOLLECTION)throw new O("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(e,t,n){return n===0?e.equals(t):e.distance(t)<=n}},{key:"norm",value:function(){var e=this.copy();return e.normalize(),e}},{key:"reverse",value:function(){var e=this.reverseInternal();return this.envelope!=null&&(e.envelope=this.envelope.copy()),e.setSRID(this.getSRID()),e}},{key:"copy",value:function(){var e=this.copyInternal();return e.envelope=this._envelope==null?null:this._envelope.copy(),e._SRID=this._SRID,e._userData=this._userData,e}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new ke(this._envelope)}},{key:"setSRID",value:function(e){this._SRID=e}},{key:"setUserData",value:function(e){this._userData=e}},{key:"compare",value:function(e,t){for(var n=e.iterator(),a=t.iterator();n.hasNext()&&a.hasNext();){var c=n.next(),d=a.next(),y=c.compareTo(d);if(y!==0)return y}return n.hasNext()?1:a.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(e){return this.getClass()===e.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===u.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===u.TYPECODE_MULTIPOINT||this.getTypeCode()===u.TYPECODE_MULTILINESTRING||this.getTypeCode()===u.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[W,B,Z]}},{key:"getClass",value:function(){return u}}],[{key:"hasNonEmptyElements",value:function(e){for(var t=0;t<e.length;t++)if(!e[t].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(e){for(var t=0;t<e.length;t++)if(e[t]===null)return!0;return!1}}]),u}();V.constructor_=function(u){u&&(this._envelope=null,this._userData=null,this._factory=u,this._SRID=u.getSRID())},V.TYPECODE_POINT=0,V.TYPECODE_MULTIPOINT=1,V.TYPECODE_LINESTRING=2,V.TYPECODE_LINEARRING=3,V.TYPECODE_MULTILINESTRING=4,V.TYPECODE_POLYGON=5,V.TYPECODE_MULTIPOLYGON=6,V.TYPECODE_GEOMETRYCOLLECTION=7,V.TYPENAME_POINT="Point",V.TYPENAME_MULTIPOINT="MultiPoint",V.TYPENAME_LINESTRING="LineString",V.TYPENAME_LINEARRING="LinearRing",V.TYPENAME_MULTILINESTRING="MultiLineString",V.TYPENAME_POLYGON="Polygon",V.TYPENAME_MULTIPOLYGON="MultiPolygon",V.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",V.geometryChangedFilter={get interfaces_(){return[fe]},filter:function(u){u.geometryChangedAction()}};var w=function(){function u(){i(this,u)}return l(u,null,[{key:"toLocationSymbol",value:function(e){switch(e){case u.EXTERIOR:return"e";case u.BOUNDARY:return"b";case u.INTERIOR:return"i";case u.NONE:return"-"}throw new O("Unknown location value: "+e)}}]),u}();w.INTERIOR=0,w.BOUNDARY=1,w.EXTERIOR=2,w.NONE=-1;var nt=function(){function u(){i(this,u)}return l(u,[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}]),u}(),Ht=function(u){h(t,u);var e=k(t);function t(n){var a;return i(this,t),(a=e.call(this,n)).name=Object.keys({NoSuchElementException:t})[0],a}return t}(A),ft=function(u){h(t,u);var e=k(t);function t(n){var a;return i(this,t),(a=e.call(this,n)).name=Object.keys({UnsupportedOperationException:t})[0],a}return t}(A),Ni=function(u){h(t,u);var e=k(t);function t(){return i(this,t),e.apply(this,arguments)}return l(t,[{key:"contains",value:function(){}}]),t}(nt),xr=function(u,e){h(n,u);var t=k(n);function n(a){var c;return i(this,n),(c=t.call(this)).map=new Map,a instanceof nt&&c.addAll(a),c}return l(n,[{key:"contains",value:function(a){var c=a.hashCode?a.hashCode():a;return!!this.map.has(c)}},{key:"add",value:function(a){var c=a.hashCode?a.hashCode():a;return!this.map.has(c)&&!!this.map.set(c,a)}},{key:"addAll",value:function(a){var c,d=M(a);try{for(d.s();!(c=d.n()).done;){var y=c.value;this.add(y)}}catch(p){d.e(p)}finally{d.f()}return!0}},{key:"remove",value:function(){throw new ft}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new Fo(this.map)}},{key:e,value:function(){return this.map}}]),n}(Ni,Symbol.iterator),Fo=function(){function u(e){i(this,u),this.iterator=e.values();var t=this.iterator.next(),n=t.done,a=t.value;this.done=n,this.value=a}return l(u,[{key:"next",value:function(){if(this.done)throw new Ht;var e=this.value,t=this.iterator.next(),n=t.done,a=t.value;return this.done=n,this.value=a,e}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new ft}}]),u}(),G=function(){function u(){i(this,u)}return l(u,null,[{key:"opposite",value:function(e){return e===u.LEFT?u.RIGHT:e===u.RIGHT?u.LEFT:e}}]),u}();G.ON=0,G.LEFT=1,G.RIGHT=2;var Pi=function(u){h(t,u);var e=k(t);function t(n){var a;return i(this,t),(a=e.call(this,n)).name=Object.keys({EmptyStackException:t})[0],a}return t}(A),Mi=function(u){h(t,u);var e=k(t);function t(n){var a;return i(this,t),(a=e.call(this,n)).name=Object.keys({IndexOutOfBoundsException:t})[0],a}return t}(A),St=function(u){h(t,u);var e=k(t);function t(){return i(this,t),e.apply(this,arguments)}return l(t,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}]),t}(nt),qo=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),(n=e.call(this)).array=[],n}return l(t,[{key:"add",value:function(n){return this.array.push(n),!0}},{key:"get",value:function(n){if(n<0||n>=this.size())throw new Mi;return this.array[n]}},{key:"push",value:function(n){return this.array.push(n),n}},{key:"pop",value:function(){if(this.array.length===0)throw new Pi;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new Pi;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(n){return this.array.indexOf(n)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}]),t}(St);function oe(u,e){return u.interfaces_&&u.interfaces_.indexOf(e)>-1}var ln=function(){function u(e){i(this,u),this.str=e}return l(u,[{key:"append",value:function(e){this.str+=e}},{key:"setCharAt",value:function(e,t){this.str=this.str.substr(0,e)+t+this.str.substr(e+1)}},{key:"toString",value:function(){return this.str}}]),u}(),Fn=function(){function u(e){i(this,u),this.value=e}return l(u,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(e){return this.value<e?-1:this.value>e?1:0}}],[{key:"compare",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"isNan",value:function(e){return Number.isNaN(e)}},{key:"valueOf",value:function(e){return new u(e)}}]),u}(),Er=function(){function u(){i(this,u)}return l(u,null,[{key:"isWhitespace",value:function(e){return e<=32&&e>=0||e===127}},{key:"toUpperCase",value:function(e){return e.toUpperCase()}}]),u}(),Q=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"le",value:function(e){return this._hi<e._hi||this._hi===e._hi&&this._lo<=e._lo}},{key:"extractSignificantDigits",value:function(e,t){var n=this.abs(),a=u.magnitude(n._hi),c=u.TEN.pow(a);(n=n.divide(c)).gt(u.TEN)?(n=n.divide(u.TEN),a+=1):n.lt(u.ONE)&&(n=n.multiply(u.TEN),a-=1);for(var d=a+1,y=new ln,p=u.MAX_PRINT_DIGITS-1,E=0;E<=p;E++){e&&E===d&&y.append(".");var I=Math.trunc(n._hi);if(I<0)break;var L=!1,T=0;I>9?(L=!0,T="9"):T="0"+I,y.append(T),n=n.subtract(u.valueOf(I)).multiply(u.TEN),L&&n.selfAdd(u.TEN);var q=!0,F=u.magnitude(n._hi);if(F<0&&Math.abs(F)>=p-E&&(q=!1),!q)break}return t[0]=a,y.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof u){var e=arguments[0];return this.add(e.negate())}if(typeof arguments[0]=="number"){var t=arguments[0];return this.add(-t)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof u){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof u){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}if(typeof arguments[0]=="number"){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(e){return this.le(e)?this:e}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof u){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}if(typeof arguments[0]=="number"){var t=arguments[0];return this.selfDivide(t,0)}}else if(arguments.length===2){var n=arguments[0],a=arguments[1],c=null,d=null,y=null,p=null,E=null,I=null,L=null,T=null;return E=this._hi/n,T=(c=(I=u.SPLIT*E)-(c=I-E))*(y=(T=u.SPLIT*n)-(y=T-n))-(L=E*n)+c*(p=n-y)+(d=E-c)*y+d*p,T=E+(I=(this._hi-L-T+this._lo-E*a)/n),this._hi=T,this._lo=E-T+I,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof u){var e=arguments[0],t=null,n=null,a=null,c=null,d=null,y=null,p=null,E=null;n=(d=this._hi/e._hi)-(t=(y=u.SPLIT*d)-(t=y-d)),E=t*(a=(E=u.SPLIT*e._hi)-(a=E-e._hi))-(p=d*e._hi)+t*(c=e._hi-a)+n*a+n*c;var I=E=d+(y=(this._hi-p-E+this._lo-d*e._lo)/e._hi),L=d-E+y;return new u(I,L)}if(typeof arguments[0]=="number"){var T=arguments[0];return X.isNaN(T)?u.createNaN():u.copy(this).selfDivide(T,0)}}},{key:"ge",value:function(e){return this._hi>e._hi||this._hi===e._hi&&this._lo>=e._lo}},{key:"pow",value:function(e){if(e===0)return u.valueOf(1);var t=new u(this),n=u.valueOf(1),a=Math.abs(e);if(a>1)for(;a>0;)a%2==1&&n.selfMultiply(t),(a/=2)>0&&(t=t.sqr());else n=t;return e<0?n.reciprocal():n}},{key:"ceil",value:function(){if(this.isNaN())return u.NaN;var e=Math.ceil(this._hi),t=0;return e===this._hi&&(t=Math.ceil(this._lo)),new u(e,t)}},{key:"compareTo",value:function(e){var t=e;return this._hi<t._hi?-1:this._hi>t._hi?1:this._lo<t._lo?-1:this._lo>t._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof u){var e=arguments[0];return this.init(e),this}if(typeof arguments[0]=="number"){var t=arguments[0];return this.init(t),this}}},{key:"max",value:function(e){return this.ge(e)?this:e}},{key:"sqrt",value:function(){if(this.isZero())return u.valueOf(0);if(this.isNegative())return u.NaN;var e=1/Math.sqrt(this._hi),t=this._hi*e,n=u.valueOf(t),a=this.subtract(n.sqr())._hi*(.5*e);return n.add(a)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof u){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}if(typeof arguments[0]=="number"){var t=arguments[0],n=null,a=null,c=null,d=null,y=null,p=null;return d=(c=this._hi+t)-(y=c-this._hi),a=(p=(d=t-y+(this._hi-d))+this._lo)+(c-(n=c+p)),this._hi=n+a,this._lo=a+(n-this._hi),this}}else if(arguments.length===2){var E=arguments[0],I=arguments[1],L=null,T=null,q=null,F=null,H=null,$=null,te=null;F=this._hi+E,T=this._lo+I,H=F-($=F-this._hi),q=T-(te=T-this._lo);var Ee=(L=F+($=(H=E-$+(this._hi-H))+T))+($=(q=I-te+(this._lo-q))+($+(F-L))),Se=$+(L-Ee);return this._hi=Ee,this._lo=Se,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof u){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}if(typeof arguments[0]=="number"){var t=arguments[0];return this.selfMultiply(t,0)}}else if(arguments.length===2){var n=arguments[0],a=arguments[1],c=null,d=null,y=null,p=null,E=null,I=null;c=(E=u.SPLIT*this._hi)-this._hi,I=u.SPLIT*n,c=E-c,d=this._hi-c,y=I-n;var L=(E=this._hi*n)+(I=c*(y=I-y)-E+c*(p=n-y)+d*y+d*p+(this._hi*a+this._lo*n)),T=I+(c=E-L);return this._hi=L,this._lo=T,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return u.NaN;var e=Math.floor(this._hi),t=0;return e===this._hi&&(t=Math.floor(this._lo)),new u(e,t)}},{key:"negate",value:function(){return this.isNaN()?this:new u(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(e){if(e instanceof CloneNotSupportedException)return null;throw e}}},{key:"multiply",value:function(){if(arguments[0]instanceof u){var e=arguments[0];return e.isNaN()?u.createNaN():u.copy(this).selfMultiply(e)}if(typeof arguments[0]=="number"){var t=arguments[0];return X.isNaN(t)?u.createNaN():u.copy(this).selfMultiply(t,0)}}},{key:"isNaN",value:function(){return X.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var e=u.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var e=this.getSpecialNumberString();if(e!==null)return e;var t=new Array(1).fill(null),n=this.extractSignificantDigits(!0,t),a=t[0]+1,c=n;if(n.charAt(0)===".")c="0"+n;else if(a<0)c="0."+u.stringOfChar("0",-a)+n;else if(n.indexOf(".")===-1){var d=a-n.length;c=n+u.stringOfChar("0",d)+".0"}return this.isNegative()?"-"+c:c}},{key:"reciprocal",value:function(){var e,t,n,a,c=null,d=null,y=null,p=null;e=(n=1/this._hi)-(c=(y=u.SPLIT*n)-(c=y-n)),d=(p=u.SPLIT*this._hi)-this._hi;var E=n+(y=(1-(a=n*this._hi)-(p=c*(d=p-d)-a+c*(t=this._hi-d)+e*d+e*t)-n*this._lo)/this._hi);return new u(E,n-E+y)}},{key:"toSciNotation",value:function(){if(this.isZero())return u.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(e!==null)return e;var t=new Array(1).fill(null),n=this.extractSignificantDigits(!1,t),a=u.SCI_NOT_EXPONENT_CHAR+t[0];if(n.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+n);var c="";n.length>1&&(c=n.substring(1));var d=n.charAt(0)+"."+c;return this.isNegative()?"-"+d+a:d+a}},{key:"abs",value:function(){return this.isNaN()?u.NaN:this.isNegative()?this.negate():new u(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(e){return this._hi<e._hi||this._hi===e._hi&&this._lo<e._lo}},{key:"add",value:function(){if(arguments[0]instanceof u){var e=arguments[0];return u.copy(this).selfAdd(e)}if(typeof arguments[0]=="number"){var t=arguments[0];return u.copy(this).selfAdd(t)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this._hi=e,this._lo=0}else if(arguments[0]instanceof u){var t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(arguments.length===2){var n=arguments[0],a=arguments[1];this._hi=n,this._lo=a}}},{key:"gt",value:function(e){return this._hi>e._hi||this._hi===e._hi&&this._lo>e._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?u.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[Z,B,W]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof u){var t=arguments[0];this.init(t)}else if(typeof arguments[0]=="string"){var n=arguments[0];u.constructor_.call(this,u.parse(n))}}else if(arguments.length===2){var a=arguments[0],c=arguments[1];this.init(a,c)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1],n=arguments[2],a=arguments[3];return u.determinant(u.valueOf(e),u.valueOf(t),u.valueOf(n),u.valueOf(a))}if(arguments[3]instanceof u&&arguments[2]instanceof u&&arguments[0]instanceof u&&arguments[1]instanceof u){var c=arguments[0],d=arguments[1],y=arguments[2],p=arguments[3],E=c.multiply(p).selfSubtract(d.multiply(y));return E}}},{key:"sqr",value:function(e){return u.valueOf(e).selfMultiply(e)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var e=arguments[0];return u.parse(e)}if(typeof arguments[0]=="number"){var t=arguments[0];return new u(t)}}},{key:"sqrt",value:function(e){return u.valueOf(e).sqrt()}},{key:"parse",value:function(e){for(var t=0,n=e.length;Er.isWhitespace(e.charAt(t));)t++;var a=!1;if(t<n){var c=e.charAt(t);c!=="-"&&c!=="+"||(t++,c==="-"&&(a=!0))}for(var d=new u,y=0,p=0,E=0,I=!1;!(t>=n);){var L=e.charAt(t);if(t++,Er.isDigit(L)){var T=L-"0";d.selfMultiply(u.TEN),d.selfAdd(T),y++}else{if(L!=="."){if(L==="e"||L==="E"){var q=e.substring(t);try{E=Fn.parseInt(q)}catch(Ee){throw Ee instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+q+" in string "+e):Ee}break}throw new NumberFormatException("Unexpected character '"+L+"' at position "+t+" in string "+e)}p=y,I=!0}}var F=d;I||(p=y);var H=y-p-E;if(H===0)F=d;else if(H>0){var $=u.TEN.pow(H);F=d.divide($)}else if(H<0){var te=u.TEN.pow(-H);F=d.multiply(te)}return a?F.negate():F}},{key:"createNaN",value:function(){return new u(X.NaN,X.NaN)}},{key:"copy",value:function(e){return new u(e)}},{key:"magnitude",value:function(e){var t=Math.abs(e),n=Math.log(t)/Math.log(10),a=Math.trunc(Math.floor(n));return 10*Math.pow(10,a)<=t&&(a+=1),a}},{key:"stringOfChar",value:function(e,t){for(var n=new ln,a=0;a<t;a++)n.append(e);return n.toString()}}]),u}();Q.PI=new Q(3.141592653589793,12246467991473532e-32),Q.TWO_PI=new Q(6.283185307179586,24492935982947064e-32),Q.PI_2=new Q(1.5707963267948966,6123233995736766e-32),Q.E=new Q(2.718281828459045,14456468917292502e-32),Q.NaN=new Q(X.NaN,X.NaN),Q.EPS=123259516440783e-46,Q.SPLIT=134217729,Q.MAX_PRINT_DIGITS=32,Q.TEN=Q.valueOf(10),Q.ONE=Q.valueOf(1),Q.SCI_NOT_EXPONENT_CHAR="E",Q.SCI_NOT_ZERO="0.0E0";var kr=function(){function u(){i(this,u)}return l(u,null,[{key:"orientationIndex",value:function(e,t,n){var a=u.orientationIndexFilter(e,t,n);if(a<=1)return a;var c=Q.valueOf(t.x).selfAdd(-e.x),d=Q.valueOf(t.y).selfAdd(-e.y),y=Q.valueOf(n.x).selfAdd(-t.x),p=Q.valueOf(n.y).selfAdd(-t.y);return c.selfMultiply(p).selfSubtract(d.selfMultiply(y)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof Q&&arguments[2]instanceof Q&&arguments[0]instanceof Q&&arguments[1]instanceof Q){var e=arguments[0],t=arguments[1],n=arguments[2],a=arguments[3],c=e.multiply(a).selfSubtract(t.multiply(n));return c.signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var d=arguments[0],y=arguments[1],p=arguments[2],E=arguments[3],I=Q.valueOf(d),L=Q.valueOf(y),T=Q.valueOf(p),q=Q.valueOf(E),F=I.multiply(q).selfSubtract(L.multiply(T));return F.signum()}}},{key:"intersection",value:function(e,t,n,a){var c=new Q(e.y).selfSubtract(t.y),d=new Q(t.x).selfSubtract(e.x),y=new Q(e.x).selfMultiply(t.y).selfSubtract(new Q(t.x).selfMultiply(e.y)),p=new Q(n.y).selfSubtract(a.y),E=new Q(a.x).selfSubtract(n.x),I=new Q(n.x).selfMultiply(a.y).selfSubtract(new Q(a.x).selfMultiply(n.y)),L=d.multiply(I).selfSubtract(E.multiply(y)),T=p.multiply(y).selfSubtract(c.multiply(I)),q=c.multiply(E).selfSubtract(p.multiply(d)),F=L.selfDivide(q).doubleValue(),H=T.selfDivide(q).doubleValue();return X.isNaN(F)||X.isInfinite(F)||X.isNaN(H)||X.isInfinite(H)?null:new S(F,H)}},{key:"orientationIndexFilter",value:function(e,t,n){var a=null,c=(e.x-n.x)*(t.y-n.y),d=(e.y-n.y)*(t.x-n.x),y=c-d;if(c>0){if(d<=0)return u.signum(y);a=c+d}else{if(!(c<0)||d>=0)return u.signum(y);a=-c-d}var p=u.DP_SAFE_EPSILON*a;return y>=p||-y>=p?u.signum(y):2}},{key:"signum",value:function(e){return e>0?1:e<0?-1:0}}]),u}();kr.DP_SAFE_EPSILON=1e-15;var ge=function(){function u(){i(this,u)}return l(u,[{key:"getM",value:function(e){if(this.hasM()){var t=this.getDimension()-this.getMeasures();return this.getOrdinate(e,t)}return X.NaN}},{key:"setOrdinate",value:function(e,t,n){}},{key:"getZ",value:function(e){return this.hasZ()?this.getOrdinate(e,2):X.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(e,t){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(e){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(e){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(e){}},{key:"copy",value:function(){}},{key:"getY",value:function(e){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[W]}}]),u}();ge.X=0,ge.Y=1,ge.Z=2,ge.M=3;var ee=function(){function u(){i(this,u)}return l(u,null,[{key:"index",value:function(e,t,n){return kr.orientationIndex(e,t,n)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var e=arguments[0],t=e.length-1;if(t<3)throw new O("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=e[0],a=0,c=1;c<=t;c++){var d=e[c];d.y>n.y&&(n=d,a=c)}var y=a;do(y-=1)<0&&(y=t);while(e[y].equals2D(n)&&y!==a);var p=a;do p=(p+1)%t;while(e[p].equals2D(n)&&p!==a);var E=e[y],I=e[p];if(E.equals2D(n)||I.equals2D(n)||E.equals2D(I))return!1;var L=u.index(E,n,I),T=null;return T=L===0?E.x>I.x:L>0,T}if(oe(arguments[0],ge)){var q=arguments[0],F=q.size()-1;if(F<3)throw new O("Ring has fewer than 4 points, so orientation cannot be determined");for(var H=q.getCoordinate(0),$=0,te=1;te<=F;te++){var Ee=q.getCoordinate(te);Ee.y>H.y&&(H=Ee,$=te)}var Se=null,Xe=$;do(Xe-=1)<0&&(Xe=F),Se=q.getCoordinate(Xe);while(Se.equals2D(H)&&Xe!==$);var et=null,ct=$;do ct=(ct+1)%F,et=q.getCoordinate(ct);while(et.equals2D(H)&&ct!==$);if(Se.equals2D(H)||et.equals2D(H)||Se.equals2D(et))return!1;var Et=u.index(Se,H,et);return Et===0?Se.x>et.x:Et>0}}}]),u}();ee.CLOCKWISE=-1,ee.RIGHT=ee.CLOCKWISE,ee.COUNTERCLOCKWISE=1,ee.LEFT=ee.COUNTERCLOCKWISE,ee.COLLINEAR=0,ee.STRAIGHT=ee.COLLINEAR;var Go=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(e,t){var n=this.getRightmostSideOfSegment(e,t);return n<0&&(n=this.getRightmostSideOfSegment(e,t-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(e)),n}},{key:"findRightmostEdgeAtVertex",value:function(){var e=this._minDe.getEdge().getCoordinates();U.isTrue(this._minIndex>0&&this._minIndex<e.length,"rightmost point expected to be interior vertex of edge");var t=e[this._minIndex-1],n=e[this._minIndex+1],a=ee.index(this._minCoord,n,t),c=!1;(t.y<this._minCoord.y&&n.y<this._minCoord.y&&a===ee.COUNTERCLOCKWISE||t.y>this._minCoord.y&&n.y>this._minCoord.y&&a===ee.CLOCKWISE)&&(c=!0),c&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(e,t){var n=e.getEdge().getCoordinates();if(t<0||t+1>=n.length||n[t].y===n[t+1].y)return-1;var a=G.LEFT;return n[t].y<n[t+1].y&&(a=G.RIGHT),a}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(e){for(var t=e.getEdge().getCoordinates(),n=0;n<t.length-1;n++)(this._minCoord===null||t[n].x>this._minCoord.x)&&(this._minDe=e,this._minIndex=n,this._minCoord=t[n])}},{key:"findRightmostEdgeAtNode",value:function(){var e=this._minDe.getNode().getEdges();this._minDe=e.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();n.isForward()&&this.checkForRightmostCoordinate(n)}U.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===G.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}]),u}(),pt=function(u){h(t,u);var e=k(t);function t(n,a){var c;return i(this,t),(c=e.call(this,a?n+" [ "+a+" ]":n)).pt=a?new S(a):void 0,c.name=Object.keys({TopologyException:t})[0],c}return l(t,[{key:"getCoordinate",value:function(){return this.pt}}]),t}(qe),zo=function(){function u(){i(this,u),this.array=[]}return l(u,[{key:"addLast",value:function(e){this.array.push(e)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}]),u}(),K=function(u,e){h(n,u);var t=k(n);function n(a){var c;return i(this,n),(c=t.call(this)).array=[],a instanceof nt&&c.addAll(a),c}return l(n,[{key:"interfaces_",get:function(){return[St,nt]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(a){return arguments.length===1?this.array.push(a):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(a){var c,d=M(a);try{for(d.s();!(c=d.n()).done;){var y=c.value;this.array.push(y)}}catch(p){d.e(p)}finally{d.f()}}},{key:"set",value:function(a,c){var d=this.array[a];return this.array[a]=c,d}},{key:"iterator",value:function(){return new Bo(this)}},{key:"get",value:function(a){if(a<0||a>=this.size())throw new Mi;return this.array[a]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(a){a?this.array.sort(function(c,d){return a.compare(c,d)}):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(a){for(var c=0,d=this.array.length;c<d;c++)if(this.array[c]===a)return!!this.array.splice(c,1);return!1}},{key:e,value:function(){return this.array.values()}}]),n}(St,Symbol.iterator),Bo=function(){function u(e){i(this,u),this.arrayList=e,this.position=0}return l(u,[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new Ht;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(e){return this.arrayList.set(this.position-1,e)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}]),u}(),Yo=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"clearVisitedEdges",value:function(){for(var e=this._dirEdgeList.iterator();e.hasNext();)e.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(e){for(var t=null,n=e.getEdges().iterator();n.hasNext();){var a=n.next();if(a.isVisited()||a.getSym().isVisited()){t=a;break}}if(t===null)throw new pt("unable to find edge to compute depths at "+e.getCoordinate());e.getEdges().computeDepths(t);for(var c=e.getEdges().iterator();c.hasNext();){var d=c.next();d.setVisited(!0),this.copySymDepths(d)}}},{key:"computeDepth",value:function(e){this.clearVisitedEdges();var t=this._finder.getEdge();t.getNode(),t.getLabel(),t.setEdgeDepths(G.RIGHT,e),this.copySymDepths(t),this.computeDepths(t)}},{key:"create",value:function(e){this.addReachable(e),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var t=e.next();t.getDepth(G.RIGHT)>=1&&t.getDepth(G.LEFT)<=0&&!t.isInteriorAreaEdge()&&t.setInResult(!0)}}},{key:"computeDepths",value:function(e){var t=new xr,n=new zo,a=e.getNode();for(n.addLast(a),t.add(a),e.setVisited(!0);!n.isEmpty();){var c=n.removeFirst();t.add(c),this.computeNodeDepth(c);for(var d=c.getEdges().iterator();d.hasNext();){var y=d.next().getSym();if(!y.isVisited()){var p=y.getNode();t.contains(p)||(n.addLast(p),t.add(p))}}}}},{key:"compareTo",value:function(e){var t=e;return this._rightMostCoord.x<t._rightMostCoord.x?-1:this._rightMostCoord.x>t._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var e=new ke,t=this._dirEdgeList.iterator();t.hasNext();)for(var n=t.next().getEdge().getCoordinates(),a=0;a<n.length-1;a++)e.expandToInclude(n[a]);this._env=e}return this._env}},{key:"addReachable",value:function(e){var t=new qo;for(t.add(e);!t.empty();){var n=t.pop();this.add(n,t)}}},{key:"copySymDepths",value:function(e){var t=e.getSym();t.setDepth(G.LEFT,e.getDepth(G.RIGHT)),t.setDepth(G.RIGHT,e.getDepth(G.LEFT))}},{key:"add",value:function(e,t){e.setVisited(!0),this._nodes.add(e);for(var n=e.getEdges().iterator();n.hasNext();){var a=n.next();this._dirEdgeList.add(a);var c=a.getSym().getNode();c.isVisited()||t.push(c)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[B]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new K,this._nodes=new K,this._rightMostCoord=null,this._env=null,this._finder=new Go}}]),u}(),wr=function(){function u(){i(this,u)}return l(u,null,[{key:"intersection",value:function(e,t,n,a){var c=e.x<t.x?e.x:t.x,d=e.y<t.y?e.y:t.y,y=e.x>t.x?e.x:t.x,p=e.y>t.y?e.y:t.y,E=n.x<a.x?n.x:a.x,I=n.y<a.y?n.y:a.y,L=n.x>a.x?n.x:a.x,T=n.y>a.y?n.y:a.y,q=((c>E?c:E)+(y<L?y:L))/2,F=((d>I?d:I)+(p<T?p:T))/2,H=e.x-q,$=e.y-F,te=t.x-q,Ee=t.y-F,Se=n.x-q,Xe=n.y-F,et=a.x-q,ct=a.y-F,Et=$-Ee,Ft=te-H,pn=H*Ee-te*$,_n=Xe-ct,en=et-Se,gs=Se*ct-et*Xe,ds=Et*en-_n*Ft,Gr=(Ft*gs-en*pn)/ds,zr=(_n*pn-Et*gs)/ds;return X.isNaN(Gr)||X.isInfinite(Gr)||X.isNaN(zr)||X.isInfinite(zr)?null:new S(Gr+q,zr+F)}}]),u}(),rt=function(){function u(){i(this,u)}return l(u,null,[{key:"arraycopy",value:function(e,t,n,a,c){for(var d=0,y=t;y<t+c;y++)n[a+d]=e[y],d++}},{key:"getProperty",value:function(e){return{"line.separator":`
`}[e]}}]),u}(),cn=function(){function u(){i(this,u)}return l(u,null,[{key:"log10",value:function(e){var t=Math.log(e);return X.isInfinite(t)||X.isNaN(t)?t:t/u.LOG_10}},{key:"min",value:function(e,t,n,a){var c=e;return t<c&&(c=t),n<c&&(c=n),a<c&&(c=a),c}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1],n=arguments[2];return e<t?t:e>n?n:e}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var a=arguments[0],c=arguments[1],d=arguments[2];return a<c?c:a>d?d:a}}},{key:"wrap",value:function(e,t){return e<0?t- -e%t:e%t}},{key:"max",value:function(){if(arguments.length===3){var e=arguments[0],t=arguments[1],n=arguments[2],a=e;return t>a&&(a=t),n>a&&(a=n),a}if(arguments.length===4){var c=arguments[0],d=arguments[1],y=arguments[2],p=arguments[3],E=c;return d>E&&(E=d),y>E&&(E=y),p>E&&(E=p),E}}},{key:"average",value:function(e,t){return(e+t)/2}}]),u}();cn.LOG_10=Math.log(10);var gt=function(){function u(){i(this,u)}return l(u,null,[{key:"segmentToSegment",value:function(e,t,n,a){if(e.equals(t))return u.pointToSegment(e,n,a);if(n.equals(a))return u.pointToSegment(a,e,t);var c=!1;if(ke.intersects(e,t,n,a)){var d=(t.x-e.x)*(a.y-n.y)-(t.y-e.y)*(a.x-n.x);if(d===0)c=!0;else{var y=(e.y-n.y)*(a.x-n.x)-(e.x-n.x)*(a.y-n.y),p=((e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y))/d,E=y/d;(E<0||E>1||p<0||p>1)&&(c=!0)}}else c=!0;return c?cn.min(u.pointToSegment(e,n,a),u.pointToSegment(t,n,a),u.pointToSegment(n,e,t),u.pointToSegment(a,e,t)):0}},{key:"pointToSegment",value:function(e,t,n){if(t.x===n.x&&t.y===n.y)return e.distance(t);var a=(n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y),c=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/a;if(c<=0)return e.distance(t);if(c>=1)return e.distance(n);var d=((t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y))/a;return Math.abs(d)*Math.sqrt(a)}},{key:"pointToLinePerpendicular",value:function(e,t,n){var a=(n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y),c=((t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y))/a;return Math.abs(c)*Math.sqrt(a)}},{key:"pointToSegmentString",value:function(e,t){if(t.length===0)throw new O("Line array must contain at least one vertex");for(var n=e.distance(t[0]),a=0;a<t.length-1;a++){var c=u.pointToSegment(e,t[a],t[a+1]);c<n&&(n=c)}return n}}]),u}(),Li=function(){function u(){i(this,u)}return l(u,[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||oe(arguments[0],ge);else if(arguments.length!==2){if(arguments.length===3){var e=arguments[0],t=arguments[1];return this.create(e,t)}}}}]),u}(),qn=function(){function u(){i(this,u)}return l(u,[{key:"filter",value:function(e){}}]),u}(),Xo=function(){function u(){i(this,u)}return l(u,null,[{key:"ofLine",value:function(e){var t=e.size();if(t<=1)return 0;var n=0,a=new S;e.getCoordinate(0,a);for(var c=a.x,d=a.y,y=1;y<t;y++){e.getCoordinate(y,a);var p=a.x,E=a.y,I=p-c,L=E-d;n+=Math.sqrt(I*I+L*L),c=p,d=E}return n}}]),u}(),bi=function u(){i(this,u)},Ct=function(){function u(){i(this,u)}return l(u,null,[{key:"copyCoord",value:function(e,t,n,a){for(var c=Math.min(e.getDimension(),n.getDimension()),d=0;d<c;d++)n.setOrdinate(a,d,e.getOrdinate(t,d))}},{key:"isRing",value:function(e){var t=e.size();return t===0||!(t<=3)&&e.getOrdinate(0,ge.X)===e.getOrdinate(t-1,ge.X)&&e.getOrdinate(0,ge.Y)===e.getOrdinate(t-1,ge.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(oe(arguments[0],ge)&&Number.isInteger(arguments[1])){var e=arguments[0],t=arguments[1];u.scroll(e,t,u.isRing(e))}else if(oe(arguments[0],ge)&&arguments[1]instanceof S){var n=arguments[0],a=arguments[1],c=u.indexOf(a,n);if(c<=0)return null;u.scroll(n,c)}}else if(arguments.length===3){var d=arguments[0],y=arguments[1],p=arguments[2],E=y;if(E<=0)return null;for(var I=d.copy(),L=p?d.size()-1:d.size(),T=0;T<L;T++)for(var q=0;q<d.getDimension();q++)d.setOrdinate(T,q,I.getOrdinate((y+T)%L,q));if(p)for(var F=0;F<d.getDimension();F++)d.setOrdinate(L,F,d.getOrdinate(0,F))}}},{key:"isEqual",value:function(e,t){var n=e.size();if(n!==t.size())return!1;for(var a=Math.min(e.getDimension(),t.getDimension()),c=0;c<n;c++)for(var d=0;d<a;d++){var y=e.getOrdinate(c,d),p=t.getOrdinate(c,d);if(e.getOrdinate(c,d)!==t.getOrdinate(c,d)&&(!X.isNaN(y)||!X.isNaN(p)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var e=arguments[0];return u.minCoordinateIndex(e,0,e.size()-1)}if(arguments.length===3){for(var t=arguments[0],n=arguments[1],a=arguments[2],c=-1,d=null,y=n;y<=a;y++){var p=t.getCoordinate(y);(d===null||d.compareTo(p)>0)&&(d=p,c=y)}return c}}},{key:"extend",value:function(e,t,n){var a=e.create(n,t.getDimension()),c=t.size();if(u.copy(t,0,a,0,c),c>0)for(var d=c;d<n;d++)u.copy(t,c-1,a,d,1);return a}},{key:"reverse",value:function(e){for(var t=e.size()-1,n=Math.trunc(t/2),a=0;a<=n;a++)u.swap(e,a,t-a)}},{key:"swap",value:function(e,t,n){if(t===n)return null;for(var a=0;a<e.getDimension();a++){var c=e.getOrdinate(t,a);e.setOrdinate(t,a,e.getOrdinate(n,a)),e.setOrdinate(n,a,c)}}},{key:"copy",value:function(e,t,n,a,c){for(var d=0;d<c;d++)u.copyCoord(e,t+d,n,a+d)}},{key:"ensureValidRing",value:function(e,t){var n=t.size();return n===0?t:n<=3?u.createClosedRing(e,t,4):t.getOrdinate(0,ge.X)===t.getOrdinate(n-1,ge.X)&&t.getOrdinate(0,ge.Y)===t.getOrdinate(n-1,ge.Y)?t:u.createClosedRing(e,t,n+1)}},{key:"indexOf",value:function(e,t){for(var n=0;n<t.size();n++)if(e.x===t.getOrdinate(n,ge.X)&&e.y===t.getOrdinate(n,ge.Y))return n;return-1}},{key:"createClosedRing",value:function(e,t,n){var a=e.create(n,t.getDimension()),c=t.size();u.copy(t,0,a,0,c);for(var d=c;d<n;d++)u.copy(t,0,a,d,1);return a}},{key:"minCoordinate",value:function(e){for(var t=null,n=0;n<e.size();n++){var a=e.getCoordinate(n);(t===null||t.compareTo(a)>0)&&(t=a)}return t}}]),u}(),z=function(){function u(){i(this,u)}return l(u,null,[{key:"toDimensionSymbol",value:function(e){switch(e){case u.FALSE:return u.SYM_FALSE;case u.TRUE:return u.SYM_TRUE;case u.DONTCARE:return u.SYM_DONTCARE;case u.P:return u.SYM_P;case u.L:return u.SYM_L;case u.A:return u.SYM_A}throw new O("Unknown dimension value: "+e)}},{key:"toDimensionValue",value:function(e){switch(Er.toUpperCase(e)){case u.SYM_FALSE:return u.FALSE;case u.SYM_TRUE:return u.TRUE;case u.SYM_DONTCARE:return u.DONTCARE;case u.SYM_P:return u.P;case u.SYM_L:return u.L;case u.SYM_A:return u.A}throw new O("Unknown dimension symbol: "+e)}}]),u}();z.P=0,z.L=1,z.A=2,z.FALSE=-1,z.TRUE=-2,z.DONTCARE=-3,z.SYM_FALSE="F",z.SYM_TRUE="T",z.SYM_DONTCARE="*",z.SYM_P="0",z.SYM_L="1",z.SYM_A="2";var Gn=function(){function u(){i(this,u)}return l(u,[{key:"filter",value:function(e){}}]),u}(),zn=function(){function u(){i(this,u)}return l(u,[{key:"filter",value:function(e,t){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}]),u}(),hn=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new ke:this._points.expandEnvelope(new ke)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new t(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var n=arguments[0],a=arguments[1];if(!this.isEquivalentClass(n))return!1;var c=n;if(this._points.size()!==c._points.size())return!1;for(var d=0;d<this._points.size();d++)if(!this.equal(this._points.getCoordinate(d),c._points.getCoordinate(d),a))return!1;return!0}return N(f(t.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var n=0;n<Math.trunc(this._points.size()/2);n++){var a=this._points.size()-1-n;if(!this._points.getCoordinate(n).equals(this._points.getCoordinate(a))){if(this._points.getCoordinate(n).compareTo(this._points.getCoordinate(a))>0){var c=this._points.copy();Ct.reverse(c),this._points=c}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?z.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var n=this._points.copy();return Ct.reverse(n),this.getFactory().createLineString(n)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return V.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return Xo.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var n=arguments[0],a=n,c=0,d=0;c<this._points.size()&&d<a._points.size();){var y=this._points.getCoordinate(c).compareTo(a._points.getCoordinate(d));if(y!==0)return y;c++,d++}return c<this._points.size()?1:d<a._points.size()?-1:0}if(arguments.length===2){var p=arguments[0],E=arguments[1],I=p;return E.compare(this._points,I._points)}}},{key:"apply",value:function(){if(oe(arguments[0],qn))for(var n=arguments[0],a=0;a<this._points.size();a++)n.filter(this._points.getCoordinate(a));else if(oe(arguments[0],zn)){var c=arguments[0];if(this._points.size()===0)return null;for(var d=0;d<this._points.size()&&(c.filter(this._points,d),!c.isDone());d++);c.isGeometryChanged()&&this.geometryChanged()}else if(oe(arguments[0],Gn)){var y=arguments[0];y.filter(this)}else if(oe(arguments[0],fe)){var p=arguments[0];p.filter(this)}}},{key:"getBoundary",value:function(){throw new ft}},{key:"isEquivalentClass",value:function(n){return n instanceof t}},{key:"getCoordinateN",value:function(n){return this._points.getCoordinate(n)}},{key:"getGeometryType",value:function(){return V.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(n){if(n===null&&(n=this.getFactory().getCoordinateSequenceFactory().create([])),n.size()===1)throw new O("Invalid number of points in LineString (found "+n.size()+" - must be 0 or >= 2)");this._points=n}},{key:"isCoordinate",value:function(n){for(var a=0;a<this._points.size();a++)if(this._points.getCoordinate(a).equals(n))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(n){return this.getFactory().createPoint(this._points.getCoordinate(n))}},{key:"interfaces_",get:function(){return[bi]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var n=arguments[0],a=arguments[1];V.constructor_.call(this,a),this.init(n)}}}}]),t}(V),Si=function u(){i(this,u)},Ir=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new ke;var n=new ke;return n.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),n}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new t(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var n=arguments[0],a=arguments[1];return!!this.isEquivalentClass(n)&&(!(!this.isEmpty()||!n.isEmpty())||this.isEmpty()===n.isEmpty()&&this.equal(n.getCoordinate(),this.getCoordinate(),a))}return N(f(t.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return z.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return V.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var n=arguments[0],a=n;return this.getCoordinate().compareTo(a.getCoordinate())}if(arguments.length===2){var c=arguments[0],d=arguments[1],y=c;return d.compare(this._coordinates,y._coordinates)}}},{key:"apply",value:function(){if(oe(arguments[0],qn)){var n=arguments[0];if(this.isEmpty())return null;n.filter(this.getCoordinate())}else if(oe(arguments[0],zn)){var a=arguments[0];if(this.isEmpty())return null;a.filter(this._coordinates,0),a.isGeometryChanged()&&this.geometryChanged()}else if(oe(arguments[0],Gn)){var c=arguments[0];c.filter(this)}else if(oe(arguments[0],fe)){var d=arguments[0];d.filter(this)}}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return V.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(n){n===null&&(n=this.getFactory().getCoordinateSequenceFactory().create([])),U.isTrue(n.size()<=1),this._coordinates=n}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[Si]}}],[{key:"constructor_",value:function(){this._coordinates=null;var n=arguments[0],a=arguments[1];V.constructor_.call(this,a),this.init(n)}}]),t}(V),Ci=function(){function u(){i(this,u)}return l(u,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var e=arguments[0];return Math.abs(u.ofRingSigned(e))}if(oe(arguments[0],ge)){var t=arguments[0];return Math.abs(u.ofRingSigned(t))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var t=0,n=e[0].x,a=1;a<e.length-1;a++){var c=e[a].x-n,d=e[a+1].y,y=e[a-1].y;t+=c*(y-d)}return t/2}if(oe(arguments[0],ge)){var p=arguments[0],E=p.size();if(E<3)return 0;var I=new S,L=new S,T=new S;p.getCoordinate(0,L),p.getCoordinate(1,T);var q=L.x;T.x-=q;for(var F=0,H=1;H<E-1;H++)I.y=L.y,L.x=T.x,L.y=T.y,p.getCoordinate(H+1,T),T.x-=q,F+=L.x*(I.y-T.y);return F/2}}}]),u}(),Tt=function(){function u(){i(this,u)}return l(u,null,[{key:"sort",value:function(){var e=arguments,t=arguments[0];if(arguments.length===1)t.sort(function(q,F){return q.compareTo(F)});else if(arguments.length===2)t.sort(function(q,F){return e[1].compare(q,F)});else if(arguments.length===3){var n=t.slice(arguments[1],arguments[2]);n.sort();var a=t.slice(0,arguments[1]).concat(n,t.slice(arguments[2],t.length));t.splice(0,t.length);var c,d=M(a);try{for(d.s();!(c=d.n()).done;){var y=c.value;t.push(y)}}catch(q){d.e(q)}finally{d.f()}}else if(arguments.length===4){var p=t.slice(arguments[1],arguments[2]);p.sort(function(q,F){return e[3].compare(q,F)});var E=t.slice(0,arguments[1]).concat(p,t.slice(arguments[2],t.length));t.splice(0,t.length);var I,L=M(E);try{for(L.s();!(I=L.n()).done;){var T=I.value;t.push(T)}}catch(q){L.e(q)}finally{L.f()}}}},{key:"asList",value:function(e){var t,n=new K,a=M(e);try{for(a.s();!(t=a.n()).done;){var c=t.value;n.add(c)}}catch(d){a.e(d)}finally{a.f()}return n}},{key:"copyOf",value:function(e,t){return e.slice(0,t)}}]),u}(),Ti=function u(){i(this,u)},Bn=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var n=new Array(this.getNumPoints()).fill(null),a=-1,c=this._shell.getCoordinates(),d=0;d<c.length;d++)n[++a]=c[d];for(var y=0;y<this._holes.length;y++)for(var p=this._holes[y].getCoordinates(),E=0;E<p.length;E++)n[++a]=p[E];return n}},{key:"getArea",value:function(){var n=0;n+=Ci.ofRing(this._shell.getCoordinateSequence());for(var a=0;a<this._holes.length;a++)n-=Ci.ofRing(this._holes[a].getCoordinateSequence());return n}},{key:"copyInternal",value:function(){for(var n=this._shell.copy(),a=new Array(this._holes.length).fill(null),c=0;c<this._holes.length;c++)a[c]=this._holes[c].copy();return new t(n,a,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var n=this._shell.getCoordinateSequence(),a=this.getEnvelopeInternal(),c=0;c<5;c++){var d=n.getX(c);if(d!==a.getMinX()&&d!==a.getMaxX())return!1;var y=n.getY(c);if(y!==a.getMinY()&&y!==a.getMaxY())return!1}for(var p=n.getX(0),E=n.getY(0),I=1;I<=4;I++){var L=n.getX(I),T=n.getY(I);if(L!==p==(T!==E))return!1;p=L,E=T}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var n=arguments[0],a=arguments[1];if(!this.isEquivalentClass(n))return!1;var c=n,d=this._shell,y=c._shell;if(!d.equalsExact(y,a)||this._holes.length!==c._holes.length)return!1;for(var p=0;p<this._holes.length;p++)if(!this._holes[p].equalsExact(c._holes[p],a))return!1;return!0}return N(f(t.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var n=0;n<this._holes.length;n++)this._holes[n]=this.normalized(this._holes[n],!1);Tt.sort(this._holes)}else if(arguments.length===2){var a=arguments[0],c=arguments[1];if(a.isEmpty())return null;var d=a.getCoordinateSequence(),y=Ct.minCoordinateIndex(d,0,d.size()-2);Ct.scroll(d,y,!0),ee.isCCW(d)===c&&Ct.reverse(d)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var n=this.getExteriorRing().reverse(),a=new Array(this.getNumInteriorRing()).fill(null),c=0;c<a.length;c++)a[c]=this.getInteriorRingN(c).reverse();return this.getFactory().createPolygon(n,a)}},{key:"getTypeCode",value:function(){return V.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var n=0;n+=this._shell.getLength();for(var a=0;a<this._holes.length;a++)n+=this._holes[a].getLength();return n}},{key:"getNumPoints",value:function(){for(var n=this._shell.getNumPoints(),a=0;a<this._holes.length;a++)n+=this._holes[a].getNumPoints();return n}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(n,a){var c=n.copy();return this.normalize(c,a),c}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var n=arguments[0],a=this._shell,c=n._shell;return a.compareToSameClass(c)}if(arguments.length===2){var d=arguments[0],y=arguments[1],p=d,E=this._shell,I=p._shell,L=E.compareToSameClass(I,y);if(L!==0)return L;for(var T=this.getNumInteriorRing(),q=p.getNumInteriorRing(),F=0;F<T&&F<q;){var H=this.getInteriorRingN(F),$=p.getInteriorRingN(F),te=H.compareToSameClass($,y);if(te!==0)return te;F++}return F<T?1:F<q?-1:0}}},{key:"apply",value:function(){if(oe(arguments[0],qn)){var n=arguments[0];this._shell.apply(n);for(var a=0;a<this._holes.length;a++)this._holes[a].apply(n)}else if(oe(arguments[0],zn)){var c=arguments[0];if(this._shell.apply(c),!c.isDone())for(var d=0;d<this._holes.length&&(this._holes[d].apply(c),!c.isDone());d++);c.isGeometryChanged()&&this.geometryChanged()}else if(oe(arguments[0],Gn)){var y=arguments[0];y.filter(this)}else if(oe(arguments[0],fe)){var p=arguments[0];p.filter(this),this._shell.apply(p);for(var E=0;E<this._holes.length;E++)this._holes[E].apply(p)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var n=new Array(this._holes.length+1).fill(null);n[0]=this._shell;for(var a=0;a<this._holes.length;a++)n[a+1]=this._holes[a];return n.length<=1?this.getFactory().createLinearRing(n[0].getCoordinateSequence()):this.getFactory().createMultiLineString(n)}},{key:"getGeometryType",value:function(){return V.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(n){return this._holes[n]}},{key:"interfaces_",get:function(){return[Ti]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var n=arguments[0],a=arguments[1],c=arguments[2];if(V.constructor_.call(this,c),n===null&&(n=this.getFactory().createLinearRing()),a===null&&(a=[]),V.hasNullElements(a))throw new O("holes must not contain null elements");if(n.isEmpty()&&V.hasNonEmptyElements(a))throw new O("shell is empty but holes are not");this._shell=n,this._holes=a}}]),t}(V),Uo=function(u){h(t,u);var e=k(t);function t(){return i(this,t),e.apply(this,arguments)}return t}(Ni),Oi=function(u){h(t,u);var e=k(t);function t(n){var a;return i(this,t),(a=e.call(this)).array=[],n instanceof nt&&a.addAll(n),a}return l(t,[{key:"contains",value:function(n){var a,c=M(this.array);try{for(c.s();!(a=c.n()).done;)if(a.value.compareTo(n)===0)return!0}catch(d){c.e(d)}finally{c.f()}return!1}},{key:"add",value:function(n){if(this.contains(n))return!1;for(var a=0,c=this.array.length;a<c;a++)if(this.array[a].compareTo(n)===1)return!!this.array.splice(a,0,n);return this.array.push(n),!0}},{key:"addAll",value:function(n){var a,c=M(n);try{for(c.s();!(a=c.n()).done;){var d=a.value;this.add(d)}}catch(y){c.e(y)}finally{c.f()}return!0}},{key:"remove",value:function(){throw new ft}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new Vo(this.array)}}]),t}(Uo),Vo=function(){function u(e){i(this,u),this.array=e,this.position=0}return l(u,[{key:"next",value:function(){if(this.position===this.array.length)throw new Ht;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new ft}}]),u}(),Ke=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"computeEnvelopeInternal",value:function(){for(var n=new ke,a=0;a<this._geometries.length;a++)n.expandToInclude(this._geometries[a].getEnvelopeInternal());return n}},{key:"getGeometryN",value:function(n){return this._geometries[n]}},{key:"getCoordinates",value:function(){for(var n=new Array(this.getNumPoints()).fill(null),a=-1,c=0;c<this._geometries.length;c++)for(var d=this._geometries[c].getCoordinates(),y=0;y<d.length;y++)n[++a]=d[y];return n}},{key:"getArea",value:function(){for(var n=0,a=0;a<this._geometries.length;a++)n+=this._geometries[a].getArea();return n}},{key:"copyInternal",value:function(){for(var n=new Array(this._geometries.length).fill(null),a=0;a<n.length;a++)n[a]=this._geometries[a].copy();return new t(n,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var n=arguments[0],a=arguments[1];if(!this.isEquivalentClass(n))return!1;var c=n;if(this._geometries.length!==c._geometries.length)return!1;for(var d=0;d<this._geometries.length;d++)if(!this._geometries[d].equalsExact(c._geometries[d],a))return!1;return!0}return N(f(t.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var n=0;n<this._geometries.length;n++)this._geometries[n].normalize();Tt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var n=z.FALSE,a=0;a<this._geometries.length;a++)n=Math.max(n,this._geometries[a].getBoundaryDimension());return n}},{key:"reverseInternal",value:function(){for(var n=this._geometries.length,a=new K(n),c=0;c<n;c++)a.add(this._geometries[c].reverse());return this.getFactory().buildGeometry(a)}},{key:"getTypeCode",value:function(){return V.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var n=z.FALSE,a=0;a<this._geometries.length;a++)n=Math.max(n,this._geometries[a].getDimension());return n}},{key:"getLength",value:function(){for(var n=0,a=0;a<this._geometries.length;a++)n+=this._geometries[a].getLength();return n}},{key:"getNumPoints",value:function(){for(var n=0,a=0;a<this._geometries.length;a++)n+=this._geometries[a].getNumPoints();return n}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var n=arguments[0],a=new Oi(Tt.asList(this._geometries)),c=new Oi(Tt.asList(n._geometries));return this.compare(a,c)}if(arguments.length===2){for(var d=arguments[0],y=arguments[1],p=d,E=this.getNumGeometries(),I=p.getNumGeometries(),L=0;L<E&&L<I;){var T=this.getGeometryN(L),q=p.getGeometryN(L),F=T.compareToSameClass(q,y);if(F!==0)return F;L++}return L<E?1:L<I?-1:0}}},{key:"apply",value:function(){if(oe(arguments[0],qn))for(var n=arguments[0],a=0;a<this._geometries.length;a++)this._geometries[a].apply(n);else if(oe(arguments[0],zn)){var c=arguments[0];if(this._geometries.length===0)return null;for(var d=0;d<this._geometries.length&&(this._geometries[d].apply(c),!c.isDone());d++);c.isGeometryChanged()&&this.geometryChanged()}else if(oe(arguments[0],Gn)){var y=arguments[0];y.filter(this);for(var p=0;p<this._geometries.length;p++)this._geometries[p].apply(y)}else if(oe(arguments[0],fe)){var E=arguments[0];E.filter(this);for(var I=0;I<this._geometries.length;I++)this._geometries[I].apply(E)}}},{key:"getBoundary",value:function(){return V.checkNotGeometryCollection(this),U.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return V.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var n=0;n<this._geometries.length;n++)if(!this._geometries[n].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var n=arguments[0],a=arguments[1];if(V.constructor_.call(this,a),n===null&&(n=[]),V.hasNullElements(n))throw new O("geometries must not contain null elements");this._geometries=n}}}}]),t}(V),Nr=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"copyInternal",value:function(){for(var n=new Array(this._geometries.length).fill(null),a=0;a<n.length;a++)n[a]=this._geometries[a].copy();return new t(n,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var n=arguments[0],a=arguments[1];return!!this.isEquivalentClass(n)&&N(f(t.prototype),"equalsExact",this).call(this,n,a)}return N(f(t.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var n=arguments[0];return this._geometries[n].getCoordinate()}return N(f(t.prototype),"getCoordinate",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return z.FALSE}},{key:"getTypeCode",value:function(){return V.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return V.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[Si]}}],[{key:"constructor_",value:function(){var n=arguments[0],a=arguments[1];Ke.constructor_.call(this,n,a)}}]),t}(Ke),fn=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"copyInternal",value:function(){return new t(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return z.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||N(f(t.prototype),"isClosed",this).call(this)}},{key:"reverseInternal",value:function(){var n=this._points.copy();return Ct.reverse(n),this.getFactory().createLinearRing(n)}},{key:"getTypeCode",value:function(){return V.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!N(f(t.prototype),"isClosed",this).call(this))throw new O("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new O("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return V.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var n=arguments[0],a=arguments[1];hn.constructor_.call(this,n,a),this.validateConstruction()}}]),t}(hn);fn.MINIMUM_VALID_SIZE=4;var Ot=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"setOrdinate",value:function(n,a){switch(n){case t.X:this.x=a;break;case t.Y:this.y=a;break;default:throw new O("Invalid ordinate index: "+n)}}},{key:"getZ",value:function(){return S.NULL_ORDINATE}},{key:"getOrdinate",value:function(n){switch(n){case t.X:return this.x;case t.Y:return this.y}throw new O("Invalid ordinate index: "+n)}},{key:"setZ",value:function(n){throw new O("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(n){this.x=n.x,this.y=n.y,this.z=n.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)S.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof t){var n=arguments[0];S.constructor_.call(this,n.x,n.y)}else if(arguments[0]instanceof S){var a=arguments[0];S.constructor_.call(this,a.x,a.y)}}else if(arguments.length===2){var c=arguments[0],d=arguments[1];S.constructor_.call(this,c,d,S.NULL_ORDINATE)}}}]),t}(S);Ot.X=0,Ot.Y=1,Ot.Z=-1,Ot.M=-1;var Rt=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(n,a){switch(n){case t.X:this.x=a;break;case t.Y:this.y=a;break;case t.M:this._m=a;break;default:throw new O("Invalid ordinate index: "+n)}}},{key:"setM",value:function(n){this._m=n}},{key:"getZ",value:function(){return S.NULL_ORDINATE}},{key:"getOrdinate",value:function(n){switch(n){case t.X:return this.x;case t.Y:return this.y;case t.M:return this._m}throw new O("Invalid ordinate index: "+n)}},{key:"setZ",value:function(n){throw new O("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(n){this.x=n.x,this.y=n.y,this.z=n.getZ(),this._m=n.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)S.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof t){var n=arguments[0];S.constructor_.call(this,n.x,n.y),this._m=n._m}else if(arguments[0]instanceof S){var a=arguments[0];S.constructor_.call(this,a.x,a.y),this._m=this.getM()}}else if(arguments.length===3){var c=arguments[0],d=arguments[1],y=arguments[2];S.constructor_.call(this,c,d,S.NULL_ORDINATE),this._m=y}}}]),t}(S);Rt.X=0,Rt.Y=1,Rt.Z=-1,Rt.M=2;var Pr=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(n,a){switch(n){case S.X:this.x=a;break;case S.Y:this.y=a;break;case S.Z:this.z=a;break;case S.M:this._m=a;break;default:throw new O("Invalid ordinate index: "+n)}}},{key:"setM",value:function(n){this._m=n}},{key:"getOrdinate",value:function(n){switch(n){case S.X:return this.x;case S.Y:return this.y;case S.Z:return this.getZ();case S.M:return this.getM()}throw new O("Invalid ordinate index: "+n)}},{key:"copy",value:function(){return new t(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(n){this.x=n.x,this.y=n.y,this.z=n.getZ(),this._m=n.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)S.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof t){var n=arguments[0];S.constructor_.call(this,n),this._m=n._m}else if(arguments[0]instanceof S){var a=arguments[0];S.constructor_.call(this,a),this._m=this.getM()}}else if(arguments.length===4){var c=arguments[0],d=arguments[1],y=arguments[2],p=arguments[3];S.constructor_.call(this,c,d,y),this._m=p}}}]),t}(S),Yn=function(){function u(){i(this,u)}return l(u,null,[{key:"measures",value:function(e){return e instanceof Ot?0:e instanceof Rt||e instanceof Pr?1:0}},{key:"dimension",value:function(e){return e instanceof Ot?2:e instanceof Rt?3:e instanceof Pr?4:3}},{key:"create",value:function(){if(arguments.length===1){var e=arguments[0];return u.create(e,0)}if(arguments.length===2){var t=arguments[0],n=arguments[1];return t===2?new Ot:t===3&&n===0?new S:t===3&&n===1?new Rt:t===4&&n===1?new Pr:new S}}}]),u}(),gn=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"getCoordinate",value:function(n){return this.get(n)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&oe(arguments[0],nt)){for(var n=arguments[0],a=arguments[1],c=!1,d=n.iterator();d.hasNext();)this.add(d.next(),a),c=!0;return c}return N(f(t.prototype),"addAll",this).apply(this,arguments)}},{key:"clone",value:function(){for(var n=N(f(t.prototype),"clone",this).call(this),a=0;a<this.size();a++)n.add(a,this.get(a).clone());return n}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(t.coordArrayType);if(arguments.length===1){var n=arguments[0];if(n)return this.toArray(t.coordArrayType);for(var a=this.size(),c=new Array(a).fill(null),d=0;d<a;d++)c[d]=this.get(a-d-1);return c}}},{key:"add",value:function(){if(arguments.length===1){var n=arguments[0];return N(f(t.prototype),"add",this).call(this,n)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var a=arguments[0],c=arguments[1];return this.add(a,c,!0),!0}if(arguments[0]instanceof S&&typeof arguments[1]=="boolean"){var d=arguments[0],y=arguments[1];if(!y&&this.size()>=1){var p=this.get(this.size()-1);if(p.equals2D(d))return null}N(f(t.prototype),"add",this).call(this,d)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var E=arguments[0],I=arguments[1];return this.add(E,I),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var L=arguments[0],T=arguments[1],q=arguments[2];if(q)for(var F=0;F<L.length;F++)this.add(L[F],T);else for(var H=L.length-1;H>=0;H--)this.add(L[H],T);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof S){var $=arguments[0],te=arguments[1],Ee=arguments[2];if(!Ee){var Se=this.size();if(Se>0){if($>0){var Xe=this.get($-1);if(Xe.equals2D(te))return null}if($<Se){var et=this.get($);if(et.equals2D(te))return null}}}N(f(t.prototype),"add",this).call(this,$,te)}}else if(arguments.length===4){var ct=arguments[0],Et=arguments[1],Ft=arguments[2],pn=arguments[3],_n=1;Ft>pn&&(_n=-1);for(var en=Ft;en!==pn;en+=_n)this.add(ct[en],Et);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var n=this.get(0).copy();this.add(n,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var n=arguments[0];this.ensureCapacity(n.length),this.add(n,!0)}else if(arguments.length===2){var a=arguments[0],c=arguments[1];this.ensureCapacity(a.length),this.add(a,c)}}}}]),t}(K);gn.coordArrayType=new Array(0).fill(null);var Ge=function(){function u(){i(this,u)}return l(u,null,[{key:"isRing",value:function(e){return!(e.length<4)&&!!e[0].equals2D(e[e.length-1])}},{key:"ptNotInList",value:function(e,t){for(var n=0;n<e.length;n++){var a=e[n];if(u.indexOf(a,t)<0)return a}return null}},{key:"scroll",value:function(e,t){var n=u.indexOf(t,e);if(n<0)return null;var a=new Array(e.length).fill(null);rt.arraycopy(e,n,a,0,e.length-n),rt.arraycopy(e,0,a,e.length-n,n),rt.arraycopy(a,0,e,0,e.length)}},{key:"equals",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];if(e===t)return!0;if(e===null||t===null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].equals(t[n]))return!1;return!0}if(arguments.length===3){var a=arguments[0],c=arguments[1],d=arguments[2];if(a===c)return!0;if(a===null||c===null||a.length!==c.length)return!1;for(var y=0;y<a.length;y++)if(d.compare(a[y],c[y])!==0)return!1;return!0}}},{key:"intersection",value:function(e,t){for(var n=new gn,a=0;a<e.length;a++)t.intersects(e[a])&&n.add(e[a],!0);return n.toCoordinateArray()}},{key:"measures",value:function(e){if(e===null||e.length===0)return 0;var t,n=0,a=M(e);try{for(a.s();!(t=a.n()).done;){var c=t.value;n=Math.max(n,Yn.measures(c))}}catch(d){a.e(d)}finally{a.f()}return n}},{key:"hasRepeatedPoints",value:function(e){for(var t=1;t<e.length;t++)if(e[t-1].equals(e[t]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(e){return u.hasRepeatedPoints(e)?new gn(e,!1).toCoordinateArray():e}},{key:"reverse",value:function(e){for(var t=e.length-1,n=Math.trunc(t/2),a=0;a<=n;a++){var c=e[a];e[a]=e[t-a],e[t-a]=c}}},{key:"removeNull",value:function(e){for(var t=0,n=0;n<e.length;n++)e[n]!==null&&t++;var a=new Array(t).fill(null);if(t===0)return a;for(var c=0,d=0;d<e.length;d++)e[d]!==null&&(a[c++]=e[d]);return a}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var e=arguments[0],t=new Array(e.length).fill(null),n=0;n<e.length;n++)t[n]=e[n].copy();return t}if(arguments.length===5)for(var a=arguments[0],c=arguments[1],d=arguments[2],y=arguments[3],p=arguments[4],E=0;E<p;E++)d[y+E]=a[c+E].copy()}},{key:"isEqualReversed",value:function(e,t){for(var n=0;n<e.length;n++){var a=e[n],c=t[e.length-n-1];if(a.compareTo(c)!==0)return!1}return!0}},{key:"envelope",value:function(e){for(var t=new ke,n=0;n<e.length;n++)t.expandToInclude(e[n]);return t}},{key:"toCoordinateArray",value:function(e){return e.toArray(u.coordArrayType)}},{key:"dimension",value:function(e){if(e===null||e.length===0)return 3;var t,n=0,a=M(e);try{for(a.s();!(t=a.n()).done;){var c=t.value;n=Math.max(n,Yn.dimension(c))}}catch(d){a.e(d)}finally{a.f()}return n}},{key:"atLeastNCoordinatesOrNothing",value:function(e,t){return t.length>=e?t:[]}},{key:"indexOf",value:function(e,t){for(var n=0;n<t.length;n++)if(e.equals(t[n]))return n;return-1}},{key:"increasingDirection",value:function(e){for(var t=0;t<Math.trunc(e.length/2);t++){var n=e.length-1-t,a=e[t].compareTo(e[n]);if(a!==0)return a}return 1}},{key:"compare",value:function(e,t){for(var n=0;n<e.length&&n<t.length;){var a=e[n].compareTo(t[n]);if(a!==0)return a;n++}return n<t.length?-1:n<e.length?1:0}},{key:"minCoordinate",value:function(e){for(var t=null,n=0;n<e.length;n++)(t===null||t.compareTo(e[n])>0)&&(t=e[n]);return t}},{key:"extract",value:function(e,t,n){t=cn.clamp(t,0,e.length);var a=(n=cn.clamp(n,-1,e.length))-t+1;n<0&&(a=0),t>=e.length&&(a=0),n<t&&(a=0);var c=new Array(a).fill(null);if(a===0)return c;for(var d=0,y=t;y<=n;y++)c[d++]=e[y];return c}}]),u}(),Ho=function(){function u(){i(this,u)}return l(u,[{key:"compare",value:function(e,t){var n=e,a=t;return Ge.compare(n,a)}},{key:"interfaces_",get:function(){return[tt]}}]),u}(),Zo=function(){function u(){i(this,u)}return l(u,[{key:"compare",value:function(e,t){var n=e,a=t;if(n.length<a.length)return-1;if(n.length>a.length)return 1;if(n.length===0)return 0;var c=Ge.compare(n,a);return Ge.isEqualReversed(n,a)?0:c}},{key:"OLDcompare",value:function(e,t){var n=e,a=t;if(n.length<a.length)return-1;if(n.length>a.length)return 1;if(n.length===0)return 0;for(var c=Ge.increasingDirection(n),d=Ge.increasingDirection(a),y=c>0?0:n.length-1,p=d>0?0:n.length-1,E=0;E<n.length;E++){var I=n[y].compareTo(a[p]);if(I!==0)return I;y+=c,p+=d}return 0}},{key:"interfaces_",get:function(){return[tt]}}]),u}();Ge.ForwardComparator=Ho,Ge.BidirectionalComparator=Zo,Ge.coordArrayType=new Array(0).fill(null);var Xn=function(){function u(e){i(this,u),this.str=e}return l(u,[{key:"append",value:function(e){this.str+=e}},{key:"setCharAt",value:function(e,t){this.str=this.str.substr(0,e)+t+this.str.substr(e+1)}},{key:"toString",value:function(){return this.str}}]),u}(),dn=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getM",value:function(e){return this.hasM()?this._coordinates[e].getM():X.NaN}},{key:"setOrdinate",value:function(e,t,n){switch(t){case ge.X:this._coordinates[e].x=n;break;case ge.Y:this._coordinates[e].y=n;break;default:this._coordinates[e].setOrdinate(t,n)}}},{key:"getZ",value:function(e){return this.hasZ()?this._coordinates[e].getZ():X.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(e,t){switch(t){case ge.X:return this._coordinates[e].x;case ge.Y:return this._coordinates[e].y;default:return this._coordinates[e].getOrdinate(t)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var e=arguments[0];return this._coordinates[e]}if(arguments.length===2){var t=arguments[0],n=arguments[1];n.setCoordinate(this._coordinates[t])}}},{key:"getCoordinateCopy",value:function(e){var t=this.createCoordinate();return t.setCoordinate(this._coordinates[e]),t}},{key:"createCoordinate",value:function(){return Yn.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(e){return this._coordinates[e].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(e){for(var t=0;t<this._coordinates.length;t++)e.expandToInclude(this._coordinates[t]);return e}},{key:"copy",value:function(){for(var e=new Array(this.size()).fill(null),t=0;t<this._coordinates.length;t++){var n=this.createCoordinate();n.setCoordinate(this._coordinates[t]),e[t]=n}return new u(e,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var e=new Xn(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var t=1;t<this._coordinates.length;t++)e.append(", "),e.append(this._coordinates[t]);return e.append(")"),e.toString()}return"()"}},{key:"getY",value:function(e){return this._coordinates[e].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[ge,Z]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];u.constructor_.call(this,e,Ge.dimension(e),Ge.measures(e))}else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var n=0;n<t;n++)this._coordinates[n]=new S}else if(oe(arguments[0],ge)){var a=arguments[0];if(a===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=a.getDimension(),this._measures=a.getMeasures(),this._coordinates=new Array(a.size()).fill(null);for(var c=0;c<this._coordinates.length;c++)this._coordinates[c]=a.getCoordinateCopy(c)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var d=arguments[0],y=arguments[1];u.constructor_.call(this,d,y,Ge.measures(d))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var p=arguments[0],E=arguments[1];this._coordinates=new Array(p).fill(null),this._dimension=E;for(var I=0;I<p;I++)this._coordinates[I]=Yn.create(E)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var L=arguments[0],T=arguments[1],q=arguments[2];this._dimension=T,this._measures=q,this._coordinates=L===null?new Array(0).fill(null):L}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var F=arguments[0],H=arguments[1],$=arguments[2];this._coordinates=new Array(F).fill(null),this._dimension=H,this._measures=$;for(var te=0;te<F;te++)this._coordinates[te]=this.createCoordinate()}}}}]),u}(),Mr=function(){function u(){i(this,u)}return l(u,[{key:"readResolve",value:function(){return u.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return new dn(e)}if(oe(arguments[0],ge)){var t=arguments[0];return new dn(t)}}else{if(arguments.length===2){var n=arguments[0],a=arguments[1];return a>3&&(a=3),a<2&&(a=2),new dn(n,a)}if(arguments.length===3){var c=arguments[0],d=arguments[1],y=arguments[2],p=d-y;return y>1&&(y=1),p>3&&(p=3),p<2&&(p=2),new dn(c,p+y,y)}}}},{key:"interfaces_",get:function(){return[Li,Z]}}],[{key:"instance",value:function(){return u.instanceObject}}]),u}();Mr.instanceObject=new Mr;var Lr=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"copyInternal",value:function(){for(var n=new Array(this._geometries.length).fill(null),a=0;a<n.length;a++)n[a]=this._geometries[a].copy();return new t(n,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var n=arguments[0],a=arguments[1];return!!this.isEquivalentClass(n)&&N(f(t.prototype),"equalsExact",this).call(this,n,a)}return N(f(t.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return V.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var n=new K,a=0;a<this._geometries.length;a++)for(var c=this._geometries[a].getBoundary(),d=0;d<c.getNumGeometries();d++)n.add(c.getGeometryN(d));var y=new Array(n.size()).fill(null);return this.getFactory().createMultiLineString(n.toArray(y))}},{key:"getGeometryType",value:function(){return V.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Ti]}}],[{key:"constructor_",value:function(){var n=arguments[0],a=arguments[1];Ke.constructor_.call(this,n,a)}}]),t}(Ke),Ri=function(){function u(){i(this,u)}return l(u,[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}]),u}(),Wo=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),(n=e.call(this)).map=new Map,n}return l(t,[{key:"get",value:function(n){return this.map.get(n)||null}},{key:"put",value:function(n,a){return this.map.set(n,a),a}},{key:"values",value:function(){for(var n=new K,a=this.map.values(),c=a.next();!c.done;)n.add(c.value),c=a.next();return n}},{key:"entrySet",value:function(){var n=new xr;return this.map.entries().forEach(function(a){return n.add(a)}),n}},{key:"size",value:function(){return this.map.size()}}]),t}(Ri),ut=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"equals",value:function(e){if(!(e instanceof u))return!1;var t=e;return this._modelType===t._modelType&&this._scale===t._scale}},{key:"compareTo",value:function(e){var t=e,n=this.getMaximumSignificantDigits(),a=t.getMaximumSignificantDigits();return Fn.compare(n,a)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===u.FLOATING||this._modelType===u.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var e="UNKNOWN";return this._modelType===u.FLOATING?e="Floating":this._modelType===u.FLOATING_SINGLE?e="Floating-Single":this._modelType===u.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var e=arguments[0];return X.isNaN(e)||this._modelType===u.FLOATING_SINGLE?e:this._modelType===u.FIXED?Math.round(e*this._scale)/this._scale:e}if(arguments[0]instanceof S){var t=arguments[0];if(this._modelType===u.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}},{key:"getMaximumSignificantDigits",value:function(){var e=16;return this._modelType===u.FLOATING?e=16:this._modelType===u.FLOATING_SINGLE?e=6:this._modelType===u.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e}},{key:"setScale",value:function(e){this._scale=Math.abs(e)}},{key:"interfaces_",get:function(){return[Z,B]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=u.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Zt){var e=arguments[0];this._modelType=e,e===u.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var t=arguments[0];this._modelType=u.FIXED,this.setScale(t)}else if(arguments[0]instanceof u){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}}}},{key:"mostPrecise",value:function(e,t){return e.compareTo(t)>=0?e:t}}]),u}(),Zt=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"readResolve",value:function(){return u.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[Z]}}],[{key:"constructor_",value:function(){this._name=null;var e=arguments[0];this._name=e,u.nameToTypeMap.put(e,this)}}]),u}();Zt.nameToTypeMap=new Wo,ut.Type=Zt,ut.FIXED=new Zt("FIXED"),ut.FLOATING=new Zt("FLOATING"),ut.FLOATING_SINGLE=new Zt("FLOATING SINGLE"),ut.maximumPreciseValue=9007199254740992;var br=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"copyInternal",value:function(){for(var n=new Array(this._geometries.length).fill(null),a=0;a<n.length;a++)n[a]=this._geometries[a].copy();return new t(n,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){var n=arguments[0],a=arguments[1];return!!this.isEquivalentClass(n)&&N(f(t.prototype),"equalsExact",this).call(this,n,a)}return N(f(t.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?z.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var n=0;n<this._geometries.length;n++)if(!this._geometries[n].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return V.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new ft}},{key:"getGeometryType",value:function(){return V.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[bi]}}],[{key:"constructor_",value:function(){var n=arguments[0],a=arguments[1];Ke.constructor_.call(this,n,a)}}]),t}(Ke),Wt=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"createEmpty",value:function(e){switch(e){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new O("Invalid dimension: "+e)}}},{key:"toGeometry",value:function(e){return e.isNull()?this.createPoint():e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new S(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new S(e.getMinX(),e.getMinY()),new S(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new S(e.getMinX(),e.getMinY()),new S(e.getMinX(),e.getMaxY()),new S(e.getMaxX(),e.getMaxY()),new S(e.getMaxX(),e.getMinY()),new S(e.getMinX(),e.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLineString(e!==null?this.getCoordinateSequenceFactory().create(e):null)}if(oe(arguments[0],ge)){var t=arguments[0];return new hn(t,this)}}}},{key:"createMultiLineString",value:function(){if(arguments.length===0)return new br(null,this);if(arguments.length===1){var e=arguments[0];return new br(e,this)}}},{key:"buildGeometry",value:function(e){for(var t=null,n=!1,a=!1,c=e.iterator();c.hasNext();){var d=c.next(),y=d.getTypeCode();t===null&&(t=y),y!==t&&(n=!0),d instanceof Ke&&(a=!0)}if(t===null)return this.createGeometryCollection();if(n||a)return this.createGeometryCollection(u.toGeometryArray(e));var p=e.iterator().next();if(e.size()>1){if(p instanceof Bn)return this.createMultiPolygon(u.toPolygonArray(e));if(p instanceof hn)return this.createMultiLineString(u.toLineStringArray(e));if(p instanceof Ir)return this.createMultiPoint(u.toPointArray(e));U.shouldNeverReachHere("Unhandled geometry type: "+p.getGeometryType())}return p}},{key:"createMultiPointFromCoords",value:function(e){return this.createMultiPoint(e!==null?this.getCoordinateSequenceFactory().create(e):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof S){var e=arguments[0];return this.createPoint(e!==null?this.getCoordinateSequenceFactory().create([e]):null)}if(oe(arguments[0],ge)){var t=arguments[0];return new Ir(t,this)}}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(oe(arguments[0],ge)){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Array){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof fn){var n=arguments[0];return this.createPolygon(n,null)}}else if(arguments.length===2){var a=arguments[0],c=arguments[1];return new Bn(a,c,this)}}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){if(arguments.length===0)return new Ke(null,this);if(arguments.length===1){var e=arguments[0];return new Ke(e,this)}}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(e!==null?this.getCoordinateSequenceFactory().create(e):null)}if(oe(arguments[0],ge)){var t=arguments[0];return new fn(t,this)}}}},{key:"createMultiPolygon",value:function(){if(arguments.length===0)return new Lr(null,this);if(arguments.length===1){var e=arguments[0];return new Lr(e,this)}}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Nr(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return new Nr(e,this)}if(oe(arguments[0],ge)){var t=arguments[0];if(t===null)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(t.size()).fill(null),a=0;a<t.size();a++){var c=this.getCoordinateSequenceFactory().create(1,t.getDimension(),t.getMeasures());Ct.copy(t,a,c,0,1),n[a]=this.createPoint(c)}return this.createMultiPoint(n)}}}},{key:"interfaces_",get:function(){return[Z]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)u.constructor_.call(this,new ut,0);else if(arguments.length===1){if(oe(arguments[0],Li)){var e=arguments[0];u.constructor_.call(this,new ut,0,e)}else if(arguments[0]instanceof ut){var t=arguments[0];u.constructor_.call(this,t,0,u.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var n=arguments[0],a=arguments[1];u.constructor_.call(this,n,a,u.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var c=arguments[0],d=arguments[1],y=arguments[2];this._precisionModel=c,this._coordinateSequenceFactory=y,this._SRID=d}}},{key:"toMultiPolygonArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toGeometryArray",value:function(e){if(e===null)return null;var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Mr.instance()}},{key:"toMultiLineStringArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toLineStringArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toMultiPointArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toLinearRingArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toPointArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toPolygonArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"createPointFromInternalCoord",value:function(e,t){return t.getPrecisionModel().makePrecise(e),t.getFactory().createPoint(e)}}]),u}(),Sr="XY",$o="XYZ",Jo="XYM",Ko="XYZM",Ai={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Di="EMPTY",Un=1,_t=2,Mt=3,Fi=4,$t=5,Qo=6;for(var jo in Ai)Ai[jo].toUpperCase();var eu=function(){function u(e){i(this,u),this.wkt=e,this.index_=-1}return l(u,[{key:"isAlpha_",value:function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}},{key:"isNumeric_",value:function(e,t){return e>="0"&&e<="9"||e=="."&&!(t!==void 0&&t)}},{key:"isWhiteSpace_",value:function(e){return e==" "||e=="	"||e=="\r"||e==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var e,t=this.nextChar_(),n=this.index_,a=t;if(t=="(")e=_t;else if(t==",")e=$t;else if(t==")")e=Mt;else if(this.isNumeric_(t)||t=="-")e=Fi,a=this.readNumber_();else if(this.isAlpha_(t))e=Un,a=this.readText_();else{if(this.isWhiteSpace_(t))return this.nextToken();if(t!=="")throw new Error("Unexpected character: "+t);e=Qo}return{position:n,value:a,type:e}}},{key:"readNumber_",value:function(){var e,t=this.index_,n=!1,a=!1;do e=="."?n=!0:e!="e"&&e!="E"||(a=!0),e=this.nextChar_();while(this.isNumeric_(e,n)||!a&&(e=="e"||e=="E")||a&&(e=="-"||e=="+"));return parseFloat(this.wkt.substring(t,this.index_--))}},{key:"readText_",value:function(){var e,t=this.index_;do e=this.nextChar_();while(this.isAlpha_(e));return this.wkt.substring(t,this.index_--).toUpperCase()}}]),u}(),tu=function(){function u(e,t){i(this,u),this.lexer_=e,this.token_,this.layout_=Sr,this.factory=t}return l(u,[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(e){return this.token_.type==e}},{key:"match",value:function(e){var t=this.isTokenType(e);return t&&this.consume_(),t}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var e=Sr,t=this.token_;if(this.isTokenType(Un)){var n=t.value;n==="Z"?e=$o:n==="M"?e=Jo:n==="ZM"&&(e=Ko),e!==Sr&&this.consume_()}return e}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(_t)){var e=[];do e.push(this.parseGeometry_());while(this.match($t));if(this.match(Mt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(_t)){var e=this.parsePoint_();if(this.match(Mt))return e}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(_t)){var e=this.parsePointList_();if(this.match(Mt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(_t)){var e=this.parseLineStringTextList_();if(this.match(Mt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var e;if(this.match(_t)){if(e=this.token_.type==_t?this.parsePointTextList_():this.parsePointList_(),this.match(Mt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(_t)){var e=this.parseLineStringTextList_();if(this.match(Mt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(_t)){var e=this.parsePolygonTextList_();if(this.match(Mt))return e}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var e=[],t=this.layout_.length,n=0;n<t;++n){var a=this.token_;if(!this.match(Fi))break;e.push(a.value)}if(e.length==t)return e;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var e=[this.parsePoint_()];this.match($t);)e.push(this.parsePoint_());return e}},{key:"parsePointTextList_",value:function(){for(var e=[this.parsePointText_()];this.match($t);)e.push(this.parsePointText_());return e}},{key:"parseLineStringTextList_",value:function(){for(var e=[this.parseLineStringText_()];this.match($t);)e.push(this.parseLineStringText_());return e}},{key:"parsePolygonTextList_",value:function(){for(var e=[this.parsePolygonText_()];this.match($t);)e.push(this.parsePolygonText_());return e}},{key:"isEmptyGeometry_",value:function(){var e=this.isTokenType(Un)&&this.token_.value==Di;return e&&this.consume_(),e}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var e=this.factory,t=function($){return m(S,C($))},n=function($){var te=$.map(function(Ee){return e.createLinearRing(Ee.map(t))});return te.length>1?e.createPolygon(te[0],te.slice(1)):e.createPolygon(te[0])},a=this.token_;if(this.match(Un)){var c=a.value;if(this.layout_=this.parseGeometryLayout_(),c=="GEOMETRYCOLLECTION"){var d=this.parseGeometryCollectionText_();return e.createGeometryCollection(d)}switch(c){case"POINT":var y=this.parsePointText_();return y?e.createPoint(m(S,C(y))):e.createPoint();case"LINESTRING":var p=this.parseLineStringText_().map(t);return e.createLineString(p);case"LINEARRING":var E=this.parseLineStringText_().map(t);return e.createLinearRing(E);case"POLYGON":var I=this.parsePolygonText_();return I&&I.length!==0?n(I):e.createPolygon();case"MULTIPOINT":var L=this.parseMultiPointText_();if(!L||L.length===0)return e.createMultiPoint();var T=L.map(t).map(function($){return e.createPoint($)});return e.createMultiPoint(T);case"MULTILINESTRING":var q=this.parseMultiLineStringText_().map(function($){return e.createLineString($.map(t))});return e.createMultiLineString(q);case"MULTIPOLYGON":var F=this.parseMultiPolygonText_();if(!F||F.length===0)return e.createMultiPolygon();var H=F.map(n);return e.createMultiPolygon(H);default:throw new Error("Invalid geometry type: "+c)}}throw new Error(this.formatErrorMessage_())}}]),u}();function qi(u){if(u.isEmpty())return"";var e=u.getCoordinate(),t=[e.x,e.y];return e.z===void 0||Number.isNaN(e.z)||t.push(e.z),e.m===void 0||Number.isNaN(e.m)||t.push(e.m),t.join(" ")}function vn(u){for(var e=u.getCoordinates().map(function(c){var d=[c.x,c.y];return c.z===void 0||Number.isNaN(c.z)||d.push(c.z),c.m===void 0||Number.isNaN(c.m)||d.push(c.m),d}),t=[],n=0,a=e.length;n<a;++n)t.push(e[n].join(" "));return t.join(", ")}function Gi(u){var e=[];e.push("("+vn(u.getExteriorRing())+")");for(var t=0,n=u.getNumInteriorRing();t<n;++t)e.push("("+vn(u.getInteriorRingN(t))+")");return e.join(", ")}var nu={Point:qi,LineString:vn,LinearRing:vn,Polygon:Gi,MultiPoint:function(u){for(var e=[],t=0,n=u.getNumGeometries();t<n;++t)e.push("("+qi(u.getGeometryN(t))+")");return e.join(", ")},MultiLineString:function(u){for(var e=[],t=0,n=u.getNumGeometries();t<n;++t)e.push("("+vn(u.getGeometryN(t))+")");return e.join(", ")},MultiPolygon:function(u){for(var e=[],t=0,n=u.getNumGeometries();t<n;++t)e.push("("+Gi(u.getGeometryN(t))+")");return e.join(", ")},GeometryCollection:function(u){for(var e=[],t=0,n=u.getNumGeometries();t<n;++t)e.push(zi(u.getGeometryN(t)));return e.join(", ")}};function zi(u){var e=u.getGeometryType(),t=nu[e];e=e.toUpperCase();var n=function(a){var c="";if(a.isEmpty())return c;var d=a.getCoordinate();return d.z===void 0||Number.isNaN(d.z)||(c+="Z"),d.m===void 0||Number.isNaN(d.m)||(c+="M"),c}(u);return n.length>0&&(e+=" "+n),u.isEmpty()?e+" "+Di:e+" ("+t(u)+")"}var ru=function(){function u(e){i(this,u),this.geometryFactory=e||new Wt,this.precisionModel=this.geometryFactory.getPrecisionModel()}return l(u,[{key:"read",value:function(e){var t=new eu(e);return new tu(t,this.geometryFactory).parse()}},{key:"write",value:function(e){return zi(e)}}]),u}(),Cr=function(){function u(e){i(this,u),this.parser=new ru(e)}return l(u,[{key:"write",value:function(e){return this.parser.write(e)}}],[{key:"toLineString",value:function(e,t){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+t.x+" "+t.y+" )"}}]),u}(),be=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getIndexAlongSegment",value:function(e,t){return this.computeIntLineIndex(),this._intLineIndex[e][t]}},{key:"getTopologySummary",value:function(){var e=new Xn;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()}},{key:"computeIntersection",value:function(e,t,n,a){this._inputLines[0][0]=e,this._inputLines[0][1]=t,this._inputLines[1][0]=n,this._inputLines[1][1]=a,this._result=this.computeIntersect(e,t,n,a)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var e=arguments[0],t=this.getEdgeDistance(e,0),n=this.getEdgeDistance(e,1);t>n?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(e){this._precisionModel=e}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var e=arguments[0],t=0;t<this._result;t++)if(!this._intPt[t].equals2D(this._inputLines[e][0])&&!this._intPt[t].equals2D(this._inputLines[e][1]))return!0;return!1}}},{key:"getIntersection",value:function(e){return this._intPt[e]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==u.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(e,t){return u.computeEdgeDistance(this._intPt[t],this._inputLines[e][0],this._inputLines[e][1])}},{key:"isCollinear",value:function(){return this._result===u.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return Cr.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Cr.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(e,t){return this._inputLines[e][t]}},{key:"isIntersection",value:function(e){for(var t=0;t<this._result;t++)if(this._intPt[t].equals2D(e))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(e,t){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][t]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new S,this._intPt[1]=new S,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(e,t,n){var a=Math.abs(n.x-t.x),c=Math.abs(n.y-t.y),d=-1;if(e.equals(t))d=0;else if(e.equals(n))d=a>c?a:c;else{var y=Math.abs(e.x-t.x),p=Math.abs(e.y-t.y);(d=a>c?y:p)!==0||e.equals(t)||(d=Math.max(y,p))}return U.isTrue(!(d===0&&!e.equals(t)),"Bad distance calculation"),d}},{key:"nonRobustComputeEdgeDistance",value:function(e,t,n){var a=e.x-t.x,c=e.y-t.y,d=Math.sqrt(a*a+c*c);return U.isTrue(!(d===0&&!e.equals(t)),"Invalid distance calculation"),d}}]),u}();be.DONT_INTERSECT=0,be.DO_INTERSECT=1,be.COLLINEAR=2,be.NO_INTERSECTION=0,be.POINT_INTERSECTION=1,be.COLLINEAR_INTERSECTION=2;var At=function(u){h(t,u);var e=k(t);function t(){return i(this,t),e.call(this)}return l(t,[{key:"isInSegmentEnvelopes",value:function(n){var a=new ke(this._inputLines[0][0],this._inputLines[0][1]),c=new ke(this._inputLines[1][0],this._inputLines[1][1]);return a.contains(n)&&c.contains(n)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return N(f(t.prototype),"computeIntersection",this).apply(this,arguments);var n=arguments[0],a=arguments[1],c=arguments[2];if(this._isProper=!1,ke.intersects(a,c,n)&&ee.index(a,c,n)===0&&ee.index(c,a,n)===0)return this._isProper=!0,(n.equals(a)||n.equals(c))&&(this._isProper=!1),this._result=be.POINT_INTERSECTION,null;this._result=be.NO_INTERSECTION}},{key:"intersection",value:function(n,a,c,d){var y=this.intersectionSafe(n,a,c,d);return this.isInSegmentEnvelopes(y)||(y=new S(t.nearestEndpoint(n,a,c,d))),this._precisionModel!==null&&this._precisionModel.makePrecise(y),y}},{key:"checkDD",value:function(n,a,c,d,y){var p=kr.intersection(n,a,c,d),E=this.isInSegmentEnvelopes(p);rt.out.println("DD in env = "+E+"  --------------------- "+p),y.distance(p)>1e-4&&rt.out.println("Distance = "+y.distance(p))}},{key:"intersectionSafe",value:function(n,a,c,d){var y=wr.intersection(n,a,c,d);return y===null&&(y=t.nearestEndpoint(n,a,c,d)),y}},{key:"computeCollinearIntersection",value:function(n,a,c,d){var y=ke.intersects(n,a,c),p=ke.intersects(n,a,d),E=ke.intersects(c,d,n),I=ke.intersects(c,d,a);return y&&p?(this._intPt[0]=c,this._intPt[1]=d,be.COLLINEAR_INTERSECTION):E&&I?(this._intPt[0]=n,this._intPt[1]=a,be.COLLINEAR_INTERSECTION):y&&E?(this._intPt[0]=c,this._intPt[1]=n,!c.equals(n)||p||I?be.COLLINEAR_INTERSECTION:be.POINT_INTERSECTION):y&&I?(this._intPt[0]=c,this._intPt[1]=a,!c.equals(a)||p||E?be.COLLINEAR_INTERSECTION:be.POINT_INTERSECTION):p&&E?(this._intPt[0]=d,this._intPt[1]=n,!d.equals(n)||y||I?be.COLLINEAR_INTERSECTION:be.POINT_INTERSECTION):p&&I?(this._intPt[0]=d,this._intPt[1]=a,!d.equals(a)||y||E?be.COLLINEAR_INTERSECTION:be.POINT_INTERSECTION):be.NO_INTERSECTION}},{key:"computeIntersect",value:function(n,a,c,d){if(this._isProper=!1,!ke.intersects(n,a,c,d))return be.NO_INTERSECTION;var y=ee.index(n,a,c),p=ee.index(n,a,d);if(y>0&&p>0||y<0&&p<0)return be.NO_INTERSECTION;var E=ee.index(c,d,n),I=ee.index(c,d,a);return E>0&&I>0||E<0&&I<0?be.NO_INTERSECTION:y===0&&p===0&&E===0&&I===0?this.computeCollinearIntersection(n,a,c,d):(y===0||p===0||E===0||I===0?(this._isProper=!1,n.equals2D(c)||n.equals2D(d)?this._intPt[0]=n:a.equals2D(c)||a.equals2D(d)?this._intPt[0]=a:y===0?this._intPt[0]=new S(c):p===0?this._intPt[0]=new S(d):E===0?this._intPt[0]=new S(n):I===0&&(this._intPt[0]=new S(a))):(this._isProper=!0,this._intPt[0]=this.intersection(n,a,c,d)),be.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(n,a,c,d){var y=n,p=gt.pointToSegment(n,c,d),E=gt.pointToSegment(a,c,d);return E<p&&(p=E,y=a),(E=gt.pointToSegment(c,n,a))<p&&(p=E,y=c),(E=gt.pointToSegment(d,n,a))<p&&(p=E,y=d),y}}]),t}(be),iu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"countSegment",value:function(e,t){if(e.x<this._p.x&&t.x<this._p.x)return null;if(this._p.x===t.x&&this._p.y===t.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&t.y===this._p.y){var n=e.x,a=t.x;return n>a&&(n=t.x,a=e.x),this._p.x>=n&&this._p.x<=a&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&t.y<=this._p.y||t.y>this._p.y&&e.y<=this._p.y){var c=ee.index(e,t,this._p);if(c===ee.COLLINEAR)return this._isPointOnSegment=!0,null;t.y<e.y&&(c=-c),c===ee.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==w.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?w.BOUNDARY:this._crossingCount%2==1?w.INTERIOR:w.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var e=arguments[0];this._p=e}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof S&&oe(arguments[1],ge)){for(var e=arguments[0],t=arguments[1],n=new u(e),a=new S,c=new S,d=1;d<t.size();d++)if(t.getCoordinate(d,a),t.getCoordinate(d-1,c),n.countSegment(a,c),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof S&&arguments[1]instanceof Array){for(var y=arguments[0],p=arguments[1],E=new u(y),I=1;I<p.length;I++){var L=p[I],T=p[I-1];if(E.countSegment(L,T),E.isOnSegment())return E.getLocation()}return E.getLocation()}}}]),u}(),Tr=function(){function u(){i(this,u)}return l(u,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof S&&oe(arguments[1],ge)){for(var e=arguments[0],t=arguments[1],n=new At,a=new S,c=new S,d=t.size(),y=1;y<d;y++)if(t.getCoordinate(y-1,a),t.getCoordinate(y,c),n.computeIntersection(e,a,c),n.hasIntersection())return!0;return!1}if(arguments[0]instanceof S&&arguments[1]instanceof Array){for(var p=arguments[0],E=arguments[1],I=new At,L=1;L<E.length;L++){var T=E[L-1],q=E[L];if(I.computeIntersection(p,T,q),I.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(e,t){return iu.locatePointInRing(e,t)}},{key:"isInRing",value:function(e,t){return u.locateInRing(e,t)!==w.EXTERIOR}}]),u}(),it=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"setAllLocations",value:function(e){for(var t=0;t<this.location.length;t++)this.location[t]=e}},{key:"isNull",value:function(){for(var e=0;e<this.location.length;e++)if(this.location[e]!==w.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(e){for(var t=0;t<this.location.length;t++)this.location[t]===w.NONE&&(this.location[t]=e)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(e){if(e.location.length>this.location.length){var t=new Array(3).fill(null);t[G.ON]=this.location[G.ON],t[G.LEFT]=w.NONE,t[G.RIGHT]=w.NONE,this.location=t}for(var n=0;n<this.location.length;n++)this.location[n]===w.NONE&&n<e.location.length&&(this.location[n]=e.location[n])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var e=this.location[G.LEFT];this.location[G.LEFT]=this.location[G.RIGHT],this.location[G.RIGHT]=e}},{key:"toString",value:function(){var e=new ln;return this.location.length>1&&e.append(w.toLocationSymbol(this.location[G.LEFT])),e.append(w.toLocationSymbol(this.location[G.ON])),this.location.length>1&&e.append(w.toLocationSymbol(this.location[G.RIGHT])),e.toString()}},{key:"setLocations",value:function(e,t,n){this.location[G.ON]=e,this.location[G.LEFT]=t,this.location[G.RIGHT]=n}},{key:"get",value:function(e){return e<this.location.length?this.location[e]:w.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var e=0;e<this.location.length;e++)if(this.location[e]===w.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var e=arguments[0];this.setLocation(G.ON,e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.location[t]=n}}},{key:"init",value:function(e){this.location=new Array(e).fill(null),this.setAllLocations(w.NONE)}},{key:"isEqualOnSide",value:function(e,t){return this.location[t]===e.location[t]}},{key:"allPositionsEqual",value:function(e){for(var t=0;t<this.location.length;t++)if(this.location[t]!==e)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var t=arguments[0];this.init(1),this.location[G.ON]=t}else if(arguments[0]instanceof u){var n=arguments[0];if(this.init(n.location.length),n!==null)for(var a=0;a<this.location.length;a++)this.location[a]=n.location[a]}}else if(arguments.length===3){var c=arguments[0],d=arguments[1],y=arguments[2];this.init(3),this.location[G.ON]=c,this.location[G.LEFT]=d,this.location[G.RIGHT]=y}}}]),u}(),st=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getGeometryCount",value:function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e}},{key:"setAllLocations",value:function(e,t){this.elt[e].setAllLocations(t)}},{key:"isNull",value:function(e){return this.elt[e].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.elt[t].setAllLocationsIfNull(n)}}},{key:"isLine",value:function(e){return this.elt[e].isLine()}},{key:"merge",value:function(e){for(var t=0;t<2;t++)this.elt[t]===null&&e.elt[t]!==null?this.elt[t]=new it(e.elt[t]):this.elt[t].merge(e.elt[t])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var e=arguments[0];return this.elt[e].get(G.ON)}if(arguments.length===2){var t=arguments[0],n=arguments[1];return this.elt[t].get(n)}}},{key:"toString",value:function(){var e=new ln;return this.elt[0]!==null&&(e.append("A:"),e.append(this.elt[0].toString())),this.elt[1]!==null&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var e=arguments[0];return this.elt[e].isArea()}}},{key:"isAnyNull",value:function(e){return this.elt[e].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];this.elt[e].setLocation(G.ON,t)}else if(arguments.length===3){var n=arguments[0],a=arguments[1],c=arguments[2];this.elt[n].setLocation(a,c)}}},{key:"isEqualOnSide",value:function(e,t){return this.elt[0].isEqualOnSide(e.elt[0],t)&&this.elt[1].isEqualOnSide(e.elt[1],t)}},{key:"allPositionsEqual",value:function(e,t){return this.elt[e].allPositionsEqual(t)}},{key:"toLine",value:function(e){this.elt[e].isArea()&&(this.elt[e]=new it(this.elt[e].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new it(e),this.elt[1]=new it(e)}else if(arguments[0]instanceof u){var t=arguments[0];this.elt[0]=new it(t.elt[0]),this.elt[1]=new it(t.elt[1])}}else if(arguments.length===2){var n=arguments[0],a=arguments[1];this.elt[0]=new it(w.NONE),this.elt[1]=new it(w.NONE),this.elt[n].setLocation(a)}else if(arguments.length===3){var c=arguments[0],d=arguments[1],y=arguments[2];this.elt[0]=new it(c,d,y),this.elt[1]=new it(c,d,y)}else if(arguments.length===4){var p=arguments[0],E=arguments[1],I=arguments[2],L=arguments[3];this.elt[0]=new it(w.NONE,w.NONE,w.NONE),this.elt[1]=new it(w.NONE,w.NONE,w.NONE),this.elt[p].setLocations(E,I,L)}}},{key:"toLineLabel",value:function(e){for(var t=new u(w.NONE),n=0;n<2;n++)t.setLocation(n,e.getLocation(n));return t}}]),u}(),Vn=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var e=new Array(this._pts.size()).fill(null),t=0;t<this._pts.size();t++)e[t]=this._pts.get(t);this._ring=this._geometryFactory.createLinearRing(e),this._isHole=ee.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(e){this._startDe=e;var t=e,n=!0;do{if(t===null)throw new pt("Found null DirectedEdge");if(t.getEdgeRing()===this)throw new pt("Directed Edge visited twice during ring-building at "+t.getCoordinate());this._edges.add(t);var a=t.getLabel();U.isTrue(a.isArea()),this.mergeLabel(a),this.addPoints(t.getEdge(),t.isForward(),n),n=!1,this.setEdgeRing(t,this),t=this.getNext(t)}while(t!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(e){return this._pts.get(e)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var e=this._startDe;do{var t=e.getNode().getEdges().getOutgoingDegree(this);t>this._maxNodeDegree&&(this._maxNodeDegree=t),e=this.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(e,t,n){var a=e.getCoordinates();if(t){var c=1;n&&(c=0);for(var d=c;d<a.length;d++)this._pts.add(a[d])}else{var y=a.length-2;n&&(y=a.length-1);for(var p=y;p>=0;p--)this._pts.add(a[p])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var e=this._startDe;do e.getEdge().setInResult(!0),e=e.getNext();while(e!==this._startDe)}},{key:"containsPoint",value:function(e){var t=this.getLinearRing();if(!t.getEnvelopeInternal().contains(e)||!Tr.isInRing(e,t.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(e))return!1;return!0}},{key:"addHole",value:function(e){this._holes.add(e)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var e=arguments[0];this.mergeLabel(e,0),this.mergeLabel(e,1)}else if(arguments.length===2){var t=arguments[0],n=arguments[1],a=t.getLocation(n,G.RIGHT);if(a===w.NONE)return null;if(this._label.getLocation(n)===w.NONE)return this._label.setLocation(n,a),null}}},{key:"setShell",value:function(e){this._shell=e,e!==null&&e.addHole(this)}},{key:"toPolygon",value:function(e){for(var t=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)t[n]=this._holes.get(n).getLinearRing();return e.createPolygon(this.getLinearRing(),t)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new K,this._pts=new K,this._label=new st(w.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new K,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var e=arguments[0],t=arguments[1];this._geometryFactory=t,this.computePoints(e),this.computeRing()}}}}]),u}(),su=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"setEdgeRing",value:function(n,a){n.setMinEdgeRing(a)}},{key:"getNext",value:function(n){return n.getNextMin()}}],[{key:"constructor_",value:function(){var n=arguments[0],a=arguments[1];Vn.constructor_.call(this,n,a)}}]),t}(Vn),au=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"buildMinimalRings",value:function(){var n=new K,a=this._startDe;do{if(a.getMinEdgeRing()===null){var c=new su(a,this._geometryFactory);n.add(c)}a=a.getNext()}while(a!==this._startDe);return n}},{key:"setEdgeRing",value:function(n,a){n.setEdgeRing(a)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var n=this._startDe;do n.getNode().getEdges().linkMinimalDirectedEdges(this),n=n.getNext();while(n!==this._startDe)}},{key:"getNext",value:function(n){return n.getNext()}}],[{key:"constructor_",value:function(){var n=arguments[0],a=arguments[1];Vn.constructor_.call(this,n,a)}}]),t}(Vn),Bi=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"setVisited",value:function(e){this._isVisited=e}},{key:"setInResult",value:function(e){this._isInResult=e}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(e){this._label=e}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(e){this._isCovered=e,this._isCoveredSet=!0}},{key:"updateIM",value:function(e){U.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._label=e}}}}]),u}(),Hn=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"isIncidentEdgeInResult",value:function(){for(var n=this.getEdges().getEdges().iterator();n.hasNext();)if(n.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(n){n.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(n){}},{key:"computeMergedLocation",value:function(n,a){var c=w.NONE;if(c=this._label.getLocation(a),!n.isNull(a)){var d=n.getLocation(a);c!==w.BOUNDARY&&(c=d)}return c}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return N(f(t.prototype),"setLabel",this).apply(this,arguments);var n=arguments[0],a=arguments[1];this._label===null?this._label=new st(n,a):this._label.setLocation(n,a)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof t){var n=arguments[0];this.mergeLabel(n._label)}else if(arguments[0]instanceof st)for(var a=arguments[0],c=0;c<2;c++){var d=this.computeMergedLocation(a,c),y=this._label.getLocation(c);y===w.NONE&&this._label.setLocation(c,d)}}},{key:"add",value:function(n){this._edges.insert(n),n.setNode(this)}},{key:"setLabelBoundary",value:function(n){if(this._label===null)return null;var a=w.NONE;this._label!==null&&(a=this._label.getLocation(n));var c=null;switch(a){case w.BOUNDARY:c=w.INTERIOR;break;case w.INTERIOR:default:c=w.BOUNDARY}this._label.setLocation(n,c)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var n=arguments[0],a=arguments[1];this._coord=n,this._edges=a,this._label=new st(0,w.NONE)}}]),t}(Bi),ou=function(u){h(t,u);var e=k(t);function t(){return i(this,t),e.apply(this,arguments)}return t}(Ri);function Yi(u){return u==null?0:u.color}function pe(u){return u==null?null:u.parent}function dt(u,e){u!==null&&(u.color=e)}function Or(u){return u==null?null:u.left}function Xi(u){return u==null?null:u.right}var yn=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),(n=e.call(this)).root_=null,n.size_=0,n}return l(t,[{key:"get",value:function(n){for(var a=this.root_;a!==null;){var c=n.compareTo(a.key);if(c<0)a=a.left;else{if(!(c>0))return a.value;a=a.right}}return null}},{key:"put",value:function(n,a){if(this.root_===null)return this.root_={key:n,value:a,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var c,d,y=this.root_;do if(c=y,(d=n.compareTo(y.key))<0)y=y.left;else{if(!(d>0)){var p=y.value;return y.value=a,p}y=y.right}while(y!==null);var E={key:n,left:null,right:null,value:a,parent:c,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return d<0?c.left=E:c.right=E,this.fixAfterInsertion(E),this.size_++,null}},{key:"fixAfterInsertion",value:function(n){var a;for(n.color=1;n!=null&&n!==this.root_&&n.parent.color===1;)pe(n)===Or(pe(pe(n)))?Yi(a=Xi(pe(pe(n))))===1?(dt(pe(n),0),dt(a,0),dt(pe(pe(n)),1),n=pe(pe(n))):(n===Xi(pe(n))&&(n=pe(n),this.rotateLeft(n)),dt(pe(n),0),dt(pe(pe(n)),1),this.rotateRight(pe(pe(n)))):Yi(a=Or(pe(pe(n))))===1?(dt(pe(n),0),dt(a,0),dt(pe(pe(n)),1),n=pe(pe(n))):(n===Or(pe(n))&&(n=pe(n),this.rotateRight(n)),dt(pe(n),0),dt(pe(pe(n)),1),this.rotateLeft(pe(pe(n))));this.root_.color=0}},{key:"values",value:function(){var n=new K,a=this.getFirstEntry();if(a!==null)for(n.add(a.value);(a=t.successor(a))!==null;)n.add(a.value);return n}},{key:"entrySet",value:function(){var n=new xr,a=this.getFirstEntry();if(a!==null)for(n.add(a);(a=t.successor(a))!==null;)n.add(a);return n}},{key:"rotateLeft",value:function(n){if(n!=null){var a=n.right;n.right=a.left,a.left!=null&&(a.left.parent=n),a.parent=n.parent,n.parent==null?this.root_=a:n.parent.left===n?n.parent.left=a:n.parent.right=a,a.left=n,n.parent=a}}},{key:"rotateRight",value:function(n){if(n!=null){var a=n.left;n.left=a.right,a.right!=null&&(a.right.parent=n),a.parent=n.parent,n.parent==null?this.root_=a:n.parent.right===n?n.parent.right=a:n.parent.left=a,a.right=n,n.parent=a}}},{key:"getFirstEntry",value:function(){var n=this.root_;if(n!=null)for(;n.left!=null;)n=n.left;return n}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(n){for(var a=this.root_;a!==null;){var c=n.compareTo(a.key);if(c<0)a=a.left;else{if(!(c>0))return!0;a=a.right}}return!1}}],[{key:"successor",value:function(n){var a;if(n===null)return null;if(n.right!==null){for(a=n.right;a.left!==null;)a=a.left;return a}a=n.parent;for(var c=n;a!==null&&c===a.right;)c=a,a=a.parent;return a}}]),t}(ou),Ui=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"find",value:function(e){return this.nodeMap.get(e)}},{key:"addNode",value:function(){if(arguments[0]instanceof S){var e=arguments[0],t=this.nodeMap.get(e);return t===null&&(t=this.nodeFact.createNode(e),this.nodeMap.put(e,t)),t}if(arguments[0]instanceof Hn){var n=arguments[0],a=this.nodeMap.get(n.getCoordinate());return a===null?(this.nodeMap.put(n.getCoordinate(),n),n):(a.mergeLabel(n),a)}}},{key:"print",value:function(e){for(var t=this.iterator();t.hasNext();)t.next().print(e)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(e){for(var t=new K,n=this.iterator();n.hasNext();){var a=n.next();a.getLabel().getLocation(e)===w.BOUNDARY&&t.add(a)}return t}},{key:"add",value:function(e){var t=e.getCoordinate();this.addNode(t).add(e)}}],[{key:"constructor_",value:function(){this.nodeMap=new yn,this.nodeFact=null;var e=arguments[0];this.nodeFact=e}}]),u}(),He=function(){function u(){i(this,u)}return l(u,null,[{key:"isNorthern",value:function(e){return e===u.NE||e===u.NW}},{key:"isOpposite",value:function(e,t){return e!==t&&(e-t+4)%4===2}},{key:"commonHalfPlane",value:function(e,t){if(e===t)return e;if((e-t+4)%4===2)return-1;var n=e<t?e:t;return n===0&&(e>t?e:t)===3?3:n}},{key:"isInHalfPlane",value:function(e,t){return t===u.SE?e===u.SE||e===u.SW:e===t||e===t+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];if(e===0&&t===0)throw new O("Cannot compute the quadrant for point ( "+e+", "+t+" )");return e>=0?t>=0?u.NE:u.SE:t>=0?u.NW:u.SW}if(arguments[0]instanceof S&&arguments[1]instanceof S){var n=arguments[0],a=arguments[1];if(a.x===n.x&&a.y===n.y)throw new O("Cannot compute the quadrant for two identical points "+n);return a.x>=n.x?a.y>=n.y?u.NE:u.SE:a.y>=n.y?u.NW:u.SW}}}]),u}();He.NE=0,He.NW=1,He.SW=2,He.SE=3;var Vi=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"compareDirection",value:function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:ee.index(e._p0,e._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(e){this._node=e}},{key:"print",value:function(e){var t=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),a=n.lastIndexOf("."),c=n.substring(a+1);e.print("  "+c+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label)}},{key:"compareTo",value:function(e){var t=e;return this.compareDirection(t)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var e=Math.atan2(this._dy,this._dx),t=this.getClass().getName(),n=t.lastIndexOf(".");return"  "+t.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label}},{key:"computeLabel",value:function(e){}},{key:"init",value:function(e,t){this._p0=e,this._p1=t,this._dx=t.x-e.x,this._dy=t.y-e.y,this._quadrant=He.quadrant(this._dx,this._dy),U.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[B]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var e=arguments[0];this._edge=e}else if(arguments.length===3){var t=arguments[0],n=arguments[1],a=arguments[2];u.constructor_.call(this,t,n,a,null)}else if(arguments.length===4){var c=arguments[0],d=arguments[1],y=arguments[2],p=arguments[3];u.constructor_.call(this,c),this.init(d,y),this._label=p}}}]),u}(),Rr=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(n){return this._depth[n]}},{key:"setVisited",value:function(n){this._isVisited=n}},{key:"computeDirectedLabel",value:function(){this._label=new st(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(n,a){if(this._depth[n]!==-999&&this._depth[n]!==a)throw new pt("assigned depths do not match",this.getCoordinate());this._depth[n]=a}},{key:"isInteriorAreaEdge",value:function(){for(var n=!0,a=0;a<2;a++)this._label.isArea(a)&&this._label.getLocation(a,G.LEFT)===w.INTERIOR&&this._label.getLocation(a,G.RIGHT)===w.INTERIOR||(n=!1);return n}},{key:"setNextMin",value:function(n){this._nextMin=n}},{key:"print",value:function(n){N(f(t.prototype),"print",this).call(this,n),n.print(" "+this._depth[G.LEFT]+"/"+this._depth[G.RIGHT]),n.print(" ("+this.getDepthDelta()+")"),this._isInResult&&n.print(" inResult")}},{key:"setMinEdgeRing",value:function(n){this._minEdgeRing=n}},{key:"isLineEdge",value:function(){var n=this._label.isLine(0)||this._label.isLine(1),a=!this._label.isArea(0)||this._label.allPositionsEqual(0,w.EXTERIOR),c=!this._label.isArea(1)||this._label.allPositionsEqual(1,w.EXTERIOR);return n&&a&&c}},{key:"setEdgeRing",value:function(n){this._edgeRing=n}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var n=this._edge.getDepthDelta();return this._isForward||(n=-n),n}},{key:"setInResult",value:function(n){this._isInResult=n}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(n){this.print(n),n.print(" "),this._isForward?this._edge.print(n):this._edge.printReverse(n)}},{key:"setSym",value:function(n){this._sym=n}},{key:"setVisitedEdge",value:function(n){this.setVisited(n),this._sym.setVisited(n)}},{key:"setEdgeDepths",value:function(n,a){var c=this.getEdge().getDepthDelta();this._isForward||(c=-c);var d=1;n===G.LEFT&&(d=-1);var y=G.opposite(n),p=a+c*d;this.setDepth(n,a),this.setDepth(y,p)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(n){this._next=n}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var n=arguments[0],a=arguments[1];if(Vi.constructor_.call(this,n),this._isForward=a,a)this.init(n.getCoordinate(0),n.getCoordinate(1));else{var c=n.getNumPoints()-1;this.init(n.getCoordinate(c),n.getCoordinate(c-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(n,a){return n===w.EXTERIOR&&a===w.INTERIOR?1:n===w.INTERIOR&&a===w.EXTERIOR?-1:0}}]),t}(Vi),Hi=function(){function u(){i(this,u)}return l(u,[{key:"createNode",value:function(e){return new Hn(e,null)}}]),u}(),Zi=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"printEdges",value:function(e){e.println("Edges:");for(var t=0;t<this._edges.size();t++){e.println("edge "+t+":");var n=this._edges.get(t);n.print(e),n.eiList.print(e)}}},{key:"find",value:function(e){return this._nodes.find(e)}},{key:"addNode",value:function(){if(arguments[0]instanceof Hn){var e=arguments[0];return this._nodes.addNode(e)}if(arguments[0]instanceof S){var t=arguments[0];return this._nodes.addNode(t)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(e){rt.out.println(e)}},{key:"isBoundaryNode",value:function(e,t){var n=this._nodes.find(t);if(n===null)return!1;var a=n.getLabel();return a!==null&&a.getLocation(e)===w.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var e=this._nodes.iterator();e.hasNext();)e.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(e,t,n,a){return!!e.equals(n)&&ee.index(e,t,a)===ee.COLLINEAR&&He.quadrant(e,t)===He.quadrant(n,a)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(e){rt.out.print(e)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(e,t){for(var n=0;n<this._edges.size();n++){var a=this._edges.get(n),c=a.getCoordinates();if(this.matchInSameDirection(e,t,c[0],c[1])||this.matchInSameDirection(e,t,c[c.length-1],c[c.length-2]))return a}return null}},{key:"insertEdge",value:function(e){this._edges.add(e)}},{key:"findEdgeEnd",value:function(e){for(var t=this.getEdgeEnds().iterator();t.hasNext();){var n=t.next();if(n.getEdge()===e)return n}return null}},{key:"addEdges",value:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this._edges.add(n);var a=new Rr(n,!0),c=new Rr(n,!1);a.setSym(c),c.setSym(a),this.add(a),this.add(c)}}},{key:"add",value:function(e){this._nodes.add(e),this._edgeEndList.add(e)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(e,t){for(var n=0;n<this._edges.size();n++){var a=this._edges.get(n),c=a.getCoordinates();if(e.equals(c[0])&&t.equals(c[1]))return a}return null}}],[{key:"constructor_",value:function(){if(this._edges=new K,this._nodes=null,this._edgeEndList=new K,arguments.length===0)this._nodes=new Ui(new Hi);else if(arguments.length===1){var e=arguments[0];this._nodes=new Ui(e)}}},{key:"linkResultDirectedEdges",value:function(e){for(var t=e.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()}}]),u}(),uu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"sortShellsAndHoles",value:function(e,t,n){for(var a=e.iterator();a.hasNext();){var c=a.next();c.isHole()?n.add(c):t.add(c)}}},{key:"computePolygons",value:function(e){for(var t=new K,n=e.iterator();n.hasNext();){var a=n.next().toPolygon(this._geometryFactory);t.add(a)}return t}},{key:"placeFreeHoles",value:function(e,t){for(var n=t.iterator();n.hasNext();){var a=n.next();if(a.getShell()===null){var c=u.findEdgeRingContaining(a,e);if(c===null)throw new pt("unable to assign hole to a shell",a.getCoordinate(0));a.setShell(c)}}}},{key:"buildMinimalEdgeRings",value:function(e,t,n){for(var a=new K,c=e.iterator();c.hasNext();){var d=c.next();if(d.getMaxNodeDegree()>2){d.linkDirectedEdgesForMinimalEdgeRings();var y=d.buildMinimalRings(),p=this.findShell(y);p!==null?(this.placePolygonHoles(p,y),t.add(p)):n.addAll(y)}else a.add(d)}return a}},{key:"buildMaximalEdgeRings",value:function(e){for(var t=new K,n=e.iterator();n.hasNext();){var a=n.next();if(a.isInResult()&&a.getLabel().isArea()&&a.getEdgeRing()===null){var c=new au(a,this._geometryFactory);t.add(c),c.setInResult()}}return t}},{key:"placePolygonHoles",value:function(e,t){for(var n=t.iterator();n.hasNext();){var a=n.next();a.isHole()&&a.setShell(e)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(e){for(var t=0,n=null,a=e.iterator();a.hasNext();){var c=a.next();c.isHole()||(n=c,t++)}return U.isTrue(t<=1,"found two shells in MinimalEdgeRing list"),n}},{key:"add",value:function(){if(arguments.length===1){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(arguments.length===2){var t=arguments[0],n=arguments[1];Zi.linkResultDirectedEdges(n);var a=this.buildMaximalEdgeRings(t),c=new K,d=this.buildMinimalEdgeRings(a,this._shellList,c);this.sortShellsAndHoles(d,this._shellList,c),this.placeFreeHoles(this._shellList,c)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new K;var e=arguments[0];this._geometryFactory=e}},{key:"findEdgeRingContaining",value:function(e,t){for(var n=e.getLinearRing(),a=n.getEnvelopeInternal(),c=n.getCoordinateN(0),d=null,y=null,p=t.iterator();p.hasNext();){var E=p.next(),I=E.getLinearRing(),L=I.getEnvelopeInternal();if(!L.equals(a)&&L.contains(a)){c=Ge.ptNotInList(n.getCoordinates(),I.getCoordinates());var T=!1;Tr.isInRing(c,I.getCoordinates())&&(T=!0),T&&(d===null||y.contains(L))&&(y=(d=E).getLinearRing().getEnvelopeInternal())}}return d}}]),u}(),Wi=function(){function u(){i(this,u)}return l(u,[{key:"getBounds",value:function(){}}]),u}(),xt=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[Wi,Z]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var e=arguments[0],t=arguments[1];this._bounds=e,this._item=t}}]),u}(),Zn=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"poll",value:function(){if(this.isEmpty())return null;var e=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),e}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(e){for(var t=null,n=this._items.get(e);2*e<=this._size&&((t=2*e)!==this._size&&this._items.get(t+1).compareTo(this._items.get(t))<0&&t++,this._items.get(t).compareTo(n)<0);e=t)this._items.set(e,this._items.get(t));this._items.set(e,n)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(e){this._items.add(null),this._size+=1;var t=this._size;for(this._items.set(0,e);e.compareTo(this._items.get(Math.trunc(t/2)))<0;t/=2)this._items.set(t,this._items.get(Math.trunc(t/2)));this._items.set(t,e)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new K,this._items.add(null)}}]),u}(),lu=function(){function u(){i(this,u)}return l(u,[{key:"insert",value:function(e,t){}},{key:"remove",value:function(e,t){}},{key:"query",value:function(){}}]),u}(),at=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(e){U.isTrue(this._bounds===null),this._childBoundables.add(e)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[Wi,Z]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new K,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._level=e}}}}]),u}(),Jt={reverseOrder:function(){return{compare:function(u,e){return e.compareTo(u)}}},min:function(u){return Jt.sort(u),u.get(0)},sort:function(u,e){var t=u.toArray();e?Tt.sort(t,e):Tt.sort(t);for(var n=u.iterator(),a=0,c=t.length;a<c;a++)n.next(),n.set(t[a])},singletonList:function(u){var e=new K;return e.add(u),e}},cu=function(){function u(){i(this,u)}return l(u,null,[{key:"maxDistance",value:function(e,t,n,a,c,d,y,p){var E=u.distance(e,t,c,d);return E=Math.max(E,u.distance(e,t,y,p)),E=Math.max(E,u.distance(n,a,c,d)),E=Math.max(E,u.distance(n,a,y,p))}},{key:"distance",value:function(e,t,n,a){var c=n-e,d=a-t;return Math.sqrt(c*c+d*d)}},{key:"maximumDistance",value:function(e,t){var n=Math.min(e.getMinX(),t.getMinX()),a=Math.min(e.getMinY(),t.getMinY()),c=Math.max(e.getMaxX(),t.getMaxX()),d=Math.max(e.getMaxY(),t.getMaxY());return u.distance(n,a,c,d)}},{key:"minMaxDistance",value:function(e,t){var n=e.getMinX(),a=e.getMinY(),c=e.getMaxX(),d=e.getMaxY(),y=t.getMinX(),p=t.getMinY(),E=t.getMaxX(),I=t.getMaxY(),L=u.maxDistance(n,a,n,d,y,p,y,I);return L=Math.min(L,u.maxDistance(n,a,n,d,y,p,E,p)),L=Math.min(L,u.maxDistance(n,a,n,d,E,I,y,I)),L=Math.min(L,u.maxDistance(n,a,n,d,E,I,E,p)),L=Math.min(L,u.maxDistance(n,a,c,a,y,p,y,I)),L=Math.min(L,u.maxDistance(n,a,c,a,y,p,E,p)),L=Math.min(L,u.maxDistance(n,a,c,a,E,I,y,I)),L=Math.min(L,u.maxDistance(n,a,c,a,E,I,E,p)),L=Math.min(L,u.maxDistance(c,d,n,d,y,p,y,I)),L=Math.min(L,u.maxDistance(c,d,n,d,y,p,E,p)),L=Math.min(L,u.maxDistance(c,d,n,d,E,I,y,I)),L=Math.min(L,u.maxDistance(c,d,n,d,E,I,E,p)),L=Math.min(L,u.maxDistance(c,d,c,a,y,p,y,I)),L=Math.min(L,u.maxDistance(c,d,c,a,y,p,E,p)),L=Math.min(L,u.maxDistance(c,d,c,a,E,I,y,I)),L=Math.min(L,u.maxDistance(c,d,c,a,E,I,E,p))}}]),u}(),Kt=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"maximumDistance",value:function(){return cu.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(e,t){var n=u.isComposite(this._boundable1),a=u.isComposite(this._boundable2);if(n&&a)return u.area(this._boundable1)>u.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,e,t),null):(this.expand(this._boundable2,this._boundable1,!0,e,t),null);if(n)return this.expand(this._boundable1,this._boundable2,!1,e,t),null;if(a)return this.expand(this._boundable2,this._boundable1,!0,e,t),null;throw new O("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(u.isComposite(this._boundable1)||u.isComposite(this._boundable2))}},{key:"compareTo",value:function(e){var t=e;return this._distance<t._distance?-1:this._distance>t._distance?1:0}},{key:"expand",value:function(e,t,n,a,c){for(var d=e.getChildBoundables().iterator();d.hasNext();){var y=d.next(),p=null;(p=n?new u(t,y,this._itemDistance):new u(y,t,this._itemDistance)).getDistance()<c&&a.add(p)}}},{key:"getBoundable",value:function(e){return e===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[B]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var e=arguments[0],t=arguments[1],n=arguments[2];this._boundable1=e,this._boundable2=t,this._itemDistance=n,this._distance=this.distance()}},{key:"area",value:function(e){return e.getBounds().getArea()}},{key:"isComposite",value:function(e){return e instanceof at}}]),u}(),$i=function(){function u(){i(this,u)}return l(u,[{key:"visitItem",value:function(e){}}]),u}(),Qt=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"queryInternal",value:function(){if(oe(arguments[2],$i)&&arguments[0]instanceof Object&&arguments[1]instanceof at)for(var e=arguments[0],t=arguments[1],n=arguments[2],a=t.getChildBoundables(),c=0;c<a.size();c++){var d=a.get(c);this.getIntersectsOp().intersects(d.getBounds(),e)&&(d instanceof at?this.queryInternal(e,d,n):d instanceof xt?n.visitItem(d.getItem()):U.shouldNeverReachHere())}else if(oe(arguments[2],St)&&arguments[0]instanceof Object&&arguments[1]instanceof at)for(var y=arguments[0],p=arguments[1],E=arguments[2],I=p.getChildBoundables(),L=0;L<I.size();L++){var T=I.get(L);this.getIntersectsOp().intersects(T.getBounds(),y)&&(T instanceof at?this.queryInternal(y,T,E):T instanceof xt?E.add(T.getItem()):U.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(e){return e.get(e.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var e=arguments[0],t=0,n=e.getChildBoundables().iterator();n.hasNext();){var a=n.next();a instanceof at?t+=this.size(a):a instanceof xt&&(t+=1)}return t}}},{key:"removeItem",value:function(e,t){for(var n=null,a=e.getChildBoundables().iterator();a.hasNext();){var c=a.next();c instanceof xt&&c.getItem()===t&&(n=c)}return n!==null&&(e.getChildBoundables().remove(n),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var e=this.itemsTree(this._root);return e===null?new K:e}if(arguments.length===1){for(var t=arguments[0],n=new K,a=t.getChildBoundables().iterator();a.hasNext();){var c=a.next();if(c instanceof at){var d=this.itemsTree(c);d!==null&&n.add(d)}else c instanceof xt?n.add(c.getItem()):U.shouldNeverReachHere()}return n.size()<=0?null:n}}},{key:"insert",value:function(e,t){U.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new xt(e,t))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var e=arguments[0],t=new K;return this.boundablesAtLevel(e,this._root,t),t}if(arguments.length===3){var n=arguments[0],a=arguments[1],c=arguments[2];if(U.isTrue(n>-2),a.getLevel()===n)return c.add(a),null;for(var d=a.getChildBoundables().iterator();d.hasNext();){var y=d.next();y instanceof at?this.boundablesAtLevel(n,y,c):(U.isTrue(y instanceof xt),n===-1&&c.add(y))}return null}}},{key:"query",value:function(){if(arguments.length===1){var e=arguments[0];this.build();var t=new K;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.queryInternal(e,this._root,t),t}if(arguments.length===2){var n=arguments[0],a=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.queryInternal(n,this._root,a)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,t)}if(arguments.length===3){var n=arguments[0],a=arguments[1],c=arguments[2],d=this.removeItem(a,c);if(d)return!0;for(var y=null,p=a.getChildBoundables().iterator();p.hasNext();){var E=p.next();if(this.getIntersectsOp().intersects(E.getBounds(),n)&&E instanceof at&&(d=this.remove(n,E,c))){y=E;break}}return y!==null&&y.getChildBoundables().isEmpty()&&a.getChildBoundables().remove(y),d}}},{key:"createHigherLevels",value:function(e,t){U.isTrue(!e.isEmpty());var n=this.createParentBoundables(e,t+1);return n.size()===1?n.get(0):this.createHigherLevels(n,t+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var e=arguments[0],t=0,n=e.getChildBoundables().iterator();n.hasNext();){var a=n.next();if(a instanceof at){var c=this.depth(a);c>t&&(t=c)}}return t+1}}},{key:"createParentBoundables",value:function(e,t){U.isTrue(!e.isEmpty());var n=new K;n.add(this.createNode(t));var a=new K(e);Jt.sort(a,this.getComparator());for(var c=a.iterator();c.hasNext();){var d=c.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(t)),this.lastNode(n).addChildBoundable(d)}return n}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[Z]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new K,this._nodeCapacity=null,arguments.length===0)u.constructor_.call(this,u.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var e=arguments[0];U.isTrue(e>1,"Node capacity must be greater than 1"),this._nodeCapacity=e}}},{key:"compareDoubles",value:function(e,t){return e>t?1:e<t?-1:0}}]),u}();Qt.IntersectsOp=function(){},Qt.DEFAULT_NODE_CAPACITY=10;var hu=function(){function u(){i(this,u)}return l(u,[{key:"distance",value:function(e,t){}}]),u}(),vt=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"createParentBoundablesFromVerticalSlices",value:function(n,a){U.isTrue(n.length>0);for(var c=new K,d=0;d<n.length;d++)c.addAll(this.createParentBoundablesFromVerticalSlice(n[d],a));return c}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var n=arguments[0],a=arguments[1];return this.nearestNeighbourK(n,X.POSITIVE_INFINITY,a)}if(arguments.length===3){var c=arguments[0],d=arguments[1],y=arguments[2],p=d,E=new Zn;E.add(c);for(var I=new Zn;!E.isEmpty()&&p>=0;){var L=E.poll(),T=L.getDistance();if(T>=p)break;if(L.isLeaves())if(I.size()<y)I.add(L);else{var q=I.peek();q.getDistance()>T&&(I.poll(),I.add(L));var F=I.peek();p=F.getDistance()}else L.expandToQueue(E,p)}return t.getItems(I)}}},{key:"createNode",value:function(n){return new Ji(n)}},{key:"size",value:function(){return arguments.length===0?N(f(t.prototype),"size",this).call(this):N(f(t.prototype),"size",this).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof ke))return N(f(t.prototype),"insert",this).apply(this,arguments);var n=arguments[0],a=arguments[1];if(n.isNull())return null;N(f(t.prototype),"insert",this).call(this,n,a)}},{key:"getIntersectsOp",value:function(){return t.intersectsOp}},{key:"verticalSlices",value:function(n,a){for(var c=Math.trunc(Math.ceil(n.size()/a)),d=new Array(a).fill(null),y=n.iterator(),p=0;p<a;p++){d[p]=new K;for(var E=0;y.hasNext()&&E<c;){var I=y.next();d[p].add(I),E++}}return d}},{key:"query",value:function(){if(arguments.length===1){var n=arguments[0];return N(f(t.prototype),"query",this).call(this,n)}if(arguments.length===2){var a=arguments[0],c=arguments[1];N(f(t.prototype),"query",this).call(this,a,c)}}},{key:"getComparator",value:function(){return t.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(n,a){return N(f(t.prototype),"createParentBoundables",this).call(this,n,a)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof ke){var n=arguments[0],a=arguments[1];return N(f(t.prototype),"remove",this).call(this,n,a)}return N(f(t.prototype),"remove",this).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?N(f(t.prototype),"depth",this).call(this):N(f(t.prototype),"depth",this).apply(this,arguments)}},{key:"createParentBoundables",value:function(n,a){U.isTrue(!n.isEmpty());var c=Math.trunc(Math.ceil(n.size()/this.getNodeCapacity())),d=new K(n);Jt.sort(d,t.xComparator);var y=this.verticalSlices(d,Math.trunc(Math.ceil(Math.sqrt(c))));return this.createParentBoundablesFromVerticalSlices(y,a)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(oe(arguments[0],hu)){var n=arguments[0];if(this.isEmpty())return null;var a=new Kt(this.getRoot(),this.getRoot(),n);return this.nearestNeighbour(a)}if(arguments[0]instanceof Kt){var c=arguments[0],d=X.POSITIVE_INFINITY,y=null,p=new Zn;for(p.add(c);!p.isEmpty()&&d>0;){var E=p.poll(),I=E.getDistance();if(I>=d)break;E.isLeaves()?(d=I,y=E):E.expandToQueue(p,d)}return y===null?null:[y.getBoundable(0).getItem(),y.getBoundable(1).getItem()]}}else{if(arguments.length===2){var L=arguments[0],T=arguments[1];if(this.isEmpty()||L.isEmpty())return null;var q=new Kt(this.getRoot(),L.getRoot(),T);return this.nearestNeighbour(q)}if(arguments.length===3){var F=arguments[0],H=arguments[1],$=arguments[2],te=new xt(F,H),Ee=new Kt(this.getRoot(),te,$);return this.nearestNeighbour(Ee)[0]}if(arguments.length===4){var Se=arguments[0],Xe=arguments[1],et=arguments[2],ct=arguments[3],Et=new xt(Se,Xe),Ft=new Kt(this.getRoot(),Et,et);return this.nearestNeighbourK(Ft,ct)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var n=arguments[0],a=arguments[1],c=X.POSITIVE_INFINITY,d=new Zn;for(d.add(n);!d.isEmpty();){var y=d.poll(),p=y.getDistance();if(p>a)return!1;if(y.maximumDistance()<=a)return!0;if(y.isLeaves()){if((c=p)<=a)return!0}else y.expandToQueue(d,c)}return!1}if(arguments.length===3){var E=arguments[0],I=arguments[1],L=arguments[2],T=new Kt(this.getRoot(),E.getRoot(),I);return this.isWithinDistance(T,L)}}},{key:"interfaces_",get:function(){return[lu,Z]}}],[{key:"constructor_",value:function(){if(arguments.length===0)t.constructor_.call(this,t.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var n=arguments[0];Qt.constructor_.call(this,n)}}},{key:"centreX",value:function(n){return t.avg(n.getMinX(),n.getMaxX())}},{key:"avg",value:function(n,a){return(n+a)/2}},{key:"getItems",value:function(n){for(var a=new Array(n.size()).fill(null),c=0;!n.isEmpty();){var d=n.poll();a[c]=d.getBoundable(0).getItem(),c++}return a}},{key:"centreY",value:function(n){return t.avg(n.getMinY(),n.getMaxY())}}]),t}(Qt),Ji=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"computeBounds",value:function(){for(var n=null,a=this.getChildBoundables().iterator();a.hasNext();){var c=a.next();n===null?n=new ke(c.getBounds()):n.expandToInclude(c.getBounds())}return n}}],[{key:"constructor_",value:function(){var n=arguments[0];at.constructor_.call(this,n)}}]),t}(at);vt.STRtreeNode=Ji,vt.xComparator=new(function(){function u(){i(this,u)}return l(u,[{key:"interfaces_",get:function(){return[tt]}},{key:"compare",value:function(e,t){return Qt.compareDoubles(vt.centreX(e.getBounds()),vt.centreX(t.getBounds()))}}]),u}()),vt.yComparator=new(function(){function u(){i(this,u)}return l(u,[{key:"interfaces_",get:function(){return[tt]}},{key:"compare",value:function(e,t){return Qt.compareDoubles(vt.centreY(e.getBounds()),vt.centreY(t.getBounds()))}}]),u}()),vt.intersectsOp=new(function(){function u(){i(this,u)}return l(u,[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(e,t){return e.intersects(t)}}]),u}()),vt.DEFAULT_NODE_CAPACITY=10;var fu=function(){function u(){i(this,u)}return l(u,null,[{key:"relativeSign",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"compare",value:function(e,t,n){if(t.equals2D(n))return 0;var a=u.relativeSign(t.x,n.x),c=u.relativeSign(t.y,n.y);switch(e){case 0:return u.compareValue(a,c);case 1:return u.compareValue(c,a);case 2:return u.compareValue(c,-a);case 3:return u.compareValue(-a,c);case 4:return u.compareValue(-a,-c);case 5:return u.compareValue(-c,-a);case 6:return u.compareValue(-c,a);case 7:return u.compareValue(a,-c)}return U.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(e,t){return e<0?-1:e>0?1:t<0?-1:t>0?1:0}}]),u}(),gu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(e){var t=e;return this.segmentIndex<t.segmentIndex?-1:this.segmentIndex>t.segmentIndex?1:this.coord.equals2D(t.coord)?0:this._isInterior?t._isInterior?fu.compare(this._segmentOctant,this.coord,t.coord):1:-1}},{key:"isEndPoint",value:function(e){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===e}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[B]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var e=arguments[0],t=arguments[1],n=arguments[2],a=arguments[3];this._segString=e,this.coord=new S(t),this.segmentIndex=n,this._segmentOctant=a,this._isInterior=!t.equals2D(e.getCoordinate(n))}}]),u}(),du=function(){function u(){i(this,u)}return l(u,[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}]),u}(),vu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getSplitCoordinates",value:function(){var e=new gn;this.addEndpoints();for(var t=this.iterator(),n=t.next();t.hasNext();){var a=t.next();this.addEdgeCoordinates(n,a,e),n=a}return e.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var e=new K;this.findCollapsesFromInsertedNodes(e),this.findCollapsesFromExistingVertices(e);for(var t=e.iterator();t.hasNext();){var n=t.next().intValue();this.add(this._edge.getCoordinate(n),n)}}},{key:"createSplitEdgePts",value:function(e,t){var n=t.segmentIndex-e.segmentIndex+2;if(n===2)return[new S(e.coord),new S(t.coord)];var a=this._edge.getCoordinate(t.segmentIndex),c=t.isInterior()||!t.coord.equals2D(a);c||n--;var d=new Array(n).fill(null),y=0;d[y++]=new S(e.coord);for(var p=e.segmentIndex+1;p<=t.segmentIndex;p++)d[y++]=this._edge.getCoordinate(p);return c&&(d[y]=new S(t.coord)),d}},{key:"print",value:function(e){e.println("Intersections:");for(var t=this.iterator();t.hasNext();)t.next().print(e)}},{key:"findCollapsesFromExistingVertices",value:function(e){for(var t=0;t<this._edge.size()-2;t++){var n=this._edge.getCoordinate(t);this._edge.getCoordinate(t+1);var a=this._edge.getCoordinate(t+2);n.equals2D(a)&&e.add(Fn.valueOf(t+1))}}},{key:"addEdgeCoordinates",value:function(e,t,n){var a=this.createSplitEdgePts(e,t);n.add(a,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(e){this.addEndpoints(),this.addCollapsedNodes();for(var t=this.iterator(),n=t.next();t.hasNext();){var a=t.next(),c=this.createSplitEdge(n,a);e.add(c),n=a}}},{key:"findCollapseIndex",value:function(e,t,n){if(!e.coord.equals2D(t.coord))return!1;var a=t.segmentIndex-e.segmentIndex;return t.isInterior()||a--,a===1&&(n[0]=e.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(e){for(var t=new Array(1).fill(null),n=this.iterator(),a=n.next();n.hasNext();){var c=n.next();this.findCollapseIndex(a,c,t)&&e.add(Fn.valueOf(t[0])),a=c}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var e=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(e),e)}},{key:"createSplitEdge",value:function(e,t){var n=this.createSplitEdgePts(e,t);return new Dt(n,this._edge.getData())}},{key:"add",value:function(e,t){var n=new gu(this._edge,e,t,this._edge.getSegmentOctant(t)),a=this._nodeMap.get(n);return a!==null?(U.isTrue(a.coord.equals2D(e),"Found equal nodes with different coordinates"),a):(this._nodeMap.put(n,n),n)}},{key:"checkSplitEdgesCorrectness",value:function(e){var t=this._edge.getCoordinates(),n=e.get(0).getCoordinate(0);if(!n.equals2D(t[0]))throw new qe("bad split edge start point at "+n);var a=e.get(e.size()-1).getCoordinates(),c=a[a.length-1];if(!c.equals2D(t[t.length-1]))throw new qe("bad split edge end point at "+c)}}],[{key:"constructor_",value:function(){this._nodeMap=new yn,this._edge=null;var e=arguments[0];this._edge=e}}]),u}(),yu=function(){function u(){i(this,u)}return l(u,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],t=arguments[1];if(e===0&&t===0)throw new O("Cannot compute the octant for point ( "+e+", "+t+" )");var n=Math.abs(e),a=Math.abs(t);return e>=0?t>=0?n>=a?0:1:n>=a?7:6:t>=0?n>=a?3:2:n>=a?4:5}if(arguments[0]instanceof S&&arguments[1]instanceof S){var c=arguments[0],d=arguments[1],y=d.x-c.x,p=d.y-c.y;if(y===0&&p===0)throw new O("Cannot compute the octant for two identical points "+c);return u.octant(y,p)}}}]),u}(),mu=function(){function u(){i(this,u)}return l(u,[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(e){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(e){}},{key:"getData",value:function(){}}]),u}(),pu=function(){function u(){i(this,u)}return l(u,[{key:"addIntersection",value:function(e,t){}},{key:"interfaces_",get:function(){return[mu]}}]),u}(),Dt=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(e){return this._pts[e]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))}},{key:"setData",value:function(e){this._data=e}},{key:"safeOctant",value:function(e,t){return e.equals2D(t)?0:yu.octant(e,t)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];this.addIntersectionNode(e,t)}else if(arguments.length===4){var n=arguments[0],a=arguments[1],c=arguments[3],d=new S(n.getIntersection(c));this.addIntersection(d,a)}}},{key:"toString",value:function(){return Cr.toLineString(new dn(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(e,t){var n=t,a=n+1;if(a<this._pts.length){var c=this._pts[a];e.equals2D(c)&&(n=a)}return this._nodeList.add(e,n)}},{key:"addIntersections",value:function(e,t,n){for(var a=0;a<e.getIntersectionNum();a++)this.addIntersection(e,t,n,a)}},{key:"interfaces_",get:function(){return[pu]}}],[{key:"constructor_",value:function(){this._nodeList=new vu(this),this._pts=null,this._data=null;var e=arguments[0],t=arguments[1];this._pts=e,this._data=t}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var e=arguments[0],t=new K;return u.getNodedSubstrings(e,t),t}if(arguments.length===2)for(var n=arguments[0],a=arguments[1],c=n.iterator();c.hasNext();){var d=c.next();d.getNodeList().addSplitEdges(a)}}}]),u}(),Qe=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof u){var e=arguments[0],t=ee.index(this.p0,this.p1,e.p0),n=ee.index(this.p0,this.p1,e.p1);return t>=0&&n>=0||t<=0&&n<=0?Math.max(t,n):0}if(arguments[0]instanceof S){var a=arguments[0];return ee.index(this.p0,this.p1,a)}}},{key:"toGeometry",value:function(e){return e.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(e){if(!(e instanceof u))return!1;var t=e;return this.p0.equals(t.p0)&&this.p1.equals(t.p1)}},{key:"intersection",value:function(e){var t=new At;return t.computeIntersection(this.p0,this.p1,e.p0,e.p1),t.hasIntersection()?t.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof S){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new S(e);var t=this.projectionFactor(e),n=new S;return n.x=this.p0.x+t*(this.p1.x-this.p0.x),n.y=this.p0.y+t*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof u){var a=arguments[0],c=this.projectionFactor(a.p0),d=this.projectionFactor(a.p1);if(c>=1&&d>=1||c<=0&&d<=0)return null;var y=this.project(a.p0);c<0&&(y=this.p0),c>1&&(y=this.p1);var p=this.project(a.p1);return d<0&&(p=this.p0),d>1&&(p=this.p1),new u(y,p)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(e){return e===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(e){return gt.pointToLinePerpendicular(e,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return u.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var t=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,a=t*t+n*n;return a<=0?X.NaN:((e.x-this.p0.x)*t+(e.y-this.p0.y)*n)/a}},{key:"closestPoints",value:function(e){var t=this.intersection(e);if(t!==null)return[t,t];var n=new Array(2).fill(null),a=X.MAX_VALUE,c=null,d=this.closestPoint(e.p0);a=d.distance(e.p0),n[0]=d,n[1]=e.p0;var y=this.closestPoint(e.p1);(c=y.distance(e.p1))<a&&(a=c,n[0]=y,n[1]=e.p1);var p=e.closestPoint(this.p0);(c=p.distance(this.p0))<a&&(a=c,n[0]=this.p0,n[1]=p);var E=e.closestPoint(this.p1);return(c=E.distance(this.p1))<a&&(a=c,n[0]=this.p1,n[1]=E),n}},{key:"closestPoint",value:function(e){var t=this.projectionFactor(e);return t>0&&t<1?this.project(e):this.p0.distance(e)<this.p1.distance(e)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(e){var t=e,n=this.p0.compareTo(t.p0);return n!==0?n:this.p1.compareTo(t.p1)}},{key:"reverse",value:function(){var e=this.p0;this.p0=this.p1,this.p1=e}},{key:"equalsTopo",value:function(e){return this.p0.equals(e.p0)&&this.p1.equals(e.p1)||this.p0.equals(e.p1)&&this.p1.equals(e.p0)}},{key:"lineIntersection",value:function(e){return wr.intersection(this.p0,this.p1,e.p0,e.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(e,t){var n=this.p0.x+e*(this.p1.x-this.p0.x),a=this.p0.y+e*(this.p1.y-this.p0.y),c=this.p1.x-this.p0.x,d=this.p1.y-this.p0.y,y=Math.sqrt(c*c+d*d),p=0,E=0;if(t!==0){if(y<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");p=t*c/y,E=t*d/y}return new S(n-E,a+p)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=n.x,this.p1.y=n.y}}},{key:"segmentFraction",value:function(e){var t=this.projectionFactor(e);return t<0?t=0:(t>1||X.isNaN(t))&&(t=1),t}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(e){var t=this.p1.getY()-this.p0.getY(),n=this.p0.getX()-this.p1.getX(),a=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),c=t*t+n*n,d=t*t-n*n,y=e.getX(),p=e.getY();return new S((-d*y-2*t*n*p-2*t*a)/c,(d*p-2*t*n*y-2*n*a)/c)}},{key:"distance",value:function(){if(arguments[0]instanceof u){var e=arguments[0];return gt.segmentToSegment(this.p0,this.p1,e.p0,e.p1)}if(arguments[0]instanceof S){var t=arguments[0];return gt.pointToSegment(t,this.p0,this.p1)}}},{key:"pointAlong",value:function(e){var t=new S;return t.x=this.p0.x+e*(this.p1.x-this.p0.x),t.y=this.p0.y+e*(this.p1.y-this.p0.y),t}},{key:"hashCode",value:function(){var e=X.doubleToLongBits(this.p0.x);e^=31*X.doubleToLongBits(this.p0.y);var t=Math.trunc(e)^Math.trunc(e>>32),n=X.doubleToLongBits(this.p1.x);return n^=31*X.doubleToLongBits(this.p1.y),t^(Math.trunc(n)^Math.trunc(n>>32))}},{key:"interfaces_",get:function(){return[B,Z]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)u.constructor_.call(this,new S,new S);else if(arguments.length===1){var e=arguments[0];u.constructor_.call(this,e.p0,e.p1)}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this.p0=t,this.p1=n}else if(arguments.length===4){var a=arguments[0],c=arguments[1],d=arguments[2],y=arguments[3];u.constructor_.call(this,new S(a,c),new S(d,y))}}},{key:"midPoint",value:function(e,t){return new S((e.x+t.x)/2,(e.y+t.y)/2)}}]),u}(),_u=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var e=arguments[0],t=arguments[1],n=arguments[2],a=arguments[3];e.getLineSegment(t,this._overlapSeg1),n.getLineSegment(a,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new Qe,this._overlapSeg2=new Qe}}]),u}(),Ki=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getLineSegment",value:function(e,t){t.p0=this._pts[e],t.p1=this._pts[e+1]}},{key:"computeSelect",value:function(e,t,n,a){var c=this._pts[t],d=this._pts[n];if(n-t==1)return a.select(this,t),null;if(!e.intersects(c,d))return null;var y=Math.trunc((t+n)/2);t<y&&this.computeSelect(e,t,y,a),y<n&&this.computeSelect(e,y,n,a)}},{key:"getCoordinates",value:function(){for(var e=new Array(this._end-this._start+1).fill(null),t=0,n=this._start;n<=this._end;n++)e[t++]=this._pts[n];return e}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1];this.computeOverlaps(this._start,this._end,e,e._start,e._end,t)}else if(arguments.length===6){var n=arguments[0],a=arguments[1],c=arguments[2],d=arguments[3],y=arguments[4],p=arguments[5];if(a-n==1&&y-d==1)return p.overlap(this,n,c,d),null;if(!this.overlaps(n,a,c,d,y))return null;var E=Math.trunc((n+a)/2),I=Math.trunc((d+y)/2);n<E&&(d<I&&this.computeOverlaps(n,E,c,d,I,p),I<y&&this.computeOverlaps(n,E,c,I,y,p)),E<a&&(d<I&&this.computeOverlaps(E,a,c,d,I,p),I<y&&this.computeOverlaps(E,a,c,I,y,p))}}},{key:"setId",value:function(e){this._id=e}},{key:"select",value:function(e,t){this.computeSelect(e,this._start,this._end,t)}},{key:"getEnvelope",value:function(){if(this._env===null){var e=this._pts[this._start],t=this._pts[this._end];this._env=new ke(e,t)}return this._env}},{key:"overlaps",value:function(e,t,n,a,c){return ke.intersects(this._pts[e],this._pts[t],n._pts[a],n._pts[c])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var e=arguments[0],t=arguments[1],n=arguments[2],a=arguments[3];this._pts=e,this._start=t,this._end=n,this._context=a}}]),u}(),xu=function(){function u(){i(this,u)}return l(u,null,[{key:"findChainEnd",value:function(e,t){for(var n=t;n<e.length-1&&e[n].equals2D(e[n+1]);)n++;if(n>=e.length-1)return e.length-1;for(var a=He.quadrant(e[n],e[n+1]),c=t+1;c<e.length&&!(!e[c-1].equals2D(e[c])&&He.quadrant(e[c-1],e[c])!==a);)c++;return c-1}},{key:"getChains",value:function(){if(arguments.length===1){var e=arguments[0];return u.getChains(e,null)}if(arguments.length===2){var t=arguments[0],n=arguments[1],a=new K,c=0;do{var d=u.findChainEnd(t,c),y=new Ki(t,c,d,n);a.add(y),c=d}while(c<t.length-1);return a}}}]),u}(),Ar=function(){function u(){i(this,u)}return l(u,[{key:"computeNodes",value:function(e){}},{key:"getNodedSubstrings",value:function(){}}]),u}(),Qi=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"setSegmentIntersector",value:function(e){this._segInt=e}},{key:"interfaces_",get:function(){return[Ar]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setSegmentIntersector(e)}}}}]),u}(),Dr=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return Dt.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(n){for(var a=xu.getChains(n.getCoordinates(),n).iterator();a.hasNext();){var c=a.next();c.setId(this._idCounter++),this._index.insert(c.getEnvelope(),c),this._monoChains.add(c)}}},{key:"computeNodes",value:function(n){this._nodedSegStrings=n;for(var a=n.iterator();a.hasNext();)this.add(a.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var n=new ji(this._segInt),a=this._monoChains.iterator();a.hasNext();)for(var c=a.next(),d=this._index.query(c.getEnvelope()).iterator();d.hasNext();){var y=d.next();if(y.getId()>c.getId()&&(c.computeOverlaps(y,n),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new K,this._index=new vt,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var n=arguments[0];Qi.constructor_.call(this,n)}}}}]),t}(Qi),ji=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"overlap",value:function(){if(arguments.length!==4)return N(f(t.prototype),"overlap",this).apply(this,arguments);var n=arguments[0],a=arguments[1],c=arguments[2],d=arguments[3],y=n.getContext(),p=c.getContext();this._si.processIntersections(y,a,p,d)}}],[{key:"constructor_",value:function(){this._si=null;var n=arguments[0];this._si=n}}]),t}(_u);Dr.SegmentOverlapAction=ji;var lt=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"isDeletable",value:function(e,t,n,a){var c=this._inputLine[e],d=this._inputLine[t],y=this._inputLine[n];return!!this.isConcave(c,d,y)&&!!this.isShallow(c,d,y,a)&&this.isShallowSampled(c,d,e,n,a)}},{key:"deleteShallowConcavities",value:function(){for(var e=1,t=this.findNextNonDeletedIndex(e),n=this.findNextNonDeletedIndex(t),a=!1;n<this._inputLine.length;){var c=!1;this.isDeletable(e,t,n,this._distanceTol)&&(this._isDeleted[t]=u.DELETE,c=!0,a=!0),e=c?n:t,t=this.findNextNonDeletedIndex(e),n=this.findNextNonDeletedIndex(t)}return a}},{key:"isShallowConcavity",value:function(e,t,n,a){return ee.index(e,t,n)===this._angleOrientation&&gt.pointToSegment(t,e,n)<a}},{key:"isShallowSampled",value:function(e,t,n,a,c){var d=Math.trunc((a-n)/u.NUM_PTS_TO_CHECK);d<=0&&(d=1);for(var y=n;y<a;y+=d)if(!this.isShallow(e,t,this._inputLine[y],c))return!1;return!0}},{key:"isConcave",value:function(e,t,n){var a=ee.index(e,t,n)===this._angleOrientation;return a}},{key:"simplify",value:function(e){this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=ee.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var t=!1;do t=this.deleteShallowConcavities();while(t);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(e){for(var t=e+1;t<this._inputLine.length&&this._isDeleted[t]===u.DELETE;)t++;return t}},{key:"isShallow",value:function(e,t,n,a){return gt.pointToSegment(t,e,n)<a}},{key:"collapseLine",value:function(){for(var e=new gn,t=0;t<this._inputLine.length;t++)this._isDeleted[t]!==u.DELETE&&e.add(this._inputLine[t]);return e.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=ee.COUNTERCLOCKWISE;var e=arguments[0];this._inputLine=e}},{key:"simplify",value:function(e,t){return new u(e).simplify(t)}}]),u}();lt.INIT=0,lt.DELETE=1,lt.KEEP=1,lt.NUM_PTS_TO_CHECK=10;var es=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getCoordinates",value:function(){return this._ptList.toArray(u.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(e){this._precisionModel=e}},{key:"addPt",value:function(e){var t=new S(e);if(this._precisionModel.makePrecise(t),this.isRedundant(t))return null;this._ptList.add(t)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(e,t){if(t)for(var n=0;n<e.length;n++)this.addPt(e[n]);else for(var a=e.length-1;a>=0;a--)this.addPt(e[a])}},{key:"isRedundant",value:function(e){if(this._ptList.size()<1)return!1;var t=this._ptList.get(this._ptList.size()-1);return e.distance(t)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Wt().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var e=new S(this._ptList.get(0)),t=this._ptList.get(this._ptList.size()-1);if(e.equals(t))return null;this._ptList.add(e)}},{key:"setMinimumVertexDistance",value:function(e){this._minimimVertexDistance=e}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new K}}]),u}();es.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var je=function(){function u(){i(this,u)}return l(u,null,[{key:"toDegrees",value:function(e){return 180*e/Math.PI}},{key:"normalize",value:function(e){for(;e>Math.PI;)e-=u.PI_TIMES_2;for(;e<=-Math.PI;)e+=u.PI_TIMES_2;return e}},{key:"angle",value:function(){if(arguments.length===1){var e=arguments[0];return Math.atan2(e.y,e.x)}if(arguments.length===2){var t=arguments[0],n=arguments[1],a=n.x-t.x,c=n.y-t.y;return Math.atan2(c,a)}}},{key:"isAcute",value:function(e,t,n){var a=e.x-t.x,c=e.y-t.y;return a*(n.x-t.x)+c*(n.y-t.y)>0}},{key:"isObtuse",value:function(e,t,n){var a=e.x-t.x,c=e.y-t.y;return a*(n.x-t.x)+c*(n.y-t.y)<0}},{key:"interiorAngle",value:function(e,t,n){var a=u.angle(t,e),c=u.angle(t,n);return Math.abs(c-a)}},{key:"normalizePositive",value:function(e){if(e<0){for(;e<0;)e+=u.PI_TIMES_2;e>=u.PI_TIMES_2&&(e=0)}else{for(;e>=u.PI_TIMES_2;)e-=u.PI_TIMES_2;e<0&&(e=0)}return e}},{key:"angleBetween",value:function(e,t,n){var a=u.angle(t,e),c=u.angle(t,n);return u.diff(a,c)}},{key:"diff",value:function(e,t){var n=null;return(n=e<t?t-e:e-t)>Math.PI&&(n=2*Math.PI-n),n}},{key:"toRadians",value:function(e){return e*Math.PI/180}},{key:"getTurn",value:function(e,t){var n=Math.sin(t-e);return n>0?u.COUNTERCLOCKWISE:n<0?u.CLOCKWISE:u.NONE}},{key:"angleBetweenOriented",value:function(e,t,n){var a=u.angle(t,e),c=u.angle(t,n)-a;return c<=-Math.PI?c+u.PI_TIMES_2:c>Math.PI?c-u.PI_TIMES_2:c}}]),u}();je.PI_TIMES_2=2*Math.PI,je.PI_OVER_2=Math.PI/2,je.PI_OVER_4=Math.PI/4,je.COUNTERCLOCKWISE=ee.COUNTERCLOCKWISE,je.CLOCKWISE=ee.CLOCKWISE,je.NONE=ee.COLLINEAR;var mn=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"addNextSegment",value:function(e,t){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=ee.index(this._s0,this._s1,this._s2),a=n===ee.CLOCKWISE&&this._side===G.LEFT||n===ee.COUNTERCLOCKWISE&&this._side===G.RIGHT;n===0?this.addCollinear(t):a?this.addOutsideTurn(n,t):this.addInsideTurn(n,t)}},{key:"addLineEndCap",value:function(e,t){var n=new Qe(e,t),a=new Qe;this.computeOffsetSegment(n,G.LEFT,this._distance,a);var c=new Qe;this.computeOffsetSegment(n,G.RIGHT,this._distance,c);var d=t.x-e.x,y=t.y-e.y,p=Math.atan2(y,d);switch(this._bufParams.getEndCapStyle()){case b.CAP_ROUND:this._segList.addPt(a.p1),this.addDirectedFillet(t,p+Math.PI/2,p-Math.PI/2,ee.CLOCKWISE,this._distance),this._segList.addPt(c.p1);break;case b.CAP_FLAT:this._segList.addPt(a.p1),this._segList.addPt(c.p1);break;case b.CAP_SQUARE:var E=new S;E.x=Math.abs(this._distance)*Math.cos(p),E.y=Math.abs(this._distance)*Math.sin(p);var I=new S(a.p1.x+E.x,a.p1.y+E.y),L=new S(c.p1.x+E.x,c.p1.y+E.y);this._segList.addPt(I),this._segList.addPt(L)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(e,t,n,a){var c=wr.intersection(t.p0,t.p1,n.p0,n.p1);if(c!==null&&(a<=0?1:c.distance(e)/Math.abs(a))<=this._bufParams.getMitreLimit())return this._segList.addPt(c),null;this.addLimitedMitreJoin(t,n,a,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(e,t){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*u.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===b.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===b.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(t&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(e){this._segList.addPt(new S(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new S(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new S(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new S(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(e,t){this._segList.addPts(e,t)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(e,t,n,a,c){var d=t.x-e.x,y=t.y-e.y,p=Math.atan2(y,d),E=n.x-e.x,I=n.y-e.y,L=Math.atan2(I,E);a===ee.CLOCKWISE?p<=L&&(p+=2*Math.PI):p>=L&&(p-=2*Math.PI),this._segList.addPt(t),this.addDirectedFillet(e,p,L,a,c),this._segList.addPt(n)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(e,t,n){this._s1=e,this._s2=t,this._side=n,this._seg1.setCoordinates(e,t),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(e,t,n,a){var c=this._seg0.p1,d=je.angle(c,this._seg0.p0),y=je.angleBetweenOriented(this._seg0.p0,c,this._seg1.p1)/2,p=je.normalize(d+y),E=je.normalize(p+Math.PI),I=a*n,L=n-I*Math.abs(Math.sin(y)),T=c.x+I*Math.cos(E),q=c.y+I*Math.sin(E),F=new S(T,q),H=new Qe(c,F),$=H.pointAlongOffset(1,L),te=H.pointAlongOffset(1,-L);this._side===G.LEFT?(this._segList.addPt($),this._segList.addPt(te)):(this._segList.addPt(te),this._segList.addPt($))}},{key:"addDirectedFillet",value:function(e,t,n,a,c){var d=a===ee.CLOCKWISE?-1:1,y=Math.abs(t-n),p=Math.trunc(y/this._filletAngleQuantum+.5);if(p<1)return null;for(var E=y/p,I=new S,L=0;L<p;L++){var T=t+d*L*E;I.x=e.x+c*Math.cos(T),I.y=e.y+c*Math.sin(T),this._segList.addPt(I)}}},{key:"computeOffsetSegment",value:function(e,t,n,a){var c=t===G.LEFT?1:-1,d=e.p1.x-e.p0.x,y=e.p1.y-e.p0.y,p=Math.sqrt(d*d+y*y),E=c*n*d/p,I=c*n*y/p;a.p0.x=e.p0.x-I,a.p0.y=e.p0.y+E,a.p1.x=e.p1.x-I,a.p1.y=e.p1.y+E}},{key:"addInsideTurn",value:function(e,t){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*u.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new S((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var a=new S((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(a)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(e){var t=new S(e.x+this._distance,e.y);this._segList.addPt(t),this.addDirectedFillet(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(e,t){this._segList.addPt(e.p1),this._segList.addPt(t.p0)}},{key:"init",value:function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new es,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*u.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===b.JOIN_BEVEL||this._bufParams.getJoinStyle()===b.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,ee.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Qe,this._seg1=new Qe,this._offset0=new Qe,this._offset1=new Qe,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],t=arguments[1],n=arguments[2];this._precisionModel=e,this._bufParams=t,this._li=new At,this._filletAngleQuantum=Math.PI/2/t.getQuadrantSegments(),t.getQuadrantSegments()>=8&&t.getJoinStyle()===b.JOIN_ROUND&&(this._closingSegLengthFactor=u.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}}]),u}();mn.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,mn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,mn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,mn.MAX_CLOSING_SEG_LEN_FACTOR=80;var Eu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getOffsetCurve",value:function(e,t){if(this._distance=t,t===0)return null;var n=t<0,a=Math.abs(t),c=this.getSegGen(a);e.length<=1?this.computePointCurve(e[0],c):this.computeOffsetCurve(e,n,c);var d=c.getCoordinates();return n&&Ge.reverse(d),d}},{key:"computeSingleSidedBufferCurve",value:function(e,t,n){var a=this.simplifyTolerance(this._distance);if(t){n.addSegments(e,!0);var c=lt.simplify(e,-a),d=c.length-1;n.initSideSegments(c[d],c[d-1],G.LEFT),n.addFirstSegment();for(var y=d-2;y>=0;y--)n.addNextSegment(c[y],!0)}else{n.addSegments(e,!1);var p=lt.simplify(e,a),E=p.length-1;n.initSideSegments(p[0],p[1],G.LEFT),n.addFirstSegment();for(var I=2;I<=E;I++)n.addNextSegment(p[I],!0)}n.addLastSegment(),n.closeRing()}},{key:"computeRingBufferCurve",value:function(e,t,n){var a=this.simplifyTolerance(this._distance);t===G.RIGHT&&(a=-a);var c=lt.simplify(e,a),d=c.length-1;n.initSideSegments(c[d-1],c[0],t);for(var y=1;y<=d;y++){var p=y!==1;n.addNextSegment(c[y],p)}n.closeRing()}},{key:"computeLineBufferCurve",value:function(e,t){var n=this.simplifyTolerance(this._distance),a=lt.simplify(e,n),c=a.length-1;t.initSideSegments(a[0],a[1],G.LEFT);for(var d=2;d<=c;d++)t.addNextSegment(a[d],!0);t.addLastSegment(),t.addLineEndCap(a[c-1],a[c]);var y=lt.simplify(e,-n),p=y.length-1;t.initSideSegments(y[p],y[p-1],G.LEFT);for(var E=p-2;E>=0;E--)t.addNextSegment(y[E],!0);t.addLastSegment(),t.addLineEndCap(y[1],y[0]),t.closeRing()}},{key:"computePointCurve",value:function(e,t){switch(this._bufParams.getEndCapStyle()){case b.CAP_ROUND:t.createCircle(e);break;case b.CAP_SQUARE:t.createSquare(e)}}},{key:"getLineCurve",value:function(e,t){if(this._distance=t,this.isLineOffsetEmpty(t))return null;var n=Math.abs(t),a=this.getSegGen(n);if(e.length<=1)this.computePointCurve(e[0],a);else if(this._bufParams.isSingleSided()){var c=t<0;this.computeSingleSidedBufferCurve(e,c,a)}else this.computeLineBufferCurve(e,a);return a.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(e){return e*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(e,t,n){if(this._distance=n,e.length<=2)return this.getLineCurve(e,n);if(n===0)return u.copyCoordinates(e);var a=this.getSegGen(n);return this.computeRingBufferCurve(e,t,a),a.getCoordinates()}},{key:"computeOffsetCurve",value:function(e,t,n){var a=this.simplifyTolerance(this._distance);if(t){var c=lt.simplify(e,-a),d=c.length-1;n.initSideSegments(c[d],c[d-1],G.LEFT),n.addFirstSegment();for(var y=d-2;y>=0;y--)n.addNextSegment(c[y],!0)}else{var p=lt.simplify(e,a),E=p.length-1;n.initSideSegments(p[0],p[1],G.LEFT),n.addFirstSegment();for(var I=2;I<=E;I++)n.addNextSegment(p[I],!0)}n.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(e){return e===0||e<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(e){return new mn(this._precisionModel,this._bufParams,e)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var e=arguments[0],t=arguments[1];this._precisionModel=e,this._bufParams=t}},{key:"copyCoordinates",value:function(e){for(var t=new Array(e.length).fill(null),n=0;n<t.length;n++)t[n]=new S(e[n]);return t}}]),u}(),ts=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var e=arguments[0],t=new K,n=this._subgraphs.iterator();n.hasNext();){var a=n.next(),c=a.getEnvelope();e.y<c.getMinY()||e.y>c.getMaxY()||this.findStabbedSegments(e,a.getDirectedEdges(),t)}return t}if(arguments.length===3){if(oe(arguments[2],St)&&arguments[0]instanceof S&&arguments[1]instanceof Rr)for(var d=arguments[0],y=arguments[1],p=arguments[2],E=y.getEdge().getCoordinates(),I=0;I<E.length-1;I++){this._seg.p0=E[I],this._seg.p1=E[I+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse();var L=Math.max(this._seg.p0.x,this._seg.p1.x);if(!(L<d.x)&&!(this._seg.isHorizontal()||d.y<this._seg.p0.y||d.y>this._seg.p1.y||ee.index(this._seg.p0,this._seg.p1,d)===ee.RIGHT)){var T=y.getDepth(G.LEFT);this._seg.p0.equals(E[I])||(T=y.getDepth(G.RIGHT));var q=new ns(this._seg,T);p.add(q)}}else if(oe(arguments[2],St)&&arguments[0]instanceof S&&oe(arguments[1],St))for(var F=arguments[0],H=arguments[1],$=arguments[2],te=H.iterator();te.hasNext();){var Ee=te.next();Ee.isForward()&&this.findStabbedSegments(F,Ee,$)}}}},{key:"getDepth",value:function(e){var t=this.findStabbedSegments(e);return t.size()===0?0:Jt.min(t)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new Qe;var e=arguments[0];this._subgraphs=e}}]),u}(),ns=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"compareTo",value:function(e){var t=e;if(this._upwardSeg.minX()>=t._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=t._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(t._upwardSeg);return n!==0||(n=-1*t._upwardSeg.orientationIndex(this._upwardSeg))!==0?n:this._upwardSeg.compareTo(t._upwardSeg)}},{key:"compareX",value:function(e,t){var n=e.p0.compareTo(t.p0);return n!==0?n:e.p1.compareTo(t.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[B]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var e=arguments[0],t=arguments[1];this._upwardSeg=new Qe(e),this._leftDepth=t}}]),u}();ts.DepthSegment=ns;var rs=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,null,[{key:"constructor_",value:function(){A.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}]),t}(A),Fr=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getY",value:function(){var e=this.y/this.w;if(X.isNaN(e)||X.isInfinite(e))throw new rs;return e}},{key:"getX",value:function(){var e=this.x/this.w;if(X.isNaN(e)||X.isInfinite(e))throw new rs;return e}},{key:"getCoordinate",value:function(){var e=new S;return e.x=this.getX(),e.y=this.getY(),e}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],n=arguments[1];this.x=t,this.y=n,this.w=1}else if(arguments[0]instanceof u&&arguments[1]instanceof u){var a=arguments[0],c=arguments[1];this.x=a.y*c.w-c.y*a.w,this.y=c.x*a.w-a.x*c.w,this.w=a.x*c.y-c.x*a.y}else if(arguments[0]instanceof S&&arguments[1]instanceof S){var d=arguments[0],y=arguments[1];this.x=d.y-y.y,this.y=y.x-d.x,this.w=d.x*y.y-y.x*d.y}}else if(arguments.length===3){var p=arguments[0],E=arguments[1],I=arguments[2];this.x=p,this.y=E,this.w=I}else if(arguments.length===4){var L=arguments[0],T=arguments[1],q=arguments[2],F=arguments[3],H=L.y-T.y,$=T.x-L.x,te=L.x*T.y-T.x*L.y,Ee=q.y-F.y,Se=F.x-q.x,Xe=q.x*F.y-F.x*q.y;this.x=$*Xe-Se*te,this.y=Ee*te-H*Xe,this.w=H*Se-Ee*$}}}]),u}(),ku=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"area",value:function(){return u.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return u.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(e){if(e===null)throw new O("Supplied point is null.");return u.interpolateZ(e,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return u.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return u.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return u.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return u.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return u.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return u.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var e=arguments[0],t=arguments[1],n=arguments[2];this.p0=e,this.p1=t,this.p2=n}},{key:"area",value:function(e,t,n){return Math.abs(((n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y))/2)}},{key:"signedArea",value:function(e,t,n){return((n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y))/2}},{key:"det",value:function(e,t,n,a){return e*a-t*n}},{key:"interpolateZ",value:function(e,t,n,a){var c=t.x,d=t.y,y=n.x-c,p=a.x-c,E=n.y-d,I=a.y-d,L=y*I-p*E,T=e.x-c,q=e.y-d,F=(I*T-p*q)/L,H=(-E*T+y*q)/L;return t.getZ()+F*(n.getZ()-t.getZ())+H*(a.getZ()-t.getZ())}},{key:"longestSideLength",value:function(e,t,n){var a=e.distance(t),c=t.distance(n),d=n.distance(e),y=a;return c>y&&(y=c),d>y&&(y=d),y}},{key:"circumcentreDD",value:function(e,t,n){var a=Q.valueOf(e.x).subtract(n.x),c=Q.valueOf(e.y).subtract(n.y),d=Q.valueOf(t.x).subtract(n.x),y=Q.valueOf(t.y).subtract(n.y),p=Q.determinant(a,c,d,y).multiply(2),E=a.sqr().add(c.sqr()),I=d.sqr().add(y.sqr()),L=Q.determinant(c,E,y,I),T=Q.determinant(a,E,d,I),q=Q.valueOf(n.x).subtract(L.divide(p)).doubleValue(),F=Q.valueOf(n.y).add(T.divide(p)).doubleValue();return new S(q,F)}},{key:"isAcute",value:function(e,t,n){return!!je.isAcute(e,t,n)&&!!je.isAcute(t,n,e)&&!!je.isAcute(n,e,t)}},{key:"circumcentre",value:function(e,t,n){var a=n.x,c=n.y,d=e.x-a,y=e.y-c,p=t.x-a,E=t.y-c,I=2*u.det(d,y,p,E),L=u.det(y,d*d+y*y,E,p*p+E*E),T=u.det(d,d*d+y*y,p,p*p+E*E);return new S(a-L/I,c+T/I)}},{key:"perpendicularBisector",value:function(e,t){var n=t.x-e.x,a=t.y-e.y,c=new Fr(e.x+n/2,e.y+a/2,1),d=new Fr(e.x-a+n/2,e.y+n+a/2,1);return new Fr(c,d)}},{key:"angleBisector",value:function(e,t,n){var a=t.distance(e),c=a/(a+t.distance(n)),d=n.x-e.x,y=n.y-e.y;return new S(e.x+c*d,e.y+c*y)}},{key:"area3D",value:function(e,t,n){var a=t.x-e.x,c=t.y-e.y,d=t.getZ()-e.getZ(),y=n.x-e.x,p=n.y-e.y,E=n.getZ()-e.getZ(),I=c*E-d*p,L=d*y-a*E,T=a*p-c*y,q=I*I+L*L+T*T,F=Math.sqrt(q)/2;return F}},{key:"centroid",value:function(e,t,n){var a=(e.x+t.x+n.x)/3,c=(e.y+t.y+n.y)/3;return new S(a,c)}},{key:"inCentre",value:function(e,t,n){var a=t.distance(n),c=e.distance(n),d=e.distance(t),y=a+c+d,p=(a*e.x+c*t.x+d*n.x)/y,E=(a*e.y+c*t.y+d*n.y)/y;return new S(p,E)}}]),u}(),wu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"addRingSide",value:function(e,t,n,a,c){if(t===0&&e.length<fn.MINIMUM_VALID_SIZE)return null;var d=a,y=c;e.length>=fn.MINIMUM_VALID_SIZE&&ee.isCCW(e)&&(d=c,y=a,n=G.opposite(n));var p=this._curveBuilder.getRingCurve(e,n,t);this.addCurve(p,d,y)}},{key:"addRingBothSides",value:function(e,t){this.addRingSide(e,t,G.LEFT,w.EXTERIOR,w.INTERIOR),this.addRingSide(e,t,G.RIGHT,w.INTERIOR,w.EXTERIOR)}},{key:"addPoint",value:function(e){if(this._distance<=0)return null;var t=e.getCoordinates(),n=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(n,w.EXTERIOR,w.INTERIOR)}},{key:"addPolygon",value:function(e){var t=this._distance,n=G.LEFT;this._distance<0&&(t=-this._distance,n=G.RIGHT);var a=e.getExteriorRing(),c=Ge.removeRepeatedPoints(a.getCoordinates());if(this._distance<0&&this.isErodedCompletely(a,this._distance)||this._distance<=0&&c.length<3)return null;this.addRingSide(c,t,n,w.EXTERIOR,w.INTERIOR);for(var d=0;d<e.getNumInteriorRing();d++){var y=e.getInteriorRingN(d),p=Ge.removeRepeatedPoints(y.getCoordinates());this._distance>0&&this.isErodedCompletely(y,-this._distance)||this.addRingSide(p,t,G.opposite(n),w.INTERIOR,w.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(e,t){var n=new ku(e[0],e[1],e[2]),a=n.inCentre();return gt.pointToSegment(a,n.p0,n.p1)<Math.abs(t)}},{key:"addLineString",value:function(e){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var t=Ge.removeRepeatedPoints(e.getCoordinates());if(Ge.isRing(t)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(t,this._distance);else{var n=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(n,w.EXTERIOR,w.INTERIOR)}}},{key:"addCurve",value:function(e,t,n){if(e===null||e.length<2)return null;var a=new Dt(e,new st(0,w.BOUNDARY,t,n));this._curveList.add(a)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(e){if(e.isEmpty())return null;if(e instanceof Bn)this.addPolygon(e);else if(e instanceof hn)this.addLineString(e);else if(e instanceof Ir)this.addPoint(e);else if(e instanceof Nr)this.addCollection(e);else if(e instanceof br)this.addCollection(e);else if(e instanceof Lr)this.addCollection(e);else{if(!(e instanceof Ke))throw new ft(e.getGeometryType());this.addCollection(e)}}},{key:"isErodedCompletely",value:function(e,t){var n=e.getCoordinates();if(n.length<4)return t<0;if(n.length===4)return this.isTriangleErodedCompletely(n,t);var a=e.getEnvelopeInternal(),c=Math.min(a.getHeight(),a.getWidth());return t<0&&2*Math.abs(t)>c}},{key:"addCollection",value:function(e){for(var t=0;t<e.getNumGeometries();t++){var n=e.getGeometryN(t);this.add(n)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new K;var e=arguments[0],t=arguments[1],n=arguments[2];this._inputGeom=e,this._distance=t,this._curveBuilder=n}}]),u}(),Iu=function(){function u(){i(this,u)}return l(u,[{key:"locate",value:function(e){}}]),u}(),Nu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,u.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Ht;var e=this._parent.getGeometryN(this._index++);return e instanceof Ke?(this._subcollectionIterator=new u(e),this._subcollectionIterator.next()):e}},{key:"remove",value:function(){throw new ft(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[du]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()}},{key:"isAtomic",value:function(e){return!(e instanceof Ke)}}]),u}(),Pu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"locate",value:function(e){return u.locate(e,this._geom)}},{key:"interfaces_",get:function(){return[Iu]}}],[{key:"constructor_",value:function(){this._geom=null;var e=arguments[0];this._geom=e}},{key:"locatePointInPolygon",value:function(e,t){if(t.isEmpty())return w.EXTERIOR;var n=t.getExteriorRing(),a=u.locatePointInRing(e,n);if(a!==w.INTERIOR)return a;for(var c=0;c<t.getNumInteriorRing();c++){var d=t.getInteriorRingN(c),y=u.locatePointInRing(e,d);if(y===w.BOUNDARY)return w.BOUNDARY;if(y===w.INTERIOR)return w.EXTERIOR}return w.INTERIOR}},{key:"locatePointInRing",value:function(e,t){return t.getEnvelopeInternal().intersects(e)?Tr.locateInRing(e,t.getCoordinates()):w.EXTERIOR}},{key:"containsPointInPolygon",value:function(e,t){return w.EXTERIOR!==u.locatePointInPolygon(e,t)}},{key:"locateInGeometry",value:function(e,t){if(t instanceof Bn)return u.locatePointInPolygon(e,t);if(t instanceof Ke)for(var n=new Nu(t);n.hasNext();){var a=n.next();if(a!==t){var c=u.locateInGeometry(e,a);if(c!==w.EXTERIOR)return c}}return w.EXTERIOR}},{key:"isContained",value:function(e,t){return w.EXTERIOR!==u.locate(e,t)}},{key:"locate",value:function(e,t){return t.isEmpty()?w.EXTERIOR:t.getEnvelopeInternal().intersects(e)?u.locateInGeometry(e,t):w.EXTERIOR}}]),u}(),Mu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getNextCW",value:function(e){this.getEdges();var t=this._edgeList.indexOf(e),n=t-1;return t===0&&(n=this._edgeList.size()-1),this._edgeList.get(n)}},{key:"propagateSideLabels",value:function(e){for(var t=w.NONE,n=this.iterator();n.hasNext();){var a=n.next().getLabel();a.isArea(e)&&a.getLocation(e,G.LEFT)!==w.NONE&&(t=a.getLocation(e,G.LEFT))}if(t===w.NONE)return null;for(var c=t,d=this.iterator();d.hasNext();){var y=d.next(),p=y.getLabel();if(p.getLocation(e,G.ON)===w.NONE&&p.setLocation(e,G.ON,c),p.isArea(e)){var E=p.getLocation(e,G.LEFT),I=p.getLocation(e,G.RIGHT);if(I!==w.NONE){if(I!==c)throw new pt("side location conflict",y.getCoordinate());E===w.NONE&&U.shouldNeverReachHere("found single null side (at "+y.getCoordinate()+")"),c=E}else U.isTrue(p.getLocation(e,G.LEFT)===w.NONE,"found single null side"),p.setLocation(e,G.RIGHT,c),p.setLocation(e,G.LEFT,c)}}}},{key:"getCoordinate",value:function(){var e=this.iterator();return e.hasNext()?e.next().getCoordinate():null}},{key:"print",value:function(e){rt.out.println("EdgeEndStar:   "+this.getCoordinate());for(var t=this.iterator();t.hasNext();)t.next().print(e)}},{key:"isAreaLabelsConsistent",value:function(e){return this.computeEdgeEndLabels(e.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(e){var t=this.getEdges();if(t.size()<=0)return!0;var n=t.size()-1,a=t.get(n).getLabel().getLocation(e,G.LEFT);U.isTrue(a!==w.NONE,"Found unlabelled area edge");for(var c=a,d=this.iterator();d.hasNext();){var y=d.next().getLabel();U.isTrue(y.isArea(e),"Found non-area edge");var p=y.getLocation(e,G.LEFT),E=y.getLocation(e,G.RIGHT);if(p===E||E!==c)return!1;c=p}return!0}},{key:"findIndex",value:function(e){this.iterator();for(var t=0;t<this._edgeList.size();t++)if(this._edgeList.get(t)===e)return t;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new K(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(e,t,n){return this._ptInAreaLocation[e]===w.NONE&&(this._ptInAreaLocation[e]=Pu.locate(t,n[e].getGeometry())),this._ptInAreaLocation[e]}},{key:"toString",value:function(){var e=new ln;e.append("EdgeEndStar:   "+this.getCoordinate()),e.append(`
`);for(var t=this.iterator();t.hasNext();){var n=t.next();e.append(n),e.append(`
`)}return e.toString()}},{key:"computeEdgeEndLabels",value:function(e){for(var t=this.iterator();t.hasNext();)t.next().computeLabel(e)}},{key:"computeLabelling",value:function(e){this.computeEdgeEndLabels(e[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var t=[!1,!1],n=this.iterator();n.hasNext();)for(var a=n.next().getLabel(),c=0;c<2;c++)a.isLine(c)&&a.getLocation(c)===w.BOUNDARY&&(t[c]=!0);for(var d=this.iterator();d.hasNext();)for(var y=d.next(),p=y.getLabel(),E=0;E<2;E++)if(p.isAnyNull(E)){var I=w.NONE;if(t[E])I=w.EXTERIOR;else{var L=y.getCoordinate();I=this.getLocation(E,L,e)}p.setAllLocationsIfNull(E,I)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(e,t){this._edgeMap.put(e,t),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new yn,this._edgeList=null,this._ptInAreaLocation=[w.NONE,w.NONE]}}]),u}(),Lu=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var n=null,a=null,c=this._SCANNING_FOR_INCOMING,d=0;d<this._resultAreaEdgeList.size();d++){var y=this._resultAreaEdgeList.get(d),p=y.getSym();if(y.getLabel().isArea())switch(n===null&&y.isInResult()&&(n=y),c){case this._SCANNING_FOR_INCOMING:if(!p.isInResult())continue;a=p,c=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!y.isInResult())continue;a.setNext(y),c=this._SCANNING_FOR_INCOMING}}if(c===this._LINKING_TO_OUTGOING){if(n===null)throw new pt("no outgoing dirEdge found",this.getCoordinate());U.isTrue(n.isInResult(),"unable to link last incoming dirEdge"),a.setNext(n)}}},{key:"insert",value:function(n){var a=n;this.insertEdgeEnd(a,a)}},{key:"getRightmostEdge",value:function(){var n=this.getEdges(),a=n.size();if(a<1)return null;var c=n.get(0);if(a===1)return c;var d=n.get(a-1),y=c.getQuadrant(),p=d.getQuadrant();return He.isNorthern(y)&&He.isNorthern(p)?c:He.isNorthern(y)||He.isNorthern(p)?c.getDy()!==0?c:d.getDy()!==0?d:(U.shouldNeverReachHere("found two horizontal edges incident on node"),null):d}},{key:"print",value:function(n){rt.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var a=this.iterator();a.hasNext();){var c=a.next();n.print("out "),c.print(n),n.println(),n.print("in "),c.getSym().print(n),n.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new K;for(var n=this.iterator();n.hasNext();){var a=n.next();(a.isInResult()||a.getSym().isInResult())&&this._resultAreaEdgeList.add(a)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(n){for(var a=this.iterator();a.hasNext();){var c=a.next().getLabel();c.setAllLocationsIfNull(0,n.getLocation(0)),c.setAllLocationsIfNull(1,n.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var n=null,a=null,c=this._edgeList.size()-1;c>=0;c--){var d=this._edgeList.get(c),y=d.getSym();a===null&&(a=y),n!==null&&y.setNext(n),n=d}a.setNext(n)}},{key:"computeDepths",value:function(){if(arguments.length===1){var n=arguments[0],a=this.findIndex(n),c=n.getDepth(G.LEFT),d=n.getDepth(G.RIGHT),y=this.computeDepths(a+1,this._edgeList.size(),c),p=this.computeDepths(0,a,y);if(p!==d)throw new pt("depth mismatch at "+n.getCoordinate())}else if(arguments.length===3){for(var E=arguments[0],I=arguments[1],L=arguments[2],T=L,q=E;q<I;q++){var F=this._edgeList.get(q);F.setEdgeDepths(G.RIGHT,T),T=F.getDepth(G.LEFT)}return T}}},{key:"mergeSymLabels",value:function(){for(var n=this.iterator();n.hasNext();){var a=n.next();a.getLabel().merge(a.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(n){for(var a=null,c=null,d=this._SCANNING_FOR_INCOMING,y=this._resultAreaEdgeList.size()-1;y>=0;y--){var p=this._resultAreaEdgeList.get(y),E=p.getSym();switch(a===null&&p.getEdgeRing()===n&&(a=p),d){case this._SCANNING_FOR_INCOMING:if(E.getEdgeRing()!==n)continue;c=E,d=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(p.getEdgeRing()!==n)continue;c.setNextMin(p),d=this._SCANNING_FOR_INCOMING}}d===this._LINKING_TO_OUTGOING&&(U.isTrue(a!==null,"found null for first outgoing dirEdge"),U.isTrue(a.getEdgeRing()===n,"unable to link last incoming dirEdge"),c.setNextMin(a))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var n=0,a=this.iterator();a.hasNext();){var c=a.next();c.isInResult()&&n++}return n}if(arguments.length===1){for(var d=arguments[0],y=0,p=this.iterator();p.hasNext();){var E=p.next();E.getEdgeRing()===d&&y++}return y}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var n=w.NONE,a=this.iterator();a.hasNext();){var c=a.next(),d=c.getSym();if(!c.isLineEdge()){if(c.isInResult()){n=w.INTERIOR;break}if(d.isInResult()){n=w.EXTERIOR;break}}}if(n===w.NONE)return null;for(var y=n,p=this.iterator();p.hasNext();){var E=p.next(),I=E.getSym();E.isLineEdge()?E.getEdge().setCovered(y===w.INTERIOR):(E.isInResult()&&(y=w.EXTERIOR),I.isInResult()&&(y=w.INTERIOR))}}},{key:"computeLabelling",value:function(n){N(f(t.prototype),"computeLabelling",this).call(this,n),this._label=new st(w.NONE);for(var a=this.iterator();a.hasNext();)for(var c=a.next().getEdge().getLabel(),d=0;d<2;d++){var y=c.getLocation(d);y!==w.INTERIOR&&y!==w.BOUNDARY||this._label.setLocation(d,w.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}]),t}(Mu),bu=function(u){h(t,u);var e=k(t);function t(){return i(this,t),e.call(this)}return l(t,[{key:"createNode",value:function(n){return new Hn(n,new Lu)}}]),t}(Hi),is=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"compareTo",value:function(e){var t=e;return u.compareOriented(this._pts,this._orientation,t._pts,t._orientation)}},{key:"interfaces_",get:function(){return[B]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=u.orientation(e)}},{key:"orientation",value:function(e){return Ge.increasingDirection(e)===1}},{key:"compareOriented",value:function(e,t,n,a){for(var c=t?1:-1,d=a?1:-1,y=t?e.length:-1,p=a?n.length:-1,E=t?0:e.length-1,I=a?0:n.length-1;;){var L=e[E].compareTo(n[I]);if(L!==0)return L;var T=(E+=c)===y,q=(I+=d)===p;if(T&&!q)return-1;if(!T&&q)return 1;if(T&&q)return 0}}}]),u}(),Su=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"print",value:function(e){e.print("MULTILINESTRING ( ");for(var t=0;t<this._edges.size();t++){var n=this._edges.get(t);t>0&&e.print(","),e.print("(");for(var a=n.getCoordinates(),c=0;c<a.length;c++)c>0&&e.print(","),e.print(a[c].x+" "+a[c].y);e.println(")")}e.print(")  ")}},{key:"addAll",value:function(e){for(var t=e.iterator();t.hasNext();)this.add(t.next())}},{key:"findEdgeIndex",value:function(e){for(var t=0;t<this._edges.size();t++)if(this._edges.get(t).equals(e))return t;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(e){return this._edges.get(e)}},{key:"findEqualEdge",value:function(e){var t=new is(e.getCoordinates());return this._ocaMap.get(t)}},{key:"add",value:function(e){this._edges.add(e);var t=new is(e.getCoordinates());this._ocaMap.put(t,e)}}],[{key:"constructor_",value:function(){this._edges=new K,this._ocaMap=new yn}}]),u}(),ss=function(){function u(){i(this,u)}return l(u,[{key:"processIntersections",value:function(e,t,n,a){}},{key:"isDone",value:function(){}}]),u}(),Cu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"isTrivialIntersection",value:function(e,t,n,a){if(e===n&&this._li.getIntersectionNum()===1){if(u.isAdjacentSegments(t,a))return!0;if(e.isClosed()){var c=e.size()-1;if(t===0&&a===c||a===0&&t===c)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(e,t,n,a){if(e===n&&t===a)return null;this.numTests++;var c=e.getCoordinates()[t],d=e.getCoordinates()[t+1],y=n.getCoordinates()[a],p=n.getCoordinates()[a+1];this._li.computeIntersection(c,d,y,p),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,t,n,a)||(this._hasIntersection=!0,e.addIntersections(this._li,t,0),n.addIntersections(this._li,a,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[ss]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var e=arguments[0];this._li=e}},{key:"isAdjacentSegments",value:function(e,t){return Math.abs(e-t)===1}}]),u}(),Tu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex),e.println(" dist = "+this.dist)}},{key:"compareTo",value:function(e){var t=e;return this.compare(t.segmentIndex,t.dist)}},{key:"isEndPoint",value:function(e){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===e}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(e,t){return this.segmentIndex<e?-1:this.segmentIndex>e?1:this.dist<t?-1:this.dist>t?1:0}},{key:"interfaces_",get:function(){return[B]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var e=arguments[0],t=arguments[1],n=arguments[2];this.coord=new S(e),this.segmentIndex=t,this.dist=n}}]),u}(),Ou=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"print",value:function(e){e.println("Intersections:");for(var t=this.iterator();t.hasNext();)t.next().print(e)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(e){this.addEndpoints();for(var t=this.iterator(),n=t.next();t.hasNext();){var a=t.next(),c=this.createSplitEdge(n,a);e.add(c),n=a}}},{key:"addEndpoints",value:function(){var e=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[e],e,0)}},{key:"createSplitEdge",value:function(e,t){var n=t.segmentIndex-e.segmentIndex+2,a=this.edge.pts[t.segmentIndex],c=t.dist>0||!t.coord.equals2D(a);c||n--;var d=new Array(n).fill(null),y=0;d[y++]=new S(e.coord);for(var p=e.segmentIndex+1;p<=t.segmentIndex;p++)d[y++]=this.edge.pts[p];return c&&(d[y]=t.coord),new os(d,new st(this.edge._label))}},{key:"add",value:function(e,t,n){var a=new Tu(e,t,n),c=this._nodeMap.get(a);return c!==null?c:(this._nodeMap.put(a,a),a)}},{key:"isIntersection",value:function(e){for(var t=this.iterator();t.hasNext();)if(t.next().coord.equals(e))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new yn,this.edge=null;var e=arguments[0];this.edge=e}}]),u}(),Ru=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(u.isTrue(this._matrix[w.INTERIOR][w.INTERIOR])||u.isTrue(this._matrix[w.INTERIOR][w.BOUNDARY])||u.isTrue(this._matrix[w.BOUNDARY][w.INTERIOR])||u.isTrue(this._matrix[w.BOUNDARY][w.BOUNDARY]))&&this._matrix[w.EXTERIOR][w.INTERIOR]===z.FALSE&&this._matrix[w.EXTERIOR][w.BOUNDARY]===z.FALSE}},{key:"isCoveredBy",value:function(){return(u.isTrue(this._matrix[w.INTERIOR][w.INTERIOR])||u.isTrue(this._matrix[w.INTERIOR][w.BOUNDARY])||u.isTrue(this._matrix[w.BOUNDARY][w.INTERIOR])||u.isTrue(this._matrix[w.BOUNDARY][w.BOUNDARY]))&&this._matrix[w.INTERIOR][w.EXTERIOR]===z.FALSE&&this._matrix[w.BOUNDARY][w.EXTERIOR]===z.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var e=arguments[0],t=0;t<e.length;t++){var n=Math.trunc(t/3),a=t%3;this._matrix[n][a]=z.toDimensionValue(e.charAt(t))}else if(arguments.length===3){var c=arguments[0],d=arguments[1],y=arguments[2];this._matrix[c][d]=y}}},{key:"isContains",value:function(){return u.isTrue(this._matrix[w.INTERIOR][w.INTERIOR])&&this._matrix[w.EXTERIOR][w.INTERIOR]===z.FALSE&&this._matrix[w.EXTERIOR][w.BOUNDARY]===z.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var e=arguments[0],t=0;t<e.length;t++){var n=Math.trunc(t/3),a=t%3;this.setAtLeast(n,a,z.toDimensionValue(e.charAt(t)))}else if(arguments.length===3){var c=arguments[0],d=arguments[1],y=arguments[2];this._matrix[c][d]<y&&(this._matrix[c][d]=y)}}},{key:"setAtLeastIfValid",value:function(e,t,n){e>=0&&t>=0&&this.setAtLeast(e,t,n)}},{key:"isWithin",value:function(){return u.isTrue(this._matrix[w.INTERIOR][w.INTERIOR])&&this._matrix[w.INTERIOR][w.EXTERIOR]===z.FALSE&&this._matrix[w.BOUNDARY][w.EXTERIOR]===z.FALSE}},{key:"isTouches",value:function(e,t){return e>t?this.isTouches(t,e):(e===z.A&&t===z.A||e===z.L&&t===z.L||e===z.L&&t===z.A||e===z.P&&t===z.A||e===z.P&&t===z.L)&&this._matrix[w.INTERIOR][w.INTERIOR]===z.FALSE&&(u.isTrue(this._matrix[w.INTERIOR][w.BOUNDARY])||u.isTrue(this._matrix[w.BOUNDARY][w.INTERIOR])||u.isTrue(this._matrix[w.BOUNDARY][w.BOUNDARY]))}},{key:"isOverlaps",value:function(e,t){return e===z.P&&t===z.P||e===z.A&&t===z.A?u.isTrue(this._matrix[w.INTERIOR][w.INTERIOR])&&u.isTrue(this._matrix[w.INTERIOR][w.EXTERIOR])&&u.isTrue(this._matrix[w.EXTERIOR][w.INTERIOR]):e===z.L&&t===z.L&&this._matrix[w.INTERIOR][w.INTERIOR]===1&&u.isTrue(this._matrix[w.INTERIOR][w.EXTERIOR])&&u.isTrue(this._matrix[w.EXTERIOR][w.INTERIOR])}},{key:"isEquals",value:function(e,t){return e===t&&u.isTrue(this._matrix[w.INTERIOR][w.INTERIOR])&&this._matrix[w.INTERIOR][w.EXTERIOR]===z.FALSE&&this._matrix[w.BOUNDARY][w.EXTERIOR]===z.FALSE&&this._matrix[w.EXTERIOR][w.INTERIOR]===z.FALSE&&this._matrix[w.EXTERIOR][w.BOUNDARY]===z.FALSE}},{key:"toString",value:function(){for(var e=new Xn("123456789"),t=0;t<3;t++)for(var n=0;n<3;n++)e.setCharAt(3*t+n,z.toDimensionSymbol(this._matrix[t][n]));return e.toString()}},{key:"setAll",value:function(e){for(var t=0;t<3;t++)for(var n=0;n<3;n++)this._matrix[t][n]=e}},{key:"get",value:function(e,t){return this._matrix[e][t]}},{key:"transpose",value:function(){var e=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=e,e=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=e,e=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=e,this}},{key:"matches",value:function(e){if(e.length!==9)throw new O("Should be length 9: "+e);for(var t=0;t<3;t++)for(var n=0;n<3;n++)if(!u.matches(this._matrix[t][n],e.charAt(3*t+n)))return!1;return!0}},{key:"add",value:function(e){for(var t=0;t<3;t++)for(var n=0;n<3;n++)this.setAtLeast(t,n,e.get(t,n))}},{key:"isDisjoint",value:function(){return this._matrix[w.INTERIOR][w.INTERIOR]===z.FALSE&&this._matrix[w.INTERIOR][w.BOUNDARY]===z.FALSE&&this._matrix[w.BOUNDARY][w.INTERIOR]===z.FALSE&&this._matrix[w.BOUNDARY][w.BOUNDARY]===z.FALSE}},{key:"isCrosses",value:function(e,t){return e===z.P&&t===z.L||e===z.P&&t===z.A||e===z.L&&t===z.A?u.isTrue(this._matrix[w.INTERIOR][w.INTERIOR])&&u.isTrue(this._matrix[w.INTERIOR][w.EXTERIOR]):e===z.L&&t===z.P||e===z.A&&t===z.P||e===z.A&&t===z.L?u.isTrue(this._matrix[w.INTERIOR][w.INTERIOR])&&u.isTrue(this._matrix[w.EXTERIOR][w.INTERIOR]):e===z.L&&t===z.L&&this._matrix[w.INTERIOR][w.INTERIOR]===0}},{key:"interfaces_",get:function(){return[W]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(z.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var e=arguments[0];u.constructor_.call(this),this.set(e)}else if(arguments[0]instanceof u){var t=arguments[0];u.constructor_.call(this),this._matrix[w.INTERIOR][w.INTERIOR]=t._matrix[w.INTERIOR][w.INTERIOR],this._matrix[w.INTERIOR][w.BOUNDARY]=t._matrix[w.INTERIOR][w.BOUNDARY],this._matrix[w.INTERIOR][w.EXTERIOR]=t._matrix[w.INTERIOR][w.EXTERIOR],this._matrix[w.BOUNDARY][w.INTERIOR]=t._matrix[w.BOUNDARY][w.INTERIOR],this._matrix[w.BOUNDARY][w.BOUNDARY]=t._matrix[w.BOUNDARY][w.BOUNDARY],this._matrix[w.BOUNDARY][w.EXTERIOR]=t._matrix[w.BOUNDARY][w.EXTERIOR],this._matrix[w.EXTERIOR][w.INTERIOR]=t._matrix[w.EXTERIOR][w.INTERIOR],this._matrix[w.EXTERIOR][w.BOUNDARY]=t._matrix[w.EXTERIOR][w.BOUNDARY],this._matrix[w.EXTERIOR][w.EXTERIOR]=t._matrix[w.EXTERIOR][w.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var e=arguments[0],t=arguments[1];return t===z.SYM_DONTCARE||t===z.SYM_TRUE&&(e>=0||e===z.TRUE)||t===z.SYM_FALSE&&e===z.FALSE||t===z.SYM_P&&e===z.P||t===z.SYM_L&&e===z.L||t===z.SYM_A&&e===z.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var n=arguments[0],a=arguments[1],c=new u(n);return c.matches(a)}}},{key:"isTrue",value:function(e){return e>=0||e===z.TRUE}}]),u}(),Au=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(e){return e===null||e.length===0?null:(this.ensureCapacity(this._size+e.length),rt.arraycopy(e,0,this._data,this._size,e.length),void(this._size+=e.length))}},{key:"ensureCapacity",value:function(e){if(e<=this._data.length)return null;var t=Math.max(e,2*this._data.length);this._data=Tt.copyOf(this._data,t)}},{key:"toArray",value:function(){var e=new Array(this._size).fill(null);return rt.arraycopy(this._data,0,e,0,this._size),e}},{key:"add",value:function(e){this.ensureCapacity(this._size+1),this._data[this._size]=e,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)u.constructor_.call(this,10);else if(arguments.length===1){var e=arguments[0];this._data=new Array(e).fill(null)}}}]),u}(),Du=function(){function u(){i(this,u)}return l(u,[{key:"getChainStartIndices",value:function(e){var t=0,n=new Au(Math.trunc(e.length/2));n.add(t);do{var a=this.findChainEnd(e,t);n.add(a),t=a}while(t<e.length-1);return n.toArray()}},{key:"findChainEnd",value:function(e,t){for(var n=He.quadrant(e[t],e[t+1]),a=t+1;a<e.length&&He.quadrant(e[a-1],e[a])===n;)a++;return a-1}},{key:"OLDgetChainStartIndices",value:function(e){var t=0,n=new K;n.add(t);do{var a=this.findChainEnd(e,t);n.add(a),t=a}while(t<e.length-1);return u.toIntArray(n)}}],[{key:"toIntArray",value:function(e){for(var t=new Array(e.size()).fill(null),n=0;n<t.length;n++)t[n]=e.get(n).intValue();return t}}]),u}(),Fu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(e){var t=this.pts[this.startIndex[e]].x,n=this.pts[this.startIndex[e+1]].x;return t>n?t:n}},{key:"getMinX",value:function(e){var t=this.pts[this.startIndex[e]].x,n=this.pts[this.startIndex[e+1]].x;return t<n?t:n}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var e=arguments[0],t=arguments[1],n=arguments[2],a=arguments[3];this.computeIntersectsForChain(this.startIndex[e],this.startIndex[e+1],t,t.startIndex[n],t.startIndex[n+1],a)}else if(arguments.length===6){var c=arguments[0],d=arguments[1],y=arguments[2],p=arguments[3],E=arguments[4],I=arguments[5];if(d-c==1&&E-p==1)return I.addIntersections(this.e,c,y.e,p),null;if(!this.overlaps(c,d,y,p,E))return null;var L=Math.trunc((c+d)/2),T=Math.trunc((p+E)/2);c<L&&(p<T&&this.computeIntersectsForChain(c,L,y,p,T,I),T<E&&this.computeIntersectsForChain(c,L,y,T,E,I)),L<d&&(p<T&&this.computeIntersectsForChain(L,d,y,p,T,I),T<E&&this.computeIntersectsForChain(L,d,y,T,E,I))}}},{key:"overlaps",value:function(e,t,n,a,c){return ke.intersects(this.pts[e],this.pts[t],n.pts[a],n.pts[c])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(e,t){for(var n=0;n<this.startIndex.length-1;n++)for(var a=0;a<e.startIndex.length-1;a++)this.computeIntersectsForChain(n,e,a,t)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var e=arguments[0];this.e=e,this.pts=e.getCoordinates();var t=new Du;this.startIndex=t.getChainStartIndices(this.pts)}}]),u}(),as=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"getDepth",value:function(e,t){return this._depth[e][t]}},{key:"setDepth",value:function(e,t,n){this._depth[e][t]=n}},{key:"isNull",value:function(){if(arguments.length===0){for(var e=0;e<2;e++)for(var t=0;t<3;t++)if(this._depth[e][t]!==u.NULL_VALUE)return!1;return!0}if(arguments.length===1){var n=arguments[0];return this._depth[n][1]===u.NULL_VALUE}if(arguments.length===2){var a=arguments[0],c=arguments[1];return this._depth[a][c]===u.NULL_VALUE}}},{key:"normalize",value:function(){for(var e=0;e<2;e++)if(!this.isNull(e)){var t=this._depth[e][1];this._depth[e][2]<t&&(t=this._depth[e][2]),t<0&&(t=0);for(var n=1;n<3;n++){var a=0;this._depth[e][n]>t&&(a=1),this._depth[e][n]=a}}}},{key:"getDelta",value:function(e){return this._depth[e][G.RIGHT]-this._depth[e][G.LEFT]}},{key:"getLocation",value:function(e,t){return this._depth[e][t]<=0?w.EXTERIOR:w.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var e=arguments[0],t=0;t<2;t++)for(var n=1;n<3;n++){var a=e.getLocation(t,n);a!==w.EXTERIOR&&a!==w.INTERIOR||(this.isNull(t,n)?this._depth[t][n]=u.depthAtLocation(a):this._depth[t][n]+=u.depthAtLocation(a))}else if(arguments.length===3){var c=arguments[0],d=arguments[1],y=arguments[2];y===w.INTERIOR&&this._depth[c][d]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var e=0;e<2;e++)for(var t=0;t<3;t++)this._depth[e][t]=u.NULL_VALUE}},{key:"depthAtLocation",value:function(e){return e===w.EXTERIOR?0:e===w.INTERIOR?1:u.NULL_VALUE}}]),u}();as.NULL_VALUE=-1;var os=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var n=new Array(2).fill(null);return n[0]=this.pts[0],n[1]=this.pts[1],new t(n,st.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(n){this._isIsolated=n}},{key:"setName",value:function(n){this._name=n}},{key:"equals",value:function(n){if(!(n instanceof t))return!1;var a=n;if(this.pts.length!==a.pts.length)return!1;for(var c=!0,d=!0,y=this.pts.length,p=0;p<this.pts.length;p++)if(this.pts[p].equals2D(a.pts[p])||(c=!1),this.pts[p].equals2D(a.pts[--y])||(d=!1),!c&&!d)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var n=arguments[0];return this.pts[n]}}},{key:"print",value:function(n){n.print("edge "+this._name+": "),n.print("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&n.print(","),n.print(this.pts[a].x+" "+this.pts[a].y);n.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(n){t.updateIM(this._label,n)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(n){n.print("edge "+this._name+": ");for(var a=this.pts.length-1;a>=0;a--)n.print(this.pts[a]+" ");n.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new Fu(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new ke;for(var n=0;n<this.pts.length;n++)this._env.expandToInclude(this.pts[n])}return this._env}},{key:"addIntersection",value:function(n,a,c,d){var y=new S(n.getIntersection(d)),p=a,E=n.getEdgeDistance(c,d),I=p+1;if(I<this.pts.length){var L=this.pts[I];y.equals2D(L)&&(p=I,E=0)}this.eiList.add(y,p,E)}},{key:"toString",value:function(){var n=new Xn;n.append("edge "+this._name+": "),n.append("LINESTRING (");for(var a=0;a<this.pts.length;a++)a>0&&n.append(","),n.append(this.pts[a].x+" "+this.pts[a].y);return n.append(")  "+this._label+" "+this._depthDelta),n.toString()}},{key:"isPointwiseEqual",value:function(n){if(this.pts.length!==n.pts.length)return!1;for(var a=0;a<this.pts.length;a++)if(!this.pts[a].equals2D(n.pts[a]))return!1;return!0}},{key:"setDepthDelta",value:function(n){this._depthDelta=n}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(n,a,c){for(var d=0;d<n.getIntersectionNum();d++)this.addIntersection(n,a,c,d)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new Ou(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new as,this._depthDelta=0,arguments.length===1){var n=arguments[0];t.constructor_.call(this,n,null)}else if(arguments.length===2){var a=arguments[0],c=arguments[1];this.pts=a,this._label=c}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Ru&&arguments[0]instanceof st))return N(f(t),"updateIM",this).apply(this,arguments);var n=arguments[0],a=arguments[1];a.setAtLeastIfValid(n.getLocation(0,G.ON),n.getLocation(1,G.ON),1),n.isArea()&&(a.setAtLeastIfValid(n.getLocation(0,G.LEFT),n.getLocation(1,G.LEFT),2),a.setAtLeastIfValid(n.getLocation(0,G.RIGHT),n.getLocation(1,G.RIGHT),2))}}]),t}(Bi),us=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"setWorkingPrecisionModel",value:function(e){this._workingPrecisionModel=e}},{key:"insertUniqueEdge",value:function(e){var t=this._edgeList.findEqualEdge(e);if(t!==null){var n=t.getLabel(),a=e.getLabel();t.isPointwiseEqual(e)||(a=new st(e.getLabel())).flip(),n.merge(a);var c=u.depthDelta(a),d=t.getDepthDelta()+c;t.setDepthDelta(d)}else this._edgeList.add(e),e.setDepthDelta(u.depthDelta(e.getLabel()))}},{key:"buildSubgraphs",value:function(e,t){for(var n=new K,a=e.iterator();a.hasNext();){var c=a.next(),d=c.getRightmostCoordinate(),y=new ts(n).getDepth(d);c.computeDepth(y),c.findResultEdges(),n.add(c),t.add(c.getDirectedEdges(),c.getNodes())}}},{key:"createSubgraphs",value:function(e){for(var t=new K,n=e.getNodes().iterator();n.hasNext();){var a=n.next();if(!a.isVisited()){var c=new Yo;c.create(a),t.add(c)}}return Jt.sort(t,Jt.reverseOrder()),t}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(e){if(this._workingNoder!==null)return this._workingNoder;var t=new Dr,n=new At;return n.setPrecisionModel(e),t.setSegmentIntersector(new Cu(n)),t}},{key:"buffer",value:function(e,t){var n=this._workingPrecisionModel;n===null&&(n=e.getPrecisionModel()),this._geomFact=e.getFactory();var a=new Eu(n,this._bufParams),c=new wu(e,t,a).getCurves();if(c.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(c,n),this._graph=new Zi(new bu),this._graph.addEdges(this._edgeList.getEdges());var d=this.createSubgraphs(this._graph),y=new uu(this._geomFact);this.buildSubgraphs(d,y);var p=y.getPolygons();return p.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(p)}},{key:"computeNodedEdges",value:function(e,t){var n=this.getNoder(t);n.computeNodes(e);for(var a=n.getNodedSubstrings().iterator();a.hasNext();){var c=a.next(),d=c.getCoordinates();if(d.length!==2||!d[0].equals2D(d[1])){var y=c.getData(),p=new os(c.getCoordinates(),new st(y));this.insertUniqueEdge(p)}}}},{key:"setNoder",value:function(e){this._workingNoder=e}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Su;var e=arguments[0];this._bufParams=e}},{key:"depthDelta",value:function(e){var t=e.getLocation(0,G.LEFT),n=e.getLocation(0,G.RIGHT);return t===w.INTERIOR&&n===w.EXTERIOR?1:t===w.EXTERIOR&&n===w.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(e){for(var t=new Wt,n=new K;e.hasNext();){var a=e.next(),c=t.createLineString(a.getCoordinates());n.add(c)}return t.buildGeometry(n)}}]),u}(),qu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"rescale",value:function(){if(oe(arguments[0],nt))for(var e=arguments[0],t=e.iterator();t.hasNext();){var n=t.next();this.rescale(n.getCoordinates())}else if(arguments[0]instanceof Array){for(var a=arguments[0],c=0;c<a.length;c++)a[c].x=a[c].x/this._scaleFactor+this._offsetX,a[c].y=a[c].y/this._scaleFactor+this._offsetY;a.length===2&&a[0].equals2D(a[1])&&rt.out.println(a)}}},{key:"scale",value:function(){if(oe(arguments[0],nt)){for(var e=arguments[0],t=new K(e.size()),n=e.iterator();n.hasNext();){var a=n.next();t.add(new Dt(this.scale(a.getCoordinates()),a.getData()))}return t}if(arguments[0]instanceof Array){for(var c=arguments[0],d=new Array(c.length).fill(null),y=0;y<c.length;y++)d[y]=new S(Math.round((c[y].x-this._offsetX)*this._scaleFactor),Math.round((c[y].y-this._offsetY)*this._scaleFactor),c[y].getZ());var p=Ge.removeRepeatedPoints(d);return p}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e}},{key:"computeNodes",value:function(e){var t=e;this._isScaled&&(t=this.scale(e)),this._noder.computeNodes(t)}},{key:"interfaces_",get:function(){return[Ar]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var e=arguments[0],t=arguments[1];u.constructor_.call(this,e,t,0,0)}else if(arguments.length===4){var n=arguments[0],a=arguments[1];this._noder=n,this._scaleFactor=a,this._isScaled=!this.isIntegerPrecision()}}}]),u}(),ls=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var t=e.next(),n=t.getCoordinates();this.checkEndPtVertexIntersections(n[0],this._segStrings),this.checkEndPtVertexIntersections(n[n.length-1],this._segStrings)}else if(arguments.length===2){for(var a=arguments[0],c=arguments[1],d=c.iterator();d.hasNext();)for(var y=d.next(),p=y.getCoordinates(),E=1;E<p.length-1;E++)if(p[E].equals(a))throw new qe("found endpt/interior pt intersection at index "+E+" :pt "+a)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();)for(var t=e.next(),n=this._segStrings.iterator();n.hasNext();){var a=n.next();this.checkInteriorIntersections(t,a)}else if(arguments.length===2)for(var c=arguments[0],d=arguments[1],y=c.getCoordinates(),p=d.getCoordinates(),E=0;E<y.length-1;E++)for(var I=0;I<p.length-1;I++)this.checkInteriorIntersections(c,E,d,I);else if(arguments.length===4){var L=arguments[0],T=arguments[1],q=arguments[2],F=arguments[3];if(L===q&&T===F)return null;var H=L.getCoordinates()[T],$=L.getCoordinates()[T+1],te=q.getCoordinates()[F],Ee=q.getCoordinates()[F+1];if(this._li.computeIntersection(H,$,te,Ee),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,H,$)||this.hasInteriorIntersection(this._li,te,Ee)))throw new qe("found non-noded intersection at "+H+"-"+$+" and "+te+"-"+Ee)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var e=this._segStrings.iterator();e.hasNext();){var t=e.next();this.checkCollapses(t)}else if(arguments.length===1)for(var n=arguments[0],a=n.getCoordinates(),c=0;c<a.length-2;c++)this.checkCollapse(a[c],a[c+1],a[c+2])}},{key:"hasInteriorIntersection",value:function(e,t,n){for(var a=0;a<e.getIntersectionNum();a++){var c=e.getIntersection(a);if(!c.equals(t)&&!c.equals(n))return!0}return!1}},{key:"checkCollapse",value:function(e,t,n){if(e.equals(n))throw new qe("found non-noded collapse at "+u.fact.createLineString([e,t,n]))}}],[{key:"constructor_",value:function(){this._li=new At,this._segStrings=null;var e=arguments[0];this._segStrings=e}}]),u}();ls.fact=new Wt;var qr=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"intersectsScaled",value:function(e,t){var n=Math.min(e.x,t.x),a=Math.max(e.x,t.x),c=Math.min(e.y,t.y),d=Math.max(e.y,t.y),y=this._maxx<n||this._minx>a||this._maxy<c||this._miny>d;if(y)return!1;var p=this.intersectsToleranceSquare(e,t);return U.isTrue(!(y&&p),"Found bad envelope test"),p}},{key:"initCorners",value:function(e){var t=.5;this._minx=e.x-t,this._maxx=e.x+t,this._miny=e.y-t,this._maxy=e.y+t,this._corner[0]=new S(this._maxx,this._maxy),this._corner[1]=new S(this._minx,this._maxy),this._corner[2]=new S(this._minx,this._miny),this._corner[3]=new S(this._maxx,this._miny)}},{key:"intersects",value:function(e,t){return this._scaleFactor===1?this.intersectsScaled(e,t):(this.copyScaled(e,this._p0Scaled),this.copyScaled(t,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(e){return Math.round(e*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(e,t){t.x=this.scale(e.x),t.y=this.scale(e.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var e=u.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new ke(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(e,t){return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(e,t){var n=!1,a=!1;return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(a=!0),this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!n||!a)||!!e.equals(this._pt)||!!t.equals(this._pt))))}},{key:"addSnappedNode",value:function(e,t){var n=e.getCoordinate(t),a=e.getCoordinate(t+1);return!!this.intersects(n,a)&&(e.addIntersection(this.getCoordinate(),t),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],t=arguments[1],n=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=t,this._li=n,t<=0)throw new O("Scale factor must be non-zero");t!==1&&(this._pt=new S(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new S,this._p1Scaled=new S),this.initCorners(this._pt)}}]),u}();qr.SAFE_ENV_EXPANSION_FACTOR=.75;var Gu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var e=arguments[0],t=arguments[1];e.getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new Qe}}]),u}(),cs=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"snap",value:function(){if(arguments.length===1){var e=arguments[0];return this.snap(e,null,-1)}if(arguments.length===3){var t=arguments[0],n=arguments[1],a=arguments[2],c=t.getSafeEnvelope(),d=new hs(t,n,a);return this._index.query(c,new(function(){function y(){i(this,y)}return l(y,[{key:"interfaces_",get:function(){return[$i]}},{key:"visitItem",value:function(p){p.select(c,d)}}]),y}())),d.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var e=arguments[0];this._index=e}}]),u}(),hs=function(u){h(t,u);var e=k(t);function t(){var n;return i(this,t),n=e.call(this),t.constructor_.apply(x(n),arguments),n}return l(t,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof Ki))return N(f(t.prototype),"select",this).apply(this,arguments);var n=arguments[0],a=arguments[1],c=n.getContext();if(this._parentEdge===c&&(a===this._hotPixelVertexIndex||a+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(c,a)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var n=arguments[0],a=arguments[1],c=arguments[2];this._hotPixel=n,this._parentEdge=a,this._hotPixelVertexIndex=c}}]),t}(Gu);cs.HotPixelSnapAction=hs;var zu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"processIntersections",value:function(e,t,n,a){if(e===n&&t===a)return null;var c=e.getCoordinates()[t],d=e.getCoordinates()[t+1],y=n.getCoordinates()[a],p=n.getCoordinates()[a+1];if(this._li.computeIntersection(c,d,y,p),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var E=0;E<this._li.getIntersectionNum();E++)this._interiorIntersections.add(this._li.getIntersection(E));e.addIntersections(this._li,t,0),n.addIntersections(this._li,a,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[ss]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var e=arguments[0];this._li=e,this._interiorIntersections=new K}}]),u}(),Bu=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"checkCorrectness",value:function(e){var t=Dt.getNodedSubstrings(e),n=new ls(t);try{n.checkValid()}catch(a){if(!(a instanceof A))throw a;a.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return Dt.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(e,t){var n=this.findInteriorIntersections(e,t);this.computeIntersectionSnaps(n),this.computeVertexSnaps(e)}},{key:"findInteriorIntersections",value:function(e,t){var n=new zu(t);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(e),n.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(oe(arguments[0],nt))for(var e=arguments[0],t=e.iterator();t.hasNext();){var n=t.next();this.computeVertexSnaps(n)}else if(arguments[0]instanceof Dt)for(var a=arguments[0],c=a.getCoordinates(),d=0;d<c.length;d++){var y=new qr(c[d],this._scaleFactor,this._li),p=this._pointSnapper.snap(y,a,d);p&&a.addIntersection(c[d],d)}}},{key:"computeNodes",value:function(e){this._nodedSegStrings=e,this._noder=new Dr,this._pointSnapper=new cs(this._noder.getIndex()),this.snapRound(e,this._li)}},{key:"computeIntersectionSnaps",value:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next(),a=new qr(n,this._scaleFactor,this._li);this._pointSnapper.snap(a)}}},{key:"interfaces_",get:function(){return[Ar]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=arguments[0];this._pm=e,this._li=new At,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()}}]),u}(),jt=function(){function u(){i(this,u),u.constructor_.apply(this,arguments)}return l(u,[{key:"bufferFixedPrecision",value:function(e){var t=new qu(new Bu(new ut(1)),e.getScale()),n=new us(this._bufParams);n.setWorkingPrecisionModel(e),n.setNoder(t),this._resultGeometry=n.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var e=u.MAX_PRECISION_DIGITS;e>=0;e--){try{this.bufferReducedPrecision(e)}catch(c){if(!(c instanceof pt))throw c;this._saveException=c}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var t=arguments[0],n=u.precisionScaleFactor(this._argGeom,this._distance,t),a=new ut(n);this.bufferFixedPrecision(a)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===ut.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(e){this._bufParams.setQuadrantSegments(e)}},{key:"bufferOriginalPrecision",value:function(){try{var e=new us(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof qe))throw t;this._saveException=t}}},{key:"getResultGeometry",value:function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(e){this._bufParams.setEndCapStyle(e)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new b,this._resultGeometry=null,this._saveException=null,arguments.length===1){var e=arguments[0];this._argGeom=e}else if(arguments.length===2){var t=arguments[0],n=arguments[1];this._argGeom=t,this._bufParams=n}}},{key:"bufferOp",value:function(){if(arguments.length===2){var e=arguments[0],t=arguments[1],n=new u(e),a=n.getResultGeometry(t);return a}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof V&&typeof arguments[1]=="number"){var c=arguments[0],d=arguments[1],y=arguments[2],p=new u(c);p.setQuadrantSegments(y);var E=p.getResultGeometry(d);return E}if(arguments[2]instanceof b&&arguments[0]instanceof V&&typeof arguments[1]=="number"){var I=arguments[0],L=arguments[1],T=arguments[2],q=new u(I,T),F=q.getResultGeometry(L);return F}}else if(arguments.length===4){var H=arguments[0],$=arguments[1],te=arguments[2],Ee=arguments[3],Se=new u(H);Se.setQuadrantSegments(te),Se.setEndCapStyle(Ee);var Xe=Se.getResultGeometry($);return Xe}}},{key:"precisionScaleFactor",value:function(e,t,n){var a=e.getEnvelopeInternal(),c=cn.max(Math.abs(a.getMaxX()),Math.abs(a.getMaxY()),Math.abs(a.getMinX()),Math.abs(a.getMinY()))+2*(t>0?t:0),d=n-Math.trunc(Math.log(c)/Math.log(10)+1);return Math.pow(10,d)}}]),u}();jt.CAP_ROUND=b.CAP_ROUND,jt.CAP_BUTT=b.CAP_FLAT,jt.CAP_FLAT=b.CAP_FLAT,jt.CAP_SQUARE=b.CAP_SQUARE,jt.MAX_PRECISION_DIGITS=12;var Yu=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],fs=function(){function u(e){i(this,u),this.geometryFactory=e||new Wt}return l(u,[{key:"read",value:function(e){var t,n=(t=typeof e=="string"?JSON.parse(e):e).type;if(!ot[n])throw new Error("Unknown GeoJSON type: "+t.type);return Yu.indexOf(n)!==-1?ot[n].call(this,t.coordinates):n==="GeometryCollection"?ot[n].call(this,t.geometries):ot[n].call(this,t)}},{key:"write",value:function(e){var t=e.getGeometryType();if(!yt[t])throw new Error("Geometry is not supported");return yt[t].call(this,e)}}]),u}(),ot={Feature:function(u){var e={};for(var t in u)e[t]=u[t];if(u.geometry){var n=u.geometry.type;if(!ot[n])throw new Error("Unknown GeoJSON type: "+u.type);e.geometry=this.read(u.geometry)}return u.bbox&&(e.bbox=ot.bbox.call(this,u.bbox)),e},FeatureCollection:function(u){var e={};if(u.features){e.features=[];for(var t=0;t<u.features.length;++t)e.features.push(this.read(u.features[t]))}return u.bbox&&(e.bbox=this.parse.bbox.call(this,u.bbox)),e},coordinates:function(u){for(var e=[],t=0;t<u.length;++t){var n=u[t];e.push(m(S,C(n)))}return e},bbox:function(u){return this.geometryFactory.createLinearRing([new S(u[0],u[1]),new S(u[2],u[1]),new S(u[2],u[3]),new S(u[0],u[3]),new S(u[0],u[1])])},Point:function(u){var e=m(S,C(u));return this.geometryFactory.createPoint(e)},MultiPoint:function(u){for(var e=[],t=0;t<u.length;++t)e.push(ot.Point.call(this,u[t]));return this.geometryFactory.createMultiPoint(e)},LineString:function(u){var e=ot.coordinates.call(this,u);return this.geometryFactory.createLineString(e)},MultiLineString:function(u){for(var e=[],t=0;t<u.length;++t)e.push(ot.LineString.call(this,u[t]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(u){for(var e=ot.coordinates.call(this,u[0]),t=this.geometryFactory.createLinearRing(e),n=[],a=1;a<u.length;++a){var c=u[a],d=ot.coordinates.call(this,c),y=this.geometryFactory.createLinearRing(d);n.push(y)}return this.geometryFactory.createPolygon(t,n)},MultiPolygon:function(u){for(var e=[],t=0;t<u.length;++t){var n=u[t];e.push(ot.Polygon.call(this,n))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(u){for(var e=[],t=0;t<u.length;++t){var n=u[t];e.push(this.read(n))}return this.geometryFactory.createGeometryCollection(e)}},yt={coordinate:function(u){var e=[u.x,u.y];return u.z&&e.push(u.z),u.m&&e.push(u.m),e},Point:function(u){return{type:"Point",coordinates:yt.coordinate.call(this,u.getCoordinate())}},MultiPoint:function(u){for(var e=[],t=0;t<u._geometries.length;++t){var n=u._geometries[t],a=yt.Point.call(this,n);e.push(a.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(u){for(var e=[],t=u.getCoordinates(),n=0;n<t.length;++n){var a=t[n];e.push(yt.coordinate.call(this,a))}return{type:"LineString",coordinates:e}},MultiLineString:function(u){for(var e=[],t=0;t<u._geometries.length;++t){var n=u._geometries[t],a=yt.LineString.call(this,n);e.push(a.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(u){var e=[],t=yt.LineString.call(this,u._shell);e.push(t.coordinates);for(var n=0;n<u._holes.length;++n){var a=u._holes[n],c=yt.LineString.call(this,a);e.push(c.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(u){for(var e=[],t=0;t<u._geometries.length;++t){var n=u._geometries[t],a=yt.Polygon.call(this,n);e.push(a.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(u){for(var e=[],t=0;t<u._geometries.length;++t){var n=u._geometries[t],a=n.getGeometryType();e.push(yt[a].call(this,n))}return{type:"GeometryCollection",geometries:e}}};return{BufferOp:jt,GeoJSONReader:function(){function u(e){i(this,u),this.parser=new fs(e||new Wt)}return l(u,[{key:"read",value:function(e){return this.parser.read(e)}}]),u}(),GeoJSONWriter:function(){function u(){i(this,u),this.parser=new fs(this.geometryFactory)}return l(u,[{key:"write",value:function(e){return this.parser.write(e)}}]),u}()}})})(Ya);var sc=Ya.exports;const ac=_a(sc);var{BufferOp:oc,GeoJSONReader:uc,GeoJSONWriter:lc}=ac;function cc(r,s,i){i=i||{};var o=i.units||"kilometers",l=i.steps||8;if(!r)throw new Error("geojson is required");if(typeof i!="object")throw new Error("options must be an object");if(typeof l!="number")throw new Error("steps must be an number");if(s===void 0)throw new Error("radius is required");if(l<=0)throw new Error("steps must be greater than 0");var h=[];switch(r.type){case"GeometryCollection":return Ye(r,function(f){var g=Kn(f,s,o,l);g&&h.push(g)}),Y(h);case"FeatureCollection":return he(r,function(f){var g=Kn(f,s,o,l);g&&he(g,function(v){v&&h.push(v)})}),Y(h)}return Kn(r,s,o,l)}function Kn(r,s,i,o){var l=r.properties||{},h=r.type==="Feature"?r.geometry:r;if(h.type==="GeometryCollection"){var f=[];return Ye(r,function(C){var D=Kn(C,s,i,o);D&&f.push(D)}),Y(f)}var g=hc(h),v={type:h.type,coordinates:Ua(h.coordinates,g)},m=new uc,_=m.read(v),x=Rn(on(s,i),"meters"),P=oc.bufferOp(_,x,o),k=new lc;if(P=k.write(P),!Xa(P.coordinates)){var N={type:P.type,coordinates:Va(P.coordinates,g)};return Oe(N,l)}}function Xa(r){return Array.isArray(r[0])?Xa(r[0]):isNaN(r[0])}function Ua(r,s){return typeof r[0]!="object"?s(r):r.map(function(i){return Ua(i,s)})}function Va(r,s){return typeof r[0]!="object"?s.invert(r):r.map(function(i){return Va(i,s)})}function hc(r){var s=ur(r).geometry.coordinates,i=[-s[0],-s[1]];return Vu().rotate(i).scale(Ae)}function di(r,s={}){let i=0,o=0,l=0;return Ye(r,function(h,f,g){let v=s.weight?g==null?void 0:g[s.weight]:void 0;if(v=v??1,!De(v))throw new Error("weight value must be a number for feature index "+f);v=Number(v),v>0&&Pe(h,function(m){i+=m[0]*v,o+=m[1]*v,l+=v})}),re([i/l,o/l],s.properties,s)}function Nt(r,s={}){let i=0,o=0,l=0;return Pe(r,function(h){i+=h[0],o+=h[1],l++},!0),re([i/l,o/l],s.properties)}function fc(r,s={}){if(s=s||{},!de(s))throw new Error("options is invalid");var i=s.counter||10;if(!De(i))throw new Error("counter must be a number");var o=s.weight,l=di(r,{weight:s.weight}),h=Y([]);he(r,function(g){var v;h.features.push(Nt(g,{properties:{weight:(v=g.properties)==null?void 0:v[o]}}))});const f={tolerance:s.tolerance,medianCandidates:[]};return Ha(l.geometry.coordinates,[0,0],h,f,i)}function Ha(r,s,i,o,l){var h=o.tolerance||.001,f=0,g=0,v=0,m=0;if(he(i,function(P){var k,N=(k=P.properties)==null?void 0:k.weight,C=N??1;if(C=Number(C),!De(C))throw new Error("weight value must be a number");if(C>0){m+=1;var D=C*ye(P,r);D===0&&(D=1);var R=C/D;f+=P.geometry.coordinates[0]*R,g+=P.geometry.coordinates[1]*R,v+=R}}),m<1)throw new Error("no features to measure");var _=f/v,x=g/v;return m===1||l===0||Math.abs(_-s[0])<h&&Math.abs(x-s[1])<h?re([_,x],{medianCandidates:o.medianCandidates}):(o.medianCandidates.push([_,x]),Ha([_,x],r,i,o,l-1))}function Za(r,s={}){s.concavity=s.concavity||1/0;const i=[];if(Pe(r,l=>{i.push([l[0],l[1]])}),!i.length)return null;const o=Hu(i,s.concavity);return o.length>3?j([o]):null}function Wa(r,s={}){switch(Je(r)){case"Point":return re(me(r),s.properties);case"Polygon":var i=[];Pe(r,function(A){i.push(A)});var o=Nt(r,{properties:s.properties}),l=o.geometry.coordinates,h=0,f=0,g=0,v,m,_,x,P,k,N,C,D=i.map(function(A){return[A[0]-l[0],A[1]-l[1]]});for(v=0;v<i.length-1;v++)m=D[v],x=m[0],k=m[1],_=D[v+1],P=_[0],N=_[1],C=x*N-P*k,g+=C,h+=(x+P)*C,f+=(k+N)*C;if(g===0)return o;var R=g*.5,M=1/(6*R);return re([l[0]+M*h,l[1]+M*f],s.properties);default:var b=Za(r);return b?Wa(b,{properties:s.properties}):Nt(r,{properties:s.properties})}}function vi(r,s,i={}){const o=i.steps||64,l=i.properties?i.properties:!Array.isArray(r)&&r.type==="Feature"&&r.properties?r.properties:{},h=[];for(let f=0;f<o;f++)h.push(It(r,s,f*-360/o,i).geometry.coordinates);return h.push(h[0]),j([h],l)}function Be(r){if(!r)throw new Error("geojson is required");switch(r.type){case"Feature":return $a(r);case"FeatureCollection":return gc(r);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return yi(r);default:throw new Error("unknown GeoJSON type")}}function $a(r){const s={type:"Feature"};return Object.keys(r).forEach(i=>{switch(i){case"type":case"properties":case"geometry":return;default:s[i]=r[i]}}),s.properties=lr(r.properties),r.geometry==null?s.geometry=null:s.geometry=yi(r.geometry),s}function lr(r){const s={};return r&&Object.keys(r).forEach(i=>{const o=r[i];typeof o=="object"?o===null?s[i]=null:Array.isArray(o)?s[i]=o.map(l=>l):s[i]=lr(o):s[i]=o}),s}function gc(r){const s={type:"FeatureCollection"};return Object.keys(r).forEach(i=>{switch(i){case"type":case"features":return;default:s[i]=r[i]}}),s.features=r.features.map(i=>$a(i)),s}function yi(r){const s={type:r.type};return r.bbox&&(s.bbox=r.bbox),r.type==="GeometryCollection"?(s.geometries=r.geometries.map(i=>yi(i)),s):(s.coordinates=Ja(r.coordinates),s)}function Ja(r){const s=r;return typeof s[0]!="object"?s.slice():s.map(i=>Ja(i))}function Ka(r,s){if(!r)throw new Error("geojson is required");if(r.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(s==null)throw new Error("filter is required");var i=[];return he(r,function(o){cr(o.properties,s)&&i.push(o)}),Y(i)}function mi(r,s,i){if(!r)throw new Error("geojson is required");if(r.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(s==null)throw new Error("property is required");for(var o=pi(r,s),l=Object.keys(o),h=0;h<l.length;h++){for(var f=l[h],g=o[f],v=[],m=0;m<g.length;m++)v.push(r.features[g[m]]);i(Y(v),f,h)}}function Qa(r,s,i,o){var l=o;return mi(r,s,function(h,f,g){g===0&&o===void 0?l=h:l=i(l,h,f,g)}),l}function pi(r,s){var i={};return he(r,function(o,l){var h=o.properties||{};if(Object.prototype.hasOwnProperty.call(h,String(s))){var f=h[s];Object.prototype.hasOwnProperty.call(i,f)?i[f].push(l):i[f]=[l]}}),i}function cr(r,s){if(r===void 0)return!1;var i=typeof s;if(i==="number"||i==="string")return Object.prototype.hasOwnProperty.call(r,s);if(Array.isArray(s)){for(var o=0;o<s.length;o++)if(!cr(r,s[o]))return!1;return!0}else return _i(r,s)}function _i(r,s){for(var i=Object.keys(s),o=0;o<i.length;o++){var l=i[o];if(r[l]!==s[l])return!1}return!0}function ja(r,s){if(!s)return{};if(!s.length)return{};for(var i={},o=0;o<s.length;o++){var l=s[o];Object.prototype.hasOwnProperty.call(r,l)&&(i[l]=r[l])}return i}const dc=Object.freeze(Object.defineProperty({__proto__:null,applyFilter:cr,clusterEach:mi,clusterReduce:Qa,createBins:pi,filterProperties:ja,getCluster:Ka,propertiesContainsFilter:_i},Symbol.toStringTag,{value:"Module"}));var vc=We;function yc(r,s,i={}){i.mutate!==!0&&(r=Be(r));const o=i.minPoints||3,l=ar(s,i.units);var h=new vc(r.features.length),f=r.features.map(k=>!1),g=r.features.map(k=>!1),v=r.features.map(k=>!1),m=r.features.map(k=>-1);h.load(r.features.map((k,N)=>{var[C,D]=k.geometry.coordinates;return{minX:C,minY:D,maxX:C,maxY:D,index:N}}));const _=k=>{const N=r.features[k],[C,D]=N.geometry.coordinates,R=Math.max(D-l,-90),M=Math.min(D+l,90),b=function(){return R<0&&M>0?l:Math.abs(R)<Math.abs(M)?l/Math.cos(Te(M)):l/Math.cos(Te(R))}(),A=Math.max(C-b,-360),O=Math.min(C+b,360),fe={minX:A,minY:R,maxX:O,maxY:M};return h.search(fe).filter(B=>{const W=B.index,Z=r.features[W];return ye(N,Z,{units:"kilometers"})<=s})},x=(k,N)=>{for(var C=0;C<N.length;C++){var D=N[C];const R=D.index;if(!f[R]){f[R]=!0;const M=_(R);M.length>=o&&N.push(...M)}g[R]||(g[R]=!0,m[R]=k)}};var P=0;return r.features.forEach((k,N)=>{if(f[N])return;const C=_(N);if(C.length>=o){const D=P;P++,f[N]=!0,x(D,C)}else v[N]=!0}),r.features.forEach((k,N)=>{var C=r.features[N];C.properties||(C.properties={}),m[N]>=0?(C.properties.dbscan=v[N]?"edge":"core",C.properties.cluster=m[N]):C.properties.dbscan="noise"}),r}function mc(r,s={}){var i=r.features.length;s.numberOfClusters=s.numberOfClusters||Math.round(Math.sqrt(i/2)),s.numberOfClusters>i&&(s.numberOfClusters=i),s.mutate!==!0&&(r=Be(r));var o=In(r),l=o.slice(0,s.numberOfClusters),h=Zu(o,s.numberOfClusters,l),f={};return h.centroids.forEach(function(g,v){f[v]=g}),he(r,function(g,v){var m=h.idxs[v];g.properties.cluster=m,g.properties.centroid=f[m]}),r}var pc=We;function _c(r,s,i,o){var l=new pc(6),h=s.features.map(function(f){var g;return{minX:f.geometry.coordinates[0],minY:f.geometry.coordinates[1],maxX:f.geometry.coordinates[0],maxY:f.geometry.coordinates[1],property:(g=f.properties)==null?void 0:g[i]}});return l.load(h),r.features.forEach(function(f){f.properties||(f.properties={});var g=_e(f),v=l.search({minX:g[0],minY:g[1],maxX:g[2],maxY:g[3]}),m=[];v.forEach(function(_){ne([_.minX,_.minY],f)&&m.push(_.property)}),f.properties[o]=m}),r}function xc(r){var s={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return he(r,i=>{var o;switch((o=i.geometry)==null?void 0:o.type){case"Point":s.MultiPoint.coordinates.push(i.geometry.coordinates),s.MultiPoint.properties.push(i.properties);break;case"MultiPoint":s.MultiPoint.coordinates.push(...i.geometry.coordinates),s.MultiPoint.properties.push(i.properties);break;case"LineString":s.MultiLineString.coordinates.push(i.geometry.coordinates),s.MultiLineString.properties.push(i.properties);break;case"MultiLineString":s.MultiLineString.coordinates.push(...i.geometry.coordinates),s.MultiLineString.properties.push(i.properties);break;case"Polygon":s.MultiPolygon.coordinates.push(i.geometry.coordinates),s.MultiPolygon.properties.push(i.properties);break;case"MultiPolygon":s.MultiPolygon.coordinates.push(...i.geometry.coordinates),s.MultiPolygon.properties.push(i.properties);break}}),Y(Object.keys(s).filter(function(i){return s[i].coordinates.length}).sort().map(function(i){var o={type:i,coordinates:s[i].coordinates},l={collectedProperties:s[i].properties};return Oe(o,l)}))}function eo(r,s){let i=!1;return Y(wc(r.features.map(o=>{const l={x:o.geometry.coordinates[0],y:o.geometry.coordinates[1]};return s?l.z=o.properties[s]:o.geometry.coordinates.length===3&&(i=!0,l.z=o.geometry.coordinates[2]),l})).map(o=>{const l=[o.a.x,o.a.y],h=[o.b.x,o.b.y],f=[o.c.x,o.c.y];let g={};return i?(l.push(o.a.z),h.push(o.b.z),f.push(o.c.z)):g={a:o.a.z,b:o.b.z,c:o.c.z},j([[l,h,f,l]],g)}))}var Ts=class{constructor(r,s,i){this.a=r,this.b=s,this.c=i;const o=s.x-r.x,l=s.y-r.y,h=i.x-r.x,f=i.y-r.y,g=o*(r.x+s.x)+l*(r.y+s.y),v=h*(r.x+i.x)+f*(r.y+i.y),m=2*(o*(i.y-s.y)-l*(i.x-s.x));let _,x;this.x=(f*g-l*v)/m,this.y=(o*v-h*g)/m,_=this.x-r.x,x=this.y-r.y,this.r=_*_+x*x}};function Ec(r,s){return s.x-r.x}function kc(r){let s=r.length,i,o,l,h,f;e:for(;s;)for(o=r[--s],i=r[--s],l=s;l;)if(f=r[--l],h=r[--l],i===h&&o===f||i===f&&o===h){r.splice(s,2),r.splice(l,2),s-=2;continue e}}function wc(r){if(r.length<3)return[];r.sort(Ec);let s=r.length-1;const i=r[s].x,o=r[0].x;let l=r[s].y,h=l;const f=1e-12;let g,v,m,_,x,P;for(;s--;)r[s].y<l&&(l=r[s].y),r[s].y>h&&(h=r[s].y);let k=o-i,N=h-l;const C=k>N?k:N,D=(o+i)*.5,R=(h+l)*.5,M=[new Ts({__sentinel:!0,x:D-20*C,y:R-C},{__sentinel:!0,x:D,y:R+20*C},{__sentinel:!0,x:D+20*C,y:R-C})],b=[],A=[];let O;for(s=r.length;s--;){for(A.length=0,O=M.length;O--;){if(k=r[s].x-M[O].x,k>0&&k*k>M[O].r){b.push(M[O]),M.splice(O,1);continue}N=r[s].y-M[O].y,!(k*k+N*N>M[O].r)&&(A.push(M[O].a,M[O].b,M[O].b,M[O].c,M[O].c,M[O].a),M.splice(O,1))}for(kc(A),O=A.length;O;)v=A[--O],g=A[--O],m=r[s],_=v.x-g.x,x=v.y-g.y,P=2*(_*(m.y-v.y)-x*(m.x-v.x)),Math.abs(P)>f&&M.push(new Ts(g,v,m))}for(Array.prototype.push.apply(b,M),s=b.length;s--;)(b[s].a.__sentinel||b[s].b.__sentinel||b[s].c.__sentinel)&&b.splice(s,1);return b}function Ic(r,s={}){if(s=s||{},!de(s))throw new Error("options is invalid");const i=s.mutate;if(Je(r)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!r.features.length)throw new Error("geojson is empty");(i===!1||i===void 0)&&(r=Be(r));const o=[],l=hi(r,(h,f)=>{const g=Nc(h,f);return g||(o.push(h),f)});return l&&o.push(l),o.length?o.length===1?o[0]:bt(o.map(h=>h.coordinates)):null}function Wn(r){return r[0].toString()+","+r[1].toString()}function Nc(r,s){const i=r.geometry.coordinates,o=s.geometry.coordinates,l=Wn(i[0]),h=Wn(i[i.length-1]),f=Wn(o[0]),g=Wn(o[o.length-1]);let v;if(l===g)v=o.concat(i.slice(1));else if(f===h)v=i.concat(o.slice(1));else if(l===f)v=i.slice(1).reverse().concat(o);else if(h===g)v=i.concat(o.reverse().slice(1));else return null;return ce(v)}function Pc(r,s={}){if(Je(r)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!r.features.length)throw new Error("geojson is empty");(s.mutate===!1||s.mutate===void 0)&&(r=Be(r));const i=[];ze(r,h=>{i.push(h.geometry)});const o=$u({geoms:ni(i).geometry});return Wu(o,o.objects.geoms.geometries)}function Mc(r,s={}){if(s=s||{},!de(s))throw new Error("options is invalid");const i=s.mutate;if(Je(r)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!r.features.length)throw new Error("geojson is empty");(i===!1||i===void 0)&&(r=Be(r));const o=Lc(r);if(!o)throw new Error("geojson must be homogenous");const l=r;switch(o){case"LineString":return Ic(l,s);case"Polygon":return Pc(l,s);default:throw new Error(o+" is not supported")}}function Lc(r){const s={};ze(r,o=>{s[o.geometry.type]=!0});const i=Object.keys(s);return i.length===1?i[0]:null}function bc(r,s={}){const i=s.maxEdge||1/0,o=Sc(r),l=eo(o);if(l.features=l.features.filter(f=>{const g=f.geometry.coordinates[0][0],v=f.geometry.coordinates[0][1],m=f.geometry.coordinates[0][2],_=ye(g,v,s),x=ye(v,m,s),P=ye(g,m,s);return _<=i&&x<=i&&P<=i}),l.features.length<1)return null;const h=Mc(l);return h.coordinates.length===1&&(h.coordinates=h.coordinates[0],h.type="Polygon"),Oe(h)}function Sc(r){const s=[],i={};return he(r,o=>{if(!o.geometry)return;const l=o.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(i,l)||(s.push(o),i[l]=!0)}),Y(s)}function Cc(r){const s=[];if(Ye(r,l=>{s.push(l.coordinates)}),s.length<2)throw new Error("Must have at least two features");const i=r.features[0].properties||{},o=mt.difference(s[0],...s.slice(1));return o.length===0?null:o.length===1?j(o[0],i):$e(o,i)}function Wr(r){if(!r)throw new Error("geojson is required");var s=[];return ze(r,function(i){s.push(i)}),Y(s)}function Tc(r,s={}){if(s=s||{},!de(s))throw new Error("options is invalid");const{propertyName:i}=s;Pt(r,"Polygon","dissolve");const o=[];if(i){const l={};he(r,function(f){f.properties&&(Object.prototype.hasOwnProperty.call(l,f.properties[i])||(l[f.properties[i]]=[]),l[f.properties[i]].push(f))});const h=Object.keys(l);for(let f=0;f<h.length;f++){const g=$e(mt.union.apply(null,l[h[f]].map(function(v){return v.geometry.coordinates})));g&&g.properties&&(g.properties[i]=h[f],o.push(g))}}else return Wr($e(mt.union.apply(null,r.features.map(function(l){return l.geometry.coordinates}))));return Wr(Y(o))}function Oc(r,s,i=2){const o=me(r),l=me(s),h=o[0]-l[0],f=o[1]-l[1];return i===1?Math.abs(h)+Math.abs(f):Math.pow(Math.pow(h,i)+Math.pow(f,i),1/i)}function to(r,s){var i,o;s=s||{};const l=s.threshold||1e4,h=s.p||2,f=(i=s.binary)!=null?i:!1,g=s.alpha||-1,v=(o=s.standardization)!=null?o:!1,m=[];he(r,x=>{m.push(Nt(x))});const _=[];for(let x=0;x<m.length;x++)_[x]=[];for(let x=0;x<m.length;x++)for(let P=x;P<m.length;P++){x===P&&(_[x][P]=0);const k=Oc(m[x],m[P],h);_[x][P]=k,_[P][x]=k}for(let x=0;x<m.length;x++)for(let P=0;P<m.length;P++){const k=_[x][P];k!==0&&(f?k<=l?_[x][P]=1:_[x][P]=0:k<=l?_[x][P]=Math.pow(k,g):_[x][P]=0)}if(v)for(let x=0;x<m.length;x++){const P=_[x].reduce((k,N)=>k+N,0);for(let k=0;k<m.length;k++)_[x][k]=_[x][k]/P}return _}function an(r,s,i,o={}){const l=s<0;let h=Bt(Math.abs(s),o.units,"meters");l&&(h=-Math.abs(h));const f=me(r),g=Rc(f,h,i);return g[0]+=g[0]-f[0]>180?-360:f[0]-g[0]>180?360:0,re(g,o.properties)}function Rc(r,s,i,o){o=o===void 0?Ae:Number(o);const l=s/o,h=r[0]*Math.PI/180,f=Te(r[1]),g=Te(i),v=l*Math.cos(g);let m=f+v;Math.abs(m)>Math.PI/2&&(m=m>0?Math.PI-m:-Math.PI-m);const _=Math.log(Math.tan(m/2+Math.PI/4)/Math.tan(f/2+Math.PI/4)),x=Math.abs(_)>1e-11?v/_:Math.cos(f),P=l*Math.sin(g)/x;return[((h+P)*180/Math.PI+540)%360-180,m*180/Math.PI]}function hr(r,s,i={}){const o=me(r),l=me(s);l[0]+=l[0]-o[0]>180?-360:o[0]-l[0]>180?360:0;const h=Ac(o,l);return Bt(h,"meters",i.units)}function Ac(r,s,i){i=i===void 0?Ae:Number(i);const o=i,l=r[1]*Math.PI/180,h=s[1]*Math.PI/180,f=h-l;let g=Math.abs(s[0]-r[0])*Math.PI/180;g>Math.PI&&(g-=2*Math.PI);const v=Math.log(Math.tan(h/2+Math.PI/4)/Math.tan(l/2+Math.PI/4)),m=Math.abs(v)>1e-11?f/v:Math.cos(l);return Math.sqrt(f*f+m*m*g*g)*o}function no(r,s,i){if(i=i||{},!de(i))throw new Error("options is invalid");const o=i.pivot,l=i.mutate;if(!r)throw new Error("geojson is required");if(s==null||isNaN(s))throw new Error("angle is required");if(s===0)return r;const h=o??Nt(r);return(l===!1||l===void 0)&&(r=Be(r)),Pe(r,function(f){const v=Yt(h,f)+s,m=hr(h,f),_=J(an(h,m,v));f[0]=_[0],f[1]=_[1]}),r}function ro(r,s,i,o){o=o||{};const l=o.steps||64,h=o.units||"kilometers",f=o.angle||0,g=o.pivot||r,v=o.properties||{};if(!r)throw new Error("center is required");if(!s)throw new Error("xSemiAxis is required");if(!i)throw new Error("ySemiAxis is required");if(!de(o))throw new Error("options must be an object");if(!De(l))throw new Error("steps must be a number");if(!De(f))throw new Error("angle must be a number");const m=me(r);if(h!=="degrees"){const x=an(r,s,90,{units:h}),P=an(r,i,0,{units:h});s=me(x)[0]-m[0],i=me(P)[1]-m[1]}const _=[];for(let x=0;x<l;x+=1){const P=x*-360/l;let k=s*i/Math.sqrt(Math.pow(i,2)+Math.pow(s,2)*Math.pow(Os(P),2)),N=s*i/Math.sqrt(Math.pow(s,2)+Math.pow(i,2)/Math.pow(Os(P),2));if(P<-90&&P>=-270&&(k=-k),P<-180&&P>=-360&&(N=-N),h==="degrees"){const C=Te(f),D=k*Math.cos(C)+N*Math.sin(C),R=N*Math.cos(C)-k*Math.sin(C);k=D,N=R}_.push([k+m[0],N+m[1]])}return _.push(_[0]),h==="degrees"?j([_],v):no(j([_],v),f,{pivot:g})}function Os(r){const s=r*Math.PI/180;return Math.tan(s)}function io(r){return Dn(_e(r))}function fr(r){const s=[];return r.type==="FeatureCollection"?he(r,function(i){Pe(i,function(o){s.push(re(o,i.properties))})}):r.type==="Feature"?Pe(r,function(i){s.push(re(i,r.properties))}):Pe(r,function(i){s.push(re(i))}),Y(s)}function Dc(r,s){var i;if(s=s||{},!de(s))throw new Error("options is invalid");const o=(i=s.mutate)!=null?i:!1;if(!r)throw new Error("geojson is required");return(o===!1||o===void 0)&&(r=Be(r)),Pe(r,function(l){var h=l[0],f=l[1];l[0]=f,l[1]=h}),r}var Rs=Math.PI/180,As=180/Math.PI,Mn=function(r,s){this.lon=r,this.lat=s,this.x=Rs*r,this.y=Rs*s};Mn.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};Mn.prototype.antipode=function(){var r=-1*this.lat,s=this.lon<0?180+this.lon:(180-this.lon)*-1;return new Mn(s,r)};var so=function(){this.coords=[],this.length=0};so.prototype.move_to=function(r){this.length++,this.coords.push(r)};var xi=function(r){this.properties=r||{},this.geometries=[]};xi.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var r=[],s=0;s<this.geometries.length;s++)r.push(this.geometries[s].coords);return{geometry:{type:"MultiLineString",coordinates:r},type:"Feature",properties:this.properties}};xi.prototype.wkt=function(){for(var r="",s="LINESTRING(",i=function(h){s+=h[0]+" "+h[1]+","},o=0;o<this.geometries.length;o++){if(this.geometries[o].coords.length===0)return"LINESTRING(empty)";var l=this.geometries[o].coords;l.forEach(i),r+=s.substring(0,s.length-1)+")"}return r};var Ei=function(r,s,i){if(!r||r.x===void 0||r.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!s||s.x===void 0||s.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Mn(r.x,r.y),this.end=new Mn(s.x,s.y),this.properties=i||{};var o=this.start.x-this.end.x,l=this.start.y-this.end.y,h=Math.pow(Math.sin(l/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(o/2),2);if(this.g=2*Math.asin(Math.sqrt(h)),this.g===Math.PI)throw new Error("it appears "+r.view()+" and "+s.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+r+" and "+s)};Ei.prototype.interpolate=function(r){var s=Math.sin((1-r)*this.g)/Math.sin(this.g),i=Math.sin(r*this.g)/Math.sin(this.g),o=s*Math.cos(this.start.y)*Math.cos(this.start.x)+i*Math.cos(this.end.y)*Math.cos(this.end.x),l=s*Math.cos(this.start.y)*Math.sin(this.start.x)+i*Math.cos(this.end.y)*Math.sin(this.end.x),h=s*Math.sin(this.start.y)+i*Math.sin(this.end.y),f=As*Math.atan2(h,Math.sqrt(Math.pow(o,2)+Math.pow(l,2))),g=As*Math.atan2(l,o);return[g,f]};Ei.prototype.Arc=function(r,s){var i=[];if(!r||r<=2)i.push([this.start.lon,this.start.lat]),i.push([this.end.lon,this.end.lat]);else for(var o=1/(r-1),l=0;l<r;++l){var h=o*l,f=this.interpolate(h);i.push(f)}for(var g=!1,v=0,m=s&&s.offset?s.offset:10,_=180-m,x=-180+m,P=360-m,k=1;k<i.length;++k){var N=i[k-1][0],C=i[k][0],D=Math.abs(C-N);D>P&&(C>_&&N<x||N>_&&C<x)?g=!0:D>v&&(v=D)}var R=[];if(g&&v<m){var M=[];R.push(M);for(var b=0;b<i.length;++b){var A=parseFloat(i[b][0]);if(b>0&&Math.abs(A-i[b-1][0])>P){var O=parseFloat(i[b-1][0]),fe=parseFloat(i[b-1][1]),B=parseFloat(i[b][0]),W=parseFloat(i[b][1]);if(O>-180&&O<x&&B===180&&b+1<i.length&&i[b-1][0]>-180&&i[b-1][0]<x){M.push([-180,i[b][1]]),b++,M.push([i[b][0],i[b][1]]);continue}else if(O>_&&O<180&&B===-180&&b+1<i.length&&i[b-1][0]>_&&i[b-1][0]<180){M.push([180,i[b][1]]),b++,M.push([i[b][0],i[b][1]]);continue}if(O<x&&B>_){var Z=O;O=B,B=Z;var ae=fe;fe=W,W=ae}if(O>_&&B<x&&(B+=360),O<=180&&B>=180&&O<B){var ie=(180-O)/(B-O),ve=ie*W+(1-ie)*fe;M.push([i[b-1][0]>_?180:-180,ve]),M=[],M.push([i[b-1][0]>_?-180:180,ve]),R.push(M)}else M=[],R.push(M);M.push([A,i[b][1]])}else M.push([i[b][0],i[b][1]])}}else{var Ie=[];R.push(Ie);for(var Me=0;Me<i.length;++Me)Ie.push([i[Me][0],i[Me][1]])}for(var Ne=new xi(this.properties),ue=0;ue<R.length;++ue){var Fe=new so;Ne.geometries.push(Fe);for(var Le=R[ue],le=0;le<Le.length;++le)Fe.move_to(Le[le])}return Ne};function Fc(r,s,i){if(i=i||{},typeof i!="object")throw new Error("options is invalid");var o=i.properties,l=i.npoints,h=i.offset;r=me(r),s=me(s),o=o||{},l=l||100,h=h||10;var f=new Ei({x:r[0],y:r[1]},{x:s[0],y:s[1]},o),g=f.Arc(l,{offset:h});return g.json()}/*!
 * Copyright (c) 2019, Dane Springmeyer
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in
 *       the documentation and/or other materials provided with the
 *       distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */function Ln(r,s={}){const i=[];if(Ye(r,l=>{i.push(l.coordinates)}),i.length<2)throw new Error("Must specify at least 2 geometries");const o=mt.intersection(i[0],...i.slice(1));return o.length===0?null:o.length===1?j(o[0],s.properties):$e(o,s.properties)}function ao(r,s,i={}){const o=JSON.stringify(i.properties||{}),[l,h,f,g]=r,v=(h+g)/2,m=(l+f)/2,x=s*2/ye([l,v],[f,v],i)*(f-l),k=s*2/ye([m,h],[m,g],i)*(g-h),N=x/2,C=N*2,D=Math.sqrt(3)/2*k,R=f-l,M=g-h,b=3/4*C,A=D,O=(R-C)/(C-N/2),fe=Math.floor(O),B=(fe*b-N/2-R)/2-N/2+b/2,W=Math.floor((M-D)/D);let Z=(M-W*D)/2;const ae=W*D-M>D/2;ae&&(Z-=D/4);const ie=[],ve=[];for(let Me=0;Me<6;Me++){const Ne=2*Math.PI/6*Me;ie.push(Math.cos(Ne)),ve.push(Math.sin(Ne))}const Ie=[];for(let Me=0;Me<=fe;Me++)for(let Ne=0;Ne<=W;Ne++){const ue=Me%2===1;if(Ne===0&&ue||Ne===0&&ae)continue;const Fe=Me*b+l-B;let Le=Ne*A+h+Z;if(ue&&(Le-=D/2),i.triangles===!0)Gc([Fe,Le],x/2,k/2,JSON.parse(o),ie,ve).forEach(function(le){i.mask?Ln(Y([i.mask,le]))&&Ie.push(le):Ie.push(le)});else{const le=qc([Fe,Le],x/2,k/2,JSON.parse(o),ie,ve);i.mask?Ln(Y([i.mask,le]))&&Ie.push(le):Ie.push(le)}}return Y(Ie)}function qc(r,s,i,o,l,h){const f=[];for(let g=0;g<6;g++){const v=r[0]+s*l[g],m=r[1]+i*h[g];f.push([v,m])}return f.push(f[0].slice()),j([f],o)}function Gc(r,s,i,o,l,h){const f=[];for(let g=0;g<6;g++){const v=[];v.push(r),v.push([r[0]+s*l[g],r[1]+i*h[g]]),v.push([r[0]+s*l[(g+1)%6],r[1]+i*h[(g+1)%6]]),v.push(r),f.push(j([v],o))}return f}function oo(r,s,i={}){i.mask&&!i.units&&(i.units="kilometers");for(var o=[],l=r[0],h=r[1],f=r[2],g=r[3],v=s/ye([l,h],[f,h],i),m=v*(f-l),_=s/ye([l,h],[l,g],i),x=_*(g-h),P=f-l,k=g-h,N=Math.floor(P/m),C=Math.floor(k/x),D=(P-N*m)/2,R=(k-C*x)/2,M=l+D;M<=f;){for(var b=h+R;b<=g;){var A=re([M,b],i.properties);i.mask?Ga(A,i.mask)&&o.push(A):o.push(A),b+=x}M+=m}return Y(o)}function uo(r,s,i,o={}){const l=[],h=r[0],f=r[1],g=r[2],v=r[3],m=g-h,_=Bt(s,o.units,"degrees"),x=v-f,P=Bt(i,o.units,"degrees"),k=Math.floor(Math.abs(m)/_),N=Math.floor(Math.abs(x)/P),C=(m-k*_)/2,D=(x-N*P)/2;let R=h+C;for(let M=0;M<k;M++){let b=f+D;for(let A=0;A<N;A++){const O=j([[[R,b],[R,b+P],[R+_,b+P],[R+_,b],[R,b]]],o.properties);o.mask?Fa(o.mask,O)&&l.push(O):l.push(O),b+=P}R+=_}return Y(l)}function ki(r,s,i={}){return uo(r,s,s,i)}function lo(r,s,i={}){for(var o=[],l=s/ye([r[0],r[1]],[r[2],r[1]],i),h=l*(r[2]-r[0]),f=s/ye([r[0],r[1]],[r[0],r[3]],i),g=f*(r[3]-r[1]),v=0,m=r[0];m<=r[2];){for(var _=0,x=r[1];x<=r[3];){var P=null,k=null;v%2===0&&_%2===0?(P=j([[[m,x],[m,x+g],[m+h,x],[m,x]]],i.properties),k=j([[[m,x+g],[m+h,x+g],[m+h,x],[m,x+g]]],i.properties)):v%2===0&&_%2===1?(P=j([[[m,x],[m+h,x+g],[m+h,x],[m,x]]],i.properties),k=j([[[m,x],[m,x+g],[m+h,x+g],[m,x]]],i.properties)):_%2===0&&v%2===1?(P=j([[[m,x],[m,x+g],[m+h,x+g],[m,x]]],i.properties),k=j([[[m,x],[m+h,x+g],[m+h,x],[m,x]]],i.properties)):_%2===1&&v%2===1&&(P=j([[[m,x],[m,x+g],[m+h,x],[m,x]]],i.properties),k=j([[[m,x+g],[m+h,x+g],[m+h,x],[m,x+g]]],i.properties)),i.mask?(Ln(Y([i.mask,P]))&&o.push(P),Ln(Y([i.mask,k]))&&o.push(k)):(o.push(P),o.push(k)),x+=g,_++}v++,m+=h}return Y(o)}function zc(r,s,i){if(i=i||{},typeof i!="object")throw new Error("options is invalid");var o=i.gridType,l=i.property,h=i.weight;if(!r)throw new Error("points is required");if(Pt(r,"Point","input must contain Points"),!s)throw new Error("cellSize is required");if(h!==void 0&&typeof h!="number")throw new Error("weight must be a number");l=l||"elevation",o=o||"square",h=h||1;var f=_e(r),g;switch(o){case"point":case"points":g=oo(f,s,i);break;case"square":case"squares":g=ki(f,s,i);break;case"hex":case"hexes":g=ao(f,s,i);break;case"triangle":case"triangles":g=lo(f,s,i);break;default:throw new Error("invalid gridType")}var v=[];return he(g,function(m){var _=0,x=0;he(r,function(k){var N=o==="point"?m:Nt(m),C=ye(N,k,i),D;if(l!==void 0&&(D=k.properties[l]),D===void 0&&(D=k.geometry.coordinates[2]),D===void 0)throw new Error("zValue is missing");C===0&&(_=D);var R=1/Math.pow(C,h);x+=R,_+=R*D});var P=Be(m);P.properties[l]=_/x,v.push(P)}),Y(v)}var Bc=Object.defineProperty,Ds=Object.getOwnPropertySymbols,Yc=Object.prototype.hasOwnProperty,Xc=Object.prototype.propertyIsEnumerable,Fs=(r,s,i)=>s in r?Bc(r,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[s]=i,qs=(r,s)=>{for(var i in s||(s={}))Yc.call(s,i)&&Fs(r,i,s[i]);if(Ds)for(var i of Ds(s))Xc.call(s,i)&&Fs(r,i,s[i]);return r};function Uc(r,s){if(s=s||{},!de(s))throw new Error("options is invalid");var i=s.zProperty||"elevation",o=s.flip,l=s.flags;Pt(r,"Point","input must contain Points");for(var h=Vc(r,o),f=[],g=0;g<h.length;g++){for(var v=h[g],m=[],_=0;_<v.length;_++){var x=v[_];x.properties[i]?m.push(x.properties[i]):m.push(0),l===!0&&(x.properties.matrixPosition=[g,_])}f.push(m)}return f}function Vc(r,s){var i={};he(r,function(h){var f=J(h)[1];i[f]||(i[f]=[]),i[f].push(h)});var o=Object.keys(i).map(function(h){var f=i[h],g=f.sort(function(v,m){return J(v)[0]-J(m)[0]});return g}),l=o.sort(function(h,f){return s?J(h[0])[1]-J(f[0])[1]:J(f[0])[1]-J(h[0])[1]});return l}function Hc(r,s,i){if(i=i||{},!de(i))throw new Error("options is invalid");const o=i.zProperty||"elevation",l=i.commonProperties||{},h=i.breaksProperties||[];if(Pt(r,"Point","Input must contain Points"),!s)throw new Error("breaks is required");if(!Array.isArray(s))throw new Error("breaks is not an Array");if(!de(l))throw new Error("commonProperties is not an Object");if(!Array.isArray(h))throw new Error("breaksProperties is not an Array");const f=Uc(r,{zProperty:o,flip:!0});let g=Zc(f,s,o);g=Wc(g,f,r);const v=g.map((m,_)=>{if(h[_]&&!de(h[_]))throw new Error("Each mappedProperty is required to be an Object");const x=qs(qs({},l),h[_]);return x[o]=m[o],$e(m.groupedRings,x)});return Y(v)}function Zc(r,s,i){const o=[];for(let l=1;l<s.length;l++){const h=+s[l-1],f=+s[l],g=Ju(r,h,f-h),v=$c(g),m=Jc(v);o.push({groupedRings:m,[i]:h+"-"+f})}return o}function Wc(r,s,i){const o=_e(i),l=o[2]-o[0],h=o[3]-o[1],f=o[0],g=o[1],v=s[0].length-1,m=s.length-1,_=l/v,x=h/m;return r.map(function(P){return P.groupedRings=P.groupedRings.map(function(k){return k.map(function(N){return N.map(C=>[C[0]*_+f,C[1]*x+g])})}),P})}function $c(r){const s=r.map(function(i){return{ring:i,area:An(j([i]))}});return s.sort(function(i,o){return o.area-i.area}),s.map(function(i){return i.ring})}function Jc(r){const s=r.map(o=>({lrCoordinates:o,grouped:!1})),i=[];for(;!Qc(s);)for(let o=0;o<s.length;o++)if(!s[o].grouped){const l=[];l.push(s[o].lrCoordinates),s[o].grouped=!0;const h=j([s[o].lrCoordinates]);for(let f=o+1;f<s.length;f++)if(!s[f].grouped){const g=j([s[f].lrCoordinates]);Kc(g,h)&&(l.push(s[f].lrCoordinates),s[f].grouped=!0)}i.push(l)}return i}function Kc(r,s){const i=fr(r);for(let o=0;o<i.features.length;o++)if(!ne(i.features[o],s))return!1;return!0}function Qc(r){for(let s=0;s<r.length;s++)if(r[s].grouped===!1)return!1;return!0}var jc=Object.defineProperty,Gs=Object.getOwnPropertySymbols,eh=Object.prototype.hasOwnProperty,th=Object.prototype.propertyIsEnumerable,zs=(r,s,i)=>s in r?jc(r,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[s]=i,Bs=(r,s)=>{for(var i in s||(s={}))eh.call(s,i)&&zs(r,i,s[i]);if(Gs)for(var i of Gs(s))th.call(s,i)&&zs(r,i,s[i]);return r};function nh(r,s){if(s=s||{},!de(s))throw new Error("options is invalid");var i=s.zProperty||"elevation",o=s.flip,l=s.flags;Pt(r,"Point","input must contain Points");for(var h=rh(r,o),f=[],g=0;g<h.length;g++){for(var v=h[g],m=[],_=0;_<v.length;_++){var x=v[_];x.properties[i]?m.push(x.properties[i]):m.push(0),l===!0&&(x.properties.matrixPosition=[g,_])}f.push(m)}return f}function rh(r,s){var i={};he(r,function(h){var f=J(h)[1];i[f]||(i[f]=[]),i[f].push(h)});var o=Object.keys(i).map(function(h){var f=i[h],g=f.sort(function(v,m){return J(v)[0]-J(m)[0]});return g}),l=o.sort(function(h,f){return s?J(h[0])[1]-J(f[0])[1]:J(f[0])[1]-J(h[0])[1]});return l}function ih(r,s,i){if(i=i||{},!de(i))throw new Error("options is invalid");const o=i.zProperty||"elevation",l=i.commonProperties||{},h=i.breaksProperties||[];if(Pt(r,"Point","Input must contain Points"),!s)throw new Error("breaks is required");if(!Array.isArray(s))throw new Error("breaks must be an Array");if(!de(l))throw new Error("commonProperties must be an Object");if(!Array.isArray(h))throw new Error("breaksProperties must be an Array");const f=nh(r,{zProperty:o,flip:!0}),g=sh(f,s,o,l,h),v=ah(g,f,r);return Y(v)}function sh(r,s,i,o,l){const h=[];for(let f=0;f<s.length;f++){const g=+s[f],v=Bs(Bs({},o),l[f]);v[i]=g;const m=bt(Ku(r,g,{linearRing:!1,noFrame:!0}),v);h.push(m)}return h}function ah(r,s,i){const o=_e(i),l=o[2]-o[0],h=o[3]-o[1],f=o[0],g=o[1],v=s[0].length-1,m=s.length-1,_=l/v,x=h/m,P=k=>{k[0]=k[0]*_+f,k[1]=k[1]*x+g};return r.forEach(k=>{Pe(k,P)}),r}function oh(r){let s,i;const o={type:"FeatureCollection",features:[]};if(r.type==="Feature"?i=r.geometry:i=r,i.type==="LineString")s=[i.coordinates];else if(i.type==="MultiLineString")s=i.coordinates;else if(i.type==="MultiPolygon")s=[].concat(...i.coordinates);else if(i.type==="Polygon")s=i.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return s.forEach(l=>{s.forEach(h=>{for(let f=0;f<l.length-1;f++)for(let g=f;g<h.length-1;g++){if(l===h&&(Math.abs(f-g)===1||f===0&&g===l.length-2&&l[f][0]===l[l.length-1][0]&&l[f][1]===l[l.length-1][1]))continue;const v=uh(l[f][0],l[f][1],l[f+1][0],l[f+1][1],h[g][0],h[g][1],h[g+1][0],h[g+1][1]);v&&o.features.push(re([v[0],v[1]]))}})}),o}function uh(r,s,i,o,l,h,f,g){let v,m,_,x,P;const k={x:null,y:null,onLine1:!1,onLine2:!1};return v=(g-h)*(i-r)-(f-l)*(o-s),v===0?k.x!==null&&k.y!==null?k:!1:(m=s-h,_=r-l,x=(f-l)*m-(g-h)*_,P=(i-r)*m-(o-s)*_,m=x/v,_=P/v,k.x=r+m*(i-r),k.y=s+m*(o-s),m>=0&&m<=1&&(k.onLine1=!0),_>=0&&_<=1&&(k.onLine2=!0),k.onLine1&&k.onLine2?[k.x,k.y]:!1)}function co(r,s={}){return li(r,(i,o)=>{const l=o.geometry.coordinates;return i+ye(l[0],l[1],s)},0)}function ho(r,s,i,o,l={}){const h=l.steps||64,f=Ys(i),g=Ys(o),v=!Array.isArray(r)&&r.type==="Feature"?r.properties:{};if(f===g)return ce(vi(r,s,l).geometry.coordinates[0],v);const m=f,_=f<g?g:g+360;let x=m;const P=[];let k=0;const N=(_-m)/h;for(;x<=_;)P.push(It(r,s,x,l).geometry.coordinates),k++,x=m+k*N;return ce(P,v)}function Ys(r){let s=r%360;return s<0&&(s+=360),s}function fo(r,s,i,o){if(o=o||{},!de(o))throw new Error("options is invalid");var l,h=[];if(r.type==="Feature")l=r.geometry.coordinates;else if(r.type==="LineString")l=r.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var f=l.length,g=0,v,m,_,x=0;x<l.length&&!(s>=g&&x===l.length-1);x++){if(g>s&&h.length===0){if(v=s-g,!v)return h.push(l[x]),ce(h);m=wt(l[x],l[x-1])-180,_=It(l[x],v,m,o),h.push(_.geometry.coordinates)}if(g>=i)return v=i-g,v?(m=wt(l[x],l[x-1])-180,_=It(l[x],v,m,o),h.push(_.geometry.coordinates),ce(h)):(h.push(l[x]),ce(h));if(g>=s&&h.push(l[x]),x===l.length-1)return ce(h);g+=ye(l[x],l[x+1],o)}if(g<s&&l.length===f)throw new Error("Start position is beyond line");var P=l[l.length-1];return ce([P,P])}function lh(r,s,i){if(i=i||{},!de(i))throw new Error("options is invalid");var o=i.units,l=i.reverse;if(!r)throw new Error("geojson is required");if(s<=0)throw new Error("segmentLength must be greater than 0");var h=[];return ze(r,function(f){l&&(f.geometry.coordinates=f.geometry.coordinates.reverse()),ch(f,s,o,function(g){h.push(g)})}),Y(h)}function ch(r,s,i,o){var l=co(r,{units:i});if(l<=s)return o(r);var h=l/s;Number.isInteger(h)||(h=Math.floor(h)+1);for(var f=0;f<h;f++){var g=fo(r,s*f,s*(f+1),{units:i});o(g,f)}}function rr(r){var s=r[0],i=r[1];return[i[0]-s[0],i[1]-s[1]]}function $r(r,s){return r[0]*s[1]-s[0]*r[1]}function hh(r,s){return[r[0]+s[0],r[1]+s[1]]}function fh(r,s){return[r[0]-s[0],r[1]-s[1]]}function gh(r,s){return[r*s[0],r*s[1]]}function dh(r,s){var i=r[0],o=rr(r),l=s[0],h=rr(s),f=$r(o,h),g=fh(l,i),v=$r(g,h),m=v/f,_=hh(i,gh(m,o));return _}function vh(r,s){var i=rr(r),o=rr(s);return $r(i,o)===0}function yh(r,s){return vh(r,s)?!1:dh(r,s)}function mh(r,s,i){if(i=i||{},!de(i))throw new Error("options is invalid");var o=i.units;if(!r)throw new Error("geojson is required");if(s==null||isNaN(s))throw new Error("distance is required");var l=Je(r),h=r.properties;switch(l){case"LineString":return Xs(r,s,o);case"MultiLineString":var f=[];return ze(r,function(g){f.push(Xs(g,s,o).geometry.coordinates)}),bt(f,h);default:throw new Error("geometry "+l+" is not supported")}}function Xs(r,s,i){var o=[],l=ar(s,i),h=J(r),f=[];return h.forEach(function(g,v){if(v!==h.length-1){var m=ph(g,h[v+1],l);if(o.push(m),v>0){var _=o[v-1],x=yh(m,_);x!==!1&&(_[1]=x,m[0]=x),f.push(_[0]),v===h.length-2&&(f.push(m[0]),f.push(m[1]))}h.length===2&&(f.push(m[0]),f.push(m[1]))}}),ce(f,r.properties)}function ph(r,s,i){var o=Math.sqrt((r[0]-s[0])*(r[0]-s[0])+(r[1]-s[1])*(r[1]-s[1])),l=r[0]+i*(s[1]-r[1])/o,h=s[0]+i*(s[1]-r[1])/o,f=r[1]+i*(r[0]-s[0])/o,g=s[1]+i*(r[0]-s[0])/o;return[[l,f],[h,g]]}function _h(r,s,i){var o=J(i);if(Je(i)!=="LineString")throw new Error("line must be a LineString");var l=Lt(i,r),h=Lt(i,s),f;l.properties.index<=h.properties.index?f=[l,h]:f=[h,l];for(var g=[f[0].geometry.coordinates],v=f[0].properties.index+1;v<f[1].properties.index+1;v++)g.push(o[v]);return g.push(f[1].geometry.coordinates),ce(g,i.properties)}function go(r){var s=r[0],i=r[1],o=r[2],l=r[3],h=ye(r.slice(0,2),[o,i]),f=ye(r.slice(0,2),[s,l]);if(h>=f){var g=(i+l)/2;return[s,g-(o-s)/2,o,g+(o-s)/2]}else{var v=(s+o)/2;return[v-(l-i)/2,i,v+(l-i)/2,l]}}function vo(r,s){if(s=s??{},!de(s))throw new Error("options is invalid");var i=s.precision,o=s.coordinates,l=s.mutate;if(i=i==null||isNaN(i)?6:i,o=o==null||isNaN(o)?3:o,!r)throw new Error("<geojson> is required");if(typeof i!="number")throw new Error("<precision> must be a number");if(typeof o!="number")throw new Error("<coordinates> must be a number");(l===!1||l===void 0)&&(r=JSON.parse(JSON.stringify(r)));var h=Math.pow(10,i);return Pe(r,function(f){xh(f,h,o)}),r}function xh(r,s,i){r.length>i&&r.splice(i,r.length);for(var o=0;o<r.length;o++)r[o]=Math.round(r[o]*s)/s;return r}function Eh(r,s){if(!r)throw new Error("line is required");if(!s)throw new Error("splitter is required");var i=Je(r),o=Je(s);if(i!=="LineString")throw new Error("line must be LineString");if(o==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(o==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var l=vo(s,{precision:7});switch(o){case"Point":return Jr(r,l);case"MultiPoint":return Us(r,l);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Us(r,ht(r,l,{ignoreSelfIntersections:!0}))}}function Us(r,s){var i=[],o=or();return ze(s,function(l){if(i.forEach(function(g,v){g.id=v}),!i.length)i=Jr(r,l).features,i.forEach(function(g){g.bbox||(g.bbox=go(_e(g)))}),o.load(Y(i));else{var h=o.search(l);if(h.features.length){var f=yo(l,h);i=i.filter(function(g){return g.id!==f.id}),o.remove(f),he(Jr(f,l),function(g){i.push(g),o.insert(g)})}}}),Y(i)}function Jr(r,s){var i=[],o=J(r)[0],l=J(r)[r.geometry.coordinates.length-1];if(Ur(o,me(s))||Ur(l,me(s)))return Y([r]);var h=or(),f=Pn(r);h.load(f);var g=h.search(s);if(!g.features.length)return Y([r]);var v=yo(s,g),m=[o],_=oi(f,function(x,P,k){var N=J(P)[1],C=me(s);return k===v.id?(x.push(C),i.push(ce(x)),Ur(C,N)?[C]:[C,N]):(x.push(N),x)},m);return _.length>1&&i.push(ce(_)),Y(i)}function yo(r,s){if(!s.features.length)throw new Error("lines must contain features");if(s.features.length===1)return s.features[0];var i,o=1/0;return he(s,function(l){var h=Lt(l,r),f=h.properties.dist;f<o&&(i=l,o=f)}),i}function Ur(r,s){return r[0]===s[0]&&r[1]===s[1]}function kh(r,s={}){var i,o,l,h=s.properties,f=(i=s.autoComplete)!=null?i:!0,g=(o=s.orderCoords)!=null?o:!0,v=(l=s.mutate)!=null?l:!1;switch(v||(r=Be(r)),r.type){case"FeatureCollection":var m=[];return r.features.forEach(function(_){m.push(J(Vs(_,{},f,g)))}),$e(m,h);default:return Vs(r,h,f,g)}}function Vs(r,s,i,o){s=s||(r.type==="Feature"?r.properties:{});var l=we(r),h=l.coordinates,f=l.type;if(!h.length)throw new Error("line must contain coordinates");switch(f){case"LineString":return i&&(h=Hs(h)),j([h],s);case"MultiLineString":var g=[],v=0;return h.forEach(function(m){if(i&&(m=Hs(m)),o){var _=wh(_e(ce(m)));_>v?(g.unshift(m),v=_):g.push(m)}else g.push(m)}),j(g,s);default:throw new Error("geometry type "+f+" is not supported")}}function Hs(r){var s=r[0],i=s[0],o=s[1],l=r[r.length-1],h=l[0],f=l[1];return(i!==h||o!==f)&&r.push(s),r}function wh(r){var s=r[0],i=r[1],o=r[2],l=r[3];return Math.abs(s-o)*Math.abs(i-l)}function Ih(r,s,i){var o;const l=(o=i==null?void 0:i.mutate)!=null?o:!1;let h=s;s&&l===!1&&(h=Be(s));const f=Ph(h);let g=null;return r.type==="FeatureCollection"?g=Nh(r):r.type==="Feature"?g=Kr(mt.union(r.geometry.coordinates)):g=Kr(mt.union(r.coordinates)),g.geometry.coordinates.forEach(function(v){f.geometry.coordinates.push(v[0])}),f}function Nh(r){const s=r.features.length===2?mt.union(r.features[0].geometry.coordinates,r.features[1].geometry.coordinates):mt.union.apply(mt,r.features.map(function(i){return i.geometry.coordinates}));return Kr(s)}function Kr(r){return $e(r)}function Ph(r){let i=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]];return r&&(r.type==="Feature"?i=r.geometry.coordinates:i=r.coordinates),j(i)}function Mh(r,s){const i=ye(r,s),o=wt(r,s);return It(r,i/2,o)}function Lh(r,s){var i,o;const l=s.inputField,h=s.threshold||1e5,f=s.p||2,g=(i=s.binary)!=null?i:!1,v=s.alpha||-1,m=(o=s.standardization)!=null?o:!0,_=to(r,{alpha:v,binary:g,p:f,standardization:m,threshold:h}),x=[];he(r,ae=>{const ie=ae.properties||{};x.push(ie[l])});const P=mo(x),k=bh(x);let N=0,C=0,D=0,R=0;const M=_.length;for(let ae=0;ae<M;ae++){let ie=0;for(let ve=0;ve<M;ve++)N+=_[ae][ve]*(x[ae]-P)*(x[ve]-P),C+=_[ae][ve],D+=Math.pow(_[ae][ve]+_[ve][ae],2),ie+=_[ae][ve]+_[ve][ae];R+=Math.pow(ie,2)}D=.5*D;const b=N/C/k,A=-1/(M-1),O=M*M*D-M*R+3*(C*C),fe=(M-1)*(M+1)*(C*C),B=O/fe-A*A,W=Math.sqrt(B),Z=(b-A)/W;return{expectedMoranIndex:A,moranIndex:b,stdNorm:W,zNorm:Z}}function mo(r){let s=0;for(const i of r)s+=i;return s/r.length}function bh(r){const s=mo(r);let i=0;for(const o of r)i+=Math.pow(o-s,2);return i/r.length}var Sh=Object.defineProperty,Ch=Object.defineProperties,Th=Object.getOwnPropertyDescriptors,Zs=Object.getOwnPropertySymbols,Oh=Object.prototype.hasOwnProperty,Rh=Object.prototype.propertyIsEnumerable,Ws=(r,s,i)=>s in r?Sh(r,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[s]=i,$s=(r,s)=>{for(var i in s||(s={}))Oh.call(s,i)&&Ws(r,i,s[i]);if(Zs)for(var i of Zs(s))Rh.call(s,i)&&Ws(r,i,s[i]);return r},Js=(r,s)=>Ch(r,Th(s));function gr(r,s,i={}){if(!r)throw new Error("targetPoint is required");if(!s)throw new Error("points is required");let o=1/0,l=0;he(s,(f,g)=>{const v=ye(r,f,i);v<o&&(l=g,o=v)});const h=Be(s.features[l]);return Js($s({},h),{properties:Js($s({},h.properties),{featureIndex:l,distanceToPoint:o})})}function Ah(r,s){s=s||{};const i=s.studyArea||Dn(_e(r)),o=s.properties||{},l=s.units||"kilometers",h=[];he(r,x=>{h.push(Nt(x))});const f=h.length,g=h.map((x,P)=>{const k=Y(h.filter((N,C)=>C!==P));return ye(x,gr(x,k).geometry.coordinates,{units:l})}).reduce((x,P)=>x+P,0)/f,v=f/ri(An(i),"meters",l),m=1/(2*Math.sqrt(v)),_=.26136/Math.sqrt(f*v);return o.nearestNeighborAnalysis={units:l,arealUnits:l+"",observedMeanDistance:g,expectedMeanDistance:m,nearestNeighborIndex:g/m,numberOfPoints:f,zScore:(g-m)/_},i.properties=o,i}function po(r,s,i={}){if(i.method||(i.method="geodesic"),i.units||(i.units="kilometers"),!r)throw new Error("pt is required");if(Array.isArray(r)?r=re(r):r.type==="Point"?r=Oe(r):wn(r,"Point","point"),!s)throw new Error("line is required");Array.isArray(s)?s=ce(s):s.type==="LineString"?s=Oe(s):wn(s,"LineString","line");let o=1/0;const l=r.geometry.coordinates;return kt(s,h=>{const f=h.geometry.coordinates[0],g=h.geometry.coordinates[1],v=Dh(l,f,g,i);v<o&&(o=v)}),Bt(o,"degrees",i.units)}function Dh(r,s,i,o){const l=[i[0]-s[0],i[1]-s[1]],h=[r[0]-s[0],r[1]-s[1]],f=Ks(h,l);if(f<=0)return Vr(r,s,{method:o.method,units:"degrees"});const g=Ks(l,l);if(g<=f)return Vr(r,i,{method:o.method,units:"degrees"});const v=f/g,m=[s[0]+v*l[0],s[1]+v*l[1]];return Vr(r,m,{method:o.method,units:"degrees"})}function Ks(r,s){return r[0]*s[0]+r[1]*s[1]}function Vr(r,s,i){return i.method==="planar"?hr(r,s,i):ye(r,s,i)}var Fh=Object.defineProperty,Qs=Object.getOwnPropertySymbols,qh=Object.prototype.hasOwnProperty,Gh=Object.prototype.propertyIsEnumerable,js=(r,s,i)=>s in r?Fh(r,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[s]=i,Hr=(r,s)=>{for(var i in s||(s={}))qh.call(s,i)&&js(r,i,s[i]);if(Qs)for(var i of Qs(s))Gh.call(s,i)&&js(r,i,s[i]);return r};function zh(r,s,i={}){const o=i.units,l=i.properties||{},h=Bh(r);if(!h.features.length)throw new Error("points must contain features");if(!s)throw new Error("line is required");if(Je(s)!=="LineString")throw new Error("line must be a LineString");let f=1/0,g=null;return he(h,v=>{const m=po(v,s,{units:o});m<f&&(f=m,g=v)}),g&&(g.properties=Hr(Hr(Hr({},{dist:f}),g.properties),l)),g}function Bh(r){const s=[];switch(r.geometry?r.geometry.type:r.type){case"GeometryCollection":return Ye(r,o=>{o.type==="Point"&&s.push({type:"Feature",properties:{},geometry:o})}),{type:"FeatureCollection",features:s};case"FeatureCollection":return r.features=r.features.filter(o=>o.geometry.type==="Point"),r;default:throw new Error("points must be a Point Collection")}}function Yh(r,s){const i=me(r),h=we(s).coordinates[0];if(h.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");const f=s.type==="Feature"&&s.properties||{},g=f.a,v=f.b,m=f.c,_=i[0],x=i[1],P=h[0][0],k=h[0][1],N=g!==void 0?g:h[0][2],C=h[1][0],D=h[1][1],R=v!==void 0?v:h[1][2],M=h[2][0],b=h[2][1],A=m!==void 0?m:h[2][2];return(A*(_-P)*(x-D)+N*(_-C)*(x-b)+R*(_-M)*(x-k)-R*(_-P)*(x-b)-A*(_-C)*(x-k)-N*(_-M)*(x-D))/((_-P)*(x-D)+(_-C)*(x-b)+(_-M)*(x-k)-(_-P)*(x-b)-(_-C)*(x-k)-(_-M)*(x-D))}function Xh(r){const s=Uh(r),i=ur(s);let o=!1,l=0;for(;!o&&l<s.features.length;){const h=s.features[l].geometry;let f,g,v,m,_,x,P=!1;if(h.type==="Point")i.geometry.coordinates[0]===h.coordinates[0]&&i.geometry.coordinates[1]===h.coordinates[1]&&(o=!0);else if(h.type==="MultiPoint"){let k=!1,N=0;for(;!k&&N<h.coordinates.length;)i.geometry.coordinates[0]===h.coordinates[N][0]&&i.geometry.coordinates[1]===h.coordinates[N][1]&&(o=!0,k=!0),N++}else if(h.type==="LineString"){let k=0;for(;!P&&k<h.coordinates.length-1;)f=i.geometry.coordinates[0],g=i.geometry.coordinates[1],v=h.coordinates[k][0],m=h.coordinates[k][1],_=h.coordinates[k+1][0],x=h.coordinates[k+1][1],ea(f,g,v,m,_,x)&&(P=!0,o=!0),k++}else if(h.type==="MultiLineString"){let k=0;for(;k<h.coordinates.length;){P=!1;let N=0;const C=h.coordinates[k];for(;!P&&N<C.length-1;)f=i.geometry.coordinates[0],g=i.geometry.coordinates[1],v=C[N][0],m=C[N][1],_=C[N+1][0],x=C[N+1][1],ea(f,g,v,m,_,x)&&(P=!0,o=!0),N++;k++}}else(h.type==="Polygon"||h.type==="MultiPolygon")&&ne(i,h)&&(o=!0);l++}if(o)return i;{const h=Y([]);for(let f=0;f<s.features.length;f++)h.features=h.features.concat(fr(s.features[f]).features);return re(gr(i,h).geometry.coordinates)}}function Uh(r){return r.type!=="FeatureCollection"?r.type!=="Feature"?Y([Oe(r)]):Y([r]):r}function ea(r,s,i,o,l,h){const f=Math.sqrt((l-i)*(l-i)+(h-o)*(h-o)),g=Math.sqrt((r-i)*(r-i)+(s-o)*(s-o)),v=Math.sqrt((l-r)*(l-r)+(h-s)*(h-s));return f===g+v}function _o(r,s){const i=[];return he(r,function(o){let l=!1;if(o.geometry.type==="Point")Ye(s,function(f){ne(o,f)&&(l=!0)}),l&&i.push(o);else if(o.geometry.type==="MultiPoint"){var h=[];Ye(s,function(f){Pe(o,function(g){ne(g,f)&&(l=!0,h.push(g))})}),l&&i.push(On(h,o.properties))}else throw new Error("Input geometry must be a Point or MultiPoint")}),Y(i)}function Vh(r){return(r>0)-(r<0)||+r}function wi(r,s,i){const o=s[0]-r[0],l=s[1]-r[1],h=i[0]-s[0],f=i[1]-s[1];return Vh(o*f-h*l)}function Hh(r,s){const i=r.geometry.coordinates[0].map(f=>f[0]),o=r.geometry.coordinates[0].map(f=>f[1]),l=s.geometry.coordinates[0].map(f=>f[0]),h=s.geometry.coordinates[0].map(f=>f[1]);return Math.max.apply(null,i)===Math.max.apply(null,l)&&Math.max.apply(null,o)===Math.max.apply(null,h)&&Math.min.apply(null,i)===Math.min.apply(null,l)&&Math.min.apply(null,o)===Math.min.apply(null,h)}function ta(r,s){return s.geometry.coordinates[0].every(i=>ne(re(i),r))}function Zh(r,s){return r[0]===s[0]&&r[1]===s[1]}var na=class xo{static buildId(s){return s.join(",")}constructor(s){this.id=xo.buildId(s),this.coordinates=s,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}removeInnerEdge(s){this.innerEdges=this.innerEdges.filter(i=>i.from.id!==s.from.id)}removeOuterEdge(s){this.outerEdges=this.outerEdges.filter(i=>i.to.id!==s.to.id)}addOuterEdge(s){this.outerEdges.push(s),this.outerEdgesSorted=!1}sortOuterEdges(){this.outerEdgesSorted||(this.outerEdges.sort((s,i)=>{const o=s.to,l=i.to;if(o.coordinates[0]-this.coordinates[0]>=0&&l.coordinates[0]-this.coordinates[0]<0)return 1;if(o.coordinates[0]-this.coordinates[0]<0&&l.coordinates[0]-this.coordinates[0]>=0)return-1;if(o.coordinates[0]-this.coordinates[0]===0&&l.coordinates[0]-this.coordinates[0]===0)return o.coordinates[1]-this.coordinates[1]>=0||l.coordinates[1]-this.coordinates[1]>=0?o.coordinates[1]-l.coordinates[1]:l.coordinates[1]-o.coordinates[1];const h=wi(this.coordinates,o.coordinates,l.coordinates);if(h<0)return 1;if(h>0)return-1;const f=Math.pow(o.coordinates[0]-this.coordinates[0],2)+Math.pow(o.coordinates[1]-this.coordinates[1],2),g=Math.pow(l.coordinates[0]-this.coordinates[0],2)+Math.pow(l.coordinates[1]-this.coordinates[1],2);return f-g}),this.outerEdgesSorted=!0)}getOuterEdges(){return this.sortOuterEdges(),this.outerEdges}getOuterEdge(s){return this.sortOuterEdges(),this.outerEdges[s]}addInnerEdge(s){this.innerEdges.push(s)}},Wh=class Eo{getSymetric(){return this.symetric||(this.symetric=new Eo(this.to,this.from),this.symetric.symetric=this),this.symetric}constructor(s,i){this.from=s,this.to=i,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}deleteEdge(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)}isEqual(s){return this.from.id===s.from.id&&this.to.id===s.to.id}toString(){return`Edge { ${this.from.id} -> ${this.to.id} }`}toLineString(){return ce([this.from.coordinates,this.to.coordinates])}compareTo(s){return wi(s.from.coordinates,s.to.coordinates,this.to.coordinates)}},ko=class{constructor(){this.edges=[],this.polygon=void 0,this.envelope=void 0}push(r){this.edges.push(r),this.polygon=this.envelope=void 0}get(r){return this.edges[r]}get length(){return this.edges.length}forEach(r){this.edges.forEach(r)}map(r){return this.edges.map(r)}some(r){return this.edges.some(r)}isValid(){return!0}isHole(){const r=this.edges.reduce((l,h,f)=>(h.from.coordinates[1]>this.edges[l].from.coordinates[1]&&(l=f),l),0),s=(r===0?this.length:r)-1,i=(r+1)%this.length,o=wi(this.edges[s].from.coordinates,this.edges[r].from.coordinates,this.edges[i].from.coordinates);return o===0?this.edges[s].from.coordinates[0]>this.edges[i].from.coordinates[0]:o>0}toMultiPoint(){return On(this.edges.map(r=>r.from.coordinates))}toPolygon(){if(this.polygon)return this.polygon;const r=this.edges.map(s=>s.from.coordinates);return r.push(this.edges[0].from.coordinates),this.polygon=j([r])}getEnvelope(){return this.envelope?this.envelope:this.envelope=io(this.toPolygon())}static findEdgeRingContaining(r,s){const i=r.getEnvelope();let o,l;return s.forEach(h=>{const f=h.getEnvelope();if(l&&(o=l.getEnvelope()),!Hh(f,i)&&ta(f,i)){const g=r.map(m=>m.from.coordinates);let v;for(const m of g)h.some(_=>Zh(m,_.from.coordinates))||(v=m);v&&h.inside(re(v))&&(!l||ta(o,f))&&(l=h)}}),l}inside(r){return ne(r,this.toPolygon())}};function $h(r){if(!r)throw new Error("No geojson passed");if(r.type!=="FeatureCollection"&&r.type!=="GeometryCollection"&&r.type!=="MultiLineString"&&r.type!=="LineString"&&r.type!=="Feature")throw new Error(`Invalid input type '${r.type}'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature`)}var Jh=class wo{static fromGeoJson(s){$h(s);const i=new wo;return ze(s,o=>{wn(o,"LineString","Graph::fromGeoJson"),si(o,(l,h)=>{if(l){const f=i.getNode(l),g=i.getNode(h);i.addEdge(f,g)}return h})}),i}getNode(s){const i=na.buildId(s);let o=this.nodes[i];return o||(o=this.nodes[i]=new na(s)),o}addEdge(s,i){const o=new Wh(s,i),l=o.getSymetric();this.edges.push(o),this.edges.push(l)}constructor(){this.edges=[],this.nodes={}}deleteDangles(){Object.keys(this.nodes).map(s=>this.nodes[s]).forEach(s=>this._removeIfDangle(s))}_removeIfDangle(s){if(s.innerEdges.length<=1){const i=s.getOuterEdges().map(o=>o.to);this.removeNode(s),i.forEach(o=>this._removeIfDangle(o))}}deleteCutEdges(){this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(s=>{s.label===s.symetric.label&&(this.removeEdge(s.symetric),this.removeEdge(s))})}_computeNextCWEdges(s){typeof s>"u"?Object.keys(this.nodes).forEach(i=>this._computeNextCWEdges(this.nodes[i])):s.getOuterEdges().forEach((i,o)=>{s.getOuterEdge((o===0?s.getOuterEdges().length:o)-1).symetric.next=i})}_computeNextCCWEdges(s,i){const o=s.getOuterEdges();let l,h;for(let f=o.length-1;f>=0;--f){let g=o[f],v=g.symetric,m,_;g.label===i&&(m=g),v.label===i&&(_=v),!(!m||!_)&&(_&&(h=_),m&&(h&&(h.next=m,h=void 0),l||(l=m)))}h&&(h.next=l)}_findLabeledEdgeRings(){const s=[];let i=0;return this.edges.forEach(o=>{if(o.label>=0)return;s.push(o);let l=o;do l.label=i,l=l.next;while(!o.isEqual(l));i++}),s}getEdgeRings(){this._computeNextCWEdges(),this.edges.forEach(i=>{i.label=void 0}),this._findLabeledEdgeRings().forEach(i=>{this._findIntersectionNodes(i).forEach(o=>{this._computeNextCCWEdges(o,i.label)})});const s=[];return this.edges.forEach(i=>{i.ring||s.push(this._findEdgeRing(i))}),s}_findIntersectionNodes(s){const i=[];let o=s;do{let l=0;o.from.getOuterEdges().forEach(h=>{h.label===s.label&&++l}),l>1&&i.push(o.from),o=o.next}while(!s.isEqual(o));return i}_findEdgeRing(s){let i=s;const o=new ko;do o.push(i),i.ring=o,i=i.next;while(!s.isEqual(i));return o}removeNode(s){s.getOuterEdges().forEach(i=>this.removeEdge(i)),s.innerEdges.forEach(i=>this.removeEdge(i)),delete this.nodes[s.id]}removeEdge(s){this.edges=this.edges.filter(i=>!i.isEqual(s)),s.deleteEdge()}};function Kh(r){const s=Jh.fromGeoJson(r);s.deleteDangles(),s.deleteCutEdges();const i=[],o=[];return s.getEdgeRings().filter(l=>l.isValid()).forEach(l=>{l.isHole()?i.push(l):o.push(l)}),i.forEach(l=>{ko.findEdgeRingContaining(l,o)&&o.push(l)}),Y(o.map(l=>l.toPolygon()))}function Qh(r,s){s=s||{},s.iterations=s.iterations||1;const{iterations:i}=s,o=[];if(!r)throw new Error("inputPolys is required");return Ye(r,function(l,h,f){if(l.type==="Polygon"){let g=[[]];for(let v=0;v<i;v++){let m=[],_=l;v>0&&(_=j(g).geometry),jh(_,m),g=m.slice(0)}o.push(j(g,f))}else if(l.type==="MultiPolygon"){let g=[[[]]];for(let v=0;v<i;v++){let m=[],_=l;v>0&&(_=$e(g).geometry),ef(_,m),g=m.slice(0)}o.push($e(g,f))}else throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}),Y(o)}function jh(r,s){var i,o;Pe(r,function(l,h,f,g,v){if(o!==v)s.push([]);else{var m=i[0],_=i[1],x=l[0],P=l[1];s[v].push([.75*m+.25*x,.75*_+.25*P]),s[v].push([.25*m+.75*x,.25*_+.75*P])}i=l,o=v},!1),s.forEach(function(l){l.push(l[0])})}function ef(r,s){let i,o,l;Pe(r,function(h,f,g,v,m){if(o!==v)s.push([[]]);else if(l!==m)s[v].push([]);else{var _=i[0],x=i[1],P=h[0],k=h[1];s[v][m].push([.75*_+.25*P,.75*x+.25*k]),s[v][m].push([.25*_+.75*P,.25*x+.75*k])}i=h,o=v,l=m},!1),s.forEach(function(h){h.forEach(function(f){f.push(f[0])})})}function tf(r,s){const i=J(r),o=J(s);let l=[],h=[],f;const g=_e(s);let v=0,m=null;switch(i[0]>g[0]&&i[0]<g[2]&&i[1]>g[1]&&i[1]<g[3]&&(m=gr(r,fr(s)),v=m.properties.featureIndex),Je(s)){case"Polygon":l=o[0][v],h=o[0][0],m!==null&&m.geometry.coordinates[1]<i[1]&&(h=o[0][v]),f=bn(o[0][0],o[0][o[0].length-1],i),[l,h]=ra(o[0],i,f,l,h);break;case"MultiPolygon":for(var x=0,P=0,k=0,N=0;N<o[0].length;N++){x=N;for(var C=!1,D=0;D<o[0][N].length;D++){if(P=D,k===v){C=!0;break}k++}if(C)break}l=o[0][x][P],h=o[0][x][P],f=bn(o[0][0][0],o[0][0][o[0][0].length-1],i),o.forEach(function(R){[l,h]=ra(R[0],i,f,l,h)});break}return Y([re(l),re(h)])}function ra(r,s,i,o,l){for(let h=0;h<r.length;h++){const f=r[h];let g=r[h+1];h===r.length-1&&(g=r[0]);const v=bn(f,g,s);i<=0&&v>0?rf(s,f,o)||(o=f):i>0&&v<=0&&(nf(s,f,l)||(l=f)),i=v}return[o,l]}function nf(r,s,i){return bn(r,s,i)>0}function rf(r,s,i){return bn(r,s,i)<0}function bn(r,s,i){return(s[0]-r[0])*(i[1]-r[1])-(i[0]-r[0])*(s[1]-r[1])}function Io(r,s={}){return Po(r,"mercator",s)}function No(r,s={}){return Po(r,"wgs84",s)}function Po(r,s,i={}){i=i||{};var o=i.mutate;if(!r)throw new Error("geojson is required");return Array.isArray(r)&&De(r[0])?r=s==="mercator"?ia(r):sa(r):(o!==!0&&(r=Be(r)),Pe(r,function(l){var h=s==="mercator"?ia(l):sa(l);l[0]=h[0],l[1]=h[1]})),r}function ia(r){var s=Math.PI/180,i=6378137,o=20037508342789244e-9,l=Math.abs(r[0])<=180?r[0]:r[0]-sf(r[0])*360,h=[i*l*s,i*Math.log(Math.tan(Math.PI*.25+.5*r[1]*s))];return h[0]>o&&(h[0]=o),h[0]<-o&&(h[0]=-o),h[1]>o&&(h[1]=o),h[1]<-o&&(h[1]=-o),h}function sa(r){var s=180/Math.PI,i=6378137;return[r[0]*s/i,(Math.PI*.5-2*Math.atan(Math.exp(-r[1]/i)))*s]}function sf(r){return r<0?-1:r>0?1:0}const af=Object.freeze(Object.defineProperty({__proto__:null,toMercator:Io,toWgs84:No},Symbol.toStringTag,{value:"Module"}));function of(r,s){s=s||{};const i=s.studyBbox||_e(r),o=s.confidenceLevel||20,l=r.features,h=l.length,f=An(Dn(i)),g=Math.sqrt(f/h*2),m=ki(i,g,{units:"meters"}).features,_={};for(let B=0;B<m.length;B++)_[B]={box:_e(m[B]),cnt:0};let x=0;for(const B of l)for(const W of Object.keys(_)){const Z=_[W].box;if(lf(me(B),Z)){_[W].cnt+=1,x+=1;break}}let P=0;for(const B of Object.keys(_)){const W=_[B].cnt;W>P&&(P=W)}const k=[],N=Object.keys(_).length,C=x/N;let D=0;for(let B=0;B<P+1;B++)D+=Math.exp(-C)*Math.pow(C,B)/cf(B),k.push(D);const R=[];let M=0;for(let B=0;B<P+1;B++){for(const Z of Object.keys(_))_[Z].cnt===B&&(M+=1);const W=M/N;R.push(W)}let b=0;for(let B=0;B<P+1;B++){const W=Math.abs(k[B]-R[B]);W>b&&(b=W)}const O=uf[o]/Math.sqrt(N),fe={criticalValue:O,isRandom:!0,maxAbsoluteDifference:b,observedDistribution:R};return b>O&&(fe.isRandom=!1),fe}var uf={20:1.07275,15:1.13795,10:1.22385,5:1.3581,2:1.51743,1:1.62762};function lf(r,s){return s[0]<=r[0]&&s[1]<=r[1]&&s[2]>=r[0]&&s[3]>=r[1]}function cf(r){const s=[];function i(o){return o===0||o===1?1:s[o]>0?s[o]:s[o]=i(o-1)*o}return i(r)}function Mo(r){return vr(r),dr(r)}function dr(r){return Array.isArray(r)?aa(r):r&&r.bbox?aa(r.bbox):[ff(),gf()]}function vr(r){r!=null&&(Array.isArray(r)?tr(r):r.bbox!=null&&tr(r.bbox))}function Lo(r,s={}){vr(s.bbox),r==null&&(r=1);const i=[];for(let o=0;o<r;o++)i.push(re(dr(s.bbox)));return Y(i)}function bo(r,s={}){vr(s.bbox),r==null&&(r=1),(s.bbox===void 0||s.bbox===null)&&(s.bbox=[-180,-90,180,90]),(!De(s.num_vertices)||s.num_vertices===void 0)&&(s.num_vertices=10),(!De(s.max_radial_length)||s.max_radial_length===void 0)&&(s.max_radial_length=10);const i=Math.abs(s.bbox[0]-s.bbox[2]),o=Math.abs(s.bbox[1]-s.bbox[3]),l=Math.min(i/2,o/2);if(s.max_radial_length>l)throw new Error("max_radial_length is greater than the radius of the bbox");const h=[s.bbox[0]+s.max_radial_length,s.bbox[1]+s.max_radial_length,s.bbox[2]-s.max_radial_length,s.bbox[3]-s.max_radial_length],f=[];for(let g=0;g<r;g++){let v=[];const m=[...Array(s.num_vertices+1)].map(Math.random);m.forEach((_,x,P)=>{P[x]=x>0?_+P[x-1]:_}),m.forEach(_=>{_=_*2*Math.PI/m[m.length-1];const x=Math.random();v.push([x*(s.max_radial_length||10)*Math.sin(_),x*(s.max_radial_length||10)*Math.cos(_)])}),v[v.length-1]=v[0],v=v.map(hf(dr(h))),f.push(j([v]))}return Y(f)}function So(r,s={}){if(s=s||{},!de(s))throw new Error("options is invalid");const i=s.bbox;vr(i);let o=s.num_vertices,l=s.max_length,h=s.max_rotation;r==null&&(r=1),(!De(o)||o===void 0||o<2)&&(o=10),(!De(l)||l===void 0)&&(l=1e-4),(!De(h)||h===void 0)&&(h=Math.PI/8);const f=[];for(let g=0;g<r;g++){const m=[dr(i)];for(let _=0;_<o-1;_++){const P=(_===0?Math.random()*2*Math.PI:Math.tan((m[_][1]-m[_-1][1])/(m[_][0]-m[_-1][0])))+(Math.random()-.5)*h*2,k=Math.random()*l;m.push([m[_][0]+k*Math.cos(P),m[_][1]+k*Math.sin(P)])}f.push(ce(m))}return Y(f)}function hf(r){return s=>[s[0]+r[0],s[1]+r[1]]}function Co(){return Math.random()-.5}function ff(){return Co()*360}function gf(){return Co()*180}function aa(r){return[Math.random()*(r[2]-r[0])+r[0],Math.random()*(r[3]-r[1])+r[1]]}const df=Object.freeze(Object.defineProperty({__proto__:null,randomLineString:So,randomPoint:Lo,randomPolygon:bo,randomPosition:Mo},Symbol.toStringTag,{value:"Module"}));function vf(r,s={}){var i,o;if(s=s||{},!de(s))throw new Error("options is invalid");const l=(i=s.mutate)!=null?i:!1,h=(o=s.reverse)!=null?o:!1;if(!r)throw new Error("<geojson> is required");if(typeof h!="boolean")throw new Error("<reverse> must be a boolean");if(typeof l!="boolean")throw new Error("<mutate> must be a boolean");!l&&r.type!=="Point"&&r.type!=="MultiPoint"&&(r=Be(r));const f=[];switch(r.type){case"GeometryCollection":return Ye(r,function(g){Qn(g,h)}),r;case"FeatureCollection":return he(r,function(g){const v=Qn(g,h);he(v,function(m){f.push(m)})}),Y(f)}return Qn(r,h)}function Qn(r,s){switch(r.type==="Feature"?r.geometry.type:r.type){case"GeometryCollection":return Ye(r,function(o){Qn(o,s)}),r;case"LineString":return oa(J(r),s),r;case"Polygon":return ua(J(r),s),r;case"MultiLineString":return J(r).forEach(function(o){oa(o,s)}),r;case"MultiPolygon":return J(r).forEach(function(o){ua(o,s)}),r;case"Point":case"MultiPoint":return r}}function oa(r,s){nr(r)===s&&r.reverse()}function ua(r,s){nr(r[0])!==s&&r[0].reverse();for(let i=1;i<r.length;i++)nr(r[i])===s&&r[i].reverse()}function yf(r,s){if(!r)throw new Error("fc is required");if(s==null)throw new Error("num is required");if(typeof s!="number")throw new Error("num must be a number");var i=Y(mf(r.features,s));return i}function mf(r,s){for(var i=r.slice(0),o=r.length,l=o-s,h,f;o-- >l;)f=Math.floor((o+1)*Math.random()),h=i[f],i[f]=i[o],i[o]=h;return i.slice(l)}function pf(r,s,i,o,l={}){if(l=l||{},!de(l))throw new Error("options is invalid");const h=l.properties;if(!r)throw new Error("center is required");if(i==null)throw new Error("bearing1 is required");if(o==null)throw new Error("bearing2 is required");if(!s)throw new Error("radius is required");if(typeof l!="object")throw new Error("options must be an object");if(la(i)===la(o))return vi(r,s,l);const f=J(r),g=ho(r,s,i,o,l),v=[[f]];return Pe(g,function(m){v[0].push(m)}),v[0].push(f),j(v,h)}function la(r){let s=r%360;return s<0&&(s+=360),s}function To(r,s,i){if(i=i||{},!de(i))throw new Error("options is invalid");const o=i.origin||"centroid",l=i.mutate||!1;if(!r)throw new Error("geojson required");if(typeof s!="number"||s<=0)throw new Error("invalid factor");const h=Array.isArray(o)||typeof o=="object";return l!==!0&&(r=Be(r)),r.type==="FeatureCollection"&&!h?(he(r,function(f,g){r.features[g]=ca(f,s,o)}),r):ca(r,s,o)}function ca(r,s,i){const o=Je(r)==="Point",l=_f(r,i);return s===1||o||(Pe(r,function(h){const f=hr(l,h),g=Yt(l,h),v=f*s,m=J(an(l,v,g));h[0]=m[0],h[1]=m[1],h.length===3&&(h[2]*=s)}),delete r.bbox),r}function _f(r,s){if(s==null&&(s="centroid"),Array.isArray(s)||typeof s=="object")return me(s);const i=r.bbox?r.bbox:_e(r,{recompute:!0}),o=i[0],l=i[1],h=i[2],f=i[3];switch(s){case"sw":case"southwest":case"westsouth":case"bottomleft":return re([o,l]);case"se":case"southeast":case"eastsouth":case"bottomright":return re([h,l]);case"nw":case"northwest":case"westnorth":case"topleft":return re([o,f]);case"ne":case"northeast":case"eastnorth":case"topright":return re([h,f]);case"center":return ur(r);case void 0:case null:case"centroid":return Nt(r);default:throw new Error("invalid origin")}}function ha(r){for(var s=r,i=[];s.parent;)i.unshift(s),s=s.parent;return i}function xf(){return new Oo(function(r){return r.f})}var yr={search:function(r,s,i,o){var l;r.cleanDirty(),o=o||{};var h=o.heuristic||yr.heuristics.manhattan,f=(l=o.closest)!=null?l:!1,g=xf(),v=s;for(s.h=h(s,i),g.push(s);g.size()>0;){var m=g.pop();if(m===i)return ha(m);m.closed=!0;for(var _=r.neighbors(m),x=0,P=_.length;x<P;++x){var k=_[x];if(!(k.closed||k.isWall())){var N=m.g+k.getCost(m),C=k.visited;(!C||N<k.g)&&(k.visited=!0,k.parent=m,k.h=k.h||h(k,i),k.g=N,k.f=k.g+k.h,r.markDirty(k),f&&(k.h<v.h||k.h===v.h&&k.g<v.g)&&(v=k),C?g.rescoreElement(k):g.push(k))}}}return f?ha(v):[]},heuristics:{manhattan:function(r,s){var i=Math.abs(s.x-r.x),o=Math.abs(s.y-r.y);return i+o},diagonal:function(r,s){var i=1,o=Math.sqrt(2),l=Math.abs(s.x-r.x),h=Math.abs(s.y-r.y);return i*(l+h)+(o-2*i)*Math.min(l,h)}},cleanNode:function(r){r.f=0,r.g=0,r.h=0,r.visited=!1,r.closed=!1,r.parent=null}};function un(r,s){s=s||{},this.nodes=[],this.diagonal=!!s.diagonal,this.grid=[];for(var i=0;i<r.length;i++){this.grid[i]=[];for(var o=0,l=r[i];o<l.length;o++){var h=new mr(i,o,l[o]);this.grid[i][o]=h,this.nodes.push(h)}}this.init()}un.prototype.init=function(){this.dirtyNodes=[];for(var r=0;r<this.nodes.length;r++)yr.cleanNode(this.nodes[r])};un.prototype.cleanDirty=function(){for(var r=0;r<this.dirtyNodes.length;r++)yr.cleanNode(this.dirtyNodes[r]);this.dirtyNodes=[]};un.prototype.markDirty=function(r){this.dirtyNodes.push(r)};un.prototype.neighbors=function(r){var s=[],i=r.x,o=r.y,l=this.grid;return l[i-1]&&l[i-1][o]&&s.push(l[i-1][o]),l[i+1]&&l[i+1][o]&&s.push(l[i+1][o]),l[i]&&l[i][o-1]&&s.push(l[i][o-1]),l[i]&&l[i][o+1]&&s.push(l[i][o+1]),this.diagonal&&(l[i-1]&&l[i-1][o-1]&&s.push(l[i-1][o-1]),l[i+1]&&l[i+1][o-1]&&s.push(l[i+1][o-1]),l[i-1]&&l[i-1][o+1]&&s.push(l[i-1][o+1]),l[i+1]&&l[i+1][o+1]&&s.push(l[i+1][o+1])),s};un.prototype.toString=function(){for(var r=[],s=this.grid,i,o,l,h,f=0,g=s.length;f<g;f++){for(i=[],o=s[f],l=0,h=o.length;l<h;l++)i.push(o[l].weight);r.push(i.join(" "))}return r.join(`
`)};function mr(r,s,i){this.x=r,this.y=s,this.weight=i}mr.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};mr.prototype.getCost=function(r){return r&&r.x!==this.x&&r.y!==this.y?this.weight*1.41421:this.weight};mr.prototype.isWall=function(){return this.weight===0};function Oo(r){this.content=[],this.scoreFunction=r}Oo.prototype={push:function(r){this.content.push(r),this.sinkDown(this.content.length-1)},pop:function(){var r=this.content[0],s=this.content.pop();return this.content.length>0&&(this.content[0]=s,this.bubbleUp(0)),r},remove:function(r){var s=this.content.indexOf(r),i=this.content.pop();s!==this.content.length-1&&(this.content[s]=i,this.scoreFunction(i)<this.scoreFunction(r)?this.sinkDown(s):this.bubbleUp(s))},size:function(){return this.content.length},rescoreElement:function(r){this.sinkDown(this.content.indexOf(r))},sinkDown:function(r){for(var s=this.content[r];r>0;){var i=(r+1>>1)-1,o=this.content[i];if(this.scoreFunction(s)<this.scoreFunction(o))this.content[i]=s,this.content[r]=o,r=i;else break}},bubbleUp:function(r){for(var s=this.content.length,i=this.content[r],o=this.scoreFunction(i);;){var l=r+1<<1,h=l-1,f=null,g;if(h<s){var v=this.content[h];g=this.scoreFunction(v),g<o&&(f=h)}if(l<s){var m=this.content[l],_=this.scoreFunction(m);_<(f===null?o:g)&&(f=l)}if(f!==null)this.content[r]=this.content[f],this.content[f]=i,r=f;else break}}};function Ef(r,s,i={}){if(i=i||{},!de(i))throw new Error("options is invalid");let o=i.obstacles||Y([]),l=i.resolution||100;if(!r)throw new Error("start is required");if(!s)throw new Error("end is required");if(l&&(!De(l)||l<=0))throw new Error("options.resolution must be a number, greater than 0");const h=me(r),f=me(s);if(r=re(h),s=re(f),o.type==="FeatureCollection"){if(o.features.length===0)return ce([h,f])}else if(o.type==="Polygon")o=Y([Oe(we(o))]);else throw new Error("invalid obstacles");const g=o;g.features.push(r),g.features.push(s);const v=_e(To(Dn(_e(g)),1.15)),[m,_,x,P]=v,N=ye([m,_],[x,_],i)/l;g.features.pop(),g.features.pop();const D=N/ye([m,_],[x,_],i)*(x-m),M=N/ye([m,_],[m,P],i)*(P-_),b=x-m,A=P-_,O=Math.floor(b/D),fe=Math.floor(A/M),B=(b-O*D)/2,W=(A-fe*M)/2,Z=[],ae=[];let ie,ve,Ie=1/0,Me=1/0,Ne=P-W,ue=0;for(;Ne>=_;){const qe=[],xe=[];let U=m+B,Re=0;for(;U<=x;){const Ze=re([U,Ne]),Ve=kf(Ze,o);qe.push(Ve?0:1),xe.push(U+"|"+Ne);const S=ye(Ze,r);!Ve&&S<Ie&&(Ie=S,ie={x:Re,y:ue});const Vt=ye(Ze,s);!Ve&&Vt<Me&&(Me=Vt,ve={x:Re,y:ue}),U+=D,Re++}ae.push(qe),Z.push(xe),Ne-=M,ue++}const Fe=new un(ae,{diagonal:!0}),Le=Fe.grid[ie.y][ie.x],le=Fe.grid[ve.y][ve.x],X=yr.search(Fe,Le,le),tt=[h];return X.forEach(function(qe){const xe=Z[qe.x][qe.y].split("|");tt.push([+xe[0],+xe[1]])}),tt.push(f),Xt(ce(tt))}function kf(r,s){for(let i=0;i<s.features.length;i++)if(ne(r,s.features[i]))return!0;return!1}function wf(r,s){var i=r[0]-s[0],o=r[1]-s[1];return i*i+o*o}function If(r,s,i){var o=s[0],l=s[1],h=i[0]-o,f=i[1]-l;if(h!==0||f!==0){var g=((r[0]-o)*h+(r[1]-l)*f)/(h*h+f*f);g>1?(o=i[0],l=i[1]):g>0&&(o+=h*g,l+=f*g)}return h=r[0]-o,f=r[1]-l,h*h+f*f}function Nf(r,s){for(var i=r[0],o=[i],l,h=1,f=r.length;h<f;h++)l=r[h],wf(l,i)>s&&(o.push(l),i=l);return i!==l&&o.push(l),o}function Qr(r,s,i,o,l){for(var h=o,f,g=s+1;g<i;g++){var v=If(r[g],r[s],r[i]);v>h&&(f=g,h=v)}h>o&&(f-s>1&&Qr(r,s,f,o,l),l.push(r[f]),i-f>1&&Qr(r,f,i,o,l))}function Pf(r,s){var i=r.length-1,o=[r[0]];return Qr(r,0,i,s,o),o.push(r[i]),o}function ir(r,s,i){if(r.length<=2)return r;var o=s!==void 0?s*s:1;return r=i?r:Nf(r,o),r=Pf(r,o),r}function Mf(r,s={}){var i,o,l;if(s=s??{},!de(s))throw new Error("options is invalid");const h=(i=s.tolerance)!=null?i:1,f=(o=s.highQuality)!=null?o:!1,g=(l=s.mutate)!=null?l:!1;if(!r)throw new Error("geojson is required");if(h&&h<0)throw new Error("invalid tolerance");return g!==!0&&(r=Be(r)),Ye(r,function(v){Lf(v,h,f)}),r}function Lf(r,s,i){const o=r.type;if(o==="Point"||o==="MultiPoint")return r;if(Xt(r,{mutate:!0}),o!=="GeometryCollection")switch(o){case"LineString":r.coordinates=ir(r.coordinates,s,i);break;case"MultiLineString":r.coordinates=r.coordinates.map(l=>ir(l,s,i));break;case"Polygon":r.coordinates=fa(r.coordinates,s,i);break;case"MultiPolygon":r.coordinates=r.coordinates.map(l=>fa(l,s,i))}return r}function fa(r,s,i){return r.map(function(o){if(o.length<4)throw new Error("invalid polygon");let l=s,h=ir(o,l,i);for(;!bf(h);)l-=l*.01,h=ir(o,l,i);return(h[h.length-1][0]!==h[0][0]||h[h.length-1][1]!==h[0][1])&&h.push(h[0]),h})}function bf(r){return r.length<3?!1:!(r.length===3&&r[2][0]===r[0][0]&&r[2][1]===r[0][1])}function Sf(r,s){var i;if(s=s||{},!de(s))throw new Error("options is invalid");const o=s.steps||64,l=s.weight,h=s.properties||{};if(!De(o))throw new Error("steps must be a number");if(!de(h))throw new Error("properties must be a number");const f=In(r).length,g=di(r,{weight:l});let v=0,m=0,_=0;he(r,function(W){var Z;const ae=l&&((Z=W.properties)==null?void 0:Z[l])||1,ie=ga(J(W),J(g));v+=Math.pow(ie.x,2)*ae,m+=Math.pow(ie.y,2)*ae,_+=ie.x*ie.y*ae});const x=v-m,P=Math.sqrt(Math.pow(x,2)+4*Math.pow(_,2)),k=2*_,N=Math.atan((x+P)/k),C=N*180/Math.PI;let D=0,R=0,M=0;he(r,function(W){var Z;const ae=l&&((Z=W.properties)==null?void 0:Z[l])||1,ie=ga(J(W),J(g));D+=Math.pow(ie.x*Math.cos(N)-ie.y*Math.sin(N),2)*ae,R+=Math.pow(ie.x*Math.sin(N)+ie.y*Math.cos(N),2)*ae,M+=ae});const b=Math.sqrt(2*D/M),A=Math.sqrt(2*R/M),O=ro(g,b,A,{units:"degrees",angle:C,steps:o,properties:h}),fe=_o(r,Y([O])),B={meanCenterCoordinates:J(g),semiMajorAxis:b,semiMinorAxis:A,numberOfFeatures:f,angle:C,percentageWithinEllipse:100*In(fe).length/f};return O.properties=(i=O.properties)!=null?i:{},O.properties.standardDeviationalEllipse=B,O}function ga(r,s){return{x:r[0]-s[0],y:r[1]-s[1]}}function Cf(r,s,i,o){return r=Be(r),s=Be(s),he(r,function(l){l.properties||(l.properties={}),he(s,function(h){l.properties&&h.properties&&l.properties[o]===void 0&&ne(l,h)&&(l.properties[o]=h.properties[i])})}),r}var Ii={exports:{}};Ii.exports=pr;Ii.exports.default=pr;function pr(r,s,i){i=i||2;var o=s&&s.length,l=o?s[0]*i:r.length,h=Ro(r,0,l,i,!0),f=[];if(!h||h.next===h.prev)return f;var g,v,m,_,x,P,k;if(o&&(h=Df(r,s,h,i)),r.length>80*i){g=m=r[0],v=_=r[1];for(var N=i;N<l;N+=i)x=r[N],P=r[N+1],x<g&&(g=x),P<v&&(v=P),x>m&&(m=x),P>_&&(_=P);k=Math.max(m-g,_-v),k=k!==0?32767/k:0}return Sn(h,f,i,g,v,k,0),f}function Ro(r,s,i,o,l){var h,f;if(l===ti(r,s,i,o)>0)for(h=s;h<i;h+=o)f=da(h,r[h],r[h+1],f);else for(h=i-o;h>=s;h-=o)f=da(h,r[h],r[h+1],f);return f&&_r(f,f.next)&&(Tn(f),f=f.next),f}function Ut(r,s){if(!r)return r;s||(s=r);var i=r,o;do if(o=!1,!i.steiner&&(_r(i,i.next)||Ce(i.prev,i,i.next)===0)){if(Tn(i),i=s=i.prev,i===i.next)break;o=!0}else i=i.next;while(o||i!==s);return s}function Sn(r,s,i,o,l,h,f){if(r){!f&&h&&Bf(r,o,l,h);for(var g=r,v,m;r.prev!==r.next;){if(v=r.prev,m=r.next,h?Of(r,o,l,h):Tf(r)){s.push(v.i/i|0),s.push(r.i/i|0),s.push(m.i/i|0),Tn(r),r=m.next,g=m.next;continue}if(r=m,r===g){f?f===1?(r=Rf(Ut(r),s,i),Sn(r,s,i,o,l,h,2)):f===2&&Af(r,s,i,o,l,h):Sn(Ut(r),s,i,o,l,h,1);break}}}}function Tf(r){var s=r.prev,i=r,o=r.next;if(Ce(s,i,o)>=0)return!1;for(var l=s.x,h=i.x,f=o.x,g=s.y,v=i.y,m=o.y,_=l<h?l<f?l:f:h<f?h:f,x=g<v?g<m?g:m:v<m?v:m,P=l>h?l>f?l:f:h>f?h:f,k=g>v?g>m?g:m:v>m?v:m,N=o.next;N!==s;){if(N.x>=_&&N.x<=P&&N.y>=x&&N.y<=k&&nn(l,g,h,v,f,m,N.x,N.y)&&Ce(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function Of(r,s,i,o){var l=r.prev,h=r,f=r.next;if(Ce(l,h,f)>=0)return!1;for(var g=l.x,v=h.x,m=f.x,_=l.y,x=h.y,P=f.y,k=g<v?g<m?g:m:v<m?v:m,N=_<x?_<P?_:P:x<P?x:P,C=g>v?g>m?g:m:v>m?v:m,D=_>x?_>P?_:P:x>P?x:P,R=jr(k,N,s,i,o),M=jr(C,D,s,i,o),b=r.prevZ,A=r.nextZ;b&&b.z>=R&&A&&A.z<=M;){if(b.x>=k&&b.x<=C&&b.y>=N&&b.y<=D&&b!==l&&b!==f&&nn(g,_,v,x,m,P,b.x,b.y)&&Ce(b.prev,b,b.next)>=0||(b=b.prevZ,A.x>=k&&A.x<=C&&A.y>=N&&A.y<=D&&A!==l&&A!==f&&nn(g,_,v,x,m,P,A.x,A.y)&&Ce(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;b&&b.z>=R;){if(b.x>=k&&b.x<=C&&b.y>=N&&b.y<=D&&b!==l&&b!==f&&nn(g,_,v,x,m,P,b.x,b.y)&&Ce(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;A&&A.z<=M;){if(A.x>=k&&A.x<=C&&A.y>=N&&A.y<=D&&A!==l&&A!==f&&nn(g,_,v,x,m,P,A.x,A.y)&&Ce(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function Rf(r,s,i){var o=r;do{var l=o.prev,h=o.next.next;!_r(l,h)&&Ao(l,o,o.next,h)&&Cn(l,h)&&Cn(h,l)&&(s.push(l.i/i|0),s.push(o.i/i|0),s.push(h.i/i|0),Tn(o),Tn(o.next),o=r=h),o=o.next}while(o!==r);return Ut(o)}function Af(r,s,i,o,l,h){var f=r;do{for(var g=f.next.next;g!==f.prev;){if(f.i!==g.i&&Uf(f,g)){var v=Do(f,g);f=Ut(f,f.next),v=Ut(v,v.next),Sn(f,s,i,o,l,h,0),Sn(v,s,i,o,l,h,0);return}g=g.next}f=f.next}while(f!==r)}function Df(r,s,i,o){var l=[],h,f,g,v,m;for(h=0,f=s.length;h<f;h++)g=s[h]*o,v=h<f-1?s[h+1]*o:r.length,m=Ro(r,g,v,o,!1),m===m.next&&(m.steiner=!0),l.push(Xf(m));for(l.sort(Ff),h=0;h<l.length;h++)i=qf(l[h],i);return i}function Ff(r,s){return r.x-s.x}function qf(r,s){var i=Gf(r,s);if(!i)return s;var o=Do(i,r);return Ut(o,o.next),Ut(i,i.next)}function Gf(r,s){var i=s,o=r.x,l=r.y,h=-1/0,f;do{if(l<=i.y&&l>=i.next.y&&i.next.y!==i.y){var g=i.x+(l-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(g<=o&&g>h&&(h=g,f=i.x<i.next.x?i:i.next,g===o))return f}i=i.next}while(i!==s);if(!f)return null;var v=f,m=f.x,_=f.y,x=1/0,P;i=f;do o>=i.x&&i.x>=m&&o!==i.x&&nn(l<_?o:h,l,m,_,l<_?h:o,l,i.x,i.y)&&(P=Math.abs(l-i.y)/(o-i.x),Cn(i,r)&&(P<x||P===x&&(i.x>f.x||i.x===f.x&&zf(f,i)))&&(f=i,x=P)),i=i.next;while(i!==v);return f}function zf(r,s){return Ce(r.prev,r,s.prev)<0&&Ce(s.next,r,r.next)<0}function Bf(r,s,i,o){var l=r;do l.z===0&&(l.z=jr(l.x,l.y,s,i,o)),l.prevZ=l.prev,l.nextZ=l.next,l=l.next;while(l!==r);l.prevZ.nextZ=null,l.prevZ=null,Yf(l)}function Yf(r){var s,i,o,l,h,f,g,v,m=1;do{for(i=r,r=null,h=null,f=0;i;){for(f++,o=i,g=0,s=0;s<m&&(g++,o=o.nextZ,!!o);s++);for(v=m;g>0||v>0&&o;)g!==0&&(v===0||!o||i.z<=o.z)?(l=i,i=i.nextZ,g--):(l=o,o=o.nextZ,v--),h?h.nextZ=l:r=l,l.prevZ=h,h=l;i=o}h.nextZ=null,m*=2}while(f>1);return r}function jr(r,s,i,o,l){return r=(r-i)*l|0,s=(s-o)*l|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,r|s<<1}function Xf(r){var s=r,i=r;do(s.x<i.x||s.x===i.x&&s.y<i.y)&&(i=s),s=s.next;while(s!==r);return i}function nn(r,s,i,o,l,h,f,g){return(l-f)*(s-g)>=(r-f)*(h-g)&&(r-f)*(o-g)>=(i-f)*(s-g)&&(i-f)*(h-g)>=(l-f)*(o-g)}function Uf(r,s){return r.next.i!==s.i&&r.prev.i!==s.i&&!Vf(r,s)&&(Cn(r,s)&&Cn(s,r)&&Hf(r,s)&&(Ce(r.prev,r,s.prev)||Ce(r,s.prev,s))||_r(r,s)&&Ce(r.prev,r,r.next)>0&&Ce(s.prev,s,s.next)>0)}function Ce(r,s,i){return(s.y-r.y)*(i.x-s.x)-(s.x-r.x)*(i.y-s.y)}function _r(r,s){return r.x===s.x&&r.y===s.y}function Ao(r,s,i,o){var l=Jn(Ce(r,s,i)),h=Jn(Ce(r,s,o)),f=Jn(Ce(i,o,r)),g=Jn(Ce(i,o,s));return!!(l!==h&&f!==g||l===0&&$n(r,i,s)||h===0&&$n(r,o,s)||f===0&&$n(i,r,o)||g===0&&$n(i,s,o))}function $n(r,s,i){return s.x<=Math.max(r.x,i.x)&&s.x>=Math.min(r.x,i.x)&&s.y<=Math.max(r.y,i.y)&&s.y>=Math.min(r.y,i.y)}function Jn(r){return r>0?1:r<0?-1:0}function Vf(r,s){var i=r;do{if(i.i!==r.i&&i.next.i!==r.i&&i.i!==s.i&&i.next.i!==s.i&&Ao(i,i.next,r,s))return!0;i=i.next}while(i!==r);return!1}function Cn(r,s){return Ce(r.prev,r,r.next)<0?Ce(r,s,r.next)>=0&&Ce(r,r.prev,s)>=0:Ce(r,s,r.prev)<0||Ce(r,r.next,s)<0}function Hf(r,s){var i=r,o=!1,l=(r.x+s.x)/2,h=(r.y+s.y)/2;do i.y>h!=i.next.y>h&&i.next.y!==i.y&&l<(i.next.x-i.x)*(h-i.y)/(i.next.y-i.y)+i.x&&(o=!o),i=i.next;while(i!==r);return o}function Do(r,s){var i=new ei(r.i,r.x,r.y),o=new ei(s.i,s.x,s.y),l=r.next,h=s.prev;return r.next=s,s.prev=r,i.next=l,l.prev=i,o.next=i,i.prev=o,h.next=o,o.prev=h,o}function da(r,s,i,o){var l=new ei(r,s,i);return o?(l.next=o.next,l.prev=o,o.next.prev=l,o.next=l):(l.prev=l,l.next=l),l}function Tn(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function ei(r,s,i){this.i=r,this.x=s,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}pr.deviation=function(r,s,i,o){var l=s&&s.length,h=l?s[0]*i:r.length,f=Math.abs(ti(r,0,h,i));if(l)for(var g=0,v=s.length;g<v;g++){var m=s[g]*i,_=g<v-1?s[g+1]*i:r.length;f-=Math.abs(ti(r,m,_,i))}var x=0;for(g=0;g<o.length;g+=3){var P=o[g]*i,k=o[g+1]*i,N=o[g+2]*i;x+=Math.abs((r[P]-r[N])*(r[k+1]-r[P+1])-(r[P]-r[k])*(r[N+1]-r[P+1]))}return f===0&&x===0?0:Math.abs((x-f)/f)};function ti(r,s,i,o){for(var l=0,h=s,f=i-o;h<i;h+=o)l+=(r[f]-r[h])*(r[h+1]+r[f+1]),f=h;return l}pr.flatten=function(r){for(var s=r[0][0].length,i={vertices:[],holes:[],dimensions:s},o=0,l=0;l<r.length;l++){for(var h=0;h<r[l].length;h++)for(var f=0;f<s;f++)i.vertices.push(r[l][h][f]);l>0&&(o+=r[l-1].length,i.holes.push(o))}return i};var Zf=Ii.exports;const Wf=_a(Zf);function $f(r){if(!r.geometry||r.geometry.type!=="Polygon"&&r.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");const s={type:"FeatureCollection",features:[]};return r.geometry.type==="Polygon"?s.features=va(r.geometry.coordinates):r.geometry.coordinates.forEach(function(i){s.features=s.features.concat(va(i))}),s}function va(r){const s=Jf(r),i=2,o=Wf(s.vertices,s.holes,i),l=[],h=[];o.forEach(function(g,v){const m=o[v];h.push([s.vertices[m*i],s.vertices[m*i+1]])});for(var f=0;f<h.length;f+=3){const g=h.slice(f,f+3);g.push(h[f]),l.push(j([g]))}return l}function Jf(r){const s=r[0][0].length,i={vertices:[],holes:[],dimensions:s};let o=0;for(let l=0;l<r.length;l++){for(let h=0;h<r[l].length;h++)for(let f=0;f<s;f++)i.vertices.push(r[l][h][f]);l>0&&(o+=r[l-1].length,i.holes.push(o))}return i}function Kf(r,s,i,o){if(o=o||{},!de(o))throw new Error("options is invalid");var l=o.units,h=o.zTranslation,f=o.mutate;if(!r)throw new Error("geojson is required");if(s==null||isNaN(s))throw new Error("distance is required");if(h&&typeof h!="number"&&isNaN(h))throw new Error("zTranslation is not a number");if(h=h!==void 0?h:0,s===0&&h===0)return r;if(i==null||isNaN(i))throw new Error("direction is required");return s<0&&(s=-s,i=i+180),(f===!1||f===void 0)&&(r=Be(r)),Pe(r,function(g){var v=J(an(g,s,i,{units:l}));g[0]=v[0],g[1]=v[1],h&&g.length===3&&(g[2]+=h)}),r}function Qf(r,s={}){const i=[];if(Ye(r,l=>{i.push(l.coordinates)}),i.length<2)throw new Error("Must have at least 2 geometries");const o=mt.union(i[0],...i.slice(1));return o.length===0?null:o.length===1?j(o[0],s.properties):$e(o,s.properties)}function jf(r,s,i){if(r.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");i===void 0&&(i=1);var o=r.geometry.coordinates,l=[],h={};if(i){for(var f=[],g=0;g<o.length;g++)for(var v=0;v<o[g].length-1;v++)f.push(D(g,v));var m=new We;m.load(f)}for(var _=0;_<o.length;_++)for(var x=0;x<o[_].length-1;x++)if(i){var P=m.search(D(_,x));P.forEach(function(R){var M=R.ring,b=R.edge;C(_,x,M,b)})}else for(var k=0;k<o.length;k++)for(var N=0;N<o[k].length-1;N++)C(_,x,k,N);return s||(l={type:"Feature",geometry:{type:"MultiPoint",coordinates:l}}),l;function C(R,M,b,A){var O=o[R][M],fe=o[R][M+1],B=o[b][A],W=o[b][A+1],Z=eg(O,fe,B,W);if(Z!==null){var ae,ie;if(fe[0]!==O[0]?ae=(Z[0]-O[0])/(fe[0]-O[0]):ae=(Z[1]-O[1])/(fe[1]-O[1]),W[0]!==B[0]?ie=(Z[0]-B[0])/(W[0]-B[0]):ie=(Z[1]-B[1])/(W[1]-B[1]),!(ae>=1||ae<=0||ie>=1||ie<=0)){var ve=Z,Ie=!h[ve];Ie&&(h[ve]=!0),s?l.push(s(Z,R,M,O,fe,ae,b,A,B,W,ie,Ie)):l.push(Z)}}}function D(R,M){var b=o[R][M],A=o[R][M+1],O,fe,B,W;return b[0]<A[0]?(O=b[0],fe=A[0]):(O=A[0],fe=b[0]),b[1]<A[1]?(B=b[1],W=A[1]):(B=A[1],W=b[1]),{minX:O,minY:B,maxX:fe,maxY:W,ring:R,edge:M}}}function eg(r,s,i,o){if(En(r,i)||En(r,o)||En(s,i)||En(o,i))return null;var l=r[0],h=r[1],f=s[0],g=s[1],v=i[0],m=i[1],_=o[0],x=o[1],P=(l-f)*(m-x)-(h-g)*(v-_);if(P===0)return null;var k=((l*g-h*f)*(v-_)-(l-f)*(v*x-m*_))/P,N=((l*g-h*f)*(m-x)-(h-g)*(v*x-m*_))/P;return[k,N]}function En(r,s){if(!r||!s||r.length!==s.length)return!1;for(var i=0,o=r.length;i<o;i++)if(r[i]instanceof Array&&s[i]instanceof Array){if(!En(r[i],s[i]))return!1}else if(r[i]!==s[i])return!1;return!0}function tg(r){if(r.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(r.geometry===void 0||r.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(r.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var s=r.geometry.coordinates.length,i=[],M=0;M<s;M++){var o=r.geometry.coordinates[M];kn(o[0],o[o.length-1])||o.push(o[0]);for(var l=0;l<o.length-1;l++)i.push(o[l])}if(!rg(i))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var h=i.length,f=jf(r,function(U,Re,Ze,Ve,S,Vt,ke,V,w,nt,Ht,ft){return[U,Re,Ze,Ve,S,Vt,ke,V,w,nt,Ht,ft]}),g=f.length;if(g==0){for(var B=[],M=0;M<s;M++)B.push(j([r.geometry.coordinates[M]],{parent:-1,winding:ng(r.geometry.coordinates[M])}));var le=Y(B);return X(),tt(),le}for(var v=[],m=[],M=0;M<s;M++){v.push([]);for(var l=0;l<r.geometry.coordinates[M].length-1;l++)v[M].push([new ya(r.geometry.coordinates[M][rn(l+1,r.geometry.coordinates[M].length-1)],1,[M,l],[M,rn(l+1,r.geometry.coordinates[M].length-1)],void 0)]),m.push(new ma(r.geometry.coordinates[M][l],[M,rn(l-1,r.geometry.coordinates[M].length-1)],[M,l],void 0,void 0,!1,!0))}for(var M=0;M<g;M++)v[f[M][1]][f[M][2]].push(new ya(f[M][0],f[M][5],[f[M][1],f[M][2]],[f[M][6],f[M][7]],void 0)),f[M][11]&&m.push(new ma(f[M][0],[f[M][1],f[M][2]],[f[M][6],f[M][7]],void 0,void 0,!0,!0));for(var _=m.length,M=0;M<v.length;M++)for(var l=0;l<v[M].length;l++)v[M][l].sort(function(Re,Ze){return Re.param<Ze.param?-1:1});for(var x=[],M=0;M<_;M++)x.push({minX:m[M].coord[0],minY:m[M].coord[1],maxX:m[M].coord[0],maxY:m[M].coord[1],index:M});var P=new We;P.load(x);for(var M=0;M<v.length;M++)for(var l=0;l<v[M].length;l++)for(var k=0;k<v[M][l].length;k++){var N;k==v[M][l].length-1?N=v[M][rn(l+1,r.geometry.coordinates[M].length-1)][0].coord:N=v[M][l][k+1].coord;var C=P.search({minX:N[0],minY:N[1],maxX:N[0],maxY:N[1]})[0];v[M][l][k].nxtIsectAlongEdgeIn=C.index}for(var M=0;M<v.length;M++)for(var l=0;l<v[M].length;l++)for(var k=0;k<v[M][l].length;k++){var N=v[M][l][k].coord,C=P.search({minX:N[0],minY:N[1],maxX:N[0],maxY:N[1]})[0],D=C.index;D<h?m[D].nxtIsectAlongRingAndEdge2=v[M][l][k].nxtIsectAlongEdgeIn:kn(m[D].ringAndEdge1,v[M][l][k].ringAndEdgeIn)?m[D].nxtIsectAlongRingAndEdge1=v[M][l][k].nxtIsectAlongEdgeIn:m[D].nxtIsectAlongRingAndEdge2=v[M][l][k].nxtIsectAlongEdgeIn}for(var R=[],M=0,l=0;l<s;l++){for(var b=M,k=0;k<r.geometry.coordinates[l].length-1;k++)m[M].coord[0]<m[b].coord[0]&&(b=M),M++;for(var A=m[b].nxtIsectAlongRingAndEdge2,k=0;k<m.length;k++)if(m[k].nxtIsectAlongRingAndEdge1==b||m[k].nxtIsectAlongRingAndEdge2==b){var O=k;break}var fe=jn([m[O].coord,m[b].coord,m[A].coord],!0)?1:-1;R.push({isect:b,parent:-1,winding:fe})}R.sort(function(xe,U){return m[xe.isect].coord>m[U.isect].coord?-1:1});for(var B=[];R.length>0;){var W=R.pop(),Z=W.isect,ae=W.parent,ie=W.winding,ve=B.length,Ie=[m[Z].coord],Me=Z;if(m[Z].ringAndEdge1Walkable)var Ne=m[Z].ringAndEdge1,ue=m[Z].nxtIsectAlongRingAndEdge1;else var Ne=m[Z].ringAndEdge2,ue=m[Z].nxtIsectAlongRingAndEdge2;for(;!kn(m[Z].coord,m[ue].coord);){Ie.push(m[ue].coord);for(var Fe=void 0,M=0;M<R.length;M++)if(R[M].isect==ue){Fe=M;break}if(Fe!=null&&R.splice(Fe,1),kn(Ne,m[ue].ringAndEdge1)){if(Ne=m[ue].ringAndEdge2,m[ue].ringAndEdge2Walkable=!1,m[ue].ringAndEdge1Walkable){var Le={isect:ue};jn([m[Me].coord,m[ue].coord,m[m[ue].nxtIsectAlongRingAndEdge2].coord],ie==1)?(Le.parent=ae,Le.winding=-ie):(Le.parent=ve,Le.winding=ie),R.push(Le)}Me=ue,ue=m[ue].nxtIsectAlongRingAndEdge2}else{if(Ne=m[ue].ringAndEdge1,m[ue].ringAndEdge1Walkable=!1,m[ue].ringAndEdge2Walkable){var Le={isect:ue};jn([m[Me].coord,m[ue].coord,m[m[ue].nxtIsectAlongRingAndEdge1].coord],ie==1)?(Le.parent=ae,Le.winding=-ie):(Le.parent=ve,Le.winding=ie),R.push(Le)}Me=ue,ue=m[ue].nxtIsectAlongRingAndEdge1}}Ie.push(m[ue].coord),B.push(j([Ie],{index:ve,parent:ae,winding:ie,netWinding:void 0}))}var le=Y(B);X(),tt();function X(){for(var xe=[],U=0;U<le.features.length;U++)le.features[U].properties.parent==-1&&xe.push(U);if(xe.length>1)for(var U=0;U<xe.length;U++){for(var Re=-1,Ze=1/0,Ve=0;Ve<le.features.length;Ve++)xe[U]!=Ve&&ne(le.features[xe[U]].geometry.coordinates[0][0],le.features[Ve],{ignoreBoundary:!0})&&An(le.features[Ve])<Ze&&(Re=Ve);le.features[xe[U]].properties.parent=Re}}function tt(){for(var xe=0;xe<le.features.length;xe++)if(le.features[xe].properties.parent==-1){var U=le.features[xe].properties.winding;le.features[xe].properties.netWinding=U,qe(xe,U)}}function qe(xe,U){for(var Re=0;Re<le.features.length;Re++)if(le.features[Re].properties.parent==xe){var Ze=U+le.features[Re].properties.winding;le.features[Re].properties.netWinding=Ze,qe(Re,Ze)}}return le}var ya=function(r,s,i,o,l){this.coord=r,this.param=s,this.ringAndEdgeIn=i,this.ringAndEdgeOut=o,this.nxtIsectAlongEdgeIn=l},ma=function(r,s,i,o,l,h,f){this.coord=r,this.ringAndEdge1=s,this.ringAndEdge2=i,this.nxtIsectAlongRingAndEdge1=o,this.nxtIsectAlongRingAndEdge2=l,this.ringAndEdge1Walkable=h,this.ringAndEdge2Walkable=f};function jn(r,s){if(typeof s>"u"&&(s=!0),r.length!=3)throw new Error("This function requires an array of three points [x,y]");var i=(r[1][0]-r[0][0])*(r[2][1]-r[0][1])-(r[1][1]-r[0][1])*(r[2][0]-r[0][0]);return i>=0==s}function ng(r){for(var s=0,i=0;i<r.length-1;i++)r[i][0]<r[s][0]&&(s=i);if(jn([r[rn(s-1,r.length-1)],r[s],r[rn(s+1,r.length-1)]],!0))var o=1;else var o=-1;return o}function kn(r,s){if(!r||!s||r.length!=s.length)return!1;for(var i=0,o=r.length;i<o;i++)if(r[i]instanceof Array&&s[i]instanceof Array){if(!kn(r[i],s[i]))return!1}else if(r[i]!=s[i])return!1;return!0}function rn(r,s){return(r%s+s)%s}function rg(r){for(var s={},i=1,o=0,l=r.length;o<l;++o){if(Object.prototype.hasOwnProperty.call(s,r[o])){i=0;break}s[r[o]]=1}return i}function ig(r){var s=[];return ze(r,function(i){i.geometry.type==="Polygon"&&he(tg(i),function(o){s.push(j(o.geometry.coordinates,i.properties))})}),Y(s)}function sg(r){return r=r.slice(),r.push(r[0]),j([r])}function ag(r,s){if(s=s||{},!de(s))throw new Error("options is invalid");const i=s.bbox||[-180,-85,180,85];if(!r)throw new Error("points is required");if(!Array.isArray(i))throw new Error("bbox is invalid");return Pt(r,"Point","points"),Y(Qu().x(o=>o.geometry.coordinates[0]).y(o=>o.geometry.coordinates[1]).extent([[i[0],i[1]],[i[2],i[3]]]).polygons(r.features).map(function(o,l){return Object.assign(sg(o),{properties:lr(r.features[l].properties)})}))}const kg=Object.freeze(Object.defineProperty({__proto__:null,along:rl,angle:il,applyFilter:cr,area:An,areaFactors:er,azimuthToBearing:Na,bbox:_e,bboxClip:cl,bboxPolygon:Dn,bearing:wt,bearingToAzimuth:sn,bezierSpline:dl,booleanClockwise:nr,booleanConcave:vl,booleanContains:pl,booleanCrosses:Aa,booleanDisjoint:gi,booleanEqual:Dl,booleanIntersects:Fa,booleanOverlap:Vl,booleanParallel:Hl,booleanPointInPolygon:ne,booleanPointOnLine:se,booleanTouches:Wl,booleanValid:$l,booleanWithin:Ga,buffer:cc,center:ur,centerMean:di,centerMedian:fc,centerOfMass:Wa,centroid:Nt,circle:vi,cleanCoords:Xt,clone:Be,cloneProperties:lr,clusterEach:mi,clusterReduce:Qa,clusters:dc,clustersDbscan:yc,clustersKmeans:mc,collect:_c,collectionOf:Pt,combine:xc,concave:bc,containsNumber:ii,convertArea:ri,convertLength:Bt,convex:Za,coordAll:In,coordEach:Pe,coordReduce:si,createBins:pi,degreesToRadians:Te,destination:It,difference:Cc,dissolve:Tc,distance:ye,distanceWeight:to,earthRadius:Ae,ellipse:ro,envelope:io,explode:fr,factors:sr,feature:Oe,featureCollection:Y,featureEach:he,featureOf:wn,featureReduce:oi,filterProperties:ja,findPoint:Ca,findSegment:Sa,flatten:Wr,flattenEach:ze,flattenReduce:ba,flip:Dc,geojsonRbush:or,geojsonType:Ma,geomEach:Ye,geomReduce:ui,geometry:xa,geometryCollection:ni,getCluster:Ka,getCoord:me,getCoords:J,getGeom:we,getType:Je,greatCircle:Fc,helpers:el,hexGrid:ao,interpolate:zc,intersect:Ln,invariant:tl,isNumber:De,isObject:de,isobands:Hc,isolines:ih,kinks:oh,length:co,lengthToDegrees:ar,lengthToRadians:on,lineArc:ho,lineChunk:lh,lineEach:ci,lineIntersect:ht,lineOffset:mh,lineOverlap:qa,lineReduce:hi,lineSegment:Pn,lineSlice:_h,lineSliceAlong:fo,lineSplit:Eh,lineString:ce,lineStrings:wa,lineToPolygon:kh,mask:Ih,meta:sl,midpoint:Mh,moranIndex:Lh,multiLineString:bt,multiPoint:On,multiPolygon:$e,nearestNeighborAnalysis:Ah,nearestPoint:gr,nearestPointOnLine:Lt,nearestPointToLine:zh,planepoint:Yh,point:re,pointGrid:oo,pointOnFeature:Xh,pointToLineDistance:po,points:Ea,pointsWithinPolygon:_o,polygon:j,polygonSmooth:Qh,polygonTangents:tf,polygonToLine:Nn,polygonize:Kh,polygons:ka,projection:af,propEach:ai,propReduce:La,propertiesContainsFilter:_i,quadratAnalysis:of,radiansToDegrees:zt,radiansToLength:Rn,random:df,randomLineString:So,randomPoint:Lo,randomPolygon:bo,randomPosition:Mo,rectangleGrid:uo,rewind:vf,rhumbBearing:Yt,rhumbDestination:an,rhumbDistance:hr,round:Ia,sample:yf,sector:pf,segmentEach:kt,segmentReduce:li,shortestPath:Ef,simplify:Mf,square:go,squareGrid:ki,standardDeviationalEllipse:Sf,tag:Cf,tesselate:$f,tin:eo,toMercator:Io,toWgs84:No,transformRotate:no,transformScale:To,transformTranslate:Kf,triangleGrid:lo,truncate:vo,union:Qf,unkinkPolygon:ig,validateBBox:tr,validateId:Pa,voronoi:ag},Symbol.toStringTag,{value:"Module"}));export{Eg as a,vi as b,ju as c,nr as d,_a as g,ce as l,kg as t};
